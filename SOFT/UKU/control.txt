; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\control.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\control.d --feedback=.\EXE\UKU_VD_WG12232L3.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_VD -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DWG12232L3 --omf_browse=.\EXE\control.crf control.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  ke_start PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  e92d41fc          PUSH     {r2-r8,lr}
;;;246    {          
000004  4606              MOV      r6,r0
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000006  f04f0700          MOV      r7,#0
00000a  4dff              LDR      r5,|L1.1032|
00000c  766f              STRB     r7,[r5,#0x19]
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  7da8              LDRB     r0,[r5,#0x16]  ; spc_stat
000010  f04f0301          MOV      r3,#1
000014  2802              CMP      r0,#2
000016  d00f              BEQ      |L1.56|
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  eb060146          ADD      r1,r6,r6,LSL #1
00001c  eb011206          ADD      r2,r1,r6,LSL #4
000020  49fa              LDR      r1,|L1.1036|
000022  eb010482          ADD      r4,r1,r2,LSL #2
000026  f894103d          LDRB     r1,[r4,#0x3d]
00002a  07ca              LSLS     r2,r1,#31
00002c  d006              BEQ      |L1.60|
00002e  f04f0066          MOV      r0,#0x66
000032  7668              STRB     r0,[r5,#0x19]
                  |L1.52|
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
000034  e8bd81fc          POP      {r2-r8,pc}
                  |L1.56|
000038  766b              STRB     r3,[r5,#0x19]         ;249
00003a  e7fb              B        |L1.52|
                  |L1.60|
00003c  f894203f          LDRB     r2,[r4,#0x3f]         ;254
000040  0792              LSLS     r2,r2,#30             ;254
000042  d503              BPL      |L1.76|
000044  f04f0067          MOV      r0,#0x67              ;254
000048  7668              STRB     r0,[r5,#0x19]         ;254
00004a  e7f3              B        |L1.52|
                  |L1.76|
00004c  0789              LSLS     r1,r1,#30             ;255
00004e  d503              BPL      |L1.88|
000050  f04f0068          MOV      r0,#0x68              ;255
000054  7668              STRB     r0,[r5,#0x19]         ;255
000056  e7ed              B        |L1.52|
                  |L1.88|
000058  4aed              LDR      r2,|L1.1040|
00005a  f9b41008          LDRSH    r1,[r4,#8]            ;256
00005e  f9b22000          LDRSH    r2,[r2,#0]            ;256  ; IKB
000062  4291              CMP      r1,r2                 ;256
000064  dd03              BLE      |L1.110|
000066  f04f0069          MOV      r0,#0x69              ;256
00006a  7668              STRB     r0,[r5,#0x19]         ;256
00006c  e7e2              B        |L1.52|
                  |L1.110|
00006e  4252              RSBS     r2,r2,#0              ;257
000070  4291              CMP      r1,r2                 ;257
000072  da03              BGE      |L1.124|
000074  f04f006a          MOV      r0,#0x6a              ;257
000078  7668              STRB     r0,[r5,#0x19]         ;257
00007a  e7db              B        |L1.52|
                  |L1.124|
00007c  49e2              LDR      r1,|L1.1032|
00007e  2801              CMP      r0,#1                 ;258
000080  7dc9              LDRB     r1,[r1,#0x17]         ;258
000082  d100              BNE      |L1.134|
000084  b111              CBZ      r1,|L1.140|
                  |L1.134|
000086  2801              CMP      r0,#1                 ;259
000088  d004              BEQ      |L1.148|
00008a  e005              B        |L1.152|
                  |L1.140|
00008c  f04f006b          MOV      r0,#0x6b              ;258
000090  7668              STRB     r0,[r5,#0x19]         ;258
000092  e7cf              B        |L1.52|
                  |L1.148|
000094  2901              CMP      r1,#1                 ;259
000096  d07d              BEQ      |L1.404|
                  |L1.152|
000098  f1050516          ADD      r5,r5,#0x16           ;263
00009c  f04f0064          MOV      r0,#0x64              ;263
0000a0  70e8              STRB     r0,[r5,#3]            ;263
0000a2  702b              STRB     r3,[r5,#0]            ;265
0000a4  862b              STRH     r3,[r5,#0x30]         ;266
0000a6  4619              MOV      r1,r3                 ;267
0000a8  f44f70f8          MOV      r0,#0x1f0             ;267
0000ac  f7fffffe          BL       lc640_write_int
0000b0  706e              STRB     r6,[r5,#1]            ;269
0000b2  866e              STRH     r6,[r5,#0x32]         ;270
0000b4  4631              MOV      r1,r6                 ;271
0000b6  f44f70fa          MOV      r0,#0x1f4             ;271
0000ba  f7fffffe          BL       lc640_write_int
0000be  61a7              STR      r7,[r4,#0x18]         ;273
0000c0  48d4              LDR      r0,|L1.1044|
0000c2  2100              MOVS     r1,#0                 ;274
0000c4  f9300016          LDRSH    r0,[r0,r6,LSL #1]     ;274
0000c8  f7fffffe          BL       lc640_write_int
0000cc  70af              STRB     r7,[r5,#2]            ;276
0000ce  86af              STRH     r7,[r5,#0x34]         ;277
0000d0  4639              MOV      r1,r7                 ;278
0000d2  f44f70fb          MOV      r0,#0x1f6             ;278
0000d6  f7fffffe          BL       lc640_write_int
0000da  48cf              LDR      r0,|L1.1048|
0000dc  8800              LDRH     r0,[r0,#0]            ;285  ; bat_u_old_cnt
0000de  f1000001          ADD      r0,r0,#1              ;285
0000e2  f0000007          AND      r0,r0,#7              ;285
0000e6  eb040040          ADD      r0,r4,r0,LSL #1       ;285
0000ea  8c00              LDRH     r0,[r0,#0x20]         ;285
0000ec  9001              STR      r0,[sp,#4]            ;285
0000ee  4dcb              LDR      r5,|L1.1052|
0000f0  8ba8              LDRH     r0,[r5,#0x1c]         ;287
0000f2  9000              STR      r0,[sp,#0]            ;287
0000f4  f04f0263          MOV      r2,#0x63              ;288
0000f8  f04f0101          MOV      r1,#1                 ;288
0000fc  4668              MOV      r0,sp                 ;288
0000fe  f7fffffe          BL       gran_char
000102  4cc1              LDR      r4,|L1.1032|
000104  f89d0000          LDRB     r0,[sp,#0]            ;289
000108  3488              ADDS     r4,r4,#0x88           ;289
00010a  7020              STRB     r0,[r4,#0]            ;289
00010c  7e28              LDRB     r0,[r5,#0x18]         ;291
00010e  9000              STR      r0,[sp,#0]            ;291
000110  220c              MOVS     r2,#0xc               ;292
000112  2101              MOVS     r1,#1                 ;292
000114  4668              MOV      r0,sp                 ;292
000116  f7fffffe          BL       gran_char
00011a  f89d0000          LDRB     r0,[sp,#0]            ;293
00011e  7060              STRB     r0,[r4,#1]            ;293
000120  7b28              LDRB     r0,[r5,#0xc]          ;295
000122  9000              STR      r0,[sp,#0]            ;295
000124  221f              MOVS     r2,#0x1f              ;296
000126  2101              MOVS     r1,#1                 ;296
000128  4668              MOV      r0,sp                 ;296
00012a  f7fffffe          BL       gran_char
00012e  f89d0000          LDRB     r0,[sp,#0]            ;297
000132  70a0              STRB     r0,[r4,#2]            ;297
000134  f89d0004          LDRB     r0,[sp,#4]            ;299
000138  70e0              STRB     r0,[r4,#3]            ;299
00013a  f44f70fc          MOV      r0,#0x1f8             ;300
00013e  6821              LDR      r1,[r4,#0]            ;300  ; ke_date
000140  f7fffffe          BL       lc640_write_long
000144  7a28              LDRB     r0,[r5,#8]            ;302
000146  9000              STR      r0,[sp,#0]            ;302
000148  2217              MOVS     r2,#0x17              ;303
00014a  2100              MOVS     r1,#0                 ;303
00014c  4668              MOV      r0,sp                 ;303
00014e  f7fffffe          BL       gran_char
000152  f89d0000          LDRB     r0,[sp,#0]            ;304
000156  7120              STRB     r0,[r4,#4]            ;304
000158  7928              LDRB     r0,[r5,#4]            ;306
00015a  9000              STR      r0,[sp,#0]            ;306
00015c  223b              MOVS     r2,#0x3b              ;307
00015e  2100              MOVS     r1,#0                 ;307
000160  4668              MOV      r0,sp                 ;307
000162  f7fffffe          BL       gran_char
000166  f89d0000          LDRB     r0,[sp,#0]            ;308
00016a  7160              STRB     r0,[r4,#5]            ;308
00016c  7828              LDRB     r0,[r5,#0]            ;310
00016e  9000              STR      r0,[sp,#0]            ;310
000170  223b              MOVS     r2,#0x3b              ;311
000172  2100              MOVS     r1,#0                 ;311
000174  4668              MOV      r0,sp                 ;311
000176  f7fffffe          BL       gran_char
00017a  f89d0000          LDRB     r0,[sp,#0]            ;312
00017e  71a0              STRB     r0,[r4,#6]            ;312
000180  f89d0005          LDRB     r0,[sp,#5]            ;314
000184  71e0              STRB     r0,[r4,#7]            ;314
000186  f44f70fe          MOV      r0,#0x1fc             ;315
00018a  6861              LDR      r1,[r4,#4]            ;315  ; ke_date
00018c  f7fffffe          BL       lc640_write_long
000190  e750              B        |L1.52|
000192  e7ff              B        |L1.404|
                  |L1.404|
000194  f04f006c          MOV      r0,#0x6c              ;259
000198  7668              STRB     r0,[r5,#0x19]         ;259
00019a  e74b              B        |L1.52|
;;;320    
                          ENDP

                  samokalibr_hndl PROC
;;;327    //-----------------------------------------------
;;;328    void samokalibr_hndl(void)
00019c  e92d47f0          PUSH     {r4-r10,lr}
;;;329    {
;;;330    if(++samokalibr_cnt>=1800)samokalibr_cnt=0;
0001a0  4c99              LDR      r4,|L1.1032|
0001a2  f8b40042          LDRH     r0,[r4,#0x42]  ; samokalibr_cnt
0001a6  1c40              ADDS     r0,r0,#1
0001a8  b200              SXTH     r0,r0
0001aa  f8a40042          STRH     r0,[r4,#0x42]
0001ae  f5b06fe1          CMP      r0,#0x708
0001b2  db03              BLT      |L1.444|
0001b4  f04f0000          MOV      r0,#0
0001b8  f8a40042          STRH     r0,[r4,#0x42]
                  |L1.444|
;;;331    
;;;332    if(samokalibr_cnt>=1785U)
0001bc  f9b40042          LDRSH    r0,[r4,#0x42]  ; samokalibr_cnt
0001c0  f5b06fdf          CMP      r0,#0x6f8
0001c4  d911              BLS      |L1.490|
;;;333    	{
;;;334    	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,15);
0001c6  230f              MOVS     r3,#0xf
0001c8  2201              MOVS     r2,#1
0001ca  2164              MOVS     r1,#0x64
0001cc  20d2              MOVS     r0,#0xd2
0001ce  f7fffffe          BL       mess_send
;;;335    	mess_send(MESS2IND_HNDL,PARAM_SAMOKALIBR,0,15);
0001d2  230f              MOVS     r3,#0xf
0001d4  2200              MOVS     r2,#0
0001d6  21d8              MOVS     r1,#0xd8
0001d8  20d7              MOVS     r0,#0xd7
0001da  f7fffffe          BL       mess_send
;;;336    	mess_send(MESS2MATEMAT,PARAM_SAMOKALIBR,0,15);
0001de  230f              MOVS     r3,#0xf
0001e0  2200              MOVS     r2,#0
0001e2  21d8              MOVS     r1,#0xd8
0001e4  20dc              MOVS     r0,#0xdc
0001e6  f7fffffe          BL       mess_send
                  |L1.490|
;;;337    	} 
;;;338    
;;;339    if(samokalibr_cnt==1799U)
0001ea  f9b40042          LDRSH    r0,[r4,#0x42]  ; samokalibr_cnt
0001ee  f5a061e0          SUB      r1,r0,#0x700
0001f2  3907              SUBS     r1,#7
0001f4  d133              BNE      |L1.606|
;;;340    	{
;;;341    	if((Kibat0[0]!=ad7705_buff_[0])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[0],ad7705_buff_[0]);
0001f6  4d8a              LDR      r5,|L1.1056|
0001f8  4c8a              LDR      r4,|L1.1060|
0001fa  4e84              LDR      r6,|L1.1036|
0001fc  8828              LDRH     r0,[r5,#0]  ; Kibat0
0001fe  8821              LDRH     r1,[r4,#0]  ; ad7705_buff_
000200  270a              MOVS     r7,#0xa
000202  f8df8224          LDR      r8,|L1.1064|
000206  f8df9224          LDR      r9,|L1.1068|
00020a  4288              CMP      r0,r1
00020c  d010              BEQ      |L1.560|
00020e  f9b60008          LDRSH    r0,[r6,#8]  ; bat
000212  fb90f0f7          SDIV     r0,r0,r7
000216  b200              SXTH     r0,r0
000218  f7fffffe          BL       abs
00021c  f9b81000          LDRSH    r1,[r8,#0]  ; IZMAX
000220  4288              CMP      r0,r1
000222  da05              BGE      |L1.560|
000224  f9b41000          LDRSH    r1,[r4,#0]  ; ad7705_buff_
000228  f9b90000          LDRSH    r0,[r9,#0]  ; ADR_KI0BAT
00022c  f7fffffe          BL       lc640_write_int
                  |L1.560|
;;;342    	if((Kibat0[1]!=ad7705_buff_[1])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[1],ad7705_buff_[1]);
000230  8868              LDRH     r0,[r5,#2]  ; Kibat0
000232  8861              LDRH     r1,[r4,#2]  ; ad7705_buff_
000234  4288              CMP      r0,r1
000236  d012              BEQ      |L1.606|
000238  f9b60008          LDRSH    r0,[r6,#8]  ; bat
00023c  fb90f0f7          SDIV     r0,r0,r7
000240  b200              SXTH     r0,r0
000242  f7fffffe          BL       abs
000246  f9b81000          LDRSH    r1,[r8,#0]  ; IZMAX
00024a  4288              CMP      r0,r1
00024c  da07              BGE      |L1.606|
00024e  f9b41002          LDRSH    r1,[r4,#2]  ; ad7705_buff_
000252  f9b90002          LDRSH    r0,[r9,#2]  ; ADR_KI0BAT
000256  e8bd47f0          POP      {r4-r10,lr}
00025a  f7ffbffe          B.W      lc640_write_int
                  |L1.606|
;;;343    	
;;;344    	}	 	
;;;345    }
00025e  e8bd87f0          POP      {r4-r10,pc}
;;;346    
                          ENDP

                  ubat_old_drv PROC
;;;349    //-----------------------------------------------
;;;350    void ubat_old_drv(void)
000262  b510              PUSH     {r4,lr}
;;;351    {        
;;;352    bat_u_old_cnt++;
000264  4c6c              LDR      r4,|L1.1048|
000266  8820              LDRH     r0,[r4,#0]  ; bat_u_old_cnt
000268  f1000001          ADD      r0,r0,#1
00026c  8020              STRH     r0,[r4,#0]
;;;353    gran_ring(&bat_u_old_cnt,0,8);
00026e  f04f0208          MOV      r2,#8
000272  f04f0100          MOV      r1,#0
000276  4620              MOV      r0,r4
000278  f7fffffe          BL       gran_ring
;;;354    
;;;355    bat[0]._u_old[bat_u_old_cnt]=bat[0]._Ub;
00027c  4963              LDR      r1,|L1.1036|
00027e  f9b40000          LDRSH    r0,[r4,#0]  ; bat_u_old_cnt
000282  eb010040          ADD      r0,r1,r0,LSL #1
000286  884a              LDRH     r2,[r1,#2]  ; bat
000288  8402              STRH     r2,[r0,#0x20]
;;;356    bat[1]._u_old[bat_u_old_cnt]=bat[1]._Ub;
00028a  f8b1104e          LDRH     r1,[r1,#0x4e]  ; bat
00028e  f8a0106c          STRH     r1,[r0,#0x6c]
;;;357    }
000292  bd10              POP      {r4,pc}
;;;358    /*
                          ENDP

                  matemat PROC
;;;395    //-----------------------------------------------
;;;396    void matemat(void)
000294  e92d4ffe          PUSH     {r1-r11,lr}
;;;397    {
;;;398    //signed short temp_SS;
;;;399    signed long temp_SL/*,temp_SL_*/;
;;;400    char /*temp,*/i;
;;;401    //signed short temp_SS;
;;;402    /*
;;;403    #ifdef UKU_MGTS
;;;404    //напр€жение сети
;;;405    temp_SL=(signed long)net_buff_;
;;;406    temp_SL*=Kunet;
;;;407    temp_SL/=110000L;
;;;408    net_U=(signed short)temp_SL;
;;;409    #endif
;;;410    */
;;;411    
;;;412    /*
;;;413    #ifdef UKU_RSTKM
;;;414    //напр€жение сети
;;;415    temp_SL=(signed long)net_buff_;
;;;416    temp_SL*=Kunet;
;;;417    temp_SL/=110000L;
;;;418    net_U=(signed short)temp_SL;
;;;419    #endif
;;;420    */
;;;421    /*
;;;422    #ifdef UKU_3U
;;;423    //напр€жение сети
;;;424    temp_SL=(signed long)net_buff_;
;;;425    temp_SL*=Kunet;
;;;426    temp_SL/=36000L;
;;;427    net_U=(signed short)temp_SL;
;;;428    #endif
;;;429    */
;;;430    /*
;;;431    #ifdef UKU_6U
;;;432    //напр€жение сети
;;;433    
;;;434    if((AUSW_MAIN%10)||(AUSW_MAIN==2400)||(AUSW_MAIN==4800)||(AUSW_MAIN==6000))
;;;435    	{
;;;436    
;;;437    	if(bps[11]._device==dNET_METR)
;;;438    		{
;;;439    		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;440    		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;441    		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;442    
;;;443    		temp_SL=(signed long)net_metr_buff_[0];
;;;444    		temp_SL*=KunetA;
;;;445    		temp_SL/=6000L;
;;;446    		net_Ua=(signed short)temp_SL;
;;;447    	
;;;448    		temp_SL=(signed long)net_metr_buff_[1];
;;;449    		temp_SL*=KunetB;
;;;450    		temp_SL/=6000L;
;;;451    		net_Ub=(signed short)temp_SL;
;;;452    	
;;;453    		temp_SL=(signed long)net_metr_buff_[2];
;;;454    		temp_SL*=KunetC;
;;;455    		temp_SL/=6000L;
;;;456    		net_Uc=(signed short)temp_SL;
;;;457    		}
;;;458    	else
;;;459    		{
;;;460    		temp_SL=(signed long)net_buff_;
;;;461    		temp_SL*=KunetA;
;;;462    		temp_SL/=110000L;
;;;463    		net_Ua=(signed short)temp_SL;
;;;464    	
;;;465    		temp_SL=(signed long)adc_buff_[3];
;;;466    		temp_SL*=KunetB;
;;;467    		temp_SL/=6000L;
;;;468    		net_Ub=(signed short)temp_SL;
;;;469    	
;;;470    		temp_SL=(signed long)adc_buff_[10];
;;;471    		temp_SL*=KunetC;
;;;472    		temp_SL/=6000L;
;;;473    		net_Uc=(signed short)temp_SL;
;;;474    		}
;;;475    
;;;476    	net_U=net_Ua;
;;;477    	if(net_Ub<net_U)net_U=net_Ub;
;;;478    	if(net_Uc<net_U)net_U=net_Uc;
;;;479    	}
;;;480    else 
;;;481    	{
;;;482    	temp_SL=(signed long)net_buff_;
;;;483    	temp_SL*=Kunet;
;;;484    	temp_SL/=110000L;
;;;485    	net_U=(signed short)temp_SL;
;;;486    	}
;;;487    
;;;488    
;;;489    
;;;490    
;;;491    #endif */
;;;492    /*
;;;493    #ifdef UKU_GLONASS
;;;494    //напр€жение сети
;;;495    temp_SL=(signed long)net_buff_;
;;;496    temp_SL*=Kunet;
;;;497    temp_SL/=110000L;
;;;498    net_U=(signed short)temp_SL;
;;;499    #endif
;;;500    */
;;;501    /*#ifdef UKU_KONTUR
;;;502    //напр€жение сети
;;;503    temp_SL=(signed long)net_buff_;
;;;504    temp_SL*=Kunet;
;;;505    temp_SL/=110000L;
;;;506    net_U=(signed short)temp_SL;
;;;507    #endif */
;;;508    
;;;509    /*
;;;510    #ifdef UKU_220_V2
;;;511    //напр€жение сети
;;;512    
;;;513    if(AUSW_MAIN==22033)
;;;514    	{
;;;515    	temp_SL=(signed long)net_buff_;
;;;516    	temp_SL*=KunetA;
;;;517    	temp_SL/=6000L;
;;;518    	net_Ua=(signed short)temp_SL;
;;;519    
;;;520    	temp_SL=(signed long)adc_buff_[3];
;;;521    	temp_SL*=KunetB;
;;;522    	temp_SL/=6000L;
;;;523    	net_Ub=(signed short)temp_SL;
;;;524    
;;;525    	temp_SL=(signed long)adc_buff_[10];
;;;526    	temp_SL*=KunetC;
;;;527    	temp_SL/=6000L;
;;;528    	net_Uc=(signed short)temp_SL;
;;;529    
;;;530    	net_U=net_Ua;
;;;531    	if(net_Ub<net_U)net_U=net_Ub;
;;;532    	if(net_Uc<net_U)net_U=net_Uc;
;;;533    	}
;;;534    else
;;;535    	{
;;;536    	temp_SL=(signed long)net_buff_;
;;;537    	temp_SL*=Kunet;
;;;538    	temp_SL/=5000L;
;;;539    	net_U=(signed short)temp_SL;
;;;540    	}
;;;541    #endif
;;;542    */
;;;543    /*
;;;544    #ifdef UKU_220
;;;545    //напр€жение сети
;;;546    
;;;547    if(AUSW_MAIN==22035)
;;;548    	{
;;;549    	temp_SL=(signed long)net_buff_;
;;;550    	temp_SL*=KunetA;
;;;551    	temp_SL/=6000L;
;;;552    	net_Ua=(signed short)temp_SL;
;;;553    
;;;554    	temp_SL=(signed long)adc_buff_[3];
;;;555    	temp_SL*=KunetB;
;;;556    	temp_SL/=6000L;
;;;557    	net_Ub=(signed short)temp_SL;
;;;558    
;;;559    	temp_SL=(signed long)adc_buff_[10];
;;;560    	temp_SL*=KunetC;
;;;561    	temp_SL/=6000L;
;;;562    	net_Uc=(signed short)temp_SL;
;;;563    
;;;564    	net_U=net_Ua;
;;;565    	if(net_Ub<net_U)net_U=net_Ub;
;;;566    	if(net_Uc<net_U)net_U=net_Uc;
;;;567    	}
;;;568    else
;;;569    	{
;;;570    	temp_SL=(signed long)net_buff_;
;;;571    	temp_SL*=Kunet;
;;;572    	#ifdef _ACDC_
;;;573    	temp_SL/=500L;
;;;574    	#else
;;;575    	temp_SL/=5000L;
;;;576    	#endif
;;;577    	net_U=(signed short)temp_SL;
;;;578    	
;;;579    	}
;;;580    #endif
;;;581    */
;;;582    #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;583    //напр€жение сети
;;;584    
;;;585    
;;;586    	if(bps[11]._device==dNET_METR)
000298  4865              LDR      r0,|L1.1072|
;;;587    		{
;;;588    		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;589    		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;590    		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;591    
;;;592    		temp_SL=(signed long)net_metr_buff_[2];
;;;593    		temp_SL*=KunetA;
00029a  4a66              LDR      r2,|L1.1076|
;;;594    		temp_SL/=6000L;
;;;595    		net_Ua=(signed short)temp_SL;
;;;596    	
;;;597    		temp_SL=(signed long)net_metr_buff_[1];
;;;598    		temp_SL*=KunetB;
00029c  4967              LDR      r1,|L1.1084|
00029e  f8900528          LDRB     r0,[r0,#0x528]        ;586  ; bps
0002a2  9002              STR      r0,[sp,#8]            ;593
;;;599    		temp_SL/=6000L;
;;;600    		net_Ub=(signed short)temp_SL;
;;;601    	
;;;602    		temp_SL=(signed long)net_metr_buff_[0];
;;;603    		temp_SL*=KunetC;
0002a4  4b66              LDR      r3,|L1.1088|
0002a6  f9b2b000          LDRSH    r11,[r2,#0]           ;593
0002aa  f9b11000          LDRSH    r1,[r1,#0]            ;598
0002ae  9101              STR      r1,[sp,#4]
0002b0  f9b31000          LDRSH    r1,[r3,#0]
0002b4  4d60              LDR      r5,|L1.1080|
0002b6  4b63              LDR      r3,|L1.1092|
;;;604    		temp_SL/=6000L;
;;;605    		net_Uc=(signed short)temp_SL;
0002b8  4f63              LDR      r7,|L1.1096|
;;;606    
;;;607    		net_F3=((signed short)bps[11]._buff[6])+(((signed short)bps[11]._buff[7])<<8);
;;;608    
;;;609    		net_U=net_Ua;
0002ba  4c64              LDR      r4,|L1.1100|
;;;610    		if(net_Ub<net_U)net_U=net_Ub;
;;;611    		if(net_Uc<net_U)net_U=net_Uc;
;;;612    		}
;;;613    	  else if(AUSW_MAIN==22033)
0002bc  f8df9190          LDR      r9,|L1.1104|
0002c0  f2456611          MOV      r6,#0x5611
;;;614    	{
;;;615    	temp_SL=(signed long)net_buff_;
;;;616    	temp_SL*=KunetA;
;;;617    	temp_SL/=4000L;
;;;618    	net_Ua=(signed short)temp_SL;
;;;619    
;;;620    	temp_SL=(signed long)adc_buff_[3];
;;;621    	temp_SL*=KunetB;
;;;622    	temp_SL/=6000L;
;;;623    	net_Ub=(signed short)temp_SL;
;;;624    
;;;625    	temp_SL=(signed long)adc_buff_[10];
;;;626    	temp_SL*=KunetC;
;;;627    	temp_SL/=6000L;
;;;628    	net_Uc=(signed short)temp_SL;
;;;629    
;;;630    	net_U=net_Ua;
;;;631    	if(net_Ub<net_U)net_U=net_Ub;
;;;632    	if(net_Uc<net_U)net_U=net_Uc;
;;;633    	}
;;;634    else if((AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043)||(AUSW_MAIN==22018))
;;;635    	{
;;;636    	temp_SL=(signed long)net_buff_;
;;;637    	temp_SL*=KunetA;
;;;638    	temp_SL/=40000L;
;;;639    	net_Ua=(signed short)temp_SL;
;;;640    
;;;641    	temp_SL=(signed long)adc_buff_[3];
;;;642    	temp_SL*=KunetB;
;;;643    	temp_SL/=6000L;
;;;644    	net_Ub=(signed short)temp_SL;
;;;645    
;;;646    	temp_SL=(signed long)adc_buff_[10];
;;;647    	temp_SL*=KunetC;
;;;648    	temp_SL/=6000L;
;;;649    	net_Uc=(signed short)temp_SL;
;;;650    
;;;651    	net_U=net_Ua;
;;;652    	if(net_Ub<net_U)net_U=net_Ub;
;;;653    	if(net_Uc<net_U)net_U=net_Uc;
;;;654    	}
;;;655    else	if((AUSW_MAIN==22010)||(AUSW_MAIN==22011) )
0002c4  f24558fa          MOV      r8,#0x55fa
0002c8  9100              STR      r1,[sp,#0]            ;586
0002ca  2807              CMP      r0,#7                 ;586
0002cc  d038              BEQ      |L1.832|
0002ce  494e              LDR      r1,|L1.1032|
0002d0  f8dfc180          LDR      r12,|L1.1108|
0002d4  f8dfa164          LDR      r10,|L1.1084|
0002d8  8d0a              LDRH     r2,[r1,#0x28]         ;615
0002da  4956              LDR      r1,|L1.1076|
0002dc  f9baa000          LDRSH    r10,[r10,#0]          ;598
0002e0  f2417b70          MOV      r11,#0x1770           ;594
0002e4  f9b11000          LDRSH    r1,[r1,#0]            ;593
0002e8  f8b90000          LDRH     r0,[r9,#0]            ;613  ; AUSW_MAIN
0002ec  434a              MULS     r2,r1,r2              ;616
0002ee  f9bc1006          LDRSH    r1,[r12,#6]           ;620
0002f2  f9bcc014          LDRSH    r12,[r12,#0x14]       ;625
0002f6  fb01f10a          MUL      r1,r1,r10             ;621
0002fa  f8dfa144          LDR      r10,|L1.1088|
0002fe  fb91f1fb          SDIV     r1,r1,r11             ;622
000302  f9baa000          LDRSH    r10,[r10,#0]          ;603
000306  b209              SXTH     r1,r1                 ;623
000308  fb0cfc0a          MUL      r12,r12,r10           ;626
00030c  fb9cfcfb          SDIV     r12,r12,r11           ;627
000310  fa0ffc8c          SXTH     r12,r12               ;628
000314  42b0              CMP      r0,r6                 ;613
000316  d158              BNE      |L1.970|
000318  f44f607a          MOV      r0,#0xfa0             ;617
00031c  fb92f0f0          SDIV     r0,r2,r0              ;617
000320  b200              SXTH     r0,r0                 ;618
000322  8028              STRH     r0,[r5,#0]            ;618
000324  8019              STRH     r1,[r3,#0]            ;623
000326  f8a7c000          STRH     r12,[r7,#0]           ;628
00032a  8020              STRH     r0,[r4,#0]            ;630
00032c  4281              CMP      r1,r0                 ;631
00032e  da00              BGE      |L1.818|
000330  8021              STRH     r1,[r4,#0]            ;631
                  |L1.818|
000332  f9b40000          LDRSH    r0,[r4,#0]            ;632  ; net_U
000336  4584              CMP      r12,r0                ;632
000338  da01              BGE      |L1.830|
00033a  f8a4c000          STRH     r12,[r4,#0]           ;632
                  |L1.830|
00033e  e0aa              B        |L1.1174|
                  |L1.832|
000340  4845              LDR      r0,|L1.1112|
000342  f8dfc0c4          LDR      r12,|L1.1032|
000346  7801              LDRB     r1,[r0,#0]            ;588  ; bps
000348  7842              LDRB     r2,[r0,#1]            ;588  ; bps
00034a  f10c0c74          ADD      r12,r12,#0x74         ;588
00034e  eb012102          ADD      r1,r1,r2,LSL #8       ;588
000352  fa1ffa81          UXTH     r10,r1                ;588
000356  f8aca000          STRH     r10,[r12,#0]          ;588
00035a  7881              LDRB     r1,[r0,#2]            ;589  ; bps
00035c  78c2              LDRB     r2,[r0,#3]            ;589  ; bps
00035e  eb012102          ADD      r1,r1,r2,LSL #8       ;589
000362  b289              UXTH     r1,r1                 ;589
000364  f8ac1002          STRH     r1,[r12,#2]           ;589
000368  7902              LDRB     r2,[r0,#4]            ;590  ; bps
00036a  f890e005          LDRB     lr,[r0,#5]            ;590  ; bps
00036e  eb02220e          ADD      r2,r2,lr,LSL #8       ;590
000372  b292              UXTH     r2,r2                 ;590
000374  f8ac2004          STRH     r2,[r12,#4]           ;590
000378  fb02f20b          MUL      r2,r2,r11             ;593
00037c  f2417c70          MOV      r12,#0x1770           ;594
000380  fb92f2fc          SDIV     r2,r2,r12             ;594
000384  fa0ffb82          SXTH     r11,r2                ;595
000388  f8a5b000          STRH     r11,[r5,#0]           ;595
00038c  9a01              LDR      r2,[sp,#4]            ;598
00038e  fb01f102          MUL      r1,r1,r2              ;598
000392  fb91f1fc          SDIV     r1,r1,r12             ;599
000396  b209              SXTH     r1,r1                 ;600
000398  8019              STRH     r1,[r3,#0]            ;600
00039a  9a00              LDR      r2,[sp,#0]            ;603
00039c  fb0afa02          MUL      r10,r10,r2            ;603
0003a0  fb9af2fc          SDIV     r2,r10,r12            ;604
0003a4  b212              SXTH     r2,r2                 ;605
0003a6  803a              STRH     r2,[r7,#0]            ;605
0003a8  7983              LDRB     r3,[r0,#6]            ;607  ; bps
0003aa  79c0              LDRB     r0,[r0,#7]            ;607  ; bps
0003ac  eb032000          ADD      r0,r3,r0,LSL #8       ;607
0003b0  4b2a              LDR      r3,|L1.1116|
0003b2  8018              STRH     r0,[r3,#0]            ;607
0003b4  f8a4b000          STRH     r11,[r4,#0]           ;609
0003b8  4559              CMP      r1,r11                ;610
0003ba  da00              BGE      |L1.958|
0003bc  8021              STRH     r1,[r4,#0]            ;610
                  |L1.958|
0003be  f9b40000          LDRSH    r0,[r4,#0]            ;611  ; net_U
0003c2  4282              CMP      r2,r0                 ;611
0003c4  da67              BGE      |L1.1174|
0003c6  8022              STRH     r2,[r4,#0]            ;611
0003c8  e065              B        |L1.1174|
                  |L1.970|
0003ca  f5a04aac          SUB      r10,r0,#0x5600        ;634
0003ce  f1ba0a2f          SUBS     r10,r10,#0x2f         ;634
0003d2  d008              BEQ      |L1.998|
0003d4  f11a0a28          ADDS     r10,r10,#0x28         ;634
0003d8  d005              BEQ      |L1.998|
0003da  f1ba0a14          SUBS     r10,r10,#0x14         ;634
0003de  d002              BEQ      |L1.998|
0003e0  f11a0a19          ADDS     r10,r10,#0x19         ;634
0003e4  d140              BNE      |L1.1128|
                  |L1.998|
0003e6  f6494040          MOV      r0,#0x9c40            ;638
0003ea  fb92f0f0          SDIV     r0,r2,r0              ;638
0003ee  b200              SXTH     r0,r0                 ;639
0003f0  8028              STRH     r0,[r5,#0]            ;639
0003f2  8019              STRH     r1,[r3,#0]            ;644
0003f4  f8a7c000          STRH     r12,[r7,#0]           ;649
0003f8  8020              STRH     r0,[r4,#0]            ;651
0003fa  4281              CMP      r1,r0                 ;652
0003fc  da00              BGE      |L1.1024|
0003fe  8021              STRH     r1,[r4,#0]            ;652
                  |L1.1024|
000400  f9b40000          LDRSH    r0,[r4,#0]            ;653  ; net_U
000404  4584              CMP      r12,r0                ;653
000406  e02b              B        |L1.1120|
                  |L1.1032|
                          DCD      ||area_number.26||
                  |L1.1036|
                          DCD      bat
                  |L1.1040|
                          DCD      IKB
                  |L1.1044|
                          DCD      ADR_EE_BAT_ZAR_CNT_KE
                  |L1.1048|
                          DCD      bat_u_old_cnt
                  |L1.1052|
                          DCD      0x40024020
                  |L1.1056|
                          DCD      Kibat0
                  |L1.1060|
                          DCD      ad7705_buff_
                  |L1.1064|
                          DCD      IZMAX
                  |L1.1068|
                          DCD      ADR_KI0BAT
                  |L1.1072|
                          DCD      bps
                  |L1.1076|
                          DCD      KunetA
                  |L1.1080|
                          DCD      net_Ua
                  |L1.1084|
                          DCD      KunetB
                  |L1.1088|
                          DCD      KunetC
                  |L1.1092|
                          DCD      net_Ub
                  |L1.1096|
                          DCD      net_Uc
                  |L1.1100|
                          DCD      net_U
                  |L1.1104|
                          DCD      AUSW_MAIN
                  |L1.1108|
                          DCD      ||.bss||+0x400
                  |L1.1112|
                          DCD      bps+0x52e
                  |L1.1116|
                          DCD      net_F3
                  |L1.1120|
000460  da19              BGE      |L1.1174|
000462  f8a4c000          STRH     r12,[r4,#0]           ;653
000466  e016              B        |L1.1174|
                  |L1.1128|
;;;656    	{
;;;657    	temp_SL=(signed long)net_buff_;
;;;658    	temp_SL*=Kunet;
000468  49ff              LDR      r1,|L1.2152|
00046a  f9b12000          LDRSH    r2,[r1,#0]
00046e  49ff              LDR      r1,|L1.2156|
000470  8d09              LDRH     r1,[r1,#0x28]         ;615
000472  4351              MULS     r1,r2,r1
000474  4540              CMP      r0,r8                 ;655
000476  d003              BEQ      |L1.1152|
000478  f5a042aa          SUB      r2,r0,#0x5500         ;655
00047c  3afb              SUBS     r2,r2,#0xfb           ;655
00047e  d105              BNE      |L1.1164|
                  |L1.1152|
;;;659    	temp_SL/=35000L;
000480  f64800b8          MOV      r0,#0x88b8
000484  fb91f0f0          SDIV     r0,r1,r0
;;;660    	net_U=(signed short)temp_SL;
000488  8020              STRH     r0,[r4,#0]
00048a  e004              B        |L1.1174|
                  |L1.1164|
;;;661    	
;;;662    	}
;;;663    else
;;;664    	{
;;;665    	temp_SL=(signed long)net_buff_;
;;;666    	temp_SL*=Kunet;
;;;667    	#ifdef _ACDC_
;;;668    	temp_SL/=500L;
00048c  f44f70fa          MOV      r0,#0x1f4
000490  fb91f0f0          SDIV     r0,r1,r0
;;;669    	#else
;;;670    	temp_SL/=5000L;
;;;671    	#endif
;;;672    	net_U=(signed short)temp_SL;
000494  8020              STRH     r0,[r4,#0]
                  |L1.1174|
;;;673    	
;;;674    	}
;;;675    if(bps[11]._device!=dNET_METR) net_F3=net_F;
000496  9802              LDR      r0,[sp,#8]
000498  2807              CMP      r0,#7
00049a  d003              BEQ      |L1.1188|
00049c  48f4              LDR      r0,|L1.2160|
00049e  8801              LDRH     r1,[r0,#0]  ; net_F
0004a0  48f4              LDR      r0,|L1.2164|
0004a2  8001              STRH     r1,[r0,#0]
                  |L1.1188|
;;;676    #endif
;;;677    /*
;;;678    #ifdef UKU_TELECORE2015
;;;679    //напр€жение сети
;;;680    temp_SL=(signed long)net_buff_;
;;;681    temp_SL*=Kunet;
;;;682    temp_SL/=110000L;
;;;683    net_U=(signed short)temp_SL;
;;;684    #endif
;;;685    *//*
;;;686    #ifdef UKU_TELECORE2017
;;;687    //напр€жение сети
;;;688    temp_SL=(signed long)net_buff_;
;;;689    temp_SL*=Kunet;
;;;690    temp_SL/=110000L;
;;;691    net_U=(signed short)temp_SL;
;;;692    #endif*/
;;;693    
;;;694    //Ќапр€жени€ батарей
;;;695    temp_SL=(signed long)adc_buff_[0];
0004a4  f8dfa3d0          LDR      r10,|L1.2168|
0004a8  f9ba2000          LDRSH    r2,[r10,#0]  ; adc_buff_
;;;696    temp_SL*=Kubat[0];
0004ac  49f3              LDR      r1,|L1.2172|
0004ae  f9b10000          LDRSH    r0,[r1,#0]  ; Kubat
0004b2  4350              MULS     r0,r2,r0
;;;697    temp_SL/=2000L;
0004b4  f44f67fa          MOV      r7,#0x7d0
0004b8  fb90f0f7          SDIV     r0,r0,r7
;;;698    bat[0]._Ub=(signed short)temp_SL;
0004bc  4df0              LDR      r5,|L1.2176|
0004be  8068              STRH     r0,[r5,#2]
;;;699    /*
;;;700    #ifdef UKU_220
;;;701    //Ќапр€жени€ батарей
;;;702    temp_SL=(signed long)adc_buff_[0];
;;;703    temp_SL*=Kubat[0];
;;;704    temp_SL/=400L;
;;;705    bat[0]._Ub=(signed short)temp_SL;
;;;706    #endif
;;;707    
;;;708    #ifdef UKU_220_V2
;;;709    //Ќапр€жени€ батарей
;;;710    temp_SL=(signed long)adc_buff_[0];
;;;711    temp_SL*=Kubat[0];
;;;712    temp_SL/=400L;
;;;713    bat[0]._Ub=(signed short)temp_SL;
;;;714    #endif */
;;;715    
;;;716    temp_SL=(signed long)adc_buff_[4];
0004c0  f9ba3008          LDRSH    r3,[r10,#8]  ; adc_buff_
;;;717    temp_SL*=Kubatm[0];
0004c4  4aef              LDR      r2,|L1.2180|
0004c6  f9b20000          LDRSH    r0,[r2,#0]  ; Kubatm
0004ca  fb00f003          MUL      r0,r0,r3
;;;718    temp_SL/=700L;
0004ce  f44f732f          MOV      r3,#0x2bc
0004d2  fb90f0f3          SDIV     r0,r0,r3
;;;719    bat[0]._Ubm=(signed short)temp_SL;
0004d6  80a8              STRH     r0,[r5,#4]
;;;720    /*
;;;721    #ifdef UKU_KONTUR
;;;722    temp_SL=(signed long)adc_buff_[4];
;;;723    temp_SL*=Kubatm[0];
;;;724    temp_SL/=2000L;
;;;725    bat[0]._Ubm=(signed short)temp_SL;
;;;726    #endif */
;;;727    
;;;728    temp_SL=(signed long)adc_buff_[12];
0004d8  f9ba0018          LDRSH    r0,[r10,#0x18]  ; adc_buff_
;;;729    temp_SL*=Kubat[1];
0004dc  f9b11002          LDRSH    r1,[r1,#2]  ; Kubat
0004e0  fb01f100          MUL      r1,r1,r0
;;;730    temp_SL/=2000L;
0004e4  fb91f0f7          SDIV     r0,r1,r7
;;;731    bat[1]._Ub=(signed short)temp_SL;
0004e8  f8a5004e          STRH     r0,[r5,#0x4e]
;;;732    /*
;;;733    #ifdef UKU_220
;;;734    temp_SL=(signed long)adc_buff_[12];
;;;735    temp_SL*=Kubat[1];
;;;736    temp_SL/=400L;
;;;737    bat[1]._Ub=(signed short)temp_SL;
;;;738    #endif
;;;739    
;;;740    #ifdef UKU_220_V2
;;;741    temp_SL=(signed long)adc_buff_[12];
;;;742    temp_SL*=Kubat[1];
;;;743    temp_SL/=400L;
;;;744    bat[1]._Ub=(signed short)temp_SL;
;;;745    #endif
;;;746    */
;;;747    temp_SL=(signed long)adc_buff_[1];
0004ec  f9ba0002          LDRSH    r0,[r10,#2]  ; adc_buff_
;;;748    temp_SL*=Kubatm[1];
0004f0  f9b21002          LDRSH    r1,[r2,#2]  ; Kubatm
0004f4  fb01f100          MUL      r1,r1,r0
;;;749    temp_SL/=700L;
0004f8  fb91f0f3          SDIV     r0,r1,r3
;;;750    bat[1]._Ubm=(signed short)temp_SL;
0004fc  f8a50050          STRH     r0,[r5,#0x50]
;;;751    #ifdef UKU_KONTUR
;;;752    temp_SL=(signed long)adc_buff_[1];
;;;753    temp_SL*=Kubatm[1];
;;;754    temp_SL/=2000L;
;;;755    bat[1]._Ubm=(signed short)temp_SL;
;;;756    #endif
;;;757    
;;;758    #ifdef UKU_TELECORE2015
;;;759    temp_SL=(signed long)adc_buff_[2];
;;;760    temp_SL*=Kubat[0];
;;;761    temp_SL/=2000L;
;;;762    bat[0]._Ub=(signed short)temp_SL;
;;;763    #endif
;;;764    
;;;765    /*
;;;766    //“оки батарей
;;;767    if(!mess_find_unvol(MESS2MATEMAT))
;;;768    	{
;;;769    	temp_SL=(signed long)ad7705_buff_[0];
;;;770    	temp_SL-=(signed long)Kibat0[0];
;;;771    	temp_SL*=(signed long)Kibat1[0];
;;;772    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;773    	else temp_SL/=1000L;
;;;774    	bat[0]._Ib=(signed short)temp_SL;
;;;775    
;;;776    	temp_SL=(signed long)ad7705_buff_[1];
;;;777    	temp_SL-=(signed long)Kibat0[1];
;;;778    	temp_SL*=(signed long)Kibat1[1];
;;;779    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;780    	else temp_SL/=1000L;
;;;781    	bat[1]._Ib=(signed short)temp_SL;
;;;782    	}
;;;783    */
;;;784    
;;;785    
;;;786    //“оки батарей
;;;787    if(!mess_find_unvol(MESS2MATEMAT))
000500  f04f00dc          MOV      r0,#0xdc
000504  f7fffffe          BL       mess_find_unvol
000508  bbf0              CBNZ     r0,|L1.1416|
;;;788    	{
;;;789    	temp_SL=(signed long)ad7705_buff_[0];
00050a  f8dfc37c          LDR      r12,|L1.2184|
00050e  f8bc0000          LDRH     r0,[r12,#0]  ; ad7705_buff_
;;;790    	temp_SL-=(signed long)Kibat0[0];
000512  f8dfb378          LDR      r11,|L1.2188|
000516  f8bb1000          LDRH     r1,[r11,#0]  ; Kibat0
00051a  eba00001          SUB      r0,r0,r1
;;;791    	temp_SL*=(signed long)Kibat1[0];
00051e  4adc              LDR      r2,|L1.2192|
000520  f9b21000          LDRSH    r1,[r2,#0]  ; Kibat1
000524  fb01f100          MUL      r1,r1,r0
;;;792    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
000528  f8b90000          LDRH     r0,[r9,#0]  ; AUSW_MAIN
00052c  f6456338          MOV      r3,#0x5e38
000530  4298              CMP      r0,r3
000532  d004              BEQ      |L1.1342|
000534  f5a04ebc          SUB      lr,r0,#0x5e00
000538  f1be0e92          SUBS     lr,lr,#0x92
00053c  d104              BNE      |L1.1352|
                  |L1.1342|
00053e  f44f7e96          MOV      lr,#0x12c
000542  fb91f1fe          SDIV     r1,r1,lr
000546  e00f              B        |L1.1384|
                  |L1.1352|
;;;793    	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
000548  4540              CMP      r0,r8
00054a  d006              BEQ      |L1.1370|
00054c  f5a04eac          SUB      lr,r0,#0x5600
000550  f1be0e13          SUBS     lr,lr,#0x13
000554  d001              BEQ      |L1.1370|
000556  42b0              CMP      r0,r6
000558  d102              BNE      |L1.1376|
                  |L1.1370|
00055a  fb91f1f7          SDIV     r1,r1,r7
00055e  e003              B        |L1.1384|
                  |L1.1376|
;;;794    	else temp_SL/=1000L;
000560  f44f7e7a          MOV      lr,#0x3e8
000564  fb91f1fe          SDIV     r1,r1,lr
                  |L1.1384|
;;;795    	#ifdef UKU_TELECORE2015
;;;796    	temp_SL/=2L;
;;;797    	//temp_SL=-temp_SL;
;;;798    	#endif
;;;799    	//#ifdef UKU_TELECORE2017
;;;800    	//temp_SL/=-2L;
;;;801    	//temp_SL=-temp_SL;
;;;802    	//#endif
;;;803    	bat[0]._Ib=(signed short)temp_SL;
000568  8129              STRH     r1,[r5,#8]
;;;804    
;;;805    	temp_SL=(signed long)ad7705_buff_[1];
00056a  f8bc1002          LDRH     r1,[r12,#2]  ; ad7705_buff_
;;;806    	temp_SL-=(signed long)Kibat0[1];
00056e  f8bbc002          LDRH     r12,[r11,#2]  ; Kibat0
000572  eba10c0c          SUB      r12,r1,r12
;;;807    	temp_SL*=(signed long)Kibat1[1];
000576  f9b21002          LDRSH    r1,[r2,#2]  ; Kibat1
00057a  fb01f10c          MUL      r1,r1,r12
;;;808    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
00057e  4298              CMP      r0,r3
000580  d005              BEQ      |L1.1422|
000582  f5a042bc          SUB      r2,r0,#0x5e00
000586  e000              B        |L1.1418|
                  |L1.1416|
000588  e017              B        |L1.1466|
                  |L1.1418|
00058a  3a92              SUBS     r2,r2,#0x92
00058c  d104              BNE      |L1.1432|
                  |L1.1422|
00058e  f44f7096          MOV      r0,#0x12c
000592  fb91f0f0          SDIV     r0,r1,r0
000596  e00e              B        |L1.1462|
                  |L1.1432|
;;;809    	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
000598  4540              CMP      r0,r8
00059a  d005              BEQ      |L1.1448|
00059c  f5a042ac          SUB      r2,r0,#0x5600
0005a0  3a13              SUBS     r2,r2,#0x13
0005a2  d001              BEQ      |L1.1448|
0005a4  42b0              CMP      r0,r6
0005a6  d102              BNE      |L1.1454|
                  |L1.1448|
0005a8  fb91f0f7          SDIV     r0,r1,r7
0005ac  e003              B        |L1.1462|
                  |L1.1454|
;;;810    	else temp_SL/=1000L;
0005ae  f44f707a          MOV      r0,#0x3e8
0005b2  fb91f0f0          SDIV     r0,r1,r0
                  |L1.1462|
;;;811    	bat[1]._Ib=(signed short)temp_SL;
0005b6  f8a50054          STRH     r0,[r5,#0x54]
                  |L1.1466|
;;;812    	}
;;;813    
;;;814    
;;;815    
;;;816    
;;;817    
;;;818    //“емпературы батарей
;;;819    
;;;820    #ifdef UKU_KONTUR
;;;821    if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
;;;822    else bat[0]._nd=1;
;;;823    temp_SL=(signed long)adc_buff_[6];
;;;824    temp_SL*=Ktbat[0];
;;;825    temp_SL/=20000L;
;;;826    temp_SL-=273L;
;;;827    bat[0]._Tb=(signed short)temp_SL;
;;;828    #else
;;;829    if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
0005ba  f9ba000c          LDRSH    r0,[r10,#0xc]  ; adc_buff_
0005be  4651              MOV      r1,r10
0005c0  4606              MOV      r6,r0
0005c2  f2a03021          SUB      r0,r0,#0x321
0005c6  f64033b7          MOV      r3,#0xbb7
0005ca  2200              MOVS     r2,#0
0005cc  4682              MOV      r10,r0
;;;830    else bat[0]._nd=1;
0005ce  f04f0c01          MOV      r12,#1
0005d2  4298              CMP      r0,r3                 ;829
0005d4  d201              BCS      |L1.1498|
0005d6  732a              STRB     r2,[r5,#0xc]          ;829
0005d8  e001              B        |L1.1502|
                  |L1.1498|
0005da  f885c00c          STRB     r12,[r5,#0xc]
                  |L1.1502|
;;;831    temp_SL=(signed long)adc_buff_[6];
;;;832    temp_SL*=Ktbat[0];
0005de  f8dfe2b4          LDR      lr,|L1.2196|
0005e2  f9be0000          LDRSH    r0,[lr,#0]  ; Ktbat
0005e6  4370              MULS     r0,r6,r0
;;;833    temp_SL/=20000L;
0005e8  f6446b20          MOV      r11,#0x4e20
0005ec  fb90f0fb          SDIV     r0,r0,r11
;;;834    temp_SL-=273L;
0005f0  f2a01011          SUB      r0,r0,#0x111
;;;835    bat[0]._Tb=(signed short)temp_SL;
0005f4  8168              STRH     r0,[r5,#0xa]
;;;836    #endif
;;;837    
;;;838    #ifdef UKU_KONTUR
;;;839    if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
;;;840    else bat[1]._nd=1;
;;;841    temp_SL=(signed long)adc_buff_[7];
;;;842    temp_SL*=Ktbat[1];
;;;843    temp_SL/=20000L;
;;;844    temp_SL-=273L;
;;;845    bat[1]._Tb=(signed short)temp_SL;
;;;846    #else
;;;847    if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
0005f6  f9b1000e          LDRSH    r0,[r1,#0xe]  ; adc_buff_
0005fa  f64033b7          MOV      r3,#0xbb7
0005fe  f2a03b21          SUB      r11,r0,#0x321
000602  459b              CMP      r11,r3
000604  d202              BCS      |L1.1548|
000606  f8852058          STRB     r2,[r5,#0x58]
00060a  e001              B        |L1.1552|
                  |L1.1548|
;;;848    else bat[1]._nd=1;
00060c  f885c058          STRB     r12,[r5,#0x58]
                  |L1.1552|
;;;849    temp_SL=(signed long)adc_buff_[7];
;;;850    temp_SL*=Ktbat[1];
000610  f9be3002          LDRSH    r3,[lr,#2]  ; Ktbat
000614  4343              MULS     r3,r0,r3
;;;851    temp_SL/=20000L;
000616  f6446b20          MOV      r11,#0x4e20
00061a  fb93f0fb          SDIV     r0,r3,r11
;;;852    temp_SL-=273L;
00061e  f2a01011          SUB      r0,r0,#0x111
;;;853    bat[1]._Tb=(signed short)temp_SL;
000622  4b97              LDR      r3,|L1.2176|
000624  f8a30056          STRH     r0,[r3,#0x56]
;;;854    #endif
;;;855    
;;;856    #ifdef UKU_6U
;;;857    
;;;858    if(NUMMAKB==2)
;;;859    	{
;;;860    	if(makb[0]._cnt<5)
;;;861    		{
;;;862    		if(makb[0]._T_nd[0]==0)
;;;863    			{
;;;864    			bat[0]._Tb=makb[0]._T[0];
;;;865    			bat[0]._nd=0;
;;;866    			}
;;;867    		}
;;;868    
;;;869    	if(makb[1]._cnt<5)
;;;870    		{
;;;871    		if(makb[1]._T_nd[0]==0)
;;;872    			{
;;;873    			bat[1]._Tb=makb[1]._T[0];
;;;874    			bat[1]._nd=0;
;;;875    			}
;;;876    		}
;;;877    
;;;878    	}
;;;879    else if(NUMMAKB==4)
;;;880    	{
;;;881    	signed short temp_t;
;;;882    	temp_t=-20;
;;;883    	if(makb[0]._cnt<5)
;;;884    		{
;;;885    		if(makb[0]._T_nd[0]==0)
;;;886    			{
;;;887    			temp_t=makb[0]._T[0];
;;;888    			bat[0]._nd=0;
;;;889    			}
;;;890    		}
;;;891    	if(makb[1]._cnt<5)
;;;892    		{
;;;893    		if(makb[1]._T_nd[0]==0)
;;;894    			{
;;;895    			if(temp_t<makb[1]._T[0])
;;;896    				{
;;;897    				bat[0]._nd=0;
;;;898    				temp_t=makb[1]._T[0];
;;;899    				}
;;;900    			}
;;;901    		}
;;;902    	if(temp_t!=-20)bat[0]._Tb = temp_t;
;;;903    
;;;904     	temp_t=-20;
;;;905    	if(makb[2]._cnt<5)
;;;906    		{
;;;907    		if(makb[2]._T_nd[0]==0)
;;;908    			{
;;;909    			temp_t=makb[2]._T[0];
;;;910    			bat[1]._nd=0;
;;;911    			}
;;;912    		}
;;;913    	if(makb[3]._cnt<5)
;;;914    		{
;;;915    		if(makb[3]._T_nd[0]==0)
;;;916    			{
;;;917    			if(temp_t<makb[3]._T[0])
;;;918    				{
;;;919    				bat[1]._nd=0;
;;;920    				temp_t=makb[3]._T[0];
;;;921    				}
;;;922    			}
;;;923    		}
;;;924    	if(temp_t!=-20)bat[1]._Tb = temp_t;
;;;925    	}
;;;926    
;;;927    #endif
;;;928    
;;;929    
;;;930    //Ќапр€жение нагрузки
;;;931    temp_SL=(signed long)adc_buff_[2];
000628  f9b10004          LDRSH    r0,[r1,#4]  ; adc_buff_
;;;932    temp_SL*=Kuload;
00062c  4b9a              LDR      r3,|L1.2200|
00062e  f9b33000          LDRSH    r3,[r3,#0]  ; Kuload
000632  fb00f303          MUL      r3,r0,r3
;;;933    temp_SL/=2000L;
000636  f44f65fa          MOV      r5,#0x7d0
00063a  fb93f3f5          SDIV     r3,r3,r5
;;;934    load_U=(signed short)temp_SL;
00063e  b21f              SXTH     r7,r3
000640  4b96              LDR      r3,|L1.2204|
000642  801f              STRH     r7,[r3,#0]
;;;935    /*
;;;936    #ifdef UKU_220 
;;;937    //Ќапр€жение нагрузки
;;;938    temp_SL=(signed long)adc_buff_[2];
;;;939    temp_SL*=Kuload;
;;;940    temp_SL/=350L;
;;;941    load_U=(signed short)temp_SL;
;;;942    #endif
;;;943    
;;;944    #ifdef UKU_220_V2 
;;;945    //Ќапр€жение нагрузки
;;;946    temp_SL=(signed long)adc_buff_[2];
;;;947    temp_SL*=Kuload;
;;;948    temp_SL/=350L;
;;;949    load_U=(signed short)temp_SL;
;;;950    #endif
;;;951    */
;;;952    #ifdef UKU_VD
;;;953    //Ќапр€жение выхода
;;;954    temp_SL=(signed long)adc_buff_[1];
000644  f9b11002          LDRSH    r1,[r1,#2]  ; adc_buff_
;;;955    temp_SL*=Kuout;
000648  4b95              LDR      r3,|L1.2208|
00064a  f9b33000          LDRSH    r3,[r3,#0]  ; Kuout
00064e  fb01f103          MUL      r1,r1,r3
;;;956    temp_SL/=500L;
000652  f44f75fa          MOV      r5,#0x1f4
000656  fb91f1f5          SDIV     r1,r1,r5
;;;957    out_U=(signed short)temp_SL;
00065a  4b92              LDR      r3,|L1.2212|
00065c  8019              STRH     r1,[r3,#0]
;;;958    
;;;959    
;;;960    //Ќапр€жение вольтдобавки
;;;961    temp_SL=(signed long)adc_buff_[2];
;;;962    temp_SL*=Kuvd;
00065e  4b92              LDR      r3,|L1.2216|
000660  f9b33000          LDRSH    r3,[r3,#0]  ; Kuvd
000664  fb00f303          MUL      r3,r0,r3
;;;963    temp_SL/=500L;
000668  fb93f3f5          SDIV     r3,r3,r5
;;;964    vd_U=(signed short)temp_SL;
00066c  f8dfe23c          LDR      lr,|L1.2220|
000670  f8ae3000          STRH     r3,[lr,#0]
;;;965    
;;;966    //Ќапр€жение входа
;;;967    in_U=out_U-vd_U;
000674  eba10103          SUB      r1,r1,r3
000678  4b8d              LDR      r3,|L1.2224|
00067a  8019              STRH     r1,[r3,#0]
;;;968    
;;;969    //Ќапр€жение выпр€мителей
;;;970    temp_SL=(signed long)adc_buff_[2];
;;;971    temp_SL*=Kubps;
00067c  498d              LDR      r1,|L1.2228|
00067e  f9b11000          LDRSH    r1,[r1,#0]  ; Kubps
000682  fb00f001          MUL      r0,r0,r1
;;;972    if(AUSW_MAIN==22010)temp_SL/=400L;
000686  f8b91000          LDRH     r1,[r9,#0]  ; AUSW_MAIN
00068a  4541              CMP      r1,r8
00068c  d104              BNE      |L1.1688|
00068e  f44f71c8          MOV      r1,#0x190
000692  fb90f0f1          SDIV     r0,r0,r1
000696  e001              B        |L1.1692|
                  |L1.1688|
;;;973    else temp_SL/=500L;
000698  fb90f0f5          SDIV     r0,r0,r5
                  |L1.1692|
;;;974    bps_U=(signed short)temp_SL;
00069c  4d86              LDR      r5,|L1.2232|
00069e  b200              SXTH     r0,r0
0006a0  8028              STRH     r0,[r5,#0]
;;;975    
;;;976    if(bps_U<100)
;;;977    	{
;;;978    	char i;
;;;979    	for(i=0;i<NUMIST;i++)
0006a2  f8dfe218          LDR      lr,|L1.2236|
0006a6  2864              CMP      r0,#0x64              ;976
0006a8  da15              BGE      |L1.1750|
0006aa  f04f0000          MOV      r0,#0
0006ae  f9be8000          LDRSH    r8,[lr,#0]
0006b2  f8df920c          LDR      r9,|L1.2240|
0006b6  e00c              B        |L1.1746|
                  |L1.1720|
;;;980    		{
;;;981    		if(bps[i]._Uin>bps_U)bps_U=bps[i]._Uin;
0006b8  ebc01100          RSB      r1,r0,r0,LSL #4
0006bc  eb0901c1          ADD      r1,r9,r1,LSL #3
0006c0  f9b53000          LDRSH    r3,[r5,#0]  ; bps_U
0006c4  6a09              LDR      r1,[r1,#0x20]
0006c6  4299              CMP      r1,r3
0006c8  dd00              BLE      |L1.1740|
0006ca  8029              STRH     r1,[r5,#0]
                  |L1.1740|
0006cc  f1000001          ADD      r0,r0,#1              ;979
0006d0  b2c0              UXTB     r0,r0                 ;979
                  |L1.1746|
0006d2  4540              CMP      r0,r8                 ;979
0006d4  dbf0              BLT      |L1.1720|
                  |L1.1750|
;;;982    		}
;;;983    	}
;;;984    
;;;985    //—уммарный ток выпр€мителей
;;;986    temp_SL=0;
0006d6  f04f0300          MOV      r3,#0
;;;987    for (i=0;i<NUMIST;i++)
0006da  4618              MOV      r0,r3
0006dc  f9be1000          LDRSH    r1,[lr,#0]            ;979
0006e0  4d77              LDR      r5,|L1.2240|
0006e2  e009              B        |L1.1784|
                  |L1.1764|
;;;988    	{
;;;989    	temp_SL+=((signed long)bps[i]._Ii);
0006e4  ebc01800          RSB      r8,r0,r0,LSL #4
0006e8  eb0508c8          ADD      r8,r5,r8,LSL #3
0006ec  f8d88024          LDR      r8,[r8,#0x24]
0006f0  4443              ADD      r3,r3,r8
0006f2  f1000001          ADD      r0,r0,#1              ;987
0006f6  b2c0              UXTB     r0,r0                 ;987
                  |L1.1784|
0006f8  4288              CMP      r0,r1                 ;987
0006fa  dbf3              BLT      |L1.1764|
;;;990    	}
;;;991    bps_I=(signed short)temp_SL;
0006fc  4871              LDR      r0,|L1.2244|
0006fe  8003              STRH     r3,[r0,#0]
;;;992    
;;;993    
;;;994    #endif
;;;995    
;;;996    /*
;;;997    #ifdef UKU_KONTUR
;;;998    //¬нешний датчик температуры є1(температура внешнего воздуха)
;;;999    if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
;;;1000   else ND_EXT[0]=1;
;;;1001   temp_SL=(signed long)adc_buff_[5];
;;;1002   temp_SL*=Ktext[0];
;;;1003   temp_SL/=20000L;
;;;1004   temp_SL-=273L;
;;;1005   t_ext[0]=(signed short)temp_SL;
;;;1006   #else 
;;;1007   //¬нешний датчик температуры є1(температура внешнего воздуха)
;;;1008   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
;;;1009   else ND_EXT[0]=1;
;;;1010   temp_SL=(signed long)adc_buff_[5];
;;;1011   temp_SL*=Ktext[0];
;;;1012   temp_SL/=20000L;
;;;1013   temp_SL-=273L;
;;;1014   t_ext[0]=(signed short)temp_SL;	
;;;1015   
;;;1016   #endif	  */
;;;1017   /*
;;;1018   #ifdef UKU_220
;;;1019   
;;;1020   //¬нешний датчик температуры є2(температура отсека Ёѕ”)
;;;1021   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[1]=0;
;;;1022   else ND_EXT[1]=1;
;;;1023   temp_SL=(signed long)adc_buff_[3];
;;;1024   temp_SL*=Ktext[1];
;;;1025   temp_SL/=20000L;
;;;1026   temp_SL-=273L;
;;;1027   t_ext[1]=(signed short)temp_SL;
;;;1028   
;;;1029   //¬нешний датчик температуры є3(температура отсека MSAN)
;;;1030   if((adc_buff_[10]>800)&&(adc_buff_[10]<3800))ND_EXT[2]=0;
;;;1031   else ND_EXT[2]=1;
;;;1032   temp_SL=(signed long)adc_buff_[10];
;;;1033   temp_SL*=Ktext[2];
;;;1034   temp_SL/=20000L;
;;;1035   temp_SL-=273L;
;;;1036   t_ext[2]=(signed short)temp_SL;
;;;1037   
;;;1038   #else
;;;1039   */
;;;1040   
;;;1041   #ifdef UKU_VD
;;;1042   
;;;1043   //¬нешний датчик температуры 
;;;1044   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[0]=0;
000700  f64030b7          MOV      r0,#0xbb7
000704  4b70              LDR      r3,|L1.2248|
000706  4582              CMP      r10,r0
000708  d201              BCS      |L1.1806|
00070a  701a              STRB     r2,[r3,#0]
00070c  e001              B        |L1.1810|
                  |L1.1806|
;;;1045   else ND_EXT[0]=1;
00070e  f883c000          STRB     r12,[r3,#0]
                  |L1.1810|
;;;1046   temp_SL=(signed long)adc_buff_[6];
;;;1047   temp_SL*=Ktext[0];
000712  486e              LDR      r0,|L1.2252|
000714  f9b00000          LDRSH    r0,[r0,#0]  ; Ktext
000718  4370              MULS     r0,r6,r0
;;;1048   temp_SL/=20000L;
00071a  fb90f0fb          SDIV     r0,r0,r11
;;;1049   temp_SL-=273L;
00071e  f2a01011          SUB      r0,r0,#0x111
;;;1050   t_ext[0]=(signed short)temp_SL;
000722  f8df91ac          LDR      r9,|L1.2256|
000726  b200              SXTH     r0,r0
000728  f8a90000          STRH     r0,[r9,#0]
;;;1051   if(rele_on_cnt<0)rele_on_cnt=0;
00072c  f8dfc13c          LDR      r12,|L1.2156|
000730  f9bc6034          LDRSH    r6,[r12,#0x34]  ; rele_on_cnt
000734  2e00              CMP      r6,#0
000736  da01              BGE      |L1.1852|
000738  f8ac2034          STRH     r2,[r12,#0x34]
                  |L1.1852|
;;;1052   if(rele_on_cnt>3)rele_on_cnt=3;
00073c  f9bc6034          LDRSH    r6,[r12,#0x34]  ; rele_on_cnt
000740  2e03              CMP      r6,#3
000742  dd03              BLE      |L1.1868|
000744  f04f0603          MOV      r6,#3
000748  f8ac6034          STRH     r6,[r12,#0x34]
                  |L1.1868|
;;;1053   t_ext[0]+=3*rele_on_cnt;
00074c  f8bc6034          LDRH     r6,[r12,#0x34]  ; rele_on_cnt
000750  eb060646          ADD      r6,r6,r6,LSL #1
000754  4430              ADD      r0,r0,r6
000756  b200              SXTH     r0,r0
000758  f8a90000          STRH     r0,[r9,#0]
;;;1054   if(ND_EXT[0]==0)sys_T=t_ext[0];
00075c  4b5a              LDR      r3,|L1.2248|
00075e  781e              LDRB     r6,[r3,#0]  ; ND_EXT
000760  4b5c              LDR      r3,|L1.2260|
000762  b196              CBZ      r6,|L1.1930|
;;;1055   else sys_T=20;
000764  f04f0014          MOV      r0,#0x14
000768  8018              STRH     r0,[r3,#0]
                  |L1.1898|
;;;1056   
;;;1057   #endif
;;;1058   
;;;1059   /*
;;;1060   //¬нешний датчик температуры є2(температура отсека Ёѕ”)
;;;1061   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;1062   else ND_EXT[1]=1;
;;;1063   temp_SL=(signed long)adc_buff_[6];
;;;1064   temp_SL*=Ktext[1];
;;;1065   temp_SL/=20000L;
;;;1066   temp_SL-=273L;
;;;1067   t_ext[1]=(signed short)temp_SL;
;;;1068   
;;;1069   //¬нешний датчик температуры є3(температура отсека MSAN)
;;;1070   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[2]=0;
;;;1071   else ND_EXT[2]=1;
;;;1072   temp_SL=(signed long)adc_buff_[3];
;;;1073   temp_SL*=Ktext[2];
;;;1074   temp_SL/=20000L;
;;;1075   temp_SL-=273L;
;;;1076   t_ext[2]=(signed short)temp_SL;
;;;1077   
;;;1078   #endif */
;;;1079   
;;;1080   
;;;1081   if(!bIBAT_SMKLBR)
00076a  485b              LDR      r0,|L1.2264|
;;;1082   	{
;;;1083   	signed long temp_SL;
;;;1084   	temp_SL=(signed long)ibat_metr_buff_[0];
;;;1085   	temp_SL-=(signed long)ibat_metr_buff_[1];
;;;1086   	temp_SL*=(signed long)Kibat1[0];
;;;1087   	temp_SL/=2000L;
;;;1088   	
;;;1089   	if(bIBAT_SMKLBR_CNT) bIBAT_SMKLBR_CNT--;
00076c  f8dfa16c          LDR      r10,|L1.2268|
;;;1090   
;;;1091   	if(ibat_metr_cnt>30)temp_SL=0;
;;;1092   	
;;;1093   	if(!bIBAT_SMKLBR_CNT)
;;;1094   		{
;;;1095   		Ib_ips_termokompensat =(signed short)temp_SL;
;;;1096   		out_I=Ib_ips_termokompensat;
000770  4e5b              LDR      r6,|L1.2272|
000772  8800              LDRH     r0,[r0,#0]            ;1081  ; bIBAT_SMKLBR
000774  f8df816c          LDR      r8,|L1.2276|
000778  b148              CBZ      r0,|L1.1934|
;;;1097   		}
;;;1098   	}
;;;1099   else
;;;1100   	{
;;;1101   	bIBAT_SMKLBR_CNT=50;
00077a  f04f0032          MOV      r0,#0x32
00077e  f8aa0000          STRH     r0,[r10,#0]
                  |L1.1922|
;;;1102   	}
;;;1103   
;;;1104   if(I_LOAD_MODE==0)
000782  4859              LDR      r0,|L1.2280|
000784  8800              LDRH     r0,[r0,#0]  ; I_LOAD_MODE
000786  b328              CBZ      r0,|L1.2004|
000788  e03c              B        |L1.2052|
                  |L1.1930|
00078a  8018              STRH     r0,[r3,#0]            ;1054
00078c  e7ed              B        |L1.1898|
                  |L1.1934|
00078e  4b57              LDR      r3,|L1.2284|
000790  6818              LDR      r0,[r3,#0]            ;1084  ; ibat_metr_buff_
000792  685b              LDR      r3,[r3,#4]            ;1085  ; ibat_metr_buff_
000794  eba00303          SUB      r3,r0,r3              ;1085
000798  483d              LDR      r0,|L1.2192|
00079a  f9b00000          LDRSH    r0,[r0,#0]            ;1086  ; Kibat1
00079e  fb00f003          MUL      r0,r0,r3              ;1086
0007a2  f44f63fa          MOV      r3,#0x7d0             ;1087
0007a6  fb90f0f3          SDIV     r0,r0,r3              ;1087
0007aa  f9ba3000          LDRSH    r3,[r10,#0]           ;1089  ; bIBAT_SMKLBR_CNT
0007ae  b11b              CBZ      r3,|L1.1976|
0007b0  f1a30301          SUB      r3,r3,#1              ;1089
0007b4  f8aa3000          STRH     r3,[r10,#0]           ;1089
                  |L1.1976|
0007b8  4b4d              LDR      r3,|L1.2288|
0007ba  781b              LDRB     r3,[r3,#0]            ;1091  ; ibat_metr_cnt
0007bc  2b1e              CMP      r3,#0x1e              ;1091
0007be  d901              BLS      |L1.1988|
0007c0  f04f0000          MOV      r0,#0                 ;1091
                  |L1.1988|
0007c4  f8ba3000          LDRH     r3,[r10,#0]           ;1093  ; bIBAT_SMKLBR_CNT
0007c8  2b00              CMP      r3,#0                 ;1093
0007ca  d1da              BNE      |L1.1922|
0007cc  f8a80000          STRH     r0,[r8,#0]            ;1095
0007d0  8030              STRH     r0,[r6,#0]            ;1096
0007d2  e7d6              B        |L1.1922|
                  |L1.2004|
;;;1105   	{
;;;1106   	temp_SL=0;
0007d4  f04f0300          MOV      r3,#0
;;;1107   	for(i=0;i<NUMIST;i++)
0007d8  4618              MOV      r0,r3
0007da  e009              B        |L1.2032|
                  |L1.2012|
;;;1108   		{
;;;1109   		temp_SL+=(signed long)bps[i]._Ii;
0007dc  ebc01a00          RSB      r10,r0,r0,LSL #4
0007e0  eb050aca          ADD      r10,r5,r10,LSL #3
0007e4  f8daa024          LDR      r10,[r10,#0x24]
0007e8  4453              ADD      r3,r3,r10
0007ea  f1000001          ADD      r0,r0,#1              ;1107
0007ee  b2c0              UXTB     r0,r0                 ;1107
                  |L1.2032|
0007f0  4288              CMP      r0,r1                 ;1107
0007f2  dbf3              BLT      |L1.2012|
;;;1110   		}
;;;1111   	Ib_ips_termokompensat=(signed short)temp_SL/10;
0007f4  b21b              SXTH     r3,r3
0007f6  f04f000a          MOV      r0,#0xa
0007fa  fb93f0f0          SDIV     r0,r3,r0
0007fe  f8a80000          STRH     r0,[r8,#0]
;;;1112   	out_I=Ib_ips_termokompensat;
000802  8030              STRH     r0,[r6,#0]
                  |L1.2052|
;;;1113   	}
;;;1114   
;;;1115   
;;;1116   bat[0]._Ub=load_U;
000804  4e1e              LDR      r6,|L1.2176|
000806  8077              STRH     r7,[r6,#2]
;;;1117   
;;;1118   
;;;1119   
;;;1120   /*
;;;1121   #ifdef UKU_TELECORE2015
;;;1122   
;;;1123   //¬нешний датчик температуры є1
;;;1124   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;1125   else ND_EXT[0]=1;
;;;1126   temp_SL=(signed long)adc_buff_[7];
;;;1127   temp_SL*=Ktext[0];
;;;1128   temp_SL/=20000L;
;;;1129   temp_SL-=273L;
;;;1130   t_ext[0]=(signed short)temp_SL;
;;;1131   
;;;1132   
;;;1133   //¬нешний датчик температуры є2
;;;1134   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;1135   else ND_EXT[1]=1;
;;;1136   temp_SL=(signed long)adc_buff_[6];
;;;1137   temp_SL*=Ktext[1];
;;;1138   temp_SL/=20000L;
;;;1139   temp_SL-=273L;
;;;1140   t_ext[1]=(signed short)temp_SL;
;;;1141   
;;;1142   #endif
;;;1143   */
;;;1144   /*
;;;1145   #ifdef UKU_TELECORE2017
;;;1146   
;;;1147   //¬нешний датчик температуры є1
;;;1148   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;1149   else ND_EXT[0]=1;
;;;1150   temp_SL=(signed long)adc_buff_[7];
;;;1151   temp_SL*=Ktext[0];
;;;1152   temp_SL/=20000L;
;;;1153   temp_SL-=273L;
;;;1154   t_ext[0]=(signed short)temp_SL;
;;;1155   
;;;1156   
;;;1157   //¬нешний датчик температуры є2
;;;1158   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;1159   else ND_EXT[1]=1;
;;;1160   temp_SL=(signed long)adc_buff_[6];
;;;1161   temp_SL*=Ktext[1];
;;;1162   temp_SL/=20000L;
;;;1163   temp_SL-=273L;
;;;1164   t_ext[1]=(signed short)temp_SL;
;;;1165   
;;;1166   #endif
;;;1167   */
;;;1168   //напр€жение ввода
;;;1169   temp_SL=(signed long)adc_buff_ext_[0];
000808  f8dfb0e8          LDR      r11,|L1.2292|
00080c  f8bb3000          LDRH     r3,[r11,#0]  ; adc_buff_ext_
;;;1170   temp_SL*=Kunet_ext[0];
000810  4839              LDR      r0,|L1.2296|
000812  f9b00000          LDRSH    r0,[r0,#0]  ; Kunet_ext
000816  4358              MULS     r0,r3,r0
;;;1171   temp_SL/=4000L;
000818  f44f6a7a          MOV      r10,#0xfa0
00081c  fb90f0fa          SDIV     r0,r0,r10
;;;1172   Uvv[0]=(signed short)temp_SL;
000820  4b36              LDR      r3,|L1.2300|
000822  b280              UXTH     r0,r0
000824  8018              STRH     r0,[r3,#0]
;;;1173   if(Uvv[0]<100) Uvv0=Uvv[0];
000826  f8dfe0d8          LDR      lr,|L1.2304|
00082a  2864              CMP      r0,#0x64
00082c  d202              BCS      |L1.2100|
00082e  f8ae0000          STRH     r0,[lr,#0]
000832  e002              B        |L1.2106|
                  |L1.2100|
;;;1174   else Uvv0=net_U;
000834  8820              LDRH     r0,[r4,#0]  ; net_U
000836  f8ae0000          STRH     r0,[lr,#0]
                  |L1.2106|
;;;1175   
;;;1176   //напр€жение пэс
;;;1177   temp_SL=(signed long)adc_buff_ext_[1];
00083a  f8bb4002          LDRH     r4,[r11,#2]  ; adc_buff_ext_
;;;1178   temp_SL*=Kunet_ext[1];
00083e  482e              LDR      r0,|L1.2296|
000840  f9b00002          LDRSH    r0,[r0,#2]  ; Kunet_ext
000844  4360              MULS     r0,r4,r0
;;;1179   temp_SL/=4000L;
000846  fb90f0fa          SDIV     r0,r0,r10
;;;1180   Uvv[1]=(signed short)temp_SL;
00084a  8058              STRH     r0,[r3,#2]
;;;1181   
;;;1182   
;;;1183   //напр€жение ввода трехфазное
;;;1184   temp_SL=(signed long)eb2_data_short[0];
00084c  4b2d              LDR      r3,|L1.2308|
00084e  f9b30000          LDRSH    r0,[r3,#0]  ; eb2_data_short
;;;1185   temp_SL*=Kvv_eb2[0];
000852  4c2d              LDR      r4,|L1.2312|
000854  f9b4a000          LDRSH    r10,[r4,#0]  ; Kvv_eb2
000858  fb0afa00          MUL      r10,r10,r0
;;;1186   temp_SL/=6000L;
00085c  f2417070          MOV      r0,#0x1770
000860  fb9afbf0          SDIV     r11,r10,r0
;;;1187   Uvv_eb2[0]=(signed short)temp_SL;
000864  e052              B        |L1.2316|
000866  0000              DCW      0x0000
                  |L1.2152|
                          DCD      Kunet
                  |L1.2156|
                          DCD      ||area_number.26||
                  |L1.2160|
                          DCD      net_F
                  |L1.2164|
                          DCD      net_F3
                  |L1.2168|
                          DCD      ||.bss||+0x400
                  |L1.2172|
                          DCD      Kubat
                  |L1.2176|
                          DCD      bat
                  |L1.2180|
                          DCD      Kubatm
                  |L1.2184|
                          DCD      ad7705_buff_
                  |L1.2188|
                          DCD      Kibat0
                  |L1.2192|
                          DCD      Kibat1
                  |L1.2196|
                          DCD      Ktbat
                  |L1.2200|
                          DCD      Kuload
                  |L1.2204|
                          DCD      load_U
                  |L1.2208|
                          DCD      Kuout
                  |L1.2212|
                          DCD      out_U
                  |L1.2216|
                          DCD      Kuvd
                  |L1.2220|
                          DCD      vd_U
                  |L1.2224|
                          DCD      in_U
                  |L1.2228|
                          DCD      Kubps
                  |L1.2232|
                          DCD      bps_U
                  |L1.2236|
                          DCD      NUMIST
                  |L1.2240|
                          DCD      bps
                  |L1.2244|
                          DCD      bps_I
                  |L1.2248|
                          DCD      ND_EXT
                  |L1.2252|
                          DCD      Ktext
                  |L1.2256|
                          DCD      t_ext
                  |L1.2260|
                          DCD      sys_T
                  |L1.2264|
                          DCD      bIBAT_SMKLBR
                  |L1.2268|
                          DCD      bIBAT_SMKLBR_CNT
                  |L1.2272|
                          DCD      out_I
                  |L1.2276|
                          DCD      Ib_ips_termokompensat
                  |L1.2280|
                          DCD      I_LOAD_MODE
                  |L1.2284|
                          DCD      ibat_metr_buff_
                  |L1.2288|
                          DCD      ibat_metr_cnt
                  |L1.2292|
                          DCD      adc_buff_ext_
                  |L1.2296|
                          DCD      Kunet_ext
                  |L1.2300|
                          DCD      Uvv
                  |L1.2304|
                          DCD      Uvv0
                  |L1.2308|
                          DCD      eb2_data_short
                  |L1.2312|
                          DCD      Kvv_eb2
                  |L1.2316|
00090c  f8dfa438          LDR      r10,|L1.3400|
000910  f8aab000          STRH     r11,[r10,#0]
;;;1188   
;;;1189   temp_SL=(signed long)eb2_data_short[1];
000914  f9b3e002          LDRSH    lr,[r3,#2]  ; eb2_data_short
;;;1190   temp_SL*=Kvv_eb2[1];
000918  f9b4b002          LDRSH    r11,[r4,#2]  ; Kvv_eb2
00091c  fb0bfb0e          MUL      r11,r11,lr
;;;1191   temp_SL/=6000L;
000920  fb9bfbf0          SDIV     r11,r11,r0
;;;1192   Uvv_eb2[1]=(signed short)temp_SL;
000924  f8aab002          STRH     r11,[r10,#2]
;;;1193   
;;;1194   temp_SL=(signed long)eb2_data_short[2];
000928  f9b3b004          LDRSH    r11,[r3,#4]  ; eb2_data_short
;;;1195   temp_SL*=Kvv_eb2[2];
00092c  f9b44004          LDRSH    r4,[r4,#4]  ; Kvv_eb2
000930  fb04f40b          MUL      r4,r4,r11
;;;1196   temp_SL/=6000L;
000934  fb94f4f0          SDIV     r4,r4,r0
;;;1197   Uvv_eb2[2]=(signed short)temp_SL;
000938  f8aa4004          STRH     r4,[r10,#4]
;;;1198   
;;;1199   //напр€жение пэс трехфазное
;;;1200   temp_SL=(signed long)eb2_data_short[3];
00093c  f9b3b006          LDRSH    r11,[r3,#6]  ; eb2_data_short
;;;1201   temp_SL*=Kpes_eb2[0];
000940  f8dfa408          LDR      r10,|L1.3404|
000944  f9ba4000          LDRSH    r4,[r10,#0]  ; Kpes_eb2
000948  fb04f40b          MUL      r4,r4,r11
;;;1202   temp_SL/=6000L;
00094c  fb94fbf0          SDIV     r11,r4,r0
;;;1203   Upes_eb2[0]=(signed short)temp_SL;
000950  4cff              LDR      r4,|L1.3408|
000952  f8a4b000          STRH     r11,[r4,#0]
;;;1204   
;;;1205   temp_SL=(signed long)eb2_data_short[4];
000956  f9b3b008          LDRSH    r11,[r3,#8]  ; eb2_data_short
;;;1206   temp_SL*=Kpes_eb2[1];
00095a  f9bae002          LDRSH    lr,[r10,#2]  ; Kpes_eb2
00095e  fb0efe0b          MUL      lr,lr,r11
;;;1207   temp_SL/=6000L;
000962  fb9efbf0          SDIV     r11,lr,r0
;;;1208   Upes_eb2[1]=(signed short)temp_SL;
000966  f8a4b002          STRH     r11,[r4,#2]
;;;1209   
;;;1210   temp_SL=(signed long)eb2_data_short[5];
00096a  f9b3b00a          LDRSH    r11,[r3,#0xa]  ; eb2_data_short
;;;1211   temp_SL*=Kpes_eb2[2];
00096e  f9ba3004          LDRSH    r3,[r10,#4]  ; Kpes_eb2
000972  fb03f30b          MUL      r3,r3,r11
;;;1212   temp_SL/=6000L;
000976  fb93f0f0          SDIV     r0,r3,r0
;;;1213   Upes_eb2[2]=(signed short)temp_SL;
00097a  80a0              STRH     r0,[r4,#4]
;;;1214   
;;;1215   //¬ычисление температуры шкафа
;;;1216   
;;;1217   ibt._T[0]=t_ext[1]+273;
00097c  f8b90002          LDRH     r0,[r9,#2]  ; t_ext
000980  4cf4              LDR      r4,|L1.3412|
000982  f2001011          ADD      r0,r0,#0x111
000986  fa0ffa80          SXTH     r10,r0
00098a  f8a4a000          STRH     r10,[r4,#0]
;;;1218   ibt._T[1]=t_ext[2]+273;
00098e  f8b90004          LDRH     r0,[r9,#4]  ; t_ext
000992  f2001011          ADD      r0,r0,#0x111
000996  fa0ff980          SXTH     r9,r0
00099a  f8a49002          STRH     r9,[r4,#2]
;;;1219   
;;;1220   ibt._nd[0]=ND_EXT[1];
00099e  48ee              LDR      r0,|L1.3416|
0009a0  7843              LDRB     r3,[r0,#1]  ; ND_EXT
0009a2  7223              STRB     r3,[r4,#8]
;;;1221   ibt._nd[1]=ND_EXT[2];
0009a4  7880              LDRB     r0,[r0,#2]  ; ND_EXT
0009a6  7260              STRB     r0,[r4,#9]
;;;1222   
;;;1223   #ifndef UKU_TELECORE2015
;;;1224   if((ibt._nd[0]==0) &&  (ibt._nd[1]==0))
;;;1225   	{
;;;1226   	t_box=((ibt._T[0]+ibt._T[1])/2)-273;
0009a8  4cec              LDR      r4,|L1.3420|
0009aa  b903              CBNZ     r3,|L1.2478|
0009ac  b110              CBZ      r0,|L1.2484|
                  |L1.2478|
;;;1227   	}
;;;1228   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==0))
0009ae  2b01              CMP      r3,#1
0009b0  d00a              BEQ      |L1.2504|
0009b2  e00a              B        |L1.2506|
                  |L1.2484|
0009b4  eb0a0009          ADD      r0,r10,r9             ;1226
0009b8  eb0070d0          ADD      r0,r0,r0,LSR #31      ;1226
0009bc  f46f7388          MVN      r3,#0x110             ;1226
0009c0  eb030060          ADD      r0,r3,r0,ASR #1       ;1226
0009c4  8020              STRH     r0,[r4,#0]            ;1226
0009c6  e01e              B        |L1.2566|
                  |L1.2504|
0009c8  b108              CBZ      r0,|L1.2510|
                  |L1.2506|
;;;1229   	{
;;;1230   	t_box=ibt._T[1]-273;
;;;1231   	}
;;;1232   else if((ibt._nd[0]==0) &&  (ibt._nd[1]==1))
0009ca  b12b              CBZ      r3,|L1.2520|
0009cc  e006              B        |L1.2524|
                  |L1.2510|
0009ce  f2a91911          SUB      r9,r9,#0x111          ;1230
0009d2  f8a49000          STRH     r9,[r4,#0]            ;1230
0009d6  e016              B        |L1.2566|
                  |L1.2520|
0009d8  2801              CMP      r0,#1
0009da  d002              BEQ      |L1.2530|
                  |L1.2524|
;;;1233   	{
;;;1234   	t_box=ibt._T[0]-273;
;;;1235   	}
;;;1236   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==1))
0009dc  2b01              CMP      r3,#1
0009de  d005              BEQ      |L1.2540|
0009e0  e011              B        |L1.2566|
                  |L1.2530|
0009e2  f2aa1a11          SUB      r10,r10,#0x111        ;1234
0009e6  f8a4a000          STRH     r10,[r4,#0]           ;1234
0009ea  e00c              B        |L1.2566|
                  |L1.2540|
0009ec  2801              CMP      r0,#1
0009ee  d10a              BNE      |L1.2566|
;;;1237   	{
;;;1238   	if(t_ext_can_nd<5)t_box= t_ext_can;
0009f0  48db              LDR      r0,|L1.3424|
0009f2  7800              LDRB     r0,[r0,#0]  ; t_ext_can_nd
0009f4  2805              CMP      r0,#5
0009f6  d203              BCS      |L1.2560|
0009f8  48da              LDR      r0,|L1.3428|
0009fa  8800              LDRH     r0,[r0,#0]  ; t_ext_can
0009fc  8020              STRH     r0,[r4,#0]
0009fe  e002              B        |L1.2566|
                  |L1.2560|
;;;1239   	else t_box=20;
000a00  f04f0014          MOV      r0,#0x14
000a04  8020              STRH     r0,[r4,#0]
                  |L1.2566|
;;;1240   	}
;;;1241   #endif
;;;1242   
;;;1243   
;;;1244   #ifndef TELECORE
;;;1245   if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib;
000a06  48d8              LDR      r0,|L1.3432|
000a08  7803              LDRB     r3,[r0,#0]  ; BAT_IS_ON
000a0a  2b55              CMP      r3,#0x55
000a0c  d104              BNE      |L1.2584|
000a0e  2fc8              CMP      r7,#0xc8
000a10  dd02              BLE      |L1.2584|
000a12  8933              LDRH     r3,[r6,#8]  ; bat
000a14  f8ac303a          STRH     r3,[r12,#0x3a]
                  |L1.2584|
;;;1246   if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
000a18  7840              LDRB     r0,[r0,#1]  ; BAT_IS_ON
000a1a  2855              CMP      r0,#0x55
000a1c  d10b              BNE      |L1.2614|
000a1e  f9b6004e          LDRSH    r0,[r6,#0x4e]  ; bat
000a22  28c8              CMP      r0,#0xc8
000a24  dd07              BLE      |L1.2614|
000a26  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
000a2a  f9b63008          LDRSH    r3,[r6,#8]  ; bat
000a2e  4298              CMP      r0,r3
000a30  dd01              BLE      |L1.2614|
000a32  f8ac003a          STRH     r0,[r12,#0x3a]
                  |L1.2614|
;;;1247   #endif
;;;1248   
;;;1249   #ifdef TELECORE
;;;1250   Ibmax=0;
;;;1251   /*
;;;1252   if((NUMBAT_TELECORE>0)&&(lakb[0]._communicationFullErrorStat==0)&&(lakb[0]._ch_curr/10>Ibmax))Ibmax=lakb[0]._ch_curr/10;
;;;1253   if((NUMBAT_TELECORE>1)&&(lakb[1]._communicationFullErrorStat==0)&&(lakb[1]._ch_curr/10>Ibmax))Ibmax=lakb[1]._ch_curr/10;
;;;1254   if((NUMBAT_TELECORE>2)&&(lakb[2]._communicationFullErrorStat==0)&&(lakb[2]._ch_curr/10>Ibmax))Ibmax=lakb[2]._ch_curr/10;
;;;1255   */
;;;1256   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;1257   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;1258   //if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib/1;
;;;1259   //if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
;;;1260   #endif
;;;1261   //Ibmax=bat[0]._Ib;
;;;1262   //if((AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043))Ibmax=Ib_ips_termokompensat;
;;;1263   
;;;1264   #ifdef UKU_TELECORE2017
;;;1265   Ibmax=0;
;;;1266   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;1267   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;1268   #endif
;;;1269   
;;;1270   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1271   Ibmax=Ib_ips_termokompensat;
000a36  f8b80000          LDRH     r0,[r8,#0]  ; Ib_ips_termokompensat
000a3a  f8ac003a          STRH     r0,[r12,#0x3a]
;;;1272   #endif
;;;1273   for(i=0;i<NUMIST;i++)
000a3e  f04f0300          MOV      r3,#0
000a42  e045              B        |L1.2768|
                  |L1.2628|
;;;1274   	{
;;;1275   	if(bps[i]._cnt<25)
000a44  ebc31003          RSB      r0,r3,r3,LSL #4
000a48  eb0500c0          ADD      r0,r5,r0,LSL #3
000a4c  78c4              LDRB     r4,[r0,#3]
000a4e  2c19              CMP      r4,#0x19
000a50  d22e              BCS      |L1.2736|
;;;1276        	{
;;;1277        	bps[i]._Ii=bps[i]._buff[0]+(bps[i]._buff[1]*256);
000a52  7984              LDRB     r4,[r0,#6]
000a54  79c7              LDRB     r7,[r0,#7]
000a56  eb042407          ADD      r4,r4,r7,LSL #8
000a5a  6244              STR      r4,[r0,#0x24]
;;;1278        	bps[i]._Uin=bps[i]._buff[2]+(bps[i]._buff[3]*256);
000a5c  7a04              LDRB     r4,[r0,#8]
000a5e  7a47              LDRB     r7,[r0,#9]
000a60  eb042407          ADD      r4,r4,r7,LSL #8
000a64  6204              STR      r4,[r0,#0x20]
;;;1279        	bps[i]._Uii=bps[i]._buff[4]+(bps[i]._buff[5]*256);
000a66  7a84              LDRB     r4,[r0,#0xa]
000a68  7ac7              LDRB     r7,[r0,#0xb]
000a6a  eb042407          ADD      r4,r4,r7,LSL #8
000a6e  61c4              STR      r4,[r0,#0x1c]
;;;1280        	bps[i]._Ti=(signed)(bps[i]._buff[6]);
000a70  7b04              LDRB     r4,[r0,#0xc]
000a72  6284              STR      r4,[r0,#0x28]
;;;1281        	bps[i]._adr_ee=bps[i]._buff[7];
000a74  7b44              LDRB     r4,[r0,#0xd]
000a76  f8804058          STRB     r4,[r0,#0x58]
;;;1282        	bps[i]._flags_tm=bps[i]._buff[8];
000a7a  7b84              LDRB     r4,[r0,#0xe]
000a7c  f8804046          STRB     r4,[r0,#0x46]
;;;1283   	    //bps[i]._rotor=bps[i]._buff[10]+(bps[i]._buff[11]*256); 
;;;1284   		bps[i]._Uisum=bps[i]._buff[10]+(bps[i]._buff[11]*256); 
000a80  7c04              LDRB     r4,[r0,#0x10]
000a82  7c47              LDRB     r7,[r0,#0x11]
000a84  eb042407          ADD      r4,r4,r7,LSL #8
000a88  6304              STR      r4,[r0,#0x30]
;;;1285   		bps[i].debug_info_to_uku0=bps[i]._buff[12]+(bps[i]._buff[13]*256); 
000a8a  7c84              LDRB     r4,[r0,#0x12]
000a8c  7cc7              LDRB     r7,[r0,#0x13]
000a8e  eb042407          ADD      r4,r4,r7,LSL #8
000a92  f8a04060          STRH     r4,[r0,#0x60]
;;;1286   		bps[i].debug_info_to_uku1=bps[i]._buff[14]+(bps[i]._buff[15]*256); 
000a96  7d04              LDRB     r4,[r0,#0x14]
000a98  7d47              LDRB     r7,[r0,#0x15]
000a9a  eb042407          ADD      r4,r4,r7,LSL #8
000a9e  f8a04062          STRH     r4,[r0,#0x62]
;;;1287   		bps[i].debug_info_to_uku2=bps[i]._buff[16]+(bps[i]._buff[17]*256);   
000aa2  7d84              LDRB     r4,[r0,#0x16]
000aa4  7dc7              LDRB     r7,[r0,#0x17]
000aa6  eb042407          ADD      r4,r4,r7,LSL #8
000aaa  f8a04064          STRH     r4,[r0,#0x64]
000aae  e00c              B        |L1.2762|
                  |L1.2736|
;;;1288        	} 
;;;1289   	else 
;;;1290        	{
;;;1291        	bps[i]._Uii=0; 
000ab0  61c2              STR      r2,[r0,#0x1c]
;;;1292        	bps[i]._Ii=0;
000ab2  6242              STR      r2,[r0,#0x24]
;;;1293        	bps[i]._Uin=0;
000ab4  6202              STR      r2,[r0,#0x20]
;;;1294        	bps[i]._Ti=0;
000ab6  6282              STR      r2,[r0,#0x28]
;;;1295        	bps[i]._flags_tm=0; 
000ab8  f8802046          STRB     r2,[r0,#0x46]
;;;1296   	     //bps[i]._rotor=0;
;;;1297   		bps[i]._Uisum=0; 
000abc  6302              STR      r2,[r0,#0x30]
;;;1298   		bps[i].debug_info_to_uku0=0; 
000abe  f8a02060          STRH     r2,[r0,#0x60]
;;;1299   		bps[i].debug_info_to_uku1=0; 
000ac2  f8a02062          STRH     r2,[r0,#0x62]
;;;1300   		bps[i].debug_info_to_uku2=0;   
000ac6  f8a02064          STRH     r2,[r0,#0x64]
                  |L1.2762|
000aca  f1030301          ADD      r3,r3,#1              ;1273
000ace  b2db              UXTB     r3,r3                 ;1273
                  |L1.2768|
000ad0  428b              CMP      r3,r1                 ;1273
000ad2  dbb7              BLT      |L1.2628|
;;;1301        	}
;;;1302        
;;;1303        }
;;;1304   
;;;1305   load_I=0;
000ad4  4ca5              LDR      r4,|L1.3436|
;;;1306   #ifdef TELECORE
;;;1307   
;;;1308   /*for(i=0;i<NUMBAT_TELECORE;i++)
;;;1309   	{
;;;1310   	load_I-=lakb[i]._ch_curr/10;
;;;1311   	}*/
;;;1312   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;1313   #elif UKU_TELECORE2017
;;;1314   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;1315   #else
;;;1316   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
000ad6  f9b63008          LDRSH    r3,[r6,#8]  ; bat
000ada  f04f000a          MOV      r0,#0xa
000ade  fb93f3f0          SDIV     r3,r3,r0
000ae2  f9b66054          LDRSH    r6,[r6,#0x54]  ; bat
000ae6  fb96f0f0          SDIV     r0,r6,r0
000aea  4418              ADD      r0,r0,r3
000aec  f1c00000          RSB      r0,r0,#0
000af0  b207              SXTH     r7,r0
000af2  8027              STRH     r7,[r4,#0]
;;;1317   #endif
;;;1318   Isumm=0;
000af4  4e9e              LDR      r6,|L1.3440|
000af6  8032              STRH     r2,[r6,#0]
;;;1319   
;;;1320   for(i=0;i<NUMIST;i++)
000af8  f04f0000          MOV      r0,#0
000afc  e010              B        |L1.2848|
                  |L1.2814|
;;;1321        {
;;;1322        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
000afe  ebc01300          RSB      r3,r0,r0,LSL #4
000b02  eb0503c3          ADD      r3,r5,r3,LSL #3
000b06  f893c003          LDRB     r12,[r3,#3]
000b0a  f1bc0f05          CMP      r12,#5
000b0e  d204              BCS      |L1.2842|
000b10  6a5b              LDR      r3,[r3,#0x24]
000b12  f8b6c000          LDRH     r12,[r6,#0]  ; Isumm
000b16  4463              ADD      r3,r3,r12
000b18  8033              STRH     r3,[r6,#0]
                  |L1.2842|
000b1a  f1000001          ADD      r0,r0,#1              ;1320
000b1e  b2c0              UXTB     r0,r0                 ;1320
                  |L1.2848|
000b20  4288              CMP      r0,r1                 ;1320
000b22  dbec              BLT      |L1.2814|
;;;1323        }  
;;;1324        
;;;1325   load_I=load_I+Isumm;
000b24  8830              LDRH     r0,[r6,#0]  ; Isumm
000b26  4438              ADD      r0,r0,r7
000b28  b200              SXTH     r0,r0
000b2a  8020              STRH     r0,[r4,#0]
;;;1326   if(load_I<0)load_I=0;
000b2c  2800              CMP      r0,#0
000b2e  da00              BGE      |L1.2866|
000b30  8022              STRH     r2,[r4,#0]
                  |L1.2866|
;;;1327   
;;;1328   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1329   load_I=0;
000b32  8022              STRH     r2,[r4,#0]
;;;1330   
;;;1331   Isumm=0;
000b34  8032              STRH     r2,[r6,#0]
;;;1332   
;;;1333   for(i=0;i<NUMIST;i++)
000b36  f04f0000          MOV      r0,#0
000b3a  e00d              B        |L1.2904|
                  |L1.2876|
;;;1334        {
;;;1335        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
000b3c  ebc01300          RSB      r3,r0,r0,LSL #4
000b40  eb0503c3          ADD      r3,r5,r3,LSL #3
000b44  78df              LDRB     r7,[r3,#3]
000b46  2f05              CMP      r7,#5
000b48  d203              BCS      |L1.2898|
000b4a  6a5b              LDR      r3,[r3,#0x24]
000b4c  8837              LDRH     r7,[r6,#0]  ; Isumm
000b4e  443b              ADD      r3,r3,r7
000b50  8033              STRH     r3,[r6,#0]
                  |L1.2898|
000b52  f1000001          ADD      r0,r0,#1              ;1333
000b56  b2c0              UXTB     r0,r0                 ;1333
                  |L1.2904|
000b58  4288              CMP      r0,r1                 ;1333
000b5a  dbef              BLT      |L1.2876|
;;;1336        }  
;;;1337        
;;;1338   load_I=load_I+Isumm;
000b5c  8831              LDRH     r1,[r6,#0]  ; Isumm
000b5e  eb020001          ADD      r0,r2,r1
000b62  b200              SXTH     r0,r0
000b64  8020              STRH     r0,[r4,#0]
;;;1339   if(load_I<0)load_I=0;
000b66  2800              CMP      r0,#0
000b68  da00              BGE      |L1.2924|
000b6a  8022              STRH     r2,[r4,#0]
                  |L1.2924|
;;;1340   
;;;1341   #endif
;;;1342   
;;;1343   
;;;1344   
;;;1345   #ifdef UKU_GLONASS
;;;1346   inv[0]._Uio=6;
;;;1347   if (NUMINV)
;;;1348   	{
;;;1349   	for(i=0;i<NUMINV;i++)
;;;1350   		{
;;;1351   		if(bps[i+first_inv_slot]._cnt<25)
;;;1352        		{
;;;1353        		inv[i]._Ii=bps[i+first_inv_slot]._buff[0]+(bps[i+first_inv_slot]._buff[1]*256);
;;;1354        		inv[i]._Uin=bps[i+first_inv_slot]._buff[2]+(bps[i+first_inv_slot]._buff[3]*256);
;;;1355        		inv[i]._Uio=bps[i+first_inv_slot]._buff[4]+(bps[i+first_inv_slot]._buff[5]*256);
;;;1356        		inv[i]._Ti=(signed)(bps[i+first_inv_slot]._buff[6]);
;;;1357        		inv[i]._flags_tm=bps[i+first_inv_slot]._buff[8];
;;;1358   	    	//	inv[i]._rotor=bps[i+first_inv_slot]._buff[10]+(bps[i+first_inv_slot]._buff[11]*256);
;;;1359   			inv[i]._cnt=0;    
;;;1360        		} 
;;;1361   		else 
;;;1362        		{
;;;1363        		inv[i]._Uio=0; 
;;;1364        		inv[i]._Ii=0;
;;;1365        		inv[i]._Uin=0;
;;;1366        		inv[i]._Ti=0;
;;;1367        		inv[i]._flags_tm=0; 
;;;1368   //	     	inv[i]._rotor0;
;;;1369   			inv[i]._cnt=25;    
;;;1370        		}
;;;1371        	}
;;;1372      	}
;;;1373   #endif
;;;1374   
;;;1375   #ifndef UKU_GLONASS
;;;1376   if (NUMINV)
000b6c  4881              LDR      r0,|L1.3444|
000b6e  f9b04000          LDRSH    r4,[r0,#0]  ; NUMINV
000b72  2c00              CMP      r4,#0
000b74  d064              BEQ      |L1.3136|
;;;1377   	{
;;;1378   	for(i=0;i<NUMINV;i++)
000b76  f04f0300          MOV      r3,#0
;;;1379   		{
;;;1380   		if(bps[i+20]._cnt<25)
;;;1381        		{
;;;1382        		inv[i]._Ii=bps[i+20]._buff[0]+(bps[i+20]._buff[1]*256);
000b7a  4e7f              LDR      r6,|L1.3448|
000b7c  e05e              B        |L1.3132|
                  |L1.2942|
000b7e  f1030014          ADD      r0,r3,#0x14           ;1380
000b82  ebc01000          RSB      r0,r0,r0,LSL #4       ;1380
000b86  eb0500c0          ADD      r0,r5,r0,LSL #3       ;1380
000b8a  78c1              LDRB     r1,[r0,#3]            ;1380
000b8c  2919              CMP      r1,#0x19              ;1380
000b8e  d239              BCS      |L1.3076|
000b90  7981              LDRB     r1,[r0,#6]
000b92  79c7              LDRB     r7,[r0,#7]
000b94  eb012707          ADD      r7,r1,r7,LSL #8
000b98  eb030143          ADD      r1,r3,r3,LSL #1
000b9c  eb061141          ADD      r1,r6,r1,LSL #5
000ba0  61cf              STR      r7,[r1,#0x1c]
;;;1383        		inv[i]._Pio=bps[i+20]._buff[2]+(bps[i+20]._buff[3]*256);
000ba2  7a07              LDRB     r7,[r0,#8]
000ba4  f890c009          LDRB     r12,[r0,#9]
000ba8  eb07270c          ADD      r7,r7,r12,LSL #8
000bac  62cf              STR      r7,[r1,#0x2c]
;;;1384        		inv[i]._Uio=bps[i+20]._buff[4]+(bps[i+20]._buff[5]*256);
000bae  7a87              LDRB     r7,[r0,#0xa]
000bb0  f890c00b          LDRB     r12,[r0,#0xb]
000bb4  eb07270c          ADD      r7,r7,r12,LSL #8
000bb8  618f              STR      r7,[r1,#0x18]
;;;1385        		inv[i]._Ti=(signed)(bps[i+20]._buff[6]);
000bba  7b07              LDRB     r7,[r0,#0xc]
000bbc  620f              STR      r7,[r1,#0x20]
;;;1386        		inv[i]._flags_tm=bps[i+20]._buff[7];
000bbe  7b47              LDRB     r7,[r0,#0xd]
000bc0  f8817046          STRB     r7,[r1,#0x46]
;;;1387        		inv[i]._Uin=bps[i+20]._buff[8]+(bps[i+20]._buff[9]*256);
000bc4  7b87              LDRB     r7,[r0,#0xe]
000bc6  f890c00f          LDRB     r12,[r0,#0xf]
000bca  eb07270c          ADD      r7,r7,r12,LSL #8
000bce  628f              STR      r7,[r1,#0x28]
;;;1388        		inv[i]._Uil=bps[i+20]._buff[10]+(bps[i+20]._buff[11]*256);
000bd0  7c07              LDRB     r7,[r0,#0x10]
000bd2  f890c011          LDRB     r12,[r0,#0x11]
000bd6  eb07270c          ADD      r7,r7,r12,LSL #8
000bda  624f              STR      r7,[r1,#0x24]
;;;1389   			inv[i]._cnt=0;
000bdc  708a              STRB     r2,[r1,#2]
;;;1390   			inv[i]._Uoutmin=bps[i+20]._buff[12]; 
000bde  7c87              LDRB     r7,[r0,#0x12]
000be0  f8817059          STRB     r7,[r1,#0x59]
;;;1391   			inv[i]._Uoutmax=bps[i+20]._buff[13]; 
000be4  7cc7              LDRB     r7,[r0,#0x13]
000be6  f881705a          STRB     r7,[r1,#0x5a]
;;;1392   			inv[i]._Pnom=bps[i+20]._buff[14]; 
000bea  7d07              LDRB     r7,[r0,#0x14]
000bec  f8817058          STRB     r7,[r1,#0x58]
;;;1393   			inv[i]._net_contr_en=bps[i+20]._buff[15];
000bf0  7d47              LDRB     r7,[r0,#0x15]
000bf2  f881705b          STRB     r7,[r1,#0x5b]
;;;1394   			inv[i]._pwm_en=bps[i+20]._buff[16];  
000bf6  7d87              LDRB     r7,[r0,#0x16]
000bf8  f881705c          STRB     r7,[r1,#0x5c]
;;;1395   			inv[i]._phase_mode=bps[i+20]._buff[17];  
000bfc  7dc0              LDRB     r0,[r0,#0x17]
000bfe  f881005d          STRB     r0,[r1,#0x5d]
000c02  e018              B        |L1.3126|
                  |L1.3076|
;;;1396        		} 
;;;1397   		else 
;;;1398        		{
;;;1399         		inv[i]._Ii=0;
000c04  eb030043          ADD      r0,r3,r3,LSL #1
000c08  eb061040          ADD      r0,r6,r0,LSL #5
000c0c  61c2              STR      r2,[r0,#0x1c]
;;;1400   			inv[i]._Pio=0;
000c0e  62c2              STR      r2,[r0,#0x2c]
;;;1401   			inv[i]._Uio=0;
000c10  6182              STR      r2,[r0,#0x18]
;;;1402        		inv[i]._Ti=0;
000c12  6202              STR      r2,[r0,#0x20]
;;;1403        		inv[i]._flags_tm=0; 
000c14  f8802046          STRB     r2,[r0,#0x46]
;;;1404        		inv[i]._Uil=0;
000c18  6242              STR      r2,[r0,#0x24]
;;;1405        		inv[i]._Uin=0;
000c1a  6282              STR      r2,[r0,#0x28]
;;;1406   			inv[i]._cnt=25; 
000c1c  f04f0119          MOV      r1,#0x19
000c20  7081              STRB     r1,[r0,#2]
;;;1407   			inv[i]._Uoutmin=0; 
000c22  f8802059          STRB     r2,[r0,#0x59]
;;;1408   			inv[i]._Uoutmax=0; 
000c26  f880205a          STRB     r2,[r0,#0x5a]
;;;1409   			inv[i]._Pnom=0; 
000c2a  f8802058          STRB     r2,[r0,#0x58]
;;;1410   			inv[i]._net_contr_en=0;
000c2e  f880205b          STRB     r2,[r0,#0x5b]
;;;1411   			inv[i]._pwm_en=0;   
000c32  f880205c          STRB     r2,[r0,#0x5c]
                  |L1.3126|
000c36  f1030301          ADD      r3,r3,#1              ;1378
000c3a  b2db              UXTB     r3,r3                 ;1378
                  |L1.3132|
000c3c  42a3              CMP      r3,r4                 ;1378
000c3e  db9e              BLT      |L1.2942|
                  |L1.3136|
;;;1412   			   
;;;1413        		}
;;;1414        	}
;;;1415      	}
;;;1416   #endif
;;;1417   
;;;1418   #ifdef GLADKOV
;;;1419   inv[0]._Ii=bps[4]._buff[0]+(bps[4]._buff[1]*256);
;;;1420   inv[0]._Pio=bps[4]._buff[2]+(bps[4]._buff[3]*256);
;;;1421   inv[0]._Uio=bps[4]._buff[4]+(bps[4]._buff[5]*256);
;;;1422   inv[0]._Ti=(signed)(bps[4]._buff[6]);
;;;1423   inv[0]._flags_tm=bps[4]._buff[7];
;;;1424   inv[0]._Uin=bps[4]._buff[8]+(bps[4]._buff[9]*256);
;;;1425   inv[0]._Uil=bps[4]._buff[10]+(bps[4]._buff[11]*256);
;;;1426   inv[0]._cnt=0;    
;;;1427   
;;;1428   inv[1]._Ii=bps[21]._buff[0]+(bps[21]._buff[1]*256);
;;;1429   inv[1]._Pio=bps[21]._buff[2]+(bps[21]._buff[3]*256);
;;;1430   inv[1]._Uio=bps[21]._buff[4]+(bps[21]._buff[5]*256);
;;;1431   inv[1]._Ti=(signed)(bps[21]._buff[6]);
;;;1432   inv[1]._flags_tm=bps[21]._buff[7];
;;;1433   inv[1]._Uin=bps[21]._buff[8]+(bps[21]._buff[9]*256);
;;;1434   inv[1]._Uil=bps[21]._buff[10]+(bps[21]._buff[11]*256);
;;;1435   inv[1]._cnt=0;    
;;;1436   #endif
;;;1437   
;;;1438   /*
;;;1439   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE==1))
;;;1440   	{
;;;1441   	lakb[0]._battCommState=0;
;;;1442   	if(lakb[0]._cnt>10)lakb[0]._battCommState=2;
;;;1443   	else if(lakb[0]._bRS485ERR==1)lakb[0]._battCommState=1;
;;;1444   	
;;;1445   	if(lakb[0]._battCommState==0)
;;;1446   		{	
;;;1447   		bat[0]._Ub=(signed short)((lakb[0]._tot_bat_volt+5)/10);
;;;1448   		bat[0]._Ib=(signed short)lakb[0]._ch_curr;
;;;1449   		if(lakb[0]._dsch_curr) bat[0]._Ib=(signed short) (-lakb[0]._dsch_curr);
;;;1450   		bat[0]._Tb=(signed short)lakb[0]._max_cell_temp;
;;;1451   		}
;;;1452   	}
;;;1453   */
;;;1454   
;;;1455   #ifdef UKU_TELECORE2015
;;;1456   
;;;1457   	if(BAT_TYPE==2)
;;;1458   		{
;;;1459   		lakb[0]._ch_curr/*temp_SS*/=((ascii2halFhex(liBatteryInBuff[113]))<<12)+
;;;1460   					 		((ascii2halFhex(liBatteryInBuff[114]))<<8)+
;;;1461   							((ascii2halFhex(liBatteryInBuff[115]))<<4)+
;;;1462   							((ascii2halFhex(liBatteryInBuff[116])));
;;;1463   		
;;;1464   		/*if(temp_SS&0x8000)		lakb[0]._ch_curr=~temp_SS;
;;;1465   		else 				lakb[0]._ch_curr=temp_SS;*/
;;;1466   	
;;;1467   		lakb[0]._tot_bat_volt=	(unsigned short)(((ascii2halFhex(liBatteryInBuff[117]))<<12)+
;;;1468   							((ascii2halFhex(liBatteryInBuff[118]))<<8)+
;;;1469   							((ascii2halFhex(liBatteryInBuff[119]))<<4)+
;;;1470   							((ascii2halFhex(liBatteryInBuff[120]))))/100;
;;;1471   	
;;;1472   		lakb[0]._max_cell_temp= 	(((ascii2halFhex(liBatteryInBuff[93]))<<12)+
;;;1473   							((ascii2halFhex(liBatteryInBuff[94]))<<8)+
;;;1474   							((ascii2halFhex(liBatteryInBuff[95]))<<4)+
;;;1475   							((ascii2halFhex(liBatteryInBuff[96]))))/10-273;
;;;1476   	
;;;1477   		lakb[0]._s_o_c_abs=		(unsigned short)((ascii2halFhex(liBatteryInBuff[121]))<<12)+
;;;1478   							((ascii2halFhex(liBatteryInBuff[122]))<<8)+
;;;1479   							((ascii2halFhex(liBatteryInBuff[123]))<<4)+
;;;1480   							((ascii2halFhex(liBatteryInBuff[124])));
;;;1481   	
;;;1482   		lakb[0]._rat_cap=		(unsigned short)((ascii2halFhex(liBatteryInBuff[127]))<<12)+
;;;1483   							((ascii2halFhex(liBatteryInBuff[128]))<<8)+
;;;1484   							((ascii2halFhex(liBatteryInBuff[129]))<<4)+
;;;1485   							((ascii2halFhex(liBatteryInBuff[130])));
;;;1486   	
;;;1487   		lakb[0]._s_o_c=		lakb[0]._s_o_c_abs/(lakb[0]._rat_cap/100);
;;;1488   	
;;;1489   	
;;;1490   	/*	lakb[0]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;1491   		lakb[0]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;1492   		lakb[0]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;1493   		lakb[0]._max_cell_temp= lakb_damp[i][4];
;;;1494   		lakb[0]._min_cell_temp= lakb_damp[i][5];
;;;1495   		lakb[0]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;1496   		lakb[0]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][8];
;;;1497   		lakb[0]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;1498   		lakb[0]._s_o_c= lakb_damp[i][12];
;;;1499   		lakb[0]._r_b_t= lakb_damp[i][15];
;;;1500   		lakb[0]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;1501   		lakb[0]._s_o_h= lakb_damp[i][18];
;;;1502   	
;;;1503   		if(lakb[i]._rat_cap==0)
;;;1504   			{
;;;1505   			if(lakb[i]._isOnCnt)
;;;1506   				{
;;;1507   				lakb[i]._isOnCnt--;
;;;1508   				if(lakb[i]._isOnCnt==0)
;;;1509   					{
;;;1510   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;1511   					}
;;;1512   				}
;;;1513   			}
;;;1514   		else 
;;;1515   			{
;;;1516   			if(lakb[i]._isOnCnt<50)
;;;1517   				{
;;;1518   				lakb[i]._isOnCnt++;
;;;1519   				if(lakb[i]._isOnCnt==50)
;;;1520   					{
;;;1521   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;1522   					}
;;;1523   				}
;;;1524   			}
;;;1525   		gran(&lakb[i]._isOnCnt,0,50);*/
;;;1526   		}
;;;1527   	else if(BAT_TYPE==3)
;;;1528   		{
;;;1529   		//short numOfPacks;
;;;1530   		//short numOfCells, numOfTemperCells, baseOfData;
;;;1531   		
;;;1532   		#ifndef UKU_TELECORE2016
;;;1533   		numOfCells=((ascii2halFhex(liBatteryInBuff[17]))<<4)+((ascii2halFhex(liBatteryInBuff[18])));
;;;1534   		numOfTemperCells=((ascii2halFhex(liBatteryInBuff[17+(numOfCells*4)+2]))<<4)+((ascii2halFhex(liBatteryInBuff[18+(numOfCells*4)+2])));
;;;1535   		numOfPacks=((ascii2halFhex(liBatteryInBuff[15]))<<4)+((ascii2halFhex(liBatteryInBuff[16])));
;;;1536   		if(numOfPacks)numOfPacks-=1;
;;;1537   		if((numOfPacks<0)||(numOfPacks>NUMBAT_TELECORE))numOfPacks=0;
;;;1538   		plazma_numOfCells=numOfCells;
;;;1539   		plazma_numOfTemperCells=numOfTemperCells;
;;;1540   		plazma_numOfPacks=numOfPacks;
;;;1541   
;;;1542   
;;;1543   		baseOfData=16+(numOfCells*4)+2+(numOfTemperCells*4)+2;
;;;1544   
;;;1545   		lakb[numOfPacks]._ch_curr=(signed short)(
;;;1546   							((ascii2halFhex(liBatteryInBuff[1+baseOfData]))<<12)+
;;;1547   							((ascii2halFhex(liBatteryInBuff[2+baseOfData]))<<8)+
;;;1548   							((ascii2halFhex(liBatteryInBuff[3+baseOfData]))<<4)+
;;;1549   							((ascii2halFhex(liBatteryInBuff[4+baseOfData])))
;;;1550   							);	  
;;;1551   
;;;1552   		lakb[numOfPacks]._tot_bat_volt=(signed short)(
;;;1553   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+4]))<<12)+
;;;1554   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+4]))<<8)+
;;;1555   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+4]))<<4)+
;;;1556   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+4])))
;;;1557   							)/10;
;;;1558   
;;;1559   		lakb[numOfPacks]._max_cell_temp=(signed short)(
;;;1560   							((ascii2halFhex(liBatteryInBuff[1+baseOfData-4]))<<12)+
;;;1561   							((ascii2halFhex(liBatteryInBuff[2+baseOfData-4]))<<8)+
;;;1562   							((ascii2halFhex(liBatteryInBuff[3+baseOfData-4]))<<4)+
;;;1563   							((ascii2halFhex(liBatteryInBuff[4+baseOfData-4])))
;;;1564   							)-2730;
;;;1565   
;;;1566   		lakb[numOfPacks]._s_o_c=(signed short)(
;;;1567   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+8]))<<12)+
;;;1568   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+8]))<<8)+
;;;1569   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+8]))<<4)+
;;;1570   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+8])))
;;;1571   							)/10;
;;;1572   
;;;1573   		lakb[numOfPacks]._s_o_h=(signed short)(
;;;1574   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+14]))<<12)+
;;;1575   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+14]))<<8)+
;;;1576   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+14]))<<4)+
;;;1577   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+14])))
;;;1578   							)/10;
;;;1579   		#endif
;;;1580   		
;;;1581   		#ifdef UKU_TELECORE2016
;;;1582   		{
;;;1583   		char i;
;;;1584   		
;;;1585   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;1586   			{
;;;1587   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;1588   			}
;;;1589   		}
;;;1590   		#endif
;;;1591   		
;;;1592   										  
;;;1593   		}
;;;1594   	
;;;1595   if(sacredSunSilentCnt<3) 
;;;1596   	{
;;;1597       	bat[0]._Ub=lakb[0]._tot_bat_volt;
;;;1598       	bat[0]._Tb=lakb[0]._max_cell_temp;
;;;1599      	//bat[0]._Ib=lakb[0]._ch_curr/10;
;;;1600   	}
;;;1601   else 
;;;1602   	{
;;;1603       	//bat[0]._Ub=0;
;;;1604       	//bat[0]._Tb=0;
;;;1605      	//bat[0]._Ib=0;
;;;1606   	}
;;;1607   
;;;1608   if(BAT_TYPE==1)
;;;1609   	{
;;;1610   	char i;
;;;1611   	for(i=0;i<1;i++)
;;;1612   		{
;;;1613   		lakb[i]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;1614   		lakb[i]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;1615   		lakb[i]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;1616   		lakb[i]._max_cell_temp= lakb_damp[i][4];
;;;1617   		lakb[i]._min_cell_temp= lakb_damp[i][5];
;;;1618   		lakb[i]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;1619   		lakb[i]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][9];
;;;1620   		lakb[i]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;1621   		lakb[i]._s_o_c= lakb_damp[i][12];
;;;1622   		lakb[i]._r_b_t= lakb_damp[i][15];
;;;1623   		lakb[i]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;1624   		lakb[i]._s_o_h= lakb_damp[i][18];
;;;1625   		lakb[i]._flags1= lakb_damp[i][34];
;;;1626   		lakb[i]._flags2= lakb_damp[i][35];
;;;1627   		lakb[i]._b_p_ser_num= lakb_damp[i][36];
;;;1628   
;;;1629   /*		if(lakb[i]._rat_cap==0)
;;;1630   			{
;;;1631   			if(lakb[i]._isOnCnt)
;;;1632   				{
;;;1633   				lakb[i]._isOnCnt--;
;;;1634   				if(lakb[i]._isOnCnt==0)
;;;1635   					{
;;;1636   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;1637   					}
;;;1638   				}
;;;1639   			}
;;;1640   		else 
;;;1641   			{
;;;1642   			if(lakb[i]._isOnCnt<50)
;;;1643   				{
;;;1644   				lakb[i]._isOnCnt++;
;;;1645   				if(lakb[i]._isOnCnt==50)
;;;1646   					{
;;;1647   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;1648   					}
;;;1649   				}
;;;1650   			} */
;;;1651   		gran(&lakb[i]._isOnCnt,0,50);
;;;1652   	 	}
;;;1653   
;;;1654   	if(lakb_damp[0][41]==100)
;;;1655   		{
;;;1656   		li_bat._485Error=1;
;;;1657   		}
;;;1658   	if(lakb_damp[0][41]==0)
;;;1659   		{
;;;1660   		//if(bRS485ERR)bLAKB_KONF_CH=1;
;;;1661   		li_bat._485Error=0;
;;;1662   		}
;;;1663   	li_bat._485ErrorCnt=lakb_damp[0][41];
;;;1664   
;;;1665   
;;;1666   	}
;;;1667   
;;;1668   
;;;1669   #endif
;;;1670   
;;;1671   		#ifdef UKU_TELECORE2017
;;;1672   		{
;;;1673   		char i;
;;;1674   		
;;;1675   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;1676   			{
;;;1677   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;1678   			}
;;;1679   		}
;;;1680   		#endif
;;;1681   #ifdef UKU_TELECORE2015
;;;1682   //вычисление параметров работы батареи
;;;1683   //TODO дописать дл€ всех батарей все параметры и при отцепке батарей
;;;1684   li_bat._batStat=bsOK;
;;;1685   if(BAT_TYPE==1) //COSLIGHT
;;;1686   	{
;;;1687   	if(li_bat._batStat==bsOK)
;;;1688   		{
;;;1689   		li_bat._Ub=lakb[0]._tot_bat_volt/10;
;;;1690   
;;;1691   		if(lakb[0]._ch_curr)li_bat._Ib=lakb[0]._ch_curr/10;
;;;1692   		else if(lakb[0]._dsch_curr) li_bat._Ib=bat[0]._Ib/10;//lakb[0]._dsch_curr/10;
;;;1693   	
;;;1694   		li_bat._ratCap=lakb[0]._rat_cap/100;
;;;1695   		li_bat._soc=lakb[0]._s_o_c;
;;;1696   		li_bat._soh=lakb[0]._s_o_h;
;;;1697   		li_bat._cclv=lakb[0]._c_c_l_v/10;
;;;1698   		li_bat._Tb=lakb[0]._max_cell_temp;
;;;1699   		li_bat._rbt=lakb[0]._r_b_t;
;;;1700   		}
;;;1701   	else 
;;;1702   		{
;;;1703   		li_bat._Ub=bat[0]._Ub;
;;;1704   		li_bat._Ib=bat[0]._Ib/10;
;;;1705   		li_bat._Tb=bat[0]._Tb;
;;;1706   		}
;;;1707   
;;;1708   	if((li_bat._485Error)||(li_bat._canError))
;;;1709   		{
;;;1710   		li_bat._batStat=bsOFF;
;;;1711   		}
;;;1712   	else li_bat._batStat=bsOK;
;;;1713   	}
;;;1714   else if(BAT_TYPE==2) //SACRED SUN
;;;1715   	{
;;;1716   	}
;;;1717   else if(BAT_TYPE==3) //ZTT
;;;1718   	{
;;;1719   	if(li_bat._batStat==bsOK)
;;;1720   		{
;;;1721   
;;;1722   		}
;;;1723   	}
;;;1724   #endif
;;;1725   
;;;1726   
;;;1727   /*
;;;1728   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE[0]==1)&&(BAT_LINK==0))
;;;1729   	{
;;;1730   
;;;1731   
;;;1732   	if(bat_drv_rx_buff[13]<=0x39)bbb[0]=bat_drv_rx_buff[13]-0x30;
;;;1733   	else bbb[0]=bat_drv_rx_buff[13]-55;
;;;1734   	if(bat_drv_rx_buff[14]<=0x39)bbb[1]=bat_drv_rx_buff[14]-0x30;
;;;1735   	else bbb[1]=bat_drv_rx_buff[14]-55;
;;;1736   	if(bat_drv_rx_buff[15]<=0x39)bbb[2]=bat_drv_rx_buff[15]-0x30;
;;;1737   	else bbb[2]=bat_drv_rx_buff[15]-55;
;;;1738   	if(bat_drv_rx_buff[16]<=0x39)bbb[3]=bat_drv_rx_buff[16]-0x30;
;;;1739   	else bbb[3]=bat_drv_rx_buff[16]-55;
;;;1740   
;;;1741   	tempSS=0;
;;;1742   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;1743   
;;;1744   	bat[0]._max_cell_volt=(tempSS+5)/10;
;;;1745   
;;;1746   	if(bat_drv_rx_buff[17]<=0x39)bbb[0]=bat_drv_rx_buff[17]-0x30;
;;;1747   	else bbb[0]=bat_drv_rx_buff[17]-55;
;;;1748   	if(bat_drv_rx_buff[18]<=0x39)bbb[1]=bat_drv_rx_buff[18]-0x30;
;;;1749   	else bbb[1]=bat_drv_rx_buff[18]-55;
;;;1750   	if(bat_drv_rx_buff[19]<=0x39)bbb[2]=bat_drv_rx_buff[19]-0x30;
;;;1751   	else bbb[2]=bat_drv_rx_buff[19]-55;
;;;1752   	if(bat_drv_rx_buff[20]<=0x39)bbb[3]=bat_drv_rx_buff[20]-0x30;
;;;1753   	else bbb[3]=bat_drv_rx_buff[20]-55;
;;;1754   
;;;1755   	tempSS=0;
;;;1756   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;1757   
;;;1758   	bat[0]._min_cell_volt=(tempSS+5)/10;
;;;1759   
;;;1760   
;;;1761   	}*/
;;;1762   
;;;1763   
;;;1764   
;;;1765   }
000c40  e8bd8ffe          POP      {r1-r11,pc}
;;;1766   
                          ENDP

                  adc_init PROC
;;;1769   //-----------------------------------------------
;;;1770   void adc_init(void)
000c44  484d              LDR      r0,|L1.3452|
;;;1771   {
;;;1772   
;;;1773   SET_REG(LPC_PINCON->PINSEL1,1,(25-16)*2,2);
000c46  6841              LDR      r1,[r0,#4]
000c48  f4212140          BIC      r1,r1,#0xc0000
000c4c  f4412180          ORR      r1,r1,#0x40000
000c50  6041              STR      r1,[r0,#4]
;;;1774   SET_REG(LPC_PINCON->PINSEL1,1,(24-16)*2,2);
000c52  6841              LDR      r1,[r0,#4]
000c54  f4213140          BIC      r1,r1,#0x30000
000c58  f4413180          ORR      r1,r1,#0x10000
000c5c  6041              STR      r1,[r0,#4]
;;;1775   SET_REG(LPC_PINCON->PINSEL1,1,(23-16)*2,2);
000c5e  6841              LDR      r1,[r0,#4]
000c60  f4214140          BIC      r1,r1,#0xc000
000c64  f4414180          ORR      r1,r1,#0x4000
000c68  6041              STR      r1,[r0,#4]
;;;1776   
;;;1777   
;;;1778   SET_REG(LPC_PINCON->PINMODE1,2,(25-16)*2,2);
000c6a  6c41              LDR      r1,[r0,#0x44]
000c6c  f4212140          BIC      r1,r1,#0xc0000
000c70  f4412100          ORR      r1,r1,#0x80000
000c74  6441              STR      r1,[r0,#0x44]
;;;1779   SET_REG(LPC_PINCON->PINMODE1,2,(24-16)*2,2);
000c76  6c41              LDR      r1,[r0,#0x44]
000c78  f4213140          BIC      r1,r1,#0x30000
000c7c  f4413100          ORR      r1,r1,#0x20000
000c80  6441              STR      r1,[r0,#0x44]
;;;1780   SET_REG(LPC_PINCON->PINMODE1,2,(23-16)*2,2);
000c82  6c41              LDR      r1,[r0,#0x44]
000c84  f4214140          BIC      r1,r1,#0xc000
000c88  f4414100          ORR      r1,r1,#0x8000
000c8c  6441              STR      r1,[r0,#0x44]
;;;1781   
;;;1782   SET_REG(LPC_ADC->ADCR,0,24,3);
000c8e  483c              LDR      r0,|L1.3456|
000c90  6801              LDR      r1,[r0,#0]
000c92  f02161e0          BIC      r1,r1,#0x7000000
000c96  6001              STR      r1,[r0,#0]
;;;1783   
;;;1784   SET_REG(LPC_ADC->ADCR,1,21,1);
000c98  6801              LDR      r1,[r0,#0]
000c9a  f4411100          ORR      r1,r1,#0x200000
000c9e  6001              STR      r1,[r0,#0]
;;;1785   SET_REG(LPC_ADC->ADCR,0,16,1);
000ca0  6801              LDR      r1,[r0,#0]
000ca2  f4213180          BIC      r1,r1,#0x10000
000ca6  6001              STR      r1,[r0,#0]
;;;1786   SET_REG(LPC_ADC->ADCR,1,8,8);
000ca8  6801              LDR      r1,[r0,#0]
000caa  f421417f          BIC      r1,r1,#0xff00
000cae  f4417180          ORR      r1,r1,#0x100
000cb2  6001              STR      r1,[r0,#0]
;;;1787   
;;;1788   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;1789   //SET_REG(LPC_GPIO0->FIOPIN,4,5,3);
;;;1790   	
;;;1791   	/*if(adc_ch<=7)*///SET_REG(LPC_ADC->ADCR,1<<5,0,8);
;;;1792        /*else if(adc_ch==8) SET_REG(LPC_ADC->ADCR,1<<2,0,8);
;;;1793        else SET_REG(LPC_ADC->ADCR,1<<4,0,8);*/
;;;1794   
;;;1795   LPC_ADC->ADINTEN     =  (1<< 8);      /* global enable interrupt            */
000cb4  f44f7180          MOV      r1,#0x100
000cb8  60c1              STR      r1,[r0,#0xc]
000cba  4832              LDR      r0,|L1.3460|
000cbc  f44f0180          MOV      r1,#0x400000
000cc0  6001              STR      r1,[r0,#0]
;;;1796   
;;;1797   NVIC_EnableIRQ(ADC_IRQn);             /* enable ADC Interrupt               */
;;;1798   
;;;1799   
;;;1800   }
000cc2  4770              BX       lr
;;;1801   
                          ENDP

                  adc_drv7 PROC
;;;1802   //-----------------------------------------------
;;;1803   void adc_drv7(void) //(Uсети - посто€нка)
000cc4  e92d41f0          PUSH     {r4-r8,lr}
;;;1804   {
;;;1805   //int temp_S;
;;;1806   //char i;
;;;1807   //signed short temp_SS;
;;;1808   
;;;1809   adc_self_ch_disp[0]=abs_pal(adc_self_ch_buff[1]-adc_self_ch_buff[0]);//adc_self_ch_buff[0]&0x0f80;
000cc8  4c2f              LDR      r4,|L1.3464|
000cca  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000ccc  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000cce  1a40              SUBS     r0,r0,r1
000cd0  b200              SXTH     r0,r0
000cd2  f7fffffe          BL       abs_pal
000cd6  1da6              ADDS     r6,r4,#6
000cd8  8030              STRH     r0,[r6,#0]
;;;1810   adc_self_ch_disp[1]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[1]);//adc_self_ch_buff[1]&0x0f80;
000cda  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000cdc  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
000cde  1a40              SUBS     r0,r0,r1
000ce0  b200              SXTH     r0,r0
000ce2  f7fffffe          BL       abs_pal
000ce6  8070              STRH     r0,[r6,#2]
;;;1811   adc_self_ch_disp[2]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[0]);//adc_self_ch_buff[2]&0x0f80;
000ce8  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000cea  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000cec  1a40              SUBS     r0,r0,r1
000cee  b200              SXTH     r0,r0
000cf0  f7fffffe          BL       abs_pal
000cf4  80b0              STRH     r0,[r6,#4]
;;;1812   
;;;1813   //adc_self_ch_disp[0]=adc_self_ch_buff[0]&0x0ff0;
;;;1814   //adc_self_ch_disp[1]=adc_self_ch_buff[1]&0x0ff0;
;;;1815   //adc_self_ch_disp[2]=adc_self_ch_buff[2]&0x0ff0;
;;;1816   
;;;1817   
;;;1818   if(adc_self_ch_disp[2]<300)//==adc_self_ch_disp[2])
000cf6  f44f7196          MOV      r1,#0x12c
;;;1819   	{
;;;1820   	adc_result=adc_self_ch_buff[2];
000cfa  f1a4057a          SUB      r5,r4,#0x7a
000cfe  4288              CMP      r0,r1                 ;1818
000d00  da02              BGE      |L1.3336|
000d02  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000d04  8568              STRH     r0,[r5,#0x2a]
000d06  e00c              B        |L1.3362|
                  |L1.3336|
;;;1821   	} 
;;;1822   else if(adc_self_ch_disp[1]<300)//==adc_self_ch_disp[2])
000d08  f9b60002          LDRSH    r0,[r6,#2]  ; adc_self_ch_disp
000d0c  4288              CMP      r0,r1
000d0e  da02              BGE      |L1.3350|
;;;1823   	{
;;;1824   	adc_result=adc_self_ch_buff[1];
000d10  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000d12  8568              STRH     r0,[r5,#0x2a]
000d14  e005              B        |L1.3362|
                  |L1.3350|
;;;1825   	}
;;;1826   else if(adc_self_ch_disp[0]<300)//==adc_self_ch_disp[1])
000d16  f9b60000          LDRSH    r0,[r6,#0]  ; adc_self_ch_disp
000d1a  4288              CMP      r0,r1
000d1c  da01              BGE      |L1.3362|
;;;1827   	{
;;;1828   	adc_result=adc_self_ch_buff[0];
000d1e  8820              LDRH     r0,[r4,#0]  ; adc_self_ch_buff
000d20  8568              STRH     r0,[r5,#0x2a]
                  |L1.3362|
;;;1829   	}
;;;1830       //adc_result=92;
;;;1831   
;;;1832   if(adc_ch_net)
000d22  78ef              LDRB     r7,[r5,#3]  ; adc_ch_net
000d24  2600              MOVS     r6,#0
000d26  b39f              CBZ      r7,|L1.3472|
;;;1833   	{
;;;1834   
;;;1835   	main_power_buffer[0]+=(long)(adc_result);
000d28  4818              LDR      r0,|L1.3468|
000d2a  f9b5102a          LDRSH    r1,[r5,#0x2a]  ; adc_result
000d2e  6802              LDR      r2,[r0,#0]  ; main_power_buffer
000d30  440a              ADD      r2,r2,r1
000d32  6002              STR      r2,[r0,#0]  ; main_power_buffer
;;;1836   	main_power_buffer[1]+=(long)(adc_result);
000d34  6842              LDR      r2,[r0,#4]  ; main_power_buffer
000d36  440a              ADD      r2,r2,r1
000d38  6042              STR      r2,[r0,#4]  ; main_power_buffer
;;;1837   	main_power_buffer[2]+=(long)(adc_result);
000d3a  6882              LDR      r2,[r0,#8]  ; main_power_buffer
000d3c  440a              ADD      r2,r2,r1
000d3e  6082              STR      r2,[r0,#8]  ; main_power_buffer
;;;1838   	main_power_buffer[3]+=(long)(adc_result);
000d40  68c2              LDR      r2,[r0,#0xc]  ; main_power_buffer
000d42  4411              ADD      r1,r1,r2
000d44  60c1              STR      r1,[r0,#0xc]  ; main_power_buffer
;;;1839   
;;;1840   	adc_net_buff_cnt++;
000d46  e024              B        |L1.3474|
                  |L1.3400|
                          DCD      Uvv_eb2
                  |L1.3404|
                          DCD      Kpes_eb2
                  |L1.3408|
                          DCD      Upes_eb2
                  |L1.3412|
                          DCD      ibt
                  |L1.3416|
                          DCD      ND_EXT
                  |L1.3420|
                          DCD      t_box
                  |L1.3424|
                          DCD      t_ext_can_nd
                  |L1.3428|
                          DCD      t_ext_can
                  |L1.3432|
                          DCD      BAT_IS_ON
                  |L1.3436|
                          DCD      load_I
                  |L1.3440|
                          DCD      Isumm
                  |L1.3444|
                          DCD      NUMINV
                  |L1.3448|
                          DCD      inv
                  |L1.3452|
                          DCD      0x4002c000
                  |L1.3456|
                          DCD      0x40034000
                  |L1.3460|
                          DCD      0xe000e100
                  |L1.3464|
                          DCD      ||area_number.26||+0x7a
                  |L1.3468|
                          DCD      ||.bss||+0x420
                  |L1.3472|
000d90  e016              B        |L1.3520|
                  |L1.3474|
000d92  8e69              LDRH     r1,[r5,#0x32]  ; adc_net_buff_cnt
000d94  f1010101          ADD      r1,r1,#1
000d98  b209              SXTH     r1,r1
000d9a  8669              STRH     r1,[r5,#0x32]
;;;1841   	if(adc_net_buff_cnt>=0x1000)
000d9c  f5b15f80          CMP      r1,#0x1000
000da0  db00              BLT      |L1.3492|
;;;1842   		{
;;;1843   		adc_net_buff_cnt=0;
000da2  866e              STRH     r6,[r5,#0x32]
                  |L1.3492|
;;;1844   		}
;;;1845   	if((adc_net_buff_cnt&0x03ff)==0)
000da4  f9b51032          LDRSH    r1,[r5,#0x32]  ; adc_net_buff_cnt
000da8  058a              LSLS     r2,r1,#22
000daa  d12f              BNE      |L1.3596|
;;;1846   		{
;;;1847   		#ifdef UKU_220
;;;1848   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;1849   		#else
;;;1850   		#ifdef UKU_220_V2
;;;1851   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;1852   		#else
;;;1853   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>8);
000dac  ea4f21a1          ASR      r1,r1,#10
000db0  f8502021          LDR      r2,[r0,r1,LSL #2]
000db4  ea4f2222          ASR      r2,r2,#8
000db8  852a              STRH     r2,[r5,#0x28]
;;;1854   		#endif
;;;1855   		#endif
;;;1856   		main_power_buffer[adc_net_buff_cnt>>10]=0;
000dba  f8406021          STR      r6,[r0,r1,LSL #2]
000dbe  e025              B        |L1.3596|
                  |L1.3520|
;;;1857   		}
;;;1858   
;;;1859   
;;;1860   	} 
;;;1861   else if(!adc_ch_net)
;;;1862   	{
;;;1863   	adc_buff[adc_ch][adc_ch_cnt]=(long)adc_result;
000dc0  48fc              LDR      r0,|L1.4532|
000dc2  792c              LDRB     r4,[r5,#4]  ; adc_ch
000dc4  796a              LDRB     r2,[r5,#5]  ; adc_ch_cnt
000dc6  eb001384          ADD      r3,r0,r4,LSL #6
000dca  f9b5102a          LDRSH    r1,[r5,#0x2a]  ; adc_result
000dce  f8431022          STR      r1,[r3,r2,LSL #2]
;;;1864   	
;;;1865   	if((adc_ch_cnt&0x03)==0)
000dd2  0790              LSLS     r0,r2,#30
000dd4  d10d              BNE      |L1.3570|
;;;1866   		{
;;;1867   		long temp_L;
;;;1868   		char i;
;;;1869   		temp_L=0;
000dd6  4601              MOV      r1,r0
                  |L1.3544|
;;;1870   		for(i=0;i<16;i++)
;;;1871   			{
;;;1872   			temp_L+=adc_buff[adc_ch][i];
000dd8  f853c020          LDR      r12,[r3,r0,LSL #2]
000ddc  4461              ADD      r1,r1,r12
000dde  f1000001          ADD      r0,r0,#1              ;1870
000de2  b2c0              UXTB     r0,r0                 ;1870
000de4  2810              CMP      r0,#0x10              ;1870
000de6  d3f7              BCC      |L1.3544|
;;;1873   			}
;;;1874   		adc_buff_[adc_ch]= (short)(temp_L>>4);
000de8  ea4f1021          ASR      r0,r1,#4
000dec  49f2              LDR      r1,|L1.4536|
000dee  f8210014          STRH     r0,[r1,r4,LSL #1]
                  |L1.3570|
;;;1875   
;;;1876   		//adc_buff_[3]=346;
;;;1877   		}
;;;1878   	if(++adc_ch>=16) 
000df2  1c64              ADDS     r4,r4,#1
000df4  b2e0              UXTB     r0,r4
000df6  7128              STRB     r0,[r5,#4]
000df8  2810              CMP      r0,#0x10
000dfa  d307              BCC      |L1.3596|
;;;1879   		{
;;;1880   		adc_ch=0;
000dfc  712e              STRB     r6,[r5,#4]
;;;1881   		adc_ch_cnt++;
000dfe  f1020201          ADD      r2,r2,#1
000e02  b2d0              UXTB     r0,r2
000e04  7168              STRB     r0,[r5,#5]
;;;1882   		if(adc_ch_cnt>=16)adc_ch_cnt=0;
000e06  2810              CMP      r0,#0x10
000e08  d300              BCC      |L1.3596|
000e0a  716e              STRB     r6,[r5,#5]
                  |L1.3596|
;;;1883   		}
;;;1884   	}
;;;1885   
;;;1886   //adc_buff[adc_ch][adc_cnt1]=(adc_self_ch_buff[2]+adc_self_ch_buff[1])/2;
;;;1887   
;;;1888   //if(adc_buff[adc_ch][adc_cnt1]<adc_buff_min[adc_ch])adc_buff_min[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;1889   //if(adc_buff[adc_ch][adc_cnt1]>adc_buff_max[adc_ch])adc_buff_max[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;1890   /*
;;;1891   	{
;;;1892   	if((adc_cnt1&0x03)==0)
;;;1893   		{
;;;1894   		temp_S=0;
;;;1895   		for(i=0;i<16;i++)
;;;1896   			{
;;;1897   			temp_S+=adc_buff[adc_ch][i];
;;;1898   			} 
;;;1899            	adc_buff_[adc_ch]=temp_S>>4;
;;;1900             }
;;;1901   	}*/
;;;1902   
;;;1903   
;;;1904   		  
;;;1905   
;;;1906   adc_self_ch_cnt=0;
000e0c  70ae              STRB     r6,[r5,#2]
;;;1907   
;;;1908   adc_ch_net++;
000e0e  f1070701          ADD      r7,r7,#1
;;;1909   adc_ch_net&=1;
000e12  f0070001          AND      r0,r7,#1
000e16  70e8              STRB     r0,[r5,#3]
;;;1910   
;;;1911   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;1912   //SET_REG(LPC_GPIO0->FIOPIN,adc_ch,5,3);
;;;1913   
;;;1914   if(adc_ch_net)
;;;1915   	{
;;;1916   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;1917   	//LPC_GPIO2->FIOPIN|=(1<<7);
;;;1918   	SET_REG(LPC_ADC->ADCR,1<<2,0,8);
000e18  4ae8              LDR      r2,|L1.4540|
000e1a  b130              CBZ      r0,|L1.3626|
000e1c  6810              LDR      r0,[r2,#0]
000e1e  f02000ff          BIC      r0,r0,#0xff
000e22  f1000004          ADD      r0,r0,#4
000e26  6010              STR      r0,[r2,#0]
000e28  e03d              B        |L1.3750|
                  |L1.3626|
;;;1919   	}
;;;1920   else
;;;1921   	{
;;;1922   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;1923   	//LPC_GPIO2->FIOPIN&=~(1<<7);
;;;1924   	if(!(adc_ch&(1<<3)))SET_REG(LPC_ADC->ADCR,1<<0,0,8);
000e2a  7929              LDRB     r1,[r5,#4]  ; adc_ch
000e2c  0708              LSLS     r0,r1,#28
000e2e  d406              BMI      |L1.3646|
000e30  6810              LDR      r0,[r2,#0]
000e32  f02000ff          BIC      r0,r0,#0xff
000e36  f1000001          ADD      r0,r0,#1
000e3a  6010              STR      r0,[r2,#0]
000e3c  e005              B        |L1.3658|
                  |L1.3646|
;;;1925   	else 			SET_REG(LPC_ADC->ADCR,1<<1,0,8);
000e3e  6810              LDR      r0,[r2,#0]
000e40  f02000ff          BIC      r0,r0,#0xff
000e44  f1000002          ADD      r0,r0,#2
000e48  6010              STR      r0,[r2,#0]
                  |L1.3658|
;;;1926   
;;;1927   
;;;1928   	SET_REG(LPC_GPIO0->FIODIR,1,28,1);
000e4a  48dd              LDR      r0,|L1.4544|
000e4c  6803              LDR      r3,[r0,#0]
000e4e  f0435380          ORR      r3,r3,#0x10000000
000e52  6003              STR      r3,[r0,#0]
;;;1929   	SET_REG(LPC_GPIO1->FIODIR,1,30,1);
000e54  6a03              LDR      r3,[r0,#0x20]
000e56  f0434380          ORR      r3,r3,#0x40000000
000e5a  6203              STR      r3,[r0,#0x20]
;;;1930   	SET_REG(LPC_GPIO3->FIODIR,1,26,1);
000e5c  6e03              LDR      r3,[r0,#0x60]
000e5e  f0436380          ORR      r3,r3,#0x4000000
000e62  6603              STR      r3,[r0,#0x60]
;;;1931   
;;;1932   	if(!(adc_ch&(1<<0)))SET_REG(LPC_GPIO0->FIOPIN,0,28,1);
000e64  07cb              LSLS     r3,r1,#31
000e66  d00a              BEQ      |L1.3710|
;;;1933   	else 			SET_REG(LPC_GPIO0->FIOPIN,1,28,1);
000e68  6943              LDR      r3,[r0,#0x14]
000e6a  f0435380          ORR      r3,r3,#0x10000000
000e6e  6143              STR      r3,[r0,#0x14]
                  |L1.3696|
;;;1934   
;;;1935   	if(!(adc_ch&(1<<1)))SET_REG(LPC_GPIO1->FIOPIN,0,30,1);
000e70  078b              LSLS     r3,r1,#30
000e72  d409              BMI      |L1.3720|
000e74  6b43              LDR      r3,[r0,#0x34]
000e76  f0234380          BIC      r3,r3,#0x40000000
000e7a  6343              STR      r3,[r0,#0x34]
000e7c  e008              B        |L1.3728|
                  |L1.3710|
000e7e  6943              LDR      r3,[r0,#0x14]         ;1932
000e80  f0235380          BIC      r3,r3,#0x10000000     ;1932
000e84  6143              STR      r3,[r0,#0x14]         ;1932
000e86  e7f3              B        |L1.3696|
                  |L1.3720|
;;;1936   	else 			SET_REG(LPC_GPIO1->FIOPIN,1,30,1);
000e88  6b43              LDR      r3,[r0,#0x34]
000e8a  f0434380          ORR      r3,r3,#0x40000000
000e8e  6343              STR      r3,[r0,#0x34]
                  |L1.3728|
;;;1937   
;;;1938   	if(!(adc_ch&(1<<2)))SET_REG(LPC_GPIO3->FIOPIN,0,26,1);
000e90  0749              LSLS     r1,r1,#29
000e92  d404              BMI      |L1.3742|
000e94  6f41              LDR      r1,[r0,#0x74]
000e96  f0216180          BIC      r1,r1,#0x4000000
000e9a  6741              STR      r1,[r0,#0x74]
000e9c  e003              B        |L1.3750|
                  |L1.3742|
;;;1939   	else 			SET_REG(LPC_GPIO3->FIOPIN,1,26,1);
000e9e  6f41              LDR      r1,[r0,#0x74]
000ea0  f0416180          ORR      r1,r1,#0x4000000
000ea4  6741              STR      r1,[r0,#0x74]
                  |L1.3750|
;;;1940   	}
;;;1941   	
;;;1942   
;;;1943   
;;;1944   
;;;1945   LPC_ADC->ADCR |=  (1<<24);
000ea6  6810              LDR      r0,[r2,#0]
000ea8  f0407080          ORR      r0,r0,#0x1000000
000eac  6010              STR      r0,[r2,#0]
;;;1946   
;;;1947   }
000eae  e8bd81f0          POP      {r4-r8,pc}
;;;1948   
                          ENDP

                  avg_hndl PROC
;;;2205   //-----------------------------------------------
;;;2206   void avg_hndl(void)
000eb2  e92d47f0          PUSH     {r4-r10,lr}
;;;2207   { 
;;;2208   char i;
;;;2209   
;;;2210   if(bAVG_BLOCK)return;
000eb6  f8df830c          LDR      r8,|L1.4548|
000eba  f898000f          LDRB     r0,[r8,#0xf]  ; bAVG_BLOCK
000ebe  2800              CMP      r0,#0
000ec0  d106              BNE      |L1.3792|
;;;2211   //#define AVGCNTMAX	5
;;;2212   if(avg_main_cnt)
000ec2  f9b80022          LDRSH    r0,[r8,#0x22]  ; avg_main_cnt
000ec6  b128              CBZ      r0,|L1.3796|
;;;2213   	{
;;;2214   	avg_main_cnt--;
000ec8  f1a00001          SUB      r0,r0,#1
000ecc  f8a80022          STRH     r0,[r8,#0x22]
                  |L1.3792|
;;;2215   	return;
;;;2216   	}                 
;;;2217   
;;;2218   if(avg_cnt_<10)
;;;2219   	{
;;;2220   	avg_cnt_++;
;;;2221   	return;
;;;2222   	}   
;;;2223   avg_cnt_=0;
;;;2224   avg_num=0;
;;;2225   
;;;2226   if(bAVG_DIR)bAVG_DIR=0;
;;;2227   else bAVG_DIR=1;
;;;2228   
;;;2229   for(i=0;i<NUMIST;i++)
;;;2230   	{
;;;2231   	if((bps[i]._state==bsWRK)&&(bps[i]._cnt<20))avg_num++;
;;;2232   	}
;;;2233   
;;;2234   /*if((K[NUMI]>=1)&&(bps_state[0]==ssWRK))	avg_num++;
;;;2235   if((K[NUMI]>=2)&&(bps_state[1]==ssWRK))	avg_num++;
;;;2236   if((K[NUMI]>=3)&&(bps_state[2]==ssWRK))	avg_num++;*/
;;;2237   
;;;2238   	
;;;2239   if(avg_num<2)
;;;2240   	{
;;;2241   	return;
;;;2242   	}
;;;2243   	
;;;2244   else
;;;2245   	{
;;;2246   	i_avg_min=5000;
;;;2247   	i_avg_max=0;
;;;2248   	i_avg_summ=0;
;;;2249   	for(i=0;i<NUMIST;i++)
;;;2250   		{
;;;2251   		if(bps[i]._state==bsWRK)
;;;2252   			{
;;;2253   			if(bps[i]._Ii>i_avg_max)i_avg_max=bps[i]._Ii;
;;;2254   			if(bps[i]._Ii<i_avg_min)i_avg_min=bps[i]._Ii;
;;;2255   			
;;;2256   			i_avg_summ+=bps[i]._Ii;
;;;2257   			}
;;;2258   		}
;;;2259   	i_avg=i_avg_summ/avg_num;	
;;;2260   	
;;;2261   	if(i_avg_min==0)i_avg_min=1;
;;;2262   
;;;2263   	avg=i_avg_max;
;;;2264   	avg*=100;
;;;2265   	avg/=i_avg_min;
;;;2266   
;;;2267   	if(avg>160) bAVG=1;
;;;2268   	if((avg<120)||(vd_U<50)) bAVG=0;
;;;2269   
;;;2270   	if(bAVG==1)
;;;2271   		{
;;;2272   		for(i=0;i<NUMIST;i++)
;;;2273   			{
;;;2274   			if(bps[i]._state==bsWRK)
;;;2275   				{
;;;2276   				signed long tempSL;
;;;2277   				tempSL=0;
;;;2278   				tempSL=(signed long)bps[i]._Ii;
;;;2279   				tempSL*=100L;
;;;2280   				if(i_avg==0) i_avg=1;
;;;2281   				tempSL/=(signed long)i_avg;
;;;2282   				bps[i]._avg=(signed short)tempSL;
;;;2283   
;;;2284   				if((bps[i]._Ii>i_avg)&&(bps[i]._avg>120)&&(!bAVG_DIR))bps[i]._x_avg--;
;;;2285   				if((bps[i]._Ii<i_avg)&&(bps[i]._avg<80)&&(bAVG_DIR))bps[i]._x_avg++;
;;;2286   			
;;;2287   				if(bps[i]._x_avg<-50)bps[i]._x_avg=-50;
;;;2288   				if(bps[i]._x_avg>50)bps[i]._x_avg=50;	
;;;2289   				}
;;;2290   			else bps[i]._avg=0;
;;;2291   			}		
;;;2292   		}			
;;;2293   	}   	 
;;;2294   
;;;2295   /*if(((signed long)(UOUT_-in_U))<20L)
;;;2296   	{
;;;2297   	for(i=0;i<NUMIST;i++) bps[i]._x_=0;
;;;2298   	}*/
;;;2299   
;;;2300   avg_hndl_end:
;;;2301   __nop();  
;;;2302   }
000ed0  e8bd87f0          POP      {r4-r10,pc}
                  |L1.3796|
000ed4  f898000d          LDRB     r0,[r8,#0xd]          ;2218  ; avg_cnt_
000ed8  280a              CMP      r0,#0xa               ;2218
000eda  d204              BCS      |L1.3814|
000edc  f1000001          ADD      r0,r0,#1              ;2220
000ee0  f888000d          STRB     r0,[r8,#0xd]          ;2220
000ee4  e7f4              B        |L1.3792|
                  |L1.3814|
000ee6  f04f0c00          MOV      r12,#0                ;2223
000eea  f888c00d          STRB     r12,[r8,#0xd]         ;2223
000eee  f888c00e          STRB     r12,[r8,#0xe]         ;2224
000ef2  f8980010          LDRB     r0,[r8,#0x10]         ;2226  ; bAVG_DIR
000ef6  f04f0701          MOV      r7,#1                 ;2227
000efa  b110              CBZ      r0,|L1.3842|
000efc  f888c010          STRB     r12,[r8,#0x10]        ;2226
000f00  e001              B        |L1.3846|
                  |L1.3842|
000f02  f8887010          STRB     r7,[r8,#0x10]         ;2227
                  |L1.3846|
000f06  f04f0000          MOV      r0,#0                 ;2229
000f0a  49b0              LDR      r1,|L1.4556|
000f0c  4eae              LDR      r6,|L1.4552|
000f0e  f9b13000          LDRSH    r3,[r1,#0]            ;2229
000f12  e012              B        |L1.3898|
                  |L1.3860|
000f14  ebc01100          RSB      r1,r0,r0,LSL #4       ;2231
000f18  eb0601c1          ADD      r1,r6,r1,LSL #3       ;2231
000f1c  788a              LDRB     r2,[r1,#2]            ;2231
000f1e  2a02              CMP      r2,#2                 ;2231
000f20  d108              BNE      |L1.3892|
000f22  78c9              LDRB     r1,[r1,#3]            ;2231
000f24  2914              CMP      r1,#0x14              ;2231
000f26  d205              BCS      |L1.3892|
000f28  f898100e          LDRB     r1,[r8,#0xe]          ;2231  ; avg_num
000f2c  f1010101          ADD      r1,r1,#1              ;2231
000f30  f888100e          STRB     r1,[r8,#0xe]          ;2231
                  |L1.3892|
000f34  f1000001          ADD      r0,r0,#1              ;2229
000f38  b2c0              UXTB     r0,r0                 ;2229
                  |L1.3898|
000f3a  4298              CMP      r0,r3                 ;2229
000f3c  dbea              BLT      |L1.3860|
000f3e  f898200e          LDRB     r2,[r8,#0xe]          ;2239  ; avg_num
000f42  2a02              CMP      r2,#2                 ;2239
000f44  d3c4              BCC      |L1.3792|
000f46  f2413088          MOV      r0,#0x1388            ;2246
000f4a  f8c80058          STR      r0,[r8,#0x58]         ;2246  ; i_avg_min
000f4e  f8c8c054          STR      r12,[r8,#0x54]        ;2247  ; i_avg_max
000f52  f8c8c05c          STR      r12,[r8,#0x5c]        ;2248  ; i_avg_summ
000f56  f04f0100          MOV      r1,#0                 ;2249
000f5a  e01b              B        |L1.3988|
                  |L1.3932|
000f5c  ebc11001          RSB      r0,r1,r1,LSL #4       ;2251
000f60  eb0600c0          ADD      r0,r6,r0,LSL #3       ;2251
000f64  7884              LDRB     r4,[r0,#2]            ;2251
000f66  2c02              CMP      r4,#2                 ;2251
000f68  d111              BNE      |L1.3982|
000f6a  6a40              LDR      r0,[r0,#0x24]         ;2253
000f6c  f8d84054          LDR      r4,[r8,#0x54]         ;2253  ; i_avg_max
000f70  42a0              CMP      r0,r4                 ;2253
000f72  dd01              BLE      |L1.3960|
000f74  f8c80054          STR      r0,[r8,#0x54]         ;2253  ; i_avg_max
                  |L1.3960|
000f78  f8d84058          LDR      r4,[r8,#0x58]         ;2254  ; i_avg_min
000f7c  42a0              CMP      r0,r4                 ;2254
000f7e  da01              BGE      |L1.3972|
000f80  f8c80058          STR      r0,[r8,#0x58]         ;2254  ; i_avg_min
                  |L1.3972|
000f84  f8d8405c          LDR      r4,[r8,#0x5c]         ;2256  ; i_avg_summ
000f88  4420              ADD      r0,r0,r4              ;2256
000f8a  f8c8005c          STR      r0,[r8,#0x5c]         ;2256  ; i_avg_summ
                  |L1.3982|
000f8e  f1010101          ADD      r1,r1,#1              ;2249
000f92  b2c9              UXTB     r1,r1                 ;2249
                  |L1.3988|
000f94  4299              CMP      r1,r3                 ;2249
000f96  dbe1              BLT      |L1.3932|
000f98  f8d8005c          LDR      r0,[r8,#0x5c]         ;2259  ; i_avg_summ
000f9c  fb90f0f2          SDIV     r0,r0,r2              ;2259
000fa0  f8c80060          STR      r0,[r8,#0x60]         ;2259  ; i_avg
000fa4  f8d80058          LDR      r0,[r8,#0x58]         ;2261  ; i_avg_min
000fa8  b908              CBNZ     r0,|L1.4014|
000faa  f8c87058          STR      r7,[r8,#0x58]         ;2261  ; i_avg_min
                  |L1.4014|
000fae  f8d80054          LDR      r0,[r8,#0x54]         ;2263  ; i_avg_max
000fb2  f04f0164          MOV      r1,#0x64              ;2264
000fb6  fb00f001          MUL      r0,r0,r1              ;2264
000fba  f8d81058          LDR      r1,[r8,#0x58]         ;2265  ; i_avg_min
000fbe  fb90f0f1          SDIV     r0,r0,r1              ;2265
000fc2  f8c80064          STR      r0,[r8,#0x64]         ;2265  ; avg
000fc6  28a0              CMP      r0,#0xa0              ;2267
000fc8  dd01              BLE      |L1.4046|
000fca  f888700c          STRB     r7,[r8,#0xc]          ;2267
                  |L1.4046|
000fce  2878              CMP      r0,#0x78              ;2268
000fd0  db04              BLT      |L1.4060|
000fd2  487f              LDR      r0,|L1.4560|
000fd4  f9b00000          LDRSH    r0,[r0,#0]            ;2268  ; vd_U
000fd8  2832              CMP      r0,#0x32              ;2268
000fda  da01              BGE      |L1.4064|
                  |L1.4060|
000fdc  f888c00c          STRB     r12,[r8,#0xc]         ;2268
                  |L1.4064|
000fe0  f898000c          LDRB     r0,[r8,#0xc]          ;2270  ; bAVG
000fe4  2801              CMP      r0,#1                 ;2270
000fe6  d112              BNE      |L1.4110|
000fe8  f04f0100          MOV      r1,#0                 ;2272
000fec  f06f0931          MVN      r9,#0x31              ;2287
000ff0  e00b              B        |L1.4106|
                  |L1.4082|
000ff2  ebc11001          RSB      r0,r1,r1,LSL #4       ;2274
000ff6  eb0600c0          ADD      r0,r6,r0,LSL #3       ;2274
000ffa  7882              LDRB     r2,[r0,#2]            ;2274
000ffc  2a02              CMP      r2,#2                 ;2274
000ffe  d008              BEQ      |L1.4114|
001000  f8a0c066          STRH     r12,[r0,#0x66]        ;2290
                  |L1.4100|
001004  f1010101          ADD      r1,r1,#1              ;2272
001008  b2c9              UXTB     r1,r1                 ;2272
                  |L1.4106|
00100a  4299              CMP      r1,r3                 ;2272
00100c  dbf1              BLT      |L1.4082|
                  |L1.4110|
00100e  bf00              NOP                            ;2301
001010  e75e              B        |L1.3792|
                  |L1.4114|
001012  6a44              LDR      r4,[r0,#0x24]         ;2278
001014  f04f0264          MOV      r2,#0x64              ;2279
001018  fb04f202          MUL      r2,r4,r2              ;2279
00101c  f8d85060          LDR      r5,[r8,#0x60]         ;2280  ; i_avg
001020  b90d              CBNZ     r5,|L1.4134|
001022  f8c87060          STR      r7,[r8,#0x60]         ;2280  ; i_avg
                  |L1.4134|
001026  4615              MOV      r5,r2                 ;2281
001028  f8d82060          LDR      r2,[r8,#0x60]         ;2281  ; i_avg
00102c  fb95f5f2          SDIV     r5,r5,r2              ;2281
001030  b22d              SXTH     r5,r5                 ;2282
001032  f8a05066          STRH     r5,[r0,#0x66]         ;2282
001036  4294              CMP      r4,r2                 ;2284
001038  dd0c              BLE      |L1.4180|
00103a  2d78              CMP      r5,#0x78              ;2284
00103c  dd0a              BLE      |L1.4180|
00103e  f898a010          LDRB     r10,[r8,#0x10]        ;2284  ; bAVG_DIR
001042  f1ba0f00          CMP      r10,#0                ;2284
001046  d105              BNE      |L1.4180|
001048  f8b0a056          LDRH     r10,[r0,#0x56]        ;2284
00104c  f1aa0a01          SUB      r10,r10,#1            ;2284
001050  f8a0a056          STRH     r10,[r0,#0x56]        ;2284
                  |L1.4180|
001054  4294              CMP      r4,r2                 ;2285
001056  da0a              BGE      |L1.4206|
001058  2d50              CMP      r5,#0x50              ;2285
00105a  da08              BGE      |L1.4206|
00105c  f8982010          LDRB     r2,[r8,#0x10]         ;2285  ; bAVG_DIR
001060  b12a              CBZ      r2,|L1.4206|
001062  f8b02056          LDRH     r2,[r0,#0x56]         ;2285
001066  f1020201          ADD      r2,r2,#1              ;2285
00106a  f8a02056          STRH     r2,[r0,#0x56]         ;2285
                  |L1.4206|
00106e  f9b02056          LDRSH    r2,[r0,#0x56]         ;2287
001072  454a              CMP      r2,r9                 ;2287
001074  da01              BGE      |L1.4218|
001076  f8a09056          STRH     r9,[r0,#0x56]         ;2287
                  |L1.4218|
00107a  f9b02056          LDRSH    r2,[r0,#0x56]         ;2288
00107e  2a32              CMP      r2,#0x32              ;2288
001080  ddc0              BLE      |L1.4100|
001082  f04f0232          MOV      r2,#0x32              ;2288
001086  f8a02056          STRH     r2,[r0,#0x56]         ;2288
00108a  e7bb              B        |L1.4100|
;;;2303   
                          ENDP

                  u_out_reg_hndl PROC
;;;2304   //-----------------------------------------------
;;;2305   void u_out_reg_hndl(void)
00108c  b510              PUSH     {r4,lr}
;;;2306   { 
;;;2307   char i;
;;;2308   
;;;2309   if(u_out_reg_main_cnt)
00108e  494d              LDR      r1,|L1.4548|
001090  f9b10024          LDRSH    r0,[r1,#0x24]  ; u_out_reg_main_cnt
001094  b118              CBZ      r0,|L1.4254|
;;;2310   	{
;;;2311   	u_out_reg_main_cnt--;
001096  f1a00001          SUB      r0,r0,#1
00109a  8488              STRH     r0,[r1,#0x24]
;;;2312   	return;
;;;2313   	}                 
;;;2314   u_out_reg_main_cnt=5;
;;;2315   
;;;2316   if(out_U<(UOUT-5))
;;;2317   	{
;;;2318   	//if(UOUT_<UOUT)UOUT_=UOUT;
;;;2319   	UOUT_++;
;;;2320   	if(UOUT_>(UOUT+50))UOUT_=UOUT+50;
;;;2321   	}
;;;2322   else if(out_U>(UOUT+5))
;;;2323   	{
;;;2324   	//if(UOUT_>UOUT)UOUT_=UOUT;
;;;2325   	UOUT_--;
;;;2326   	if(UOUT_<(UOUT-50))UOUT_=UOUT-50;
;;;2327   	}
;;;2328   UOUT_=UOUT;
;;;2329   }
00109c  bd10              POP      {r4,pc}
                  |L1.4254|
00109e  f04f0005          MOV      r0,#5                 ;2314
0010a2  8488              STRH     r0,[r1,#0x24]         ;2314
0010a4  484b              LDR      r0,|L1.4564|
0010a6  4b4d              LDR      r3,|L1.4572|
0010a8  f9b02000          LDRSH    r2,[r0,#0]            ;2316  ; out_U
0010ac  484a              LDR      r0,|L1.4568|
0010ae  f9b31000          LDRSH    r1,[r3,#0]            ;2319
0010b2  f9b00000          LDRSH    r0,[r0,#0]            ;2316  ; UOUT
0010b6  f1a00405          SUB      r4,r0,#5              ;2316
0010ba  42a2              CMP      r2,r4                 ;2316
0010bc  da09              BGE      |L1.4306|
0010be  f1010101          ADD      r1,r1,#1              ;2319
0010c2  b20a              SXTH     r2,r1                 ;2319
0010c4  801a              STRH     r2,[r3,#0]            ;2319
0010c6  f1000132          ADD      r1,r0,#0x32           ;2320
0010ca  428a              CMP      r2,r1                 ;2320
0010cc  dd0d              BLE      |L1.4330|
0010ce  8019              STRH     r1,[r3,#0]            ;2320
0010d0  e00b              B        |L1.4330|
                  |L1.4306|
0010d2  1d44              ADDS     r4,r0,#5              ;2322
0010d4  42a2              CMP      r2,r4                 ;2322
0010d6  dd08              BLE      |L1.4330|
0010d8  f1a10101          SUB      r1,r1,#1              ;2325
0010dc  b20a              SXTH     r2,r1                 ;2325
0010de  801a              STRH     r2,[r3,#0]            ;2325
0010e0  f1a00132          SUB      r1,r0,#0x32           ;2326
0010e4  428a              CMP      r2,r1                 ;2326
0010e6  da00              BGE      |L1.4330|
0010e8  8019              STRH     r1,[r3,#0]            ;2326
                  |L1.4330|
0010ea  8018              STRH     r0,[r3,#0]            ;2328
0010ec  bd10              POP      {r4,pc}
;;;2330   
                          ENDP

                  rele_av_hndl PROC
;;;2343   //-----------------------------------------------
;;;2344   void rele_av_hndl(void)
0010ee  b570              PUSH     {r4-r6,lr}
;;;2345   {
;;;2346   char i,i1,i2;
;;;2347   
;;;2348   i1=0;
0010f0  f04f0300          MOV      r3,#0
;;;2349   i2=0;
0010f4  461a              MOV      r2,r3
;;;2350   
;;;2351   for(i=0;i<NUMIST;i++)
0010f6  4610              MOV      r0,r2
0010f8  4934              LDR      r1,|L1.4556|
;;;2352   	{
;;;2353   	if(bps[i]._av&0x0f)i1=1;
0010fa  4c33              LDR      r4,|L1.4552|
0010fc  f9b15000          LDRSH    r5,[r1,#0]            ;2351
001100  e00f              B        |L1.4386|
                  |L1.4354|
001102  ebc01100          RSB      r1,r0,r0,LSL #4
001106  eb0401c1          ADD      r1,r4,r1,LSL #3
00110a  7849              LDRB     r1,[r1,#1]
00110c  070e              LSLS     r6,r1,#28
00110e  d001              BEQ      |L1.4372|
001110  f04f0301          MOV      r3,#1
                  |L1.4372|
;;;2354   	if(bps[i]._av&0x10)i2=1;
001114  06c9              LSLS     r1,r1,#27
001116  d501              BPL      |L1.4380|
001118  f04f0201          MOV      r2,#1
                  |L1.4380|
00111c  f1000001          ADD      r0,r0,#1              ;2351
001120  b2c0              UXTB     r0,r0                 ;2351
                  |L1.4386|
001122  42a8              CMP      r0,r5                 ;2351
001124  dbed              BLT      |L1.4354|
;;;2355   	}
;;;2356   
;;;2357   if(i1)					avar_vd_stat|=(1<<0);
001126  492e              LDR      r1,|L1.4576|
001128  f9b10000          LDRSH    r0,[r1,#0]
00112c  b11b              CBZ      r3,|L1.4406|
00112e  f0400001          ORR      r0,r0,#1
001132  8008              STRH     r0,[r1,#0]
001134  e002              B        |L1.4412|
                  |L1.4406|
;;;2358   else 					avar_vd_stat&=~(1<<0);
001136  f0200001          BIC      r0,r0,#1
00113a  8008              STRH     r0,[r1,#0]
                  |L1.4412|
;;;2359   if(overloadAvar==0) 	avar_vd_stat&=~(1<<1);
00113c  4829              LDR      r0,|L1.4580|
00113e  7800              LDRB     r0,[r0,#0]  ; overloadAvar
001140  b110              CBZ      r0,|L1.4424|
;;;2360   else if(overloadAvar==1)avar_vd_stat|=(1<<1);
001142  2801              CMP      r0,#1
001144  d005              BEQ      |L1.4434|
001146  e008              B        |L1.4442|
                  |L1.4424|
001148  8808              LDRH     r0,[r1,#0]            ;2359  ; avar_vd_stat
00114a  f0200002          BIC      r0,r0,#2              ;2359
00114e  8008              STRH     r0,[r1,#0]            ;2359
001150  e003              B        |L1.4442|
                  |L1.4434|
001152  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
001154  f0400002          ORR      r0,r0,#2
001158  8008              STRH     r0,[r1,#0]
                  |L1.4442|
;;;2361   
;;;2362   if(sysTAvar==0) 		avar_vd_stat&=~(1<<2);
00115a  4823              LDR      r0,|L1.4584|
00115c  7800              LDRB     r0,[r0,#0]  ; sysTAvar
00115e  b110              CBZ      r0,|L1.4454|
;;;2363   else if(sysTAvar==1)	avar_vd_stat|=(1<<2);
001160  2801              CMP      r0,#1
001162  d005              BEQ      |L1.4464|
001164  e008              B        |L1.4472|
                  |L1.4454|
001166  8808              LDRH     r0,[r1,#0]            ;2362  ; avar_vd_stat
001168  f0200004          BIC      r0,r0,#4              ;2362
00116c  8008              STRH     r0,[r1,#0]            ;2362
00116e  e003              B        |L1.4472|
                  |L1.4464|
001170  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
001172  f0400004          ORR      r0,r0,#4
001176  8008              STRH     r0,[r1,#0]
                  |L1.4472|
;;;2364   
;;;2365   if(uOutAvar==0) 		avar_vd_stat&=~((1<<3)|(1<<4));
001178  481c              LDR      r0,|L1.4588|
00117a  7800              LDRB     r0,[r0,#0]  ; uOutAvar
00117c  b120              CBZ      r0,|L1.4488|
;;;2366   else if(uOutAvar==1)	avar_vd_stat|=(1<<4);
00117e  2801              CMP      r0,#1
001180  d007              BEQ      |L1.4498|
;;;2367   else if(uOutAvar==2)	avar_vd_stat|=(1<<3);
001182  2802              CMP      r0,#2
001184  d00a              BEQ      |L1.4508|
001186  e00d              B        |L1.4516|
                  |L1.4488|
001188  8808              LDRH     r0,[r1,#0]            ;2365  ; avar_vd_stat
00118a  f0200018          BIC      r0,r0,#0x18           ;2365
00118e  8008              STRH     r0,[r1,#0]            ;2365
001190  e008              B        |L1.4516|
                  |L1.4498|
001192  8808              LDRH     r0,[r1,#0]            ;2366  ; avar_vd_stat
001194  f0400010          ORR      r0,r0,#0x10           ;2366
001198  8008              STRH     r0,[r1,#0]            ;2366
00119a  e003              B        |L1.4516|
                  |L1.4508|
00119c  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
00119e  f0400008          ORR      r0,r0,#8
0011a2  8008              STRH     r0,[r1,#0]
                  |L1.4516|
;;;2368   if(uInAvar==0) 			avar_vd_stat&=~((1<<5)|(1<<6));
0011a4  4812              LDR      r0,|L1.4592|
0011a6  7800              LDRB     r0,[r0,#0]  ; uInAvar
0011a8  b320              CBZ      r0,|L1.4596|
;;;2369   else if(uInAvar==1)		avar_vd_stat|=(1<<6);
0011aa  2801              CMP      r0,#1
0011ac  d027              BEQ      |L1.4606|
;;;2370   else if(uInAvar==2)		avar_vd_stat|=(1<<5);
0011ae  2802              CMP      r0,#2
0011b0  d02a              BEQ      |L1.4616|
0011b2  e02d              B        |L1.4624|
                  |L1.4532|
                          DCD      ||.bss||
                  |L1.4536|
                          DCD      ||.bss||+0x400
                  |L1.4540|
                          DCD      0x40034000
                  |L1.4544|
                          DCD      0x2009c000
                  |L1.4548|
                          DCD      ||area_number.26||
                  |L1.4552|
                          DCD      bps
                  |L1.4556|
                          DCD      NUMIST
                  |L1.4560|
                          DCD      vd_U
                  |L1.4564|
                          DCD      out_U
                  |L1.4568|
                          DCD      UOUT
                  |L1.4572|
                          DCD      UOUT_
                  |L1.4576|
                          DCD      avar_vd_stat
                  |L1.4580|
                          DCD      overloadAvar
                  |L1.4584|
                          DCD      sysTAvar
                  |L1.4588|
                          DCD      uOutAvar
                  |L1.4592|
                          DCD      uInAvar
                  |L1.4596|
0011f4  8808              LDRH     r0,[r1,#0]            ;2368  ; avar_vd_stat
0011f6  f0200060          BIC      r0,r0,#0x60           ;2368
0011fa  8008              STRH     r0,[r1,#0]            ;2368
0011fc  e008              B        |L1.4624|
                  |L1.4606|
0011fe  8808              LDRH     r0,[r1,#0]            ;2369  ; avar_vd_stat
001200  f0400040          ORR      r0,r0,#0x40           ;2369
001204  8008              STRH     r0,[r1,#0]            ;2369
001206  e003              B        |L1.4624|
                  |L1.4616|
001208  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
00120a  f0400020          ORR      r0,r0,#0x20
00120e  8008              STRH     r0,[r1,#0]
                  |L1.4624|
;;;2371   
;;;2372   if(i2)					avar_vd_stat|=(1<<7);
001210  b122              CBZ      r2,|L1.4636|
001212  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
001214  f0400080          ORR      r0,r0,#0x80
001218  8008              STRH     r0,[r1,#0]
00121a  e003              B        |L1.4644|
                  |L1.4636|
;;;2373   else 					avar_vd_stat&=~(1<<7);
00121c  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
00121e  f0200080          BIC      r0,r0,#0x80
001222  8008              STRH     r0,[r1,#0]
                  |L1.4644|
;;;2374   
;;;2375   if(bVDISWORK)			avar_vd_stat|=(1<<8);
001224  48ff              LDR      r0,|L1.5668|
001226  7800              LDRB     r0,[r0,#0]  ; bVDISWORK
001228  b120              CBZ      r0,|L1.4660|
00122a  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
00122c  f4407080          ORR      r0,r0,#0x100
001230  8008              STRH     r0,[r1,#0]
001232  e003              B        |L1.4668|
                  |L1.4660|
;;;2376   else 					avar_vd_stat&=~(1<<8);
001234  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
001236  f4207080          BIC      r0,r0,#0x100
00123a  8008              STRH     r0,[r1,#0]
                  |L1.4668|
;;;2377   
;;;2378   for (i=0;i<4;i++)
00123c  f04f0000          MOV      r0,#0
001240  f9b15000          LDRSH    r5,[r1,#0]            ;2357
;;;2379   	{
;;;2380   	if(avar_vd_stat&RELE_SET_MASK[i])rele_av_flags|=(1<<i);
001244  4cf8              LDR      r4,|L1.5672|
001246  49f9              LDR      r1,|L1.5676|
001248  f04f0601          MOV      r6,#1                 ;2353
                  |L1.4684|
00124c  f9342010          LDRSH    r2,[r4,r0,LSL #1]
001250  422a              TST      r2,r5
001252  d006              BEQ      |L1.4706|
001254  880a              LDRH     r2,[r1,#0]  ; rele_av_flags
001256  fa06f300          LSL      r3,r6,r0
00125a  ea430302          ORR      r3,r3,r2
00125e  800b              STRH     r3,[r1,#0]
001260  e005              B        |L1.4718|
                  |L1.4706|
;;;2381   	else rele_av_flags&=~(1<<i);
001262  880a              LDRH     r2,[r1,#0]  ; rele_av_flags
001264  fa06f300          LSL      r3,r6,r0
001268  ea220203          BIC      r2,r2,r3
00126c  800a              STRH     r2,[r1,#0]
                  |L1.4718|
00126e  f1000001          ADD      r0,r0,#1              ;2378
001272  b2c0              UXTB     r0,r0                 ;2378
001274  2804              CMP      r0,#4                 ;2378
001276  d3e9              BCC      |L1.4684|
;;;2382   	} 
;;;2383   }
001278  bd70              POP      {r4-r6,pc}
;;;2384   
                          ENDP

                  rele_hndl PROC
;;;2385   //*************-----------------------------------------------
;;;2386   void rele_hndl(void)
00127a  b570              PUSH     {r4-r6,lr}
;;;2387   {
;;;2388   //static char cnt_rel_sam;
;;;2389   //char temp;
;;;2390   
;;;2391   //temp=0;
;;;2392   
;;;2393   
;;;2394   SET_REG(LPC_PINCON->PINSEL0,0,4*2,6*2);
00127c  48ec              LDR      r0,|L1.5680|
00127e  6801              LDR      r1,[r0,#0]
001280  4aec              LDR      r2,|L1.5684|
001282  ea010102          AND      r1,r1,r2
001286  6001              STR      r1,[r0,#0]
;;;2395   SET_REG(LPC_GPIO0->FIODIR,63,4,6);
001288  4ceb              LDR      r4,|L1.5688|
00128a  6821              LDR      r1,[r4,#0]
00128c  f441717c          ORR      r1,r1,#0x3f0
001290  6021              STR      r1,[r4,#0]
;;;2396   SET_REG(LPC_PINCON->PINSEL7,0,(25-16)*2,2);
001292  69c1              LDR      r1,[r0,#0x1c]
001294  f4212140          BIC      r1,r1,#0xc0000
001298  61c1              STR      r1,[r0,#0x1c]
;;;2397   SET_REG(LPC_GPIO3->FIODIR,1,25,1);
00129a  6e21              LDR      r1,[r4,#0x60]
00129c  f0417100          ORR      r1,r1,#0x2000000
0012a0  6621              STR      r1,[r4,#0x60]
;;;2398   SET_REG(LPC_PINCON->PINSEL1,0,(29-16)*2,2);
0012a2  6841              LDR      r1,[r0,#4]
0012a4  f0216140          BIC      r1,r1,#0xc000000
0012a8  6041              STR      r1,[r0,#4]
;;;2399   SET_REG(LPC_GPIO0->FIODIR,1,29,1);
0012aa  6820              LDR      r0,[r4,#0]
0012ac  f0405000          ORR      r0,r0,#0x20000000
0012b0  6020              STR      r0,[r4,#0]
;;;2400   
;;;2401   
;;;2402   
;;;2403   
;;;2404   
;;;2405   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_1))
0012b2  f04f00d2          MOV      r0,#0xd2
0012b6  f7fffffe          BL       mess_find_unvol
;;;2406   	{
;;;2407   	if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;2408   	else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;2409   	}
;;;2410   else if(!(rele_av_flags&(1<<0))) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
0012ba  4edc              LDR      r6,|L1.5676|
0012bc  4ddf              LDR      r5,|L1.5692|
0012be  b110              CBZ      r0,|L1.4806|
0012c0  6828              LDR      r0,[r5,#0]            ;2405  ; mess_data
0012c2  2865              CMP      r0,#0x65              ;2405
0012c4  d015              BEQ      |L1.4850|
                  |L1.4806|
0012c6  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
0012c8  07c0              LSLS     r0,r0,#31
0012ca  d01e              BEQ      |L1.4874|
;;;2411   else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
0012cc  6fa0              LDR      r0,[r4,#0x78]
0012ce  f0407000          ORR      r0,r0,#0x2000000
0012d2  67a0              STR      r0,[r4,#0x78]
                  |L1.4820|
;;;2412   
;;;2413   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_2))
0012d4  20d2              MOVS     r0,#0xd2
0012d6  f7fffffe          BL       mess_find_unvol
0012da  b110              CBZ      r0,|L1.4834|
0012dc  6828              LDR      r0,[r5,#0]  ; mess_data
0012de  2866              CMP      r0,#0x66
0012e0  d018              BEQ      |L1.4884|
                  |L1.4834|
;;;2414   	{
;;;2415   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;2416   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;2417   	}
;;;2418   else if(!(rele_av_flags&(1<<1))) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
0012e2  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
0012e4  0780              LSLS     r0,r0,#30
0012e6  d424              BMI      |L1.4914|
0012e8  69e0              LDR      r0,[r4,#0x1c]
0012ea  f0400080          ORR      r0,r0,#0x80
0012ee  61e0              STR      r0,[r4,#0x1c]
0012f0  e023              B        |L1.4922|
                  |L1.4850|
0012f2  6868              LDR      r0,[r5,#4]            ;2407  ; mess_data
0012f4  b120              CBZ      r0,|L1.4864|
0012f6  6fa0              LDR      r0,[r4,#0x78]         ;2408
0012f8  f0407000          ORR      r0,r0,#0x2000000      ;2408
0012fc  67a0              STR      r0,[r4,#0x78]         ;2408
0012fe  e7e9              B        |L1.4820|
                  |L1.4864|
001300  6fe0              LDR      r0,[r4,#0x7c]         ;2407
001302  f0407000          ORR      r0,r0,#0x2000000      ;2407
001306  67e0              STR      r0,[r4,#0x7c]         ;2407
001308  e7e4              B        |L1.4820|
                  |L1.4874|
00130a  6fe0              LDR      r0,[r4,#0x7c]         ;2410
00130c  f0407000          ORR      r0,r0,#0x2000000      ;2410
001310  67e0              STR      r0,[r4,#0x7c]         ;2410
001312  e7df              B        |L1.4820|
                  |L1.4884|
001314  6868              LDR      r0,[r5,#4]            ;2415  ; mess_data
001316  b110              CBZ      r0,|L1.4894|
001318  2801              CMP      r0,#1                 ;2416
00131a  d005              BEQ      |L1.4904|
00131c  e00d              B        |L1.4922|
                  |L1.4894|
00131e  69e0              LDR      r0,[r4,#0x1c]         ;2415
001320  f0400080          ORR      r0,r0,#0x80           ;2415
001324  61e0              STR      r0,[r4,#0x1c]         ;2415
001326  e008              B        |L1.4922|
                  |L1.4904|
001328  69a0              LDR      r0,[r4,#0x18]         ;2416
00132a  f0400080          ORR      r0,r0,#0x80           ;2416
00132e  61a0              STR      r0,[r4,#0x18]         ;2416
001330  e003              B        |L1.4922|
                  |L1.4914|
;;;2419   else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
001332  69a0              LDR      r0,[r4,#0x18]
001334  f0400080          ORR      r0,r0,#0x80
001338  61a0              STR      r0,[r4,#0x18]
                  |L1.4922|
;;;2420   
;;;2421   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_3))
00133a  20d2              MOVS     r0,#0xd2
00133c  f7fffffe          BL       mess_find_unvol
001340  b110              CBZ      r0,|L1.4936|
001342  6828              LDR      r0,[r5,#0]  ; mess_data
001344  2867              CMP      r0,#0x67
001346  d007              BEQ      |L1.4952|
                  |L1.4936|
;;;2422   	{
;;;2423   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;2424   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;2425       }
;;;2426   else if(!(rele_av_flags&(1<<2))) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
001348  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
00134a  0740              LSLS     r0,r0,#29
00134c  d413              BMI      |L1.4982|
00134e  69e0              LDR      r0,[r4,#0x1c]
001350  f0400010          ORR      r0,r0,#0x10
001354  61e0              STR      r0,[r4,#0x1c]
001356  e012              B        |L1.4990|
                  |L1.4952|
001358  6868              LDR      r0,[r5,#4]            ;2423  ; mess_data
00135a  b110              CBZ      r0,|L1.4962|
00135c  2801              CMP      r0,#1                 ;2424
00135e  d005              BEQ      |L1.4972|
001360  e00d              B        |L1.4990|
                  |L1.4962|
001362  69e0              LDR      r0,[r4,#0x1c]         ;2423
001364  f0400010          ORR      r0,r0,#0x10           ;2423
001368  61e0              STR      r0,[r4,#0x1c]         ;2423
00136a  e008              B        |L1.4990|
                  |L1.4972|
00136c  69a0              LDR      r0,[r4,#0x18]         ;2424
00136e  f0400010          ORR      r0,r0,#0x10           ;2424
001372  61a0              STR      r0,[r4,#0x18]         ;2424
001374  e003              B        |L1.4990|
                  |L1.4982|
;;;2427   else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
001376  69a0              LDR      r0,[r4,#0x18]
001378  f0400010          ORR      r0,r0,#0x10
00137c  61a0              STR      r0,[r4,#0x18]
                  |L1.4990|
;;;2428   
;;;2429   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_4))	 
00137e  20d2              MOVS     r0,#0xd2
001380  f7fffffe          BL       mess_find_unvol
001384  b110              CBZ      r0,|L1.5004|
001386  6828              LDR      r0,[r5,#0]  ; mess_data
001388  2868              CMP      r0,#0x68
00138a  d007              BEQ      |L1.5020|
                  |L1.5004|
;;;2430   	{
;;;2431   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
;;;2432   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,9,1);
;;;2433   	}
;;;2434   else if(!(rele_av_flags&(1<<3))) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
00138c  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
00138e  0700              LSLS     r0,r0,#28
001390  d413              BMI      |L1.5050|
001392  69e0              LDR      r0,[r4,#0x1c]
001394  f4407000          ORR      r0,r0,#0x200
001398  61e0              STR      r0,[r4,#0x1c]
00139a  e012              B        |L1.5058|
                  |L1.5020|
00139c  6868              LDR      r0,[r5,#4]            ;2431  ; mess_data
00139e  b110              CBZ      r0,|L1.5030|
0013a0  2801              CMP      r0,#1                 ;2432
0013a2  d005              BEQ      |L1.5040|
0013a4  e00d              B        |L1.5058|
                  |L1.5030|
0013a6  69e0              LDR      r0,[r4,#0x1c]         ;2431
0013a8  f4407000          ORR      r0,r0,#0x200          ;2431
0013ac  61e0              STR      r0,[r4,#0x1c]         ;2431
0013ae  e008              B        |L1.5058|
                  |L1.5040|
0013b0  69a0              LDR      r0,[r4,#0x18]         ;2432
0013b2  f4407000          ORR      r0,r0,#0x200          ;2432
0013b6  61a0              STR      r0,[r4,#0x18]         ;2432
0013b8  e003              B        |L1.5058|
                  |L1.5050|
;;;2435   else SET_REG(LPC_GPIO0->FIOSET,1,9,1);
0013ba  69a0              LDR      r0,[r4,#0x18]
0013bc  f4407000          ORR      r0,r0,#0x200
0013c0  61a0              STR      r0,[r4,#0x18]
                  |L1.5058|
;;;2436   
;;;2437   rele_on_cnt=0;
0013c2  499f              LDR      r1,|L1.5696|
0013c4  f04f0000          MOV      r0,#0
0013c8  8688              STRH     r0,[r1,#0x34]
;;;2438   if(GET_REG( LPC_GPIO3->FIOPIN, 25, 1))	rele_on_cnt++;
0013ca  6f62              LDR      r2,[r4,#0x74]
0013cc  0192              LSLS     r2,r2,#6
0013ce  d502              BPL      |L1.5078|
0013d0  f1000001          ADD      r0,r0,#1
0013d4  8688              STRH     r0,[r1,#0x34]
                  |L1.5078|
;;;2439   if(GET_REG( LPC_GPIO0->FIOPIN, 7, 1))  rele_on_cnt++;
0013d6  6960              LDR      r0,[r4,#0x14]
0013d8  0600              LSLS     r0,r0,#24
0013da  d503              BPL      |L1.5092|
0013dc  8e88              LDRH     r0,[r1,#0x34]  ; rele_on_cnt
0013de  f1000001          ADD      r0,r0,#1
0013e2  8688              STRH     r0,[r1,#0x34]
                  |L1.5092|
;;;2440   if(GET_REG( LPC_GPIO0->FIOPIN, 4, 1))  rele_on_cnt++;
0013e4  6960              LDR      r0,[r4,#0x14]
0013e6  06c0              LSLS     r0,r0,#27
0013e8  d503              BPL      |L1.5106|
0013ea  8e88              LDRH     r0,[r1,#0x34]  ; rele_on_cnt
0013ec  f1000001          ADD      r0,r0,#1
0013f0  8688              STRH     r0,[r1,#0x34]
                  |L1.5106|
;;;2441   
;;;2442   }
0013f2  bd70              POP      {r4-r6,pc}
;;;2443   
                          ENDP

                  bps_hndl PROC
;;;2444   //-----------------------------------------------
;;;2445   void bps_hndl(void)
0013f4  e92d5ff0          PUSH     {r4-r12,lr}
;;;2446   {
;;;2447   char ptr__,i;
;;;2448   unsigned short tempUS;
;;;2449   
;;;2450   if(sh_cnt0<10)
0013f8  4e91              LDR      r6,|L1.5696|
;;;2451   	{
;;;2452   	sh_cnt0++;
;;;2453   	if(sh_cnt0>=10)
;;;2454   		{
;;;2455   		sh_cnt0=0;
0013fa  2700              MOVS     r7,#0
;;;2456   		b1Hz_sh=1;
0013fc  f04f0a01          MOV      r10,#1
001400  7d30              LDRB     r0,[r6,#0x14]         ;2450  ; sh_cnt0
001402  280a              CMP      r0,#0xa               ;2450
001404  d208              BCS      |L1.5144|
001406  f1000001          ADD      r0,r0,#1              ;2452
00140a  b2c0              UXTB     r0,r0                 ;2452
00140c  7530              STRB     r0,[r6,#0x14]         ;2452
00140e  280a              CMP      r0,#0xa               ;2453
001410  d302              BCC      |L1.5144|
001412  7537              STRB     r7,[r6,#0x14]         ;2455
001414  f886a015          STRB     r10,[r6,#0x15]
                  |L1.5144|
;;;2457   		}
;;;2458   	}
;;;2459   
;;;2460   /*if(sh_cnt1<5)
;;;2461   	{
;;;2462   	sh_cnt1++;
;;;2463   	if(sh_cnt1==5)
;;;2464   		{
;;;2465   		sh_cnt1=0;
;;;2466   		b2Hz_sh=1;
;;;2467   		}
;;;2468   	} */
;;;2469   
;;;2470   
;;;2471   /*
;;;2472   if(mess_find(MESS_SRC_ON_OFF))
;;;2473   	{
;;;2474   	if(mess_data[0]==_MESS_SRC_MASK_BLOK_2SEC)
;;;2475   		{
;;;2476   		char i;
;;;2477   		for(i=0;i<NUMIST;i++)
;;;2478   			{
;;;2479   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=20;
;;;2480   			}
;;;2481   		
;;;2482   		}
;;;2483   	else if(mess_data[0]==_MESS_SRC_MASK_UNBLOK)
;;;2484   		{
;;;2485   		char i;
;;;2486   		for(i=0;i<NUMIST;i++)
;;;2487   			{
;;;2488   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=0;
;;;2489   			}
;;;2490   		
;;;2491   		}
;;;2492   	}
;;;2493   	
;;;2494   else if(mess_find(_MESS_SRC_MASK_ON))
;;;2495   	{				
;;;2496   	if(mess_data[0]==_MESS_SRC_MASK_ON)
;;;2497   		{
;;;2498   		char i;
;;;2499   		for(i=0;i<NUMIST;i++)
;;;2500   			{
;;;2501   			if(mess_data[1]&(1<<i))
;;;2502   				{
;;;2503   				src[i]._ist_blok_cnt=0;
;;;2504   				src[i]._flags_tu=2;
;;;2505   				}
;;;2506   			}
;;;2507   		
;;;2508   		}				
;;;2509   	}*/
;;;2510   
;;;2511   
;;;2512   
;;;2513   /*else*/ 
;;;2514   bps_on_mask=0;
001418  66b7              STR      r7,[r6,#0x68]  ; bps_on_mask
;;;2515   bps_off_mask=0;
00141a  66f7              STR      r7,[r6,#0x6c]  ; bps_off_mask
;;;2516   
;;;2517   if(mess_find_unvol(MESS2BPS_HNDL))
00141c  20cd              MOVS     r0,#0xcd
00141e  f7fffffe          BL       mess_find_unvol
;;;2518   	{
;;;2519   	if(mess_data[0]==PARAM_BPS_ALL_OFF_AFTER_2SEC)
;;;2520   		{
;;;2521   		bps_off_mask=0xffff;
;;;2522   		}
;;;2523   
;;;2524   	if(mess_data[0]==PARAM_BPS_MASK_OFF_AFTER_2SEC)
;;;2525   		{
;;;2526   		bps_off_mask=mess_data[1];
;;;2527   		}
;;;2528   
;;;2529   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;2530   		{
;;;2531   		bps_on_mask=mess_data[1];
;;;2532   		}
;;;2533   
;;;2534   	if(mess_data[0]==PARAM_BPS_ALL_ON)
;;;2535   		{
;;;2536   		bps_on_mask=0xffffffff;
;;;2537   		}
;;;2538   
;;;2539   	if(mess_data[0]==PARAM_BPS_MASK_ON_OFF_AFTER_2SEC)
;;;2540   		{
;;;2541   		bps_on_mask=mess_data[1];
;;;2542   		bps_off_mask=~(mess_data[1]);
;;;2543   		}
;;;2544   
;;;2545   
;;;2546   	for(i=0;i<=NUMIST;i++)
;;;2547   		{
;;;2548   		if(bps_off_mask&(1<<i)) bps[i]._blok_cnt++;
001422  f8df8220          LDR      r8,|L1.5700|
001426  f8dfb220          LDR      r11,|L1.5704|
00142a  b3f0              CBZ      r0,|L1.5290|
00142c  4983              LDR      r1,|L1.5692|
00142e  6808              LDR      r0,[r1,#0]            ;2519  ; mess_data
001430  28ce              CMP      r0,#0xce              ;2519
001432  d102              BNE      |L1.5178|
001434  f64f72ff          MOV      r2,#0xffff            ;2521
001438  66f2              STR      r2,[r6,#0x6c]         ;2521  ; bps_off_mask
                  |L1.5178|
00143a  28cf              CMP      r0,#0xcf              ;2524
00143c  d101              BNE      |L1.5186|
00143e  684a              LDR      r2,[r1,#4]            ;2526  ; mess_data
001440  66f2              STR      r2,[r6,#0x6c]         ;2526  ; bps_off_mask
                  |L1.5186|
001442  28d1              CMP      r0,#0xd1              ;2529
001444  d101              BNE      |L1.5194|
001446  684a              LDR      r2,[r1,#4]            ;2531  ; mess_data
001448  66b2              STR      r2,[r6,#0x68]         ;2531  ; bps_on_mask
                  |L1.5194|
00144a  28d2              CMP      r0,#0xd2              ;2534
00144c  d102              BNE      |L1.5204|
00144e  f04f32ff          MOV      r2,#0xffffffff        ;2536
001452  66b2              STR      r2,[r6,#0x68]         ;2536  ; bps_on_mask
                  |L1.5204|
001454  28d0              CMP      r0,#0xd0              ;2539
001456  d104              BNE      |L1.5218|
001458  6848              LDR      r0,[r1,#4]            ;2541  ; mess_data
00145a  66b0              STR      r0,[r6,#0x68]         ;2541  ; bps_on_mask
00145c  ea6f0000          MVN      r0,r0                 ;2542
001460  66f0              STR      r0,[r6,#0x6c]         ;2542  ; bps_off_mask
                  |L1.5218|
001462  f04f0400          MOV      r4,#0                 ;2546
001466  e030              B        |L1.5322|
                  |L1.5224|
001468  6ef0              LDR      r0,[r6,#0x6c]  ; bps_off_mask
00146a  fa0af904          LSL      r9,r10,r4
00146e  ea190f00          TST      r9,r0
001472  d009              BEQ      |L1.5256|
001474  ebc41004          RSB      r0,r4,r4,LSL #4
001478  eb0800c0          ADD      r0,r8,r0,LSL #3
00147c  f8301f44          LDRH     r1,[r0,#0x44]!
001480  f1010101          ADD      r1,r1,#1
001484  8001              STRH     r1,[r0,#0]
001486  e005              B        |L1.5268|
                  |L1.5256|
;;;2549   		else bps[i]._blok_cnt=0;
001488  ebc41004          RSB      r0,r4,r4,LSL #4
00148c  eb0800c0          ADD      r0,r8,r0,LSL #3
001490  f8a07044          STRH     r7,[r0,#0x44]
                  |L1.5268|
;;;2550   		gran(&bps[i]._blok_cnt,0,50);
001494  ebc41004          RSB      r0,r4,r4,LSL #4
001498  eb0805c0          ADD      r5,r8,r0,LSL #3
00149c  f1050044          ADD      r0,r5,#0x44
0014a0  2232              MOVS     r2,#0x32
0014a2  2100              MOVS     r1,#0
0014a4  f7fffffe          BL       gran
;;;2551   		if(bps[i]._blok_cnt>20) bps[i]._flags_tu=1;
0014a8  e000              B        |L1.5292|
                  |L1.5290|
0014aa  e013              B        |L1.5332|
                  |L1.5292|
0014ac  f9b50044          LDRSH    r0,[r5,#0x44]
0014b0  2814              CMP      r0,#0x14
0014b2  dd01              BLE      |L1.5304|
0014b4  f885a02c          STRB     r10,[r5,#0x2c]
                  |L1.5304|
;;;2552   		if(bps_on_mask&(1<<i)) bps[i]._flags_tu=0;
0014b8  6eb0              LDR      r0,[r6,#0x68]  ; bps_on_mask
0014ba  ea190f00          TST      r9,r0
0014be  d001              BEQ      |L1.5316|
0014c0  f885702c          STRB     r7,[r5,#0x2c]
                  |L1.5316|
0014c4  f1040401          ADD      r4,r4,#1              ;2546
0014c8  b2e4              UXTB     r4,r4                 ;2546
                  |L1.5322|
0014ca  f9bb0000          LDRSH    r0,[r11,#0]           ;2546  ; NUMIST
0014ce  4284              CMP      r4,r0                 ;2546
0014d0  ddca              BLE      |L1.5224|
0014d2  e072              B        |L1.5562|
                  |L1.5332|
;;;2553   	     }
;;;2554   
;;;2555   	
;;;2556   /*
;;;2557   
;;;2558   	if(bps_all_off_cnt>20)
;;;2559   		{
;;;2560   		for(i=0;i<=NUMIST;i++)
;;;2561   			{
;;;2562   	     	bps[i]._flags_tu=1;
;;;2563   	     	}
;;;2564   		}
;;;2565   	else if(bps_mask_off_cnt>20)
;;;2566   		{
;;;2567   		for(i=0;i<=NUMIST;i++)
;;;2568   			{
;;;2569   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;2570   	     	}
;;;2571   		}	
;;;2572   		
;;;2573   	else if(bps_mask_on_off_cnt>20)
;;;2574   		{
;;;2575   		for(i=0;i<=NUMIST;i++)
;;;2576   			{
;;;2577   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;2578   			else bps[i]._flags_tu=0;
;;;2579   	     	}
;;;2580   		}
;;;2581   		
;;;2582   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;2583   		{
;;;2584   		for(i=0;i<=NUMIST;i++)
;;;2585   			{
;;;2586   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=0;
;;;2587   	     	}
;;;2588   		}
;;;2589   */										
;;;2590   	}
;;;2591   
;;;2592   
;;;2593   else if(b1Hz_sh)
0014d4  7d70              LDRB     r0,[r6,#0x15]  ; b1Hz_sh
0014d6  b3e8              CBZ      r0,|L1.5460|
;;;2594   	{
;;;2595   	ptr__=0;
0014d8  f04f0400          MOV      r4,#0
;;;2596        for(i=0;i<=NUMIST;i++)
0014dc  4621              MOV      r1,r4
0014de  f9bb0000          LDRSH    r0,[r11,#0]           ;2546
0014e2  e008              B        |L1.5366|
                  |L1.5348|
;;;2597   		{
;;;2598   	    bps[i]._flags_tu=1;
0014e4  ebc11201          RSB      r2,r1,r1,LSL #4
0014e8  eb0802c2          ADD      r2,r8,r2,LSL #3
0014ec  f882a02c          STRB     r10,[r2,#0x2c]
0014f0  f1010101          ADD      r1,r1,#1              ;2596
0014f4  b2c9              UXTB     r1,r1                 ;2596
                  |L1.5366|
0014f6  4281              CMP      r1,r0                 ;2596
0014f8  ddf4              BLE      |L1.5348|
;;;2599   	    }	
;;;2600     	     
;;;2601     	for(i=0;(i<NUMIST)&&(ptr__<num_necc);i++)
0014fa  f04f0100          MOV      r1,#0
0014fe  e020              B        |L1.5442|
                  |L1.5376|
;;;2602     		{
;;;2603   		char ii,iii;
;;;2604   
;;;2605   		ii=(char)NUMIST;
001500  b2c2              UXTB     r2,r0
;;;2606   		//if(ii<0)ii=0;
;;;2607   		if(ii>32)ii=32;
001502  2a20              CMP      r2,#0x20
001504  d901              BLS      |L1.5386|
001506  f04f0220          MOV      r2,#0x20
                  |L1.5386|
;;;2608   		iii=numOfForvardBps;
00150a  7eb3              LDRB     r3,[r6,#0x1a]  ; numOfForvardBps
;;;2609   		//if(iii<0)iii=0;
;;;2610   		if(iii>=NUMIST)iii=0;
00150c  4283              CMP      r3,r0
00150e  db01              BLT      |L1.5396|
001510  f04f0300          MOV      r3,#0
                  |L1.5396|
;;;2611   		iii+=i;
001514  440b              ADD      r3,r3,r1
001516  b2db              UXTB     r3,r3
;;;2612   		iii=iii%ii;
001518  fbb3f5f2          UDIV     r5,r3,r2
00151c  fb023215          MLS      r2,r2,r5,r3
;;;2613   		
;;;2614     	     if((bps[iii]._state==bsRDY)||(bps[iii]._state==bsWRK))
001520  ebc21202          RSB      r2,r2,r2,LSL #4
001524  eb0803c2          ADD      r3,r8,r2,LSL #3
001528  789a              LDRB     r2,[r3,#2]
00152a  2a03              CMP      r2,#3
00152c  d001              BEQ      |L1.5426|
00152e  2a02              CMP      r2,#2
001530  d104              BNE      |L1.5436|
                  |L1.5426|
;;;2615     	         	{
;;;2616     	         	bps[iii]._flags_tu=0;
001532  f883702c          STRB     r7,[r3,#0x2c]
;;;2617     	         	ptr__++;
001536  f1040401          ADD      r4,r4,#1
00153a  b2e4              UXTB     r4,r4
                  |L1.5436|
00153c  f1010101          ADD      r1,r1,#1              ;2601
001540  b2c9              UXTB     r1,r1                 ;2601
                  |L1.5442|
001542  4281              CMP      r1,r0                 ;2601
001544  da04              BGE      |L1.5456|
001546  4a41              LDR      r2,|L1.5708|
001548  f9b22000          LDRSH    r2,[r2,#0]            ;2601  ; num_necc
00154c  4294              CMP      r4,r2                 ;2601
00154e  dbd7              BLT      |L1.5376|
                  |L1.5456|
;;;2618     	         	}
;;;2619   			
;;;2620     	     }
;;;2621   	bps[numOfForvardBps_old]._flags_tu=0;
001550  7ef1              LDRB     r1,[r6,#0x1b]  ; numOfForvardBps_old
001552  e000              B        |L1.5462|
                  |L1.5460|
001554  e031              B        |L1.5562|
                  |L1.5462|
001556  ebc11101          RSB      r1,r1,r1,LSL #4
00155a  eb0801c1          ADD      r1,r8,r1,LSL #3
00155e  f881702c          STRB     r7,[r1,#0x2c]
;;;2622   
;;;2623   	if(main_1Hz_cnt<60)
001562  493b              LDR      r1,|L1.5712|
001564  f9b11000          LDRSH    r1,[r1,#0]  ; main_1Hz_cnt
001568  293c              CMP      r1,#0x3c
00156a  da0d              BGE      |L1.5512|
;;;2624   		{
;;;2625        	for(i=0;i<=NUMIST;i++)
00156c  f04f0100          MOV      r1,#0
001570  e008              B        |L1.5508|
                  |L1.5490|
;;;2626   			{
;;;2627   	     	bps[i]._flags_tu=0;
001572  ebc11201          RSB      r2,r1,r1,LSL #4
001576  eb0802c2          ADD      r2,r8,r2,LSL #3
00157a  f882702c          STRB     r7,[r2,#0x2c]
00157e  f1010101          ADD      r1,r1,#1              ;2625
001582  b2c9              UXTB     r1,r1                 ;2625
                  |L1.5508|
001584  4281              CMP      r1,r0                 ;2625
001586  ddf4              BLE      |L1.5490|
                  |L1.5512|
;;;2628   	     	}	
;;;2629   		}
;;;2630   	if(ipsBlckStat)
001588  4932              LDR      r1,|L1.5716|
00158a  8809              LDRH     r1,[r1,#0]  ; ipsBlckStat
00158c  b169              CBZ      r1,|L1.5546|
;;;2631   		{
;;;2632        	for(i=0;i<=NUMIST;i++)
00158e  f04f0100          MOV      r1,#0
001592  e008              B        |L1.5542|
                  |L1.5524|
;;;2633   			{
;;;2634   	     	bps[i]._flags_tu=1;
001594  ebc11201          RSB      r2,r1,r1,LSL #4
001598  eb0802c2          ADD      r2,r8,r2,LSL #3
00159c  f882a02c          STRB     r10,[r2,#0x2c]
0015a0  f1010101          ADD      r1,r1,#1              ;2632
0015a4  b2c9              UXTB     r1,r1                 ;2632
                  |L1.5542|
0015a6  4281              CMP      r1,r0                 ;2632
0015a8  ddf4              BLE      |L1.5524|
                  |L1.5546|
;;;2635   	     	}
;;;2636   		}
;;;2637   
;;;2638        for(i=0;i<=NUMIST;i++)
0015aa  f04f0100          MOV      r1,#0
0015ae  e002              B        |L1.5558|
                  |L1.5552|
0015b0  f1010101          ADD      r1,r1,#1
0015b4  b2c9              UXTB     r1,r1
                  |L1.5558|
0015b6  4281              CMP      r1,r0
0015b8  ddfa              BLE      |L1.5552|
                  |L1.5562|
;;;2639   		{
;;;2640   	    //if(bps[i]._flags_tu==1) 	bps[i]._x_=-50;
;;;2641   	   	}	
;;;2642   		 
;;;2643     	}
;;;2644   
;;;2645   
;;;2646   for(i=0;i<NUMIST;i++)
0015ba  f04f0000          MOV      r0,#0
;;;2647        {
;;;2648        if(bps[i]._ist_blok_host_cnt!=0)
;;;2649           {
;;;2650           bps[i]._flags_tu=99;
0015be  f04f0463          MOV      r4,#0x63
0015c2  f9bb3000          LDRSH    r3,[r11,#0]           ;2546
0015c6  e00d              B        |L1.5604|
                  |L1.5576|
0015c8  ebc01100          RSB      r1,r0,r0,LSL #4       ;2648
0015cc  eb0801c1          ADD      r1,r8,r1,LSL #3       ;2648
0015d0  6c0a              LDR      r2,[r1,#0x40]         ;2648
0015d2  b122              CBZ      r2,|L1.5598|
0015d4  f881402c          STRB     r4,[r1,#0x2c]
;;;2651   		bps[i]._ist_blok_host_cnt--;
0015d8  f1a20201          SUB      r2,r2,#1
0015dc  640a              STR      r2,[r1,#0x40]
                  |L1.5598|
0015de  f1000001          ADD      r0,r0,#1              ;2646
0015e2  b2c0              UXTB     r0,r0                 ;2646
                  |L1.5604|
0015e4  4298              CMP      r0,r3                 ;2646
0015e6  dbef              BLT      |L1.5576|
;;;2652           }
;;;2653        }
;;;2654   
;;;2655   
;;;2656   
;;;2657   
;;;2658   b1Hz_sh=0;
0015e8  7577              STRB     r7,[r6,#0x15]
;;;2659   
;;;2660   
;;;2661   num_of_wrks_bps=0;
0015ea  7477              STRB     r7,[r6,#0x11]
;;;2662   tempUS=0;
0015ec  f04f0100          MOV      r1,#0
;;;2663   for(i=0;i<NUMIST;i++)
0015f0  4608              MOV      r0,r1
0015f2  e011              B        |L1.5656|
                  |L1.5620|
;;;2664   	{
;;;2665   	if(bps[i]._state==bsWRK)
0015f4  ebc01200          RSB      r2,r0,r0,LSL #4
0015f8  eb0802c2          ADD      r2,r8,r2,LSL #3
0015fc  7894              LDRB     r4,[r2,#2]
0015fe  2c02              CMP      r4,#2
001600  d107              BNE      |L1.5650|
;;;2666   		{
;;;2667   		num_of_wrks_bps++;
001602  7c74              LDRB     r4,[r6,#0x11]  ; num_of_wrks_bps
001604  f1040401          ADD      r4,r4,#1
001608  7474              STRB     r4,[r6,#0x11]
;;;2668   		if(bps[i]._Uii>tempUS)tempUS=bps[i]._Uii;
00160a  69d2              LDR      r2,[r2,#0x1c]
00160c  428a              CMP      r2,r1
00160e  dd00              BLE      |L1.5650|
001610  b291              UXTH     r1,r2
                  |L1.5650|
001612  f1000001          ADD      r0,r0,#1              ;2663
001616  b2c0              UXTB     r0,r0                 ;2663
                  |L1.5656|
001618  4298              CMP      r0,r3                 ;2663
00161a  dbeb              BLT      |L1.5620|
;;;2669   		}
;;;2670   	}
;;;2671   Ubpsmax=tempUS;
00161c  87f1              STRH     r1,[r6,#0x3e]
;;;2672   
;;;2673   //bPARALLEL_ENOUG=0;
;;;2674   //bPARALLEL_NOT_ENOUG=1;
;;;2675   /*
;;;2676   for(i=0;i<NUMIST;i++)
;;;2677   	{
;;;2678   	if(bps[i]._Ti>=TSIGN)
;;;2679   		{
;;;2680   		bPARALLEL_ENOUG=1;
;;;2681   		}
;;;2682   	if(bps[i]._Ti>=(TSIGN-5))
;;;2683   		{
;;;2684   		bPARALLEL_NOT_ENOUG=0;
;;;2685   		}
;;;2686   	}
;;;2687   
;;;2688   if(bPARALLEL_ENOUG==1)
;;;2689   	{
;;;2690   	bPARALLEL=1;
;;;2691   	}
;;;2692   else if(bPARALLEL && bPARALLEL_NOT_ENOUG)
;;;2693   	{
;;;2694   	bPARALLEL=0;
;;;2695   	}*/
;;;2696   }
00161e  e8bd9ff0          POP      {r4-r12,pc}
001622  0000              DCW      0x0000
                  |L1.5668|
                          DCD      bVDISWORK
                  |L1.5672|
                          DCD      RELE_SET_MASK
                  |L1.5676|
                          DCD      rele_av_flags
                  |L1.5680|
                          DCD      0x4002c000
                  |L1.5684|
                          DCD      0xfff000ff
                  |L1.5688|
                          DCD      0x2009c000
                  |L1.5692|
                          DCD      mess_data
                  |L1.5696|
                          DCD      ||area_number.26||
                  |L1.5700|
                          DCD      bps
                  |L1.5704|
                          DCD      NUMIST
                  |L1.5708|
                          DCD      num_necc
                  |L1.5712|
                          DCD      main_1Hz_cnt
                  |L1.5716|
                          DCD      ipsBlckStat
                          ENDP

                  powerAntiAliasingHndl PROC
;;;2704   //-----------------------------------------------
;;;2705   void powerAntiAliasingHndl(void)
001658  b570              PUSH     {r4-r6,lr}
;;;2706   {
;;;2707   if((power_summary_tempo/10UL)==(power_summary_tempo_old/10UL))
00165a  230a              MOVS     r3,#0xa
00165c  4cff              LDR      r4,|L1.6748|
00165e  48fe              LDR      r0,|L1.6744|
;;;2708   	{
;;;2709   	if(powerSummaryCnt<15)powerSummaryCnt++;
;;;2710   	if(powerSummaryCnt>=10)
;;;2711   		{
;;;2712   		power_summary=power_summary_tempo;
;;;2713   		}
;;;2714   	}
;;;2715   else powerSummaryCnt=0;
001660  2500              MOVS     r5,#0
001662  6822              LDR      r2,[r4,#0]            ;2707  ; power_summary_tempo_old
001664  6800              LDR      r0,[r0,#0]            ;2707  ; power_summary_tempo
001666  fbb2f6f3          UDIV     r6,r2,r3              ;2707
00166a  fbb0f1f3          UDIV     r1,r0,r3              ;2707
00166e  4afc              LDR      r2,|L1.6752|
001670  42b1              CMP      r1,r6                 ;2707
001672  d10b              BNE      |L1.5772|
001674  7811              LDRB     r1,[r2,#0]            ;2709  ; powerSummaryCnt
001676  290f              CMP      r1,#0xf               ;2709
001678  d202              BCS      |L1.5760|
00167a  f1010101          ADD      r1,r1,#1              ;2709
00167e  7011              STRB     r1,[r2,#0]            ;2709
                  |L1.5760|
001680  7811              LDRB     r1,[r2,#0]            ;2710  ; powerSummaryCnt
001682  290a              CMP      r1,#0xa               ;2710
001684  d303              BCC      |L1.5774|
001686  49f7              LDR      r1,|L1.6756|
001688  6008              STR      r0,[r1,#0]            ;2712  ; power_summary
00168a  e000              B        |L1.5774|
                  |L1.5772|
00168c  7015              STRB     r5,[r2,#0]
                  |L1.5774|
;;;2716   power_summary_tempo_old=power_summary_tempo;
00168e  6020              STR      r0,[r4,#0]  ; power_summary_tempo_old
;;;2717   
;;;2718   if((power_current_tempo/10UL)==(power_current_tempo_old/10UL))
001690  48f5              LDR      r0,|L1.6760|
001692  4cf6              LDR      r4,|L1.6764|
001694  f9b00000          LDRSH    r0,[r0,#0]  ; power_current_tempo
001698  f9b42000          LDRSH    r2,[r4,#0]  ; power_current_tempo_old
00169c  fbb0f1f3          UDIV     r1,r0,r3
0016a0  fbb2f3f3          UDIV     r3,r2,r3
;;;2719   	{
;;;2720   	if(powerCurrentCnt<15)powerCurrentCnt++;
0016a4  4af2              LDR      r2,|L1.6768|
0016a6  4299              CMP      r1,r3                 ;2718
0016a8  d10b              BNE      |L1.5826|
0016aa  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
0016ac  290f              CMP      r1,#0xf
0016ae  d202              BCS      |L1.5814|
0016b0  f1010101          ADD      r1,r1,#1
0016b4  7011              STRB     r1,[r2,#0]
                  |L1.5814|
;;;2721   	if(powerCurrentCnt>=10)
0016b6  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
0016b8  290a              CMP      r1,#0xa
0016ba  d303              BCC      |L1.5828|
;;;2722   		{
;;;2723   		power_current=power_current_tempo;
0016bc  49ed              LDR      r1,|L1.6772|
0016be  8008              STRH     r0,[r1,#0]
0016c0  e000              B        |L1.5828|
                  |L1.5826|
;;;2724   		}
;;;2725   	}
;;;2726   else powerCurrentCnt=0;
0016c2  7015              STRB     r5,[r2,#0]
                  |L1.5828|
;;;2727   power_current_tempo_old=power_current_tempo;
0016c4  8020              STRH     r0,[r4,#0]
;;;2728   }
0016c6  bd70              POP      {r4-r6,pc}
;;;2729   
                          ENDP

                  ips_current_average_hndl PROC
;;;2730   //-----------------------------------------------
;;;2731   void ips_current_average_hndl(void)
0016c8  e92d43f0          PUSH     {r4-r9,lr}
;;;2732   {
0016cc  b085              SUB      sp,sp,#0x14
;;;2733   if(++ica_timer_cnt>=10)
0016ce  4cea              LDR      r4,|L1.6776|
;;;2734   	{
;;;2735   	ica_timer_cnt=0;
;;;2736   	ica_plazma[0]++;
;;;2737   
;;;2738   	ica_my_current=bps_I;
;;;2739   
;;;2740   	if((ica_my_current>ica_your_current)&&((ica_my_current-ica_your_current)>=10)&&(ICA_EN==1))
0016d0  4eea              LDR      r6,|L1.6780|
0016d2  2500              MOVS     r5,#0                 ;2735
0016d4  7820              LDRB     r0,[r4,#0]            ;2733  ; ica_timer_cnt
0016d6  1c40              ADDS     r0,r0,#1              ;2733
0016d8  b2c0              UXTB     r0,r0                 ;2733
0016da  7020              STRB     r0,[r4,#0]            ;2733
0016dc  280a              CMP      r0,#0xa               ;2733
0016de  d340              BCC      |L1.5986|
0016e0  7025              STRB     r5,[r4,#0]            ;2735
0016e2  f8dfc39c          LDR      r12,|L1.6784|
0016e6  f89c0000          LDRB     r0,[r12,#0]           ;2736  ; ica_plazma
0016ea  f1000001          ADD      r0,r0,#1              ;2736
0016ee  f88c0000          STRB     r0,[r12,#0]           ;2736
0016f2  48e4              LDR      r0,|L1.6788|
0016f4  49e4              LDR      r1,|L1.6792|
0016f6  f9b00000          LDRSH    r0,[r0,#0]            ;2738  ; bps_I
0016fa  8008              STRH     r0,[r1,#0]            ;2738
0016fc  49e3              LDR      r1,|L1.6796|
;;;2741   		{
;;;2742   		ica_plazma[1]++;
;;;2743   		ica_u_necc--;
0016fe  f8df8390          LDR      r8,|L1.6800|
001702  4662              MOV      r2,r12                ;2736
001704  4637              MOV      r7,r6                 ;2740
001706  f9b11000          LDRSH    r1,[r1,#0]            ;2740  ; ica_your_current
00170a  7852              LDRB     r2,[r2,#1]            ;2742
00170c  f9b83000          LDRSH    r3,[r8,#0]
001710  f9b77000          LDRSH    r7,[r7,#0]            ;2740
001714  4288              CMP      r0,r1                 ;2740
001716  dd06              BLE      |L1.5926|
001718  eba00901          SUB      r9,r0,r1              ;2740
00171c  f1b90f0a          CMP      r9,#0xa               ;2740
001720  db01              BLT      |L1.5926|
001722  2f01              CMP      r7,#1                 ;2740
001724  d007              BEQ      |L1.5942|
                  |L1.5926|
;;;2744   		}
;;;2745   	else if((ica_my_current<ica_your_current)&&((ica_your_current-ica_my_current)>=10)&&(ICA_EN==1))
001726  4288              CMP      r0,r1
001728  da16              BGE      |L1.5976|
00172a  1a08              SUBS     r0,r1,r0
00172c  280a              CMP      r0,#0xa
00172e  db13              BLT      |L1.5976|
001730  2f01              CMP      r7,#1
001732  d009              BEQ      |L1.5960|
001734  e010              B        |L1.5976|
                  |L1.5942|
001736  f1020201          ADD      r2,r2,#1              ;2742
00173a  f88c2001          STRB     r2,[r12,#1]           ;2742
00173e  f1a30301          SUB      r3,r3,#1              ;2743
001742  f8a83000          STRH     r3,[r8,#0]            ;2743
001746  e007              B        |L1.5976|
                  |L1.5960|
;;;2746   		{
;;;2747   		ica_plazma[1]--;
001748  f1a20201          SUB      r2,r2,#1
00174c  f88c2001          STRB     r2,[r12,#1]
;;;2748   		ica_u_necc++;
001750  f1030301          ADD      r3,r3,#1
001754  f8a83000          STRH     r3,[r8,#0]
                  |L1.5976|
;;;2749   		}
;;;2750   	gran(&ica_u_necc,-20,20);
001758  2214              MOVS     r2,#0x14
00175a  4251              RSBS     r1,r2,#0
00175c  48cc              LDR      r0,|L1.6800|
00175e  f7fffffe          BL       gran
                  |L1.5986|
;;;2751   	}
;;;2752   
;;;2753   if((ica_timer_cnt==8)&&(ICA_EN==1))
001762  7820              LDRB     r0,[r4,#0]  ; ica_timer_cnt
;;;2754   	{
;;;2755   	char modbus_buff[20],i;
;;;2756   	short crc_temp;
;;;2757   
;;;2758   	modbus_buff[0] = ICA_MODBUS_ADDRESS;
001764  f8df832c          LDR      r8,|L1.6804|
;;;2759   	modbus_buff[1] = 4;
;;;2760   	modbus_buff[2] = 0;
;;;2761   	modbus_buff[3] = 2;
;;;2762   	modbus_buff[4] = 0;	
;;;2763   	modbus_buff[5] = 1;
;;;2764   
;;;2765   	crc_temp= CRC16_2(modbus_buff,6);
;;;2766   
;;;2767   	modbus_buff[6]= (char)crc_temp;
;;;2768   	modbus_buff[7]= (char)(crc_temp>>8);
;;;2769   
;;;2770   	if(ICA_CH==0)
001768  4fcb              LDR      r7,|L1.6808|
00176a  2808              CMP      r0,#8                 ;2753
00176c  d125              BNE      |L1.6074|
00176e  8830              LDRH     r0,[r6,#0]            ;2753  ; ICA_EN
001770  2801              CMP      r0,#1                 ;2753
001772  d122              BNE      |L1.6074|
001774  f8b80000          LDRH     r0,[r8,#0]            ;2758  ; ICA_MODBUS_ADDRESS
001778  f88d0000          STRB     r0,[sp,#0]            ;2758
00177c  f04f0004          MOV      r0,#4                 ;2759
001780  f88d0001          STRB     r0,[sp,#1]            ;2759
001784  f88d5002          STRB     r5,[sp,#2]            ;2760
001788  f04f0002          MOV      r0,#2                 ;2761
00178c  f88d0003          STRB     r0,[sp,#3]            ;2761
001790  f88d5004          STRB     r5,[sp,#4]            ;2762
001794  f04f0001          MOV      r0,#1                 ;2763
001798  f88d0005          STRB     r0,[sp,#5]            ;2763
00179c  f04f0106          MOV      r1,#6                 ;2765
0017a0  4668              MOV      r0,sp                 ;2765
0017a2  f7fffffe          BL       CRC16_2
0017a6  f88d0006          STRB     r0,[sp,#6]            ;2767
0017aa  ea4f2020          ASR      r0,r0,#8              ;2768
0017ae  f88d0007          STRB     r0,[sp,#7]            ;2768
0017b2  f9b70000          LDRSH    r0,[r7,#0]  ; ICA_CH
0017b6  b3e8              CBZ      r0,|L1.6196|
;;;2771   		{
;;;2772   		for (i=0;i<8;i++)
;;;2773   			{
;;;2774   			putchar_sc16is700(modbus_buff[i]);
;;;2775   			}
;;;2776   		}
;;;2777   	else if(ICA_CH==1)
0017b8  2801              CMP      r0,#1
                  |L1.6074|
;;;2778   		{
;;;2779   	/*	static U8 rem_IP[4];
;;;2780   		rem_IP[0]=ICA_MODBUS_TCP_IP1;
;;;2781   		rem_IP[1]=ICA_MODBUS_TCP_IP2;
;;;2782   		rem_IP[2]=ICA_MODBUS_TCP_IP3;
;;;2783   		rem_IP[3]=ICA_MODBUS_TCP_IP4;*/
;;;2784     		//tcp_soc_avg = tcp_get_socket (TCP_TYPE_CLIENT, 0, 30, tcp_callback);
;;;2785     		if (tcp_soc_avg != 0) 
;;;2786   			{
;;;2787       		
;;;2788   			//tcp_connect_stat=0;
;;;2789       		//tcp_connect (tcp_soc_avg, rem_IP, 502, 1000);
;;;2790   			/*while(!tcp_connect_stat)
;;;2791   				{
;;;2792   				}*/
;;;2793   			//delay_us(500);
;;;2794   			//tcp_close(tcp_soc_avg);
;;;2795   
;;;2796   			}
;;;2797   		}
;;;2798   	}
;;;2799   
;;;2800   if((ica_timer_cnt==3)&&(ICA_EN==1))
;;;2801   	{
;;;2802   	//if(tcp_connect_stat)
;;;2803   		{
;;;2804   		//tcp_close(tcp_soc_avg);
;;;2805   		//tcp_connect_stat=3;
;;;2806   		}
;;;2807   	}
;;;2808   
;;;2809   if((main_kb_cnt==(TBAT*60)-21)&&(ICA_EN==1))
0017ba  48b8              LDR      r0,|L1.6812|
0017bc  f06f0214          MVN      r2,#0x14
0017c0  f9b00000          LDRSH    r0,[r0,#0]  ; TBAT
0017c4  ebc01100          RSB      r1,r0,r0,LSL #4
0017c8  eb020181          ADD      r1,r2,r1,LSL #2
0017cc  4ab4              LDR      r2,|L1.6816|
0017ce  f9b22044          LDRSH    r2,[r2,#0x44]  ; main_kb_cnt
0017d2  4291              CMP      r1,r2
0017d4  d134              BNE      |L1.6208|
0017d6  8831              LDRH     r1,[r6,#0]  ; ICA_EN
0017d8  2901              CMP      r1,#1
0017da  d131              BNE      |L1.6208|
;;;2810   	{
;;;2811   	char modbus_buff[20],i;
;;;2812   	short crc_temp;
;;;2813   
;;;2814   	modbus_buff[0] = ICA_MODBUS_ADDRESS;
0017dc  f8b81000          LDRH     r1,[r8,#0]  ; ICA_MODBUS_ADDRESS
0017e0  f88d1000          STRB     r1,[sp,#0]
;;;2815   	modbus_buff[1] = 6;
0017e4  f04f0106          MOV      r1,#6
0017e8  f88d1001          STRB     r1,[sp,#1]
;;;2816   	modbus_buff[2] = 0;
0017ec  f88d5002          STRB     r5,[sp,#2]
;;;2817   	modbus_buff[3] = 30;
0017f0  f04f011e          MOV      r1,#0x1e
0017f4  f88d1003          STRB     r1,[sp,#3]
;;;2818   	modbus_buff[4] = (char)(TBAT/256);	
0017f8  ea4f71e0          ASR      r1,r0,#31
0017fc  eb006111          ADD      r1,r0,r1,LSR #24
001800  ea4f2221          ASR      r2,r1,#8
001804  f88d2004          STRB     r2,[sp,#4]
;;;2819   	modbus_buff[5] = (char)(TBAT%256);
001808  f88d0005          STRB     r0,[sp,#5]
;;;2820   
;;;2821   	crc_temp= CRC16_2(modbus_buff,6);
00180c  f04f0106          MOV      r1,#6
001810  4668              MOV      r0,sp
001812  f7fffffe          BL       CRC16_2
;;;2822   
;;;2823   	modbus_buff[6]= (char)crc_temp;
001816  f88d0006          STRB     r0,[sp,#6]
;;;2824   	modbus_buff[7]= (char)(crc_temp>>8);
00181a  ea4f2020          ASR      r0,r0,#8
00181e  f88d0007          STRB     r0,[sp,#7]
;;;2825   
;;;2826   	if(ICA_CH==0)
001822  8838              LDRH     r0,[r7,#0]  ; ICA_CH
001824  2800              CMP      r0,#0
001826  d10b              BNE      |L1.6208|
;;;2827   		{
;;;2828   		for (i=0;i<8;i++)
001828  4604              MOV      r4,r0
00182a  466d              MOV      r5,sp                 ;2811
                  |L1.6188|
;;;2829   			{
;;;2830   			putchar_sc16is700(modbus_buff[i]);
00182c  5d28              LDRB     r0,[r5,r4]
00182e  f7fffffe          BL       putchar_sc16is700
001832  e000              B        |L1.6198|
                  |L1.6196|
001834  e007              B        |L1.6214|
                  |L1.6198|
001836  f1040401          ADD      r4,r4,#1              ;2828
00183a  b2e4              UXTB     r4,r4                 ;2828
00183c  2c08              CMP      r4,#8                 ;2828
00183e  d3f5              BCC      |L1.6188|
                  |L1.6208|
;;;2831   			}
;;;2832   		}
;;;2833   	}
;;;2834   
;;;2835   }
001840  b005              ADD      sp,sp,#0x14
001842  e8bd83f0          POP      {r4-r9,pc}
                  |L1.6214|
001846  f04f0400          MOV      r4,#0                 ;2772
00184a  46e9              MOV      r9,sp                 ;2755
                  |L1.6220|
00184c  f8190004          LDRB     r0,[r9,r4]            ;2774
001850  f7fffffe          BL       putchar_sc16is700
001854  f1040401          ADD      r4,r4,#1              ;2772
001858  b2e4              UXTB     r4,r4                 ;2772
00185a  2c08              CMP      r4,#8                 ;2772
00185c  d3f6              BCC      |L1.6220|
00185e  e7ac              B        |L1.6074|
;;;2836   
                          ENDP

                  bps_drv PROC
;;;2934   //-----------------------------------------------
;;;2935   void bps_drv(char in)
001860  e92d41f0          PUSH     {r4-r8,lr}
;;;2936   {
001864  4607              MOV      r7,r0
;;;2937   char temp;
;;;2938   
;;;2939   if (bps[in]._device!=dSRC) return;
001866  498f              LDR      r1,|L1.6820|
001868  ebc71007          RSB      r0,r7,r7,LSL #4
00186c  f8112030          LDRB     r2,[r1,r0,LSL #3]
001870  2a03              CMP      r2,#3
001872  d175              BNE      |L1.6496|
;;;2940   temp=bps[in]._flags_tm;
001874  eb0104c0          ADD      r4,r1,r0,LSL #3
001878  f8945046          LDRB     r5,[r4,#0x46]
;;;2941   if(temp&(1<<AV_T))
;;;2942   	{
;;;2943   	if(bps[in]._temp_av_cnt<10/*1200*/) 
;;;2944   		{
;;;2945   		bps[in]._temp_av_cnt++;
;;;2946   		if(bps[in]._temp_av_cnt>=10/*1200*/)
;;;2947   			{
;;;2948   			bps[in]._temp_av_cnt=10/*1200*/;
00187c  f04f060a          MOV      r6,#0xa
001880  07a8              LSLS     r0,r5,#30             ;2941
001882  d515              BPL      |L1.6320|
001884  f9b4104a          LDRSH    r1,[r4,#0x4a]         ;2943
001888  290a              CMP      r1,#0xa               ;2943
00188a  da22              BGE      |L1.6354|
00188c  f1010101          ADD      r1,r1,#1              ;2945
001890  b208              SXTH     r0,r1                 ;2945
001892  f8a4004a          STRH     r0,[r4,#0x4a]         ;2945
001896  280a              CMP      r0,#0xa               ;2946
001898  db1b              BLT      |L1.6354|
00189a  f8a4604a          STRH     r6,[r4,#0x4a]
;;;2949   		   	if(!(bps[in]._av&(1<<0)))avar_bps_hndl(in,0,1);
00189e  7860              LDRB     r0,[r4,#1]
0018a0  07c0              LSLS     r0,r0,#31
0018a2  d116              BNE      |L1.6354|
0018a4  2201              MOVS     r2,#1
0018a6  2100              MOVS     r1,#0
0018a8  4638              MOV      r0,r7
0018aa  f7fffffe          BL       avar_bps_hndl
0018ae  e010              B        |L1.6354|
                  |L1.6320|
;;;2950   			}
;;;2951   		}
;;;2952   	}
;;;2953   
;;;2954   else if(!(temp&(1<<AV_T)))
;;;2955   	{
;;;2956   	if(bps[in]._temp_av_cnt) 
0018b0  f9b4104a          LDRSH    r1,[r4,#0x4a]
0018b4  b169              CBZ      r1,|L1.6354|
;;;2957   		{
;;;2958   		bps[in]._temp_av_cnt--;
0018b6  f1a10101          SUB      r1,r1,#1
0018ba  b208              SXTH     r0,r1
0018bc  f8a4004a          STRH     r0,[r4,#0x4a]
;;;2959   		if(!bps[in]._temp_av_cnt)
0018c0  b938              CBNZ     r0,|L1.6354|
;;;2960   			{
;;;2961   			if(bps[in]._av&(1<<0))avar_bps_hndl(in,0,0);
0018c2  7860              LDRB     r0,[r4,#1]
0018c4  07c0              LSLS     r0,r0,#31
0018c6  d004              BEQ      |L1.6354|
0018c8  2200              MOVS     r2,#0
0018ca  4611              MOV      r1,r2
0018cc  4638              MOV      r0,r7
0018ce  f7fffffe          BL       avar_bps_hndl
                  |L1.6354|
;;;2962   			}
;;;2963   		} 	
;;;2964   
;;;2965   	}
;;;2966   
;;;2967   if((temp&(1<<AVUMAX)))
0018d2  0728              LSLS     r0,r5,#28
0018d4  f04f0800          MOV      r8,#0                 ;2949
0018d8  d515              BPL      |L1.6406|
;;;2968   	{
;;;2969   	if(bps[in]._umax_av_cnt<10) 
0018da  f9b4104c          LDRSH    r1,[r4,#0x4c]
0018de  290a              CMP      r1,#0xa
0018e0  da26              BGE      |L1.6448|
;;;2970   		{
;;;2971   		bps[in]._umax_av_cnt++;
0018e2  f1010101          ADD      r1,r1,#1
0018e6  b208              SXTH     r0,r1
0018e8  f8a4004c          STRH     r0,[r4,#0x4c]
;;;2972   		if(bps[in]._umax_av_cnt>=10)
0018ec  280a              CMP      r0,#0xa
0018ee  db1f              BLT      |L1.6448|
;;;2973   			{ 
;;;2974   			bps[in]._umax_av_cnt=10;
0018f0  f8a4604c          STRH     r6,[r4,#0x4c]
;;;2975   			if(!(bps[in]._av&(1<<1)))avar_bps_hndl(in,1,1);
0018f4  7860              LDRB     r0,[r4,#1]
0018f6  0780              LSLS     r0,r0,#30
0018f8  d41a              BMI      |L1.6448|
0018fa  2201              MOVS     r2,#1
0018fc  4611              MOV      r1,r2
0018fe  4638              MOV      r0,r7
001900  f7fffffe          BL       avar_bps_hndl
001904  e014              B        |L1.6448|
                  |L1.6406|
;;;2976   		  	/*if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,1,1);
;;;2977   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;2978   				{
;;;2979   				apv_cnt[in,0]=APV_INIT;
;;;2980   				apv_cnt[in,1]=APV_INIT;
;;;2981   				apv_cnt[in,2]=APV_INIT;
;;;2982   				apv_flags[in]=afOFF;
;;;2983   				}				*/
;;;2984   						
;;;2985   			}
;;;2986   		} 
;;;2987   	}		
;;;2988   else if(!(temp&(1<<AVUMAX)))
;;;2989   	{
;;;2990   	if(bps[in]._umax_av_cnt>0) 
001906  f9b4104c          LDRSH    r1,[r4,#0x4c]
00190a  2900              CMP      r1,#0
00190c  dd0d              BLE      |L1.6442|
;;;2991   		{
;;;2992   		bps[in]._umax_av_cnt--;
00190e  f1a10101          SUB      r1,r1,#1
001912  b208              SXTH     r0,r1
001914  f8a4004c          STRH     r0,[r4,#0x4c]
;;;2993   		if(bps[in]._umax_av_cnt==0)
001918  b950              CBNZ     r0,|L1.6448|
;;;2994   			{
;;;2995   			bps[in]._umax_av_cnt=0;
;;;2996   			avar_bps_hndl(in,1,0);
00191a  f04f0200          MOV      r2,#0
00191e  f04f0101          MOV      r1,#1
001922  4638              MOV      r0,r7
001924  f7fffffe          BL       avar_bps_hndl
001928  e002              B        |L1.6448|
                  |L1.6442|
;;;2997   	 //		apv_cnt[in,0]=0;
;;;2998   	//		apv_cnt[in,1]=0;
;;;2999   	 //		apv_cnt[in,2]=0;			
;;;3000   			}
;;;3001   		}
;;;3002   	else if(bps[in]._umax_av_cnt<0) bps[in]._umax_av_cnt=0;		 
00192a  da01              BGE      |L1.6448|
00192c  f8a4804c          STRH     r8,[r4,#0x4c]
                  |L1.6448|
;;;3003   	}
;;;3004   
;;;3005   if(temp&(1<<AVUMIN))
001930  06e8              LSLS     r0,r5,#27
001932  d516              BPL      |L1.6498|
;;;3006   	{
;;;3007   	if(bps[in]._umin_av_cnt<10) 
001934  f9b4004e          LDRSH    r0,[r4,#0x4e]
001938  280a              CMP      r0,#0xa
00193a  da20              BGE      |L1.6526|
;;;3008   		{
;;;3009   		bps[in]._umin_av_cnt++;
00193c  f1000001          ADD      r0,r0,#1
001940  b200              SXTH     r0,r0
001942  f8a4004e          STRH     r0,[r4,#0x4e]
;;;3010   		if(bps[in]._umin_av_cnt>=10)
001946  280a              CMP      r0,#0xa
001948  db19              BLT      |L1.6526|
;;;3011   			{ 
;;;3012   			bps[in]._umin_av_cnt=10;
00194a  f8a4604e          STRH     r6,[r4,#0x4e]
;;;3013   			if(!(bps[in]._av&(1<<2)))avar_bps_hndl(in,2,1);
00194e  7860              LDRB     r0,[r4,#1]
001950  0740              LSLS     r0,r0,#29
001952  d414              BMI      |L1.6526|
001954  2201              MOVS     r2,#1
001956  2102              MOVS     r1,#2
001958  4638              MOV      r0,r7
00195a  f7fffffe          BL       avar_bps_hndl
00195e  e00e              B        |L1.6526|
                  |L1.6496|
001960  e045              B        |L1.6638|
                  |L1.6498|
;;;3014   		  	/*	if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,2,1);
;;;3015   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;3016   				{
;;;3017   				apv_cnt[in,0]=APV_INIT;
;;;3018   				apv_cnt[in,1]=APV_INIT;
;;;3019   				apv_cnt[in,2]=APV_INIT;
;;;3020   				apv_flags[in]=afOFF;
;;;3021   				}*/				
;;;3022   			}
;;;3023   		} 
;;;3024   	}	
;;;3025   	
;;;3026   else if(!(temp&(1<<AVUMIN)))
;;;3027   	{
;;;3028   	if(bps[in]._umin_av_cnt) 
001962  f9b4004e          LDRSH    r0,[r4,#0x4e]
001966  b150              CBZ      r0,|L1.6526|
;;;3029   		{
;;;3030   		bps[in]._umin_av_cnt--;
001968  f1a00001          SUB      r0,r0,#1
00196c  b200              SXTH     r0,r0
00196e  f8a4004e          STRH     r0,[r4,#0x4e]
;;;3031   		if(bps[in]._umin_av_cnt==0)
001972  b920              CBNZ     r0,|L1.6526|
;;;3032   			{
;;;3033   			bps[in]._umin_av_cnt=0;
;;;3034   			avar_bps_hndl(in,2,0);
001974  2200              MOVS     r2,#0
001976  2102              MOVS     r1,#2
001978  4638              MOV      r0,r7
00197a  f7fffffe          BL       avar_bps_hndl
                  |L1.6526|
;;;3035   		//	apv_cnt[in,0]=0;
;;;3036   		//	apv_cnt[in,1]=0;
;;;3037   		//	apv_cnt[in,2]=0;
;;;3038   			}
;;;3039   		}
;;;3040   	else if(bps[in]._umin_av_cnt>10)bps[in]._umin_av_cnt--;	 
;;;3041   	}
;;;3042   
;;;3043   //bps[in]._state=bsOFF;
;;;3044   
;;;3045   if (bps[in]._av&0x0f)					bps[in]._state=bsAV;
00197e  7860              LDRB     r0,[r4,#1]
001980  0700              LSLS     r0,r0,#28
001982  d003              BEQ      |L1.6540|
001984  f04f0005          MOV      r0,#5
001988  70a0              STRB     r0,[r4,#2]
00198a  e016              B        |L1.6586|
                  |L1.6540|
;;;3046   else if ( (net_av) && (bps[in]._cnt>20)/*&& 
00198c  4846              LDR      r0,|L1.6824|
00198e  7800              LDRB     r0,[r0,#0]  ; net_av
001990  b128              CBZ      r0,|L1.6558|
001992  78e0              LDRB     r0,[r4,#3]
001994  2814              CMP      r0,#0x14
001996  d902              BLS      |L1.6558|
;;;3047   		(bps[in]._Uii<200)*/)				bps[in]._state=bsOFF_AV_NET;
001998  f8848002          STRB     r8,[r4,#2]
00199c  e00d              B        |L1.6586|
                  |L1.6558|
;;;3048   else if (bps[in]._flags_tm&BIN8(100000))	bps[in]._state=bsRDY;
00199e  f8940046          LDRB     r0,[r4,#0x46]
0019a2  0680              LSLS     r0,r0,#26
0019a4  d503              BPL      |L1.6574|
0019a6  f04f0003          MOV      r0,#3
0019aa  70a0              STRB     r0,[r4,#2]
0019ac  e005              B        |L1.6586|
                  |L1.6574|
;;;3049   else if (bps[in]._cnt<20)				bps[in]._state=bsWRK;
0019ae  78e0              LDRB     r0,[r4,#3]
0019b0  2814              CMP      r0,#0x14
0019b2  d202              BCS      |L1.6586|
0019b4  f04f0002          MOV      r0,#2
0019b8  70a0              STRB     r0,[r4,#2]
                  |L1.6586|
;;;3050   
;;;3051   
;;;3052   
;;;3053   //else if(bps[in]._flags_tm&BIN8(100000)) bps[in]._state=ssBL;
;;;3054   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))bps[in]._state=ssWRK;
;;;3055   //else bps[0]._state=ssNOT;
;;;3056   
;;;3057   //bps[in]._is_ready=0;
;;;3058   //bps[in]._is_wrk=0;
;;;3059   //if(bps[in]._av_net) bps[in]._flags_bp='N';// не подключен
;;;3060   //else if(bps[in]._av_u_max) bps[in]._flags_bp='P';// завышено напр€жение(u_.av_.bAS1T)) bps_state[0]=ssAV;
;;;3061   //else if(bps[in]._av_u_min) bps[in]._flags_bp='M';// занижено напр€жение
;;;3062   //else if(bps[in]._av_temper) bps[in]._flags_bp='T';// температура
;;;3063   //else if(bps[in]._flags_tm&BIN8(100000)) 
;;;3064   //	{
;;;3065   //	bps[in]._flags_bp='B';// заблокирован
;;;3066   //	bps[in]._is_ready=1;
;;;3067   //	}
;;;3068   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))
;;;3069   //     {
;;;3070   //     bps[in]._flags_bp='W';// работает
;;;3071   //     bps[in]._is_ready=1;
;;;3072   //     bps[in]._is_wrk=1;
;;;3073        
;;;3074   //     }
;;;3075   //else bps[in]._is_ready=1;     
;;;3076   
;;;3077   
;;;3078   
;;;3079   
;;;3080   
;;;3081   /*
;;;3082   bps[in]._flags_tu&=BIN8(11111110);
;;;3083   if(bps[in]._ist_blok_cnt)
;;;3084   	{
;;;3085   	bps[in]._ist_blok_cnt--;
;;;3086   	bps[in]._flags_tu|=BIN8(1);
;;;3087   	}
;;;3088   
;;;3089   	   */ 
;;;3090   
;;;3091   //ѕересброс Ѕѕ—а при потере св€зи
;;;3092   if(bps[in]._cnt>=10) bps[in]._flags_tu|=BIN8(10000000);
0019ba  78e0              LDRB     r0,[r4,#3]
0019bc  280a              CMP      r0,#0xa
0019be  d306              BCC      |L1.6606|
0019c0  f894002c          LDRB     r0,[r4,#0x2c]
0019c4  f0400080          ORR      r0,r0,#0x80
0019c8  f884002c          STRB     r0,[r4,#0x2c]
0019cc  e005              B        |L1.6618|
                  |L1.6606|
;;;3093   else bps[in]._flags_tu&=BIN8(1111111);
0019ce  f894002c          LDRB     r0,[r4,#0x2c]
0019d2  f000007f          AND      r0,r0,#0x7f
0019d6  f884002c          STRB     r0,[r4,#0x2c]
                  |L1.6618|
;;;3094   	
;;;3095   bps[in]._vol_u=cntrl_stat+bps[in]._x_;	
0019da  4931              LDR      r1,|L1.6816|
0019dc  f9b40054          LDRSH    r0,[r4,#0x54]
0019e0  f9b1101e          LDRSH    r1,[r1,#0x1e]  ; cntrl_stat
0019e4  4408              ADD      r0,r0,r1
0019e6  6360              STR      r0,[r4,#0x34]
;;;3096   bps[in]._vol_i=2000; 
0019e8  f44f60fa          MOV      r0,#0x7d0
0019ec  63a0              STR      r0,[r4,#0x38]
                  |L1.6638|
;;;3097   }
0019ee  e8bd81f0          POP      {r4-r8,pc}
;;;3098   
                          ENDP

                  avt_hndl PROC
;;;3099   //-----------------------------------------------
;;;3100   void avt_hndl(void)
0019f2  b570              PUSH     {r4-r6,lr}
;;;3101   {
;;;3102   char i;
;;;3103   for(i=0;i<12;i++)
0019f4  f04f0000          MOV      r0,#0
;;;3104   	{
;;;3105   	if(eb2_data_short[6]&(1<<i))
0019f8  492c              LDR      r1,|L1.6828|
;;;3106   		{
;;;3107   		avt_stat[i]=avtON;
0019fa  4d2d              LDR      r5,|L1.6832|
0019fc  f04f0401          MOV      r4,#1                 ;3105
001a00  f9b1200c          LDRSH    r2,[r1,#0xc]          ;3105
001a04  4603              MOV      r3,r0                 ;3103
                  |L1.6662|
001a06  fa04f100          LSL      r1,r4,r0              ;3105
001a0a  420a              TST      r2,r1                 ;3105
001a0c  d001              BEQ      |L1.6674|
001a0e  542c              STRB     r4,[r5,r0]
001a10  e000              B        |L1.6676|
                  |L1.6674|
;;;3108   		}
;;;3109   	else avt_stat[i]=avtOFF;
001a12  542b              STRB     r3,[r5,r0]
                  |L1.6676|
001a14  f1000001          ADD      r0,r0,#1              ;3103
001a18  b2c0              UXTB     r0,r0                 ;3103
001a1a  280c              CMP      r0,#0xc               ;3103
001a1c  d3f3              BCC      |L1.6662|
;;;3110   	}
;;;3111   
;;;3112   if((avt_stat_old[0]!=avt_stat[0])&&(NUMAVT>=1))
001a1e  4e25              LDR      r6,|L1.6836|
001a20  7828              LDRB     r0,[r5,#0]  ; avt_stat
001a22  4c25              LDR      r4,|L1.6840|
001a24  7831              LDRB     r1,[r6,#0]  ; avt_stat_old
001a26  4281              CMP      r1,r0
001a28  d00b              BEQ      |L1.6722|
001a2a  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001a2e  2901              CMP      r1,#1
001a30  db07              BLT      |L1.6722|
;;;3113   	{
;;;3114   	if(avt_stat[0]==avtON) 	snmp_trap_send("Avtomat #1 is ON ",11,1,1);
001a32  2801              CMP      r0,#1
001a34  d07e              BEQ      |L1.6964|
;;;3115   	else 				snmp_trap_send("Avtomat #1 is OFF",11,1,0);
001a36  2300              MOVS     r3,#0
001a38  2201              MOVS     r2,#1
001a3a  210b              MOVS     r1,#0xb
001a3c  a01f              ADR      r0,|L1.6844|
001a3e  f7fffffe          BL       snmp_trap_send
                  |L1.6722|
;;;3116   	}
;;;3117   if((avt_stat_old[1]!=avt_stat[1])&&(NUMAVT>=2))
001a42  7871              LDRB     r1,[r6,#1]  ; avt_stat_old
001a44  7868              LDRB     r0,[r5,#1]  ; avt_stat
001a46  4281              CMP      r1,r0
001a48  d048              BEQ      |L1.6876|
001a4a  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001a4e  2902              CMP      r1,#2
001a50  db44              BLT      |L1.6876|
;;;3118   	{
;;;3119   	if(avt_stat[1]==avtON) 	snmp_trap_send("Avtomat #2 is ON ",11,2,1);
001a52  2801              CMP      r0,#1
001a54  d06f              BEQ      |L1.6966|
;;;3120   	else 				snmp_trap_send("Avtomat #2 is OFF",11,2,0);
001a56  e03b              B        |L1.6864|
                  |L1.6744|
                          DCD      power_summary_tempo
                  |L1.6748|
                          DCD      power_summary_tempo_old
                  |L1.6752|
                          DCD      powerSummaryCnt
                  |L1.6756|
                          DCD      power_summary
                  |L1.6760|
                          DCD      power_current_tempo
                  |L1.6764|
                          DCD      power_current_tempo_old
                  |L1.6768|
                          DCD      powerCurrentCnt
                  |L1.6772|
                          DCD      power_current
                  |L1.6776|
                          DCD      ica_timer_cnt
                  |L1.6780|
                          DCD      ICA_EN
                  |L1.6784|
                          DCD      ica_plazma
                  |L1.6788|
                          DCD      bps_I
                  |L1.6792|
                          DCD      ica_my_current
                  |L1.6796|
                          DCD      ica_your_current
                  |L1.6800|
                          DCD      ica_u_necc
                  |L1.6804|
                          DCD      ICA_MODBUS_ADDRESS
                  |L1.6808|
                          DCD      ICA_CH
                  |L1.6812|
                          DCD      TBAT
                  |L1.6816|
                          DCD      ||area_number.26||
                  |L1.6820|
                          DCD      bps
                  |L1.6824|
                          DCD      net_av
                  |L1.6828|
                          DCD      eb2_data_short
                  |L1.6832|
                          DCD      avt_stat
                  |L1.6836|
                          DCD      avt_stat_old
                  |L1.6840|
                          DCD      NUMAVT
                  |L1.6844|
001abc  4176746f          DCB      "Avtomat #1 is OFF",0
001ac0  6d617420
001ac4  23312069
001ac8  73204f46
001acc  4600    
001ace  00                DCB      0
001acf  00                DCB      0
                  |L1.6864|
001ad0  2300              MOVS     r3,#0
001ad2  2202              MOVS     r2,#2
001ad4  210b              MOVS     r1,#0xb
001ad6  a0fd              ADR      r0,|L1.7884|
001ad8  f7fffffe          BL       snmp_trap_send
                  |L1.6876|
;;;3121   	}
;;;3122   if((avt_stat_old[2]!=avt_stat[2])&&(NUMAVT>=3))
001adc  78b1              LDRB     r1,[r6,#2]  ; avt_stat_old
001ade  78a8              LDRB     r0,[r5,#2]  ; avt_stat
001ae0  4281              CMP      r1,r0
001ae2  d00b              BEQ      |L1.6908|
001ae4  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001ae8  2903              CMP      r1,#3
001aea  db07              BLT      |L1.6908|
;;;3123   	{
;;;3124   	if(avt_stat[2]==avtON) 	snmp_trap_send("Avtomat #3 is ON ",11,3,1);
001aec  2801              CMP      r0,#1
001aee  d072              BEQ      |L1.7126|
;;;3125   	else 				snmp_trap_send("Avtomat #3 is OFF",11,3,0);
001af0  2300              MOVS     r3,#0
001af2  2203              MOVS     r2,#3
001af4  210b              MOVS     r1,#0xb
001af6  a0fa              ADR      r0,|L1.7904|
001af8  f7fffffe          BL       snmp_trap_send
                  |L1.6908|
;;;3126   	}
;;;3127   if((avt_stat_old[3]!=avt_stat[3])&&(NUMAVT>=4))
001afc  78f1              LDRB     r1,[r6,#3]  ; avt_stat_old
001afe  78e8              LDRB     r0,[r5,#3]  ; avt_stat
001b00  4281              CMP      r1,r0
001b02  d00b              BEQ      |L1.6940|
001b04  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b08  2904              CMP      r1,#4
001b0a  db07              BLT      |L1.6940|
;;;3128   	{
;;;3129   	if(avt_stat[3]==avtON) 	snmp_trap_send("Avtomat #4 is ON ",11,4,1);
001b0c  2801              CMP      r0,#1
001b0e  d079              BEQ      |L1.7172|
;;;3130   	else 				snmp_trap_send("Avtomat #4 is OFF",11,4,0);
001b10  2300              MOVS     r3,#0
001b12  2204              MOVS     r2,#4
001b14  210b              MOVS     r1,#0xb
001b16  a0f7              ADR      r0,|L1.7924|
001b18  f7fffffe          BL       snmp_trap_send
                  |L1.6940|
;;;3131   	}
;;;3132   if((avt_stat_old[4]!=avt_stat[4])&&(NUMAVT>=5))
001b1c  7931              LDRB     r1,[r6,#4]  ; avt_stat_old
001b1e  7928              LDRB     r0,[r5,#4]  ; avt_stat
001b20  4281              CMP      r1,r0
001b22  d00e              BEQ      |L1.6978|
001b24  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b28  2905              CMP      r1,#5
001b2a  db0a              BLT      |L1.6978|
;;;3133   	{
;;;3134   	if(avt_stat[4]==avtON) 	snmp_trap_send("Avtomat #5 is ON ",11,5,1);
001b2c  2801              CMP      r0,#1
001b2e  d071              BEQ      |L1.7188|
;;;3135   	else 				snmp_trap_send("Avtomat #5 is OFF",11,5,0);
001b30  2300              MOVS     r3,#0
001b32  e001              B        |L1.6968|
                  |L1.6964|
001b34  e050              B        |L1.7128|
                  |L1.6966|
001b36  e056              B        |L1.7142|
                  |L1.6968|
001b38  2205              MOVS     r2,#5
001b3a  210b              MOVS     r1,#0xb
001b3c  a0f2              ADR      r0,|L1.7944|
001b3e  f7fffffe          BL       snmp_trap_send
                  |L1.6978|
;;;3136   	}
;;;3137   if((avt_stat_old[5]!=avt_stat[5])&&(NUMAVT>=6))
001b42  7971              LDRB     r1,[r6,#5]  ; avt_stat_old
001b44  7968              LDRB     r0,[r5,#5]  ; avt_stat
001b46  4281              CMP      r1,r0
001b48  d00b              BEQ      |L1.7010|
001b4a  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b4e  2906              CMP      r1,#6
001b50  db07              BLT      |L1.7010|
;;;3138   	{
;;;3139   	if(avt_stat[5]==avtON) 	snmp_trap_send("Avtomat #6 is ON ",11,6,1);
001b52  2801              CMP      r0,#1
001b54  d065              BEQ      |L1.7202|
;;;3140   	else 				snmp_trap_send("Avtomat #6 is OFF",11,6,0);
001b56  2300              MOVS     r3,#0
001b58  2206              MOVS     r2,#6
001b5a  210b              MOVS     r1,#0xb
001b5c  a0ef              ADR      r0,|L1.7964|
001b5e  f7fffffe          BL       snmp_trap_send
                  |L1.7010|
;;;3141   	}
;;;3142   if((avt_stat_old[6]!=avt_stat[6])&&(NUMAVT>=7))
001b62  79b1              LDRB     r1,[r6,#6]  ; avt_stat_old
001b64  79a8              LDRB     r0,[r5,#6]  ; avt_stat
001b66  4281              CMP      r1,r0
001b68  d00b              BEQ      |L1.7042|
001b6a  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b6e  2907              CMP      r1,#7
001b70  db07              BLT      |L1.7042|
;;;3143   	{
;;;3144   	if(avt_stat[6]==avtON) 	snmp_trap_send("Avtomat #7 is ON ",11,7,1);
001b72  2801              CMP      r0,#1
001b74  d05c              BEQ      |L1.7216|
;;;3145   	else 				snmp_trap_send("Avtomat #7 is OFF",11,7,0);
001b76  2300              MOVS     r3,#0
001b78  2207              MOVS     r2,#7
001b7a  210b              MOVS     r1,#0xb
001b7c  a0ec              ADR      r0,|L1.7984|
001b7e  f7fffffe          BL       snmp_trap_send
                  |L1.7042|
;;;3146   	}
;;;3147   if((avt_stat_old[7]!=avt_stat[7])&&(NUMAVT>=8))
001b82  79f1              LDRB     r1,[r6,#7]  ; avt_stat_old
001b84  79e8              LDRB     r0,[r5,#7]  ; avt_stat
001b86  4281              CMP      r1,r0
001b88  d00b              BEQ      |L1.7074|
001b8a  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b8e  2908              CMP      r1,#8
001b90  db07              BLT      |L1.7074|
;;;3148   	{
;;;3149   	if(avt_stat[7]==avtON) 	snmp_trap_send("Avtomat #8 is ON ",11,8,1);
001b92  2801              CMP      r0,#1
001b94  d053              BEQ      |L1.7230|
;;;3150   	else 				snmp_trap_send("Avtomat #8 is OFF",11,8,0);
001b96  2300              MOVS     r3,#0
001b98  2208              MOVS     r2,#8
001b9a  210b              MOVS     r1,#0xb
001b9c  a0e9              ADR      r0,|L1.8004|
001b9e  f7fffffe          BL       snmp_trap_send
                  |L1.7074|
;;;3151   	}
;;;3152   if((avt_stat_old[8]!=avt_stat[8])&&(NUMAVT>=9))
001ba2  7a31              LDRB     r1,[r6,#8]  ; avt_stat_old
001ba4  7a28              LDRB     r0,[r5,#8]  ; avt_stat
001ba6  4281              CMP      r1,r0
001ba8  d00b              BEQ      |L1.7106|
001baa  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001bae  2909              CMP      r1,#9
001bb0  db07              BLT      |L1.7106|
;;;3153   	{
;;;3154   	if(avt_stat[8]==avtON) 	snmp_trap_send("Avtomat #9 is ON ",11,9,1);
001bb2  2801              CMP      r0,#1
001bb4  d04a              BEQ      |L1.7244|
;;;3155   	else 				snmp_trap_send("Avtomat #9 is OFF",11,9,0);
001bb6  2300              MOVS     r3,#0
001bb8  2209              MOVS     r2,#9
001bba  210b              MOVS     r1,#0xb
001bbc  a0e6              ADR      r0,|L1.8024|
001bbe  f7fffffe          BL       snmp_trap_send
                  |L1.7106|
;;;3156   	}
;;;3157   
;;;3158   for(i=0;i<12;i++)
001bc2  f04f0000          MOV      r0,#0
                  |L1.7110|
;;;3159   	{
;;;3160   	avt_stat_old[i]=avt_stat[i];
001bc6  5c29              LDRB     r1,[r5,r0]
001bc8  5431              STRB     r1,[r6,r0]
001bca  f1000001          ADD      r0,r0,#1              ;3158
001bce  b2c0              UXTB     r0,r0                 ;3158
001bd0  280c              CMP      r0,#0xc               ;3158
001bd2  d3f8              BCC      |L1.7110|
                  |L1.7124|
;;;3161   	}
;;;3162   }
001bd4  bd70              POP      {r4-r6,pc}
                  |L1.7126|
001bd6  e00e              B        |L1.7158|
                  |L1.7128|
001bd8  2301              MOVS     r3,#1                 ;3114
001bda  461a              MOV      r2,r3                 ;3114
001bdc  210b              MOVS     r1,#0xb               ;3114
001bde  a0e3              ADR      r0,|L1.8044|
001be0  f7fffffe          BL       snmp_trap_send
001be4  e72d              B        |L1.6722|
                  |L1.7142|
001be6  2301              MOVS     r3,#1                 ;3119
001be8  2202              MOVS     r2,#2                 ;3119
001bea  210b              MOVS     r1,#0xb               ;3119
001bec  a0e4              ADR      r0,|L1.8064|
001bee  f7fffffe          BL       snmp_trap_send
001bf2  e773              B        |L1.6876|
001bf4  e006              B        |L1.7172|
                  |L1.7158|
001bf6  2301              MOVS     r3,#1                 ;3124
001bf8  2203              MOVS     r2,#3                 ;3124
001bfa  210b              MOVS     r1,#0xb               ;3124
001bfc  a0e5              ADR      r0,|L1.8084|
001bfe  f7fffffe          BL       snmp_trap_send
001c02  e77b              B        |L1.6908|
                  |L1.7172|
001c04  2301              MOVS     r3,#1                 ;3129
001c06  2204              MOVS     r2,#4                 ;3129
001c08  210b              MOVS     r1,#0xb               ;3129
001c0a  a0e7              ADR      r0,|L1.8104|
001c0c  f7fffffe          BL       snmp_trap_send
001c10  e784              B        |L1.6940|
001c12  e7ff              B        |L1.7188|
                  |L1.7188|
001c14  2301              MOVS     r3,#1                 ;3134
001c16  2205              MOVS     r2,#5                 ;3134
001c18  210b              MOVS     r1,#0xb               ;3134
001c1a  a0e8              ADR      r0,|L1.8124|
001c1c  f7fffffe          BL       snmp_trap_send
001c20  e78f              B        |L1.6978|
                  |L1.7202|
001c22  2301              MOVS     r3,#1                 ;3139
001c24  2206              MOVS     r2,#6                 ;3139
001c26  210b              MOVS     r1,#0xb               ;3139
001c28  a0e9              ADR      r0,|L1.8144|
001c2a  f7fffffe          BL       snmp_trap_send
001c2e  e798              B        |L1.7010|
                  |L1.7216|
001c30  2301              MOVS     r3,#1                 ;3144
001c32  2207              MOVS     r2,#7                 ;3144
001c34  210b              MOVS     r1,#0xb               ;3144
001c36  a0eb              ADR      r0,|L1.8164|
001c38  f7fffffe          BL       snmp_trap_send
001c3c  e7a1              B        |L1.7042|
                  |L1.7230|
001c3e  2301              MOVS     r3,#1                 ;3149
001c40  2208              MOVS     r2,#8                 ;3149
001c42  210b              MOVS     r1,#0xb               ;3149
001c44  a0ec              ADR      r0,|L1.8184|
001c46  f7fffffe          BL       snmp_trap_send
001c4a  e7aa              B        |L1.7074|
                  |L1.7244|
001c4c  2301              MOVS     r3,#1                 ;3154
001c4e  2209              MOVS     r2,#9                 ;3154
001c50  210b              MOVS     r1,#0xb               ;3154
001c52  a0ee              ADR      r0,|L1.8204|
001c54  f7fffffe          BL       snmp_trap_send
001c58  e7b3              B        |L1.7106|
;;;3163   
                          ENDP

                  overload_hndl PROC
;;;3897   //-----------------------------------------------
;;;3898   void overload_hndl(void)
001c5a  b570              PUSH     {r4-r6,lr}
;;;3899   {
;;;3900   
;;;3901   if(main_1Hz_cnt<30)return;
001c5c  48f0              LDR      r0,|L1.8224|
001c5e  f9b00000          LDRSH    r0,[r0,#0]  ; main_1Hz_cnt
001c62  281e              CMP      r0,#0x1e
001c64  dbb6              BLT      |L1.7124|
;;;3902   
;;;3903   if((out_U<UOUT)&&((UOUT-out_U)>50)&&(!(avar_vd_stat&0x0081)))
001c66  48ef              LDR      r0,|L1.8228|
;;;3904   	{
;;;3905   	if(overloadHndlCnt<(OVERLOAD_TIME*10/*TZAS*10*/))
001c68  4bf0              LDR      r3,|L1.8236|
001c6a  4cf1              LDR      r4,|L1.8240|
001c6c  f9b02000          LDRSH    r2,[r0,#0]            ;3903  ; out_U
001c70  48ed              LDR      r0,|L1.8232|
001c72  f9b01000          LDRSH    r1,[r0,#0]            ;3903  ; UOUT
001c76  f9b30000          LDRSH    r0,[r3,#0]
001c7a  428a              CMP      r2,r1                 ;3903
001c7c  da07              BGE      |L1.7310|
001c7e  1a8d              SUBS     r5,r1,r2              ;3903
001c80  2d32              CMP      r5,#0x32              ;3903
001c82  dd04              BLE      |L1.7310|
001c84  4deb              LDR      r5,|L1.8244|
001c86  882d              LDRH     r5,[r5,#0]            ;3903  ; avar_vd_stat
001c88  f0150f81          TST      r5,#0x81              ;3903
001c8c  d009              BEQ      |L1.7330|
                  |L1.7310|
;;;3906   		{
;;;3907   		overloadHndlCnt++;
;;;3908   		if(overloadHndlCnt==(OVERLOAD_TIME*10/*TZAS*10*/))
;;;3909   			{
;;;3910   			avar_overload_hndl(1);
;;;3911   			}
;;;3912   		}
;;;3913   	}
;;;3914   else if(out_U>(UOUT-50))
001c8e  3932              SUBS     r1,r1,#0x32
001c90  428a              CMP      r2,r1
001c92  dd1b              BLE      |L1.7372|
;;;3915   	{
;;;3916   	if(overloadHndlCnt)
001c94  b1d0              CBZ      r0,|L1.7372|
;;;3917   		{
;;;3918   		overloadHndlCnt--;
001c96  f1a00001          SUB      r0,r0,#1
001c9a  b200              SXTH     r0,r0
001c9c  8018              STRH     r0,[r3,#0]
;;;3919   		if(overloadHndlCnt==0)
001c9e  b190              CBZ      r0,|L1.7366|
001ca0  e014              B        |L1.7372|
                  |L1.7330|
001ca2  f9b41000          LDRSH    r1,[r4,#0]            ;3905  ; OVERLOAD_TIME
001ca6  eb010181          ADD      r1,r1,r1,LSL #2       ;3905
001caa  ebb00f41          CMP      r0,r1,LSL #1          ;3905
001cae  da0d              BGE      |L1.7372|
001cb0  f1000001          ADD      r0,r0,#1              ;3907
001cb4  b200              SXTH     r0,r0                 ;3907
001cb6  8018              STRH     r0,[r3,#0]            ;3907
001cb8  ebb00f41          CMP      r0,r1,LSL #1          ;3908
001cbc  d106              BNE      |L1.7372|
001cbe  2001              MOVS     r0,#1                 ;3910
001cc0  f7fffffe          BL       avar_overload_hndl
001cc4  e002              B        |L1.7372|
                  |L1.7366|
;;;3920   			{
;;;3921   			avar_overload_hndl(0);
001cc6  2000              MOVS     r0,#0
001cc8  f7fffffe          BL       avar_overload_hndl
                  |L1.7372|
;;;3922   			}
;;;3923   		}
;;;3924   	}
;;;3925   
;;;3926   if((Ib_ips_termokompensat>OVERLOAD_CURR))
001ccc  48da              LDR      r0,|L1.8248|
;;;3927   	{
;;;3928   	if(overloadHndlCnt1<(OVERLOAD_TIME*10))
001cce  4adc              LDR      r2,|L1.8256|
001cd0  f9b01000          LDRSH    r1,[r0,#0]            ;3926  ; Ib_ips_termokompensat
001cd4  48d9              LDR      r0,|L1.8252|
001cd6  f9b00000          LDRSH    r0,[r0,#0]            ;3926  ; OVERLOAD_CURR
001cda  4281              CMP      r1,r0                 ;3926
001cdc  dd14              BLE      |L1.7432|
001cde  f9b40000          LDRSH    r0,[r4,#0]  ; OVERLOAD_TIME
001ce2  eb000180          ADD      r1,r0,r0,LSL #2
001ce6  f9b20000          LDRSH    r0,[r2,#0]  ; overloadHndlCnt1
001cea  ebb00f41          CMP      r0,r1,LSL #1
001cee  da1e              BGE      |L1.7470|
;;;3929   		{
;;;3930   		overloadHndlCnt1++;
001cf0  f1000001          ADD      r0,r0,#1
001cf4  b200              SXTH     r0,r0
001cf6  8010              STRH     r0,[r2,#0]
;;;3931   		if(overloadHndlCnt1==(OVERLOAD_TIME*10))
001cf8  ebb00f41          CMP      r0,r1,LSL #1
001cfc  d117              BNE      |L1.7470|
;;;3932   			{
;;;3933   			avar_overload_hndl(1);
001cfe  e8bd4070          POP      {r4-r6,lr}
001d02  2001              MOVS     r0,#1
001d04  f7ffbffe          B.W      avar_overload_hndl
                  |L1.7432|
;;;3934   			}
;;;3935   		}
;;;3936   	}
;;;3937   else if((Ib_ips_termokompensat<OVERLOAD_CURR)  && (!bIBAT_SMKLBR))
001d08  da11              BGE      |L1.7470|
001d0a  48ce              LDR      r0,|L1.8260|
001d0c  8800              LDRH     r0,[r0,#0]  ; bIBAT_SMKLBR
001d0e  2800              CMP      r0,#0
001d10  d10d              BNE      |L1.7470|
;;;3938   	{
;;;3939   	if(overloadHndlCnt1)
001d12  f9b20000          LDRSH    r0,[r2,#0]  ; overloadHndlCnt1
001d16  2800              CMP      r0,#0
001d18  d009              BEQ      |L1.7470|
;;;3940   		{
;;;3941   		overloadHndlCnt1--;
001d1a  f1a00001          SUB      r0,r0,#1
001d1e  b200              SXTH     r0,r0
001d20  8010              STRH     r0,[r2,#0]
;;;3942   		if(overloadHndlCnt1==0)
001d22  2800              CMP      r0,#0
001d24  d103              BNE      |L1.7470|
;;;3943   			{
;;;3944   			avar_overload_hndl(0);
001d26  e8bd4070          POP      {r4-r6,lr}
001d2a  f7ffbffe          B.W      avar_overload_hndl
                  |L1.7470|
;;;3945   			}
;;;3946   		}
;;;3947   	}
;;;3948   
;;;3949   
;;;3950   }
001d2e  e751              B        |L1.7124|
;;;3951   
                          ENDP

                  u_avar_hndl PROC
;;;3952   //-----------------------------------------------
;;;3953   void u_avar_hndl(void)
001d30  e92d41f0          PUSH     {r4-r8,lr}
;;;3954   {
;;;3955   
;;;3956   if(main_1Hz_cnt<10)return;
001d34  48ba              LDR      r0,|L1.8224|
001d36  f9b00000          LDRSH    r0,[r0,#0]  ; main_1Hz_cnt
001d3a  280a              CMP      r0,#0xa
001d3c  db7d              BLT      |L1.7738|
;;;3957   
;;;3958   if(out_U>UOUTMAX)
001d3e  4eb9              LDR      r6,|L1.8228|
001d40  48c1              LDR      r0,|L1.8264|
;;;3959   	{
;;;3960   	if(uAvarHndlOutUMaxCnt<(10*TZAS))
001d42  4fc2              LDR      r7,|L1.8268|
001d44  f9b61000          LDRSH    r1,[r6,#0]            ;3958  ; out_U
001d48  f9b02000          LDRSH    r2,[r0,#0]            ;3958  ; UOUTMAX
001d4c  f9b70000          LDRSH    r0,[r7,#0]
001d50  2500              MOVS     r5,#0
001d52  4cbf              LDR      r4,|L1.8272|
001d54  4291              CMP      r1,r2                 ;3958
001d56  dd17              BLE      |L1.7560|
001d58  f9b42000          LDRSH    r2,[r4,#0]  ; TZAS
001d5c  eb020382          ADD      r3,r2,r2,LSL #2
001d60  ebb00f43          CMP      r0,r3,LSL #1
001d64  da0a              BGE      |L1.7548|
;;;3961   		{
;;;3962   		uAvarHndlOutUMaxCnt++;
001d66  f1000001          ADD      r0,r0,#1
001d6a  b200              SXTH     r0,r0
001d6c  8038              STRH     r0,[r7,#0]
;;;3963   		if(uAvarHndlOutUMaxCnt>=(10*TZAS))
001d6e  ebb00f43          CMP      r0,r3,LSL #1
001d72  db15              BLT      |L1.7584|
;;;3964   			{
;;;3965   			avar_u_out_hndl(1,out_U);
001d74  2001              MOVS     r0,#1
001d76  f7fffffe          BL       avar_u_out_hndl
001d7a  e011              B        |L1.7584|
                  |L1.7548|
;;;3966   			}
;;;3967   		}
;;;3968   	else uAvarHndlOutUMaxCnt=(10*TZAS);
001d7c  eb020082          ADD      r0,r2,r2,LSL #2
001d80  ea4f0040          LSL      r0,r0,#1
001d84  8038              STRH     r0,[r7,#0]
001d86  e00b              B        |L1.7584|
                  |L1.7560|
;;;3969   	}
;;;3970   else 
;;;3971   	{
;;;3972   	if(uAvarHndlOutUMaxCnt>0)
001d88  2800              CMP      r0,#0
001d8a  dd08              BLE      |L1.7582|
;;;3973   		{
;;;3974   		uAvarHndlOutUMaxCnt--;
001d8c  f1a00001          SUB      r0,r0,#1
001d90  b200              SXTH     r0,r0
001d92  8038              STRH     r0,[r7,#0]
;;;3975   		if(uAvarHndlOutUMaxCnt==0)
001d94  b920              CBNZ     r0,|L1.7584|
;;;3976   			{
;;;3977   			avar_u_out_hndl(0,out_U);
001d96  2000              MOVS     r0,#0
001d98  f7fffffe          BL       avar_u_out_hndl
001d9c  e000              B        |L1.7584|
                  |L1.7582|
;;;3978   			}
;;;3979   		}
;;;3980   	else uAvarHndlOutUMaxCnt=0;
001d9e  803d              STRH     r5,[r7,#0]
                  |L1.7584|
;;;3981   	}
;;;3982   
;;;3983   if(out_U<UOUTMIN)
001da0  48ac              LDR      r0,|L1.8276|
001da2  f9b61000          LDRSH    r1,[r6,#0]  ; out_U
;;;3984   	{
;;;3985   	if(uAvarHndlOutUMinCnt<(10*TZAS))
001da6  4eac              LDR      r6,|L1.8280|
001da8  f9b00000          LDRSH    r0,[r0,#0]            ;3983  ; UOUTMIN
001dac  4281              CMP      r1,r0                 ;3983
001dae  da19              BGE      |L1.7652|
001db0  f9b40000          LDRSH    r0,[r4,#0]  ; TZAS
001db4  f9b62000          LDRSH    r2,[r6,#0]  ; uAvarHndlOutUMinCnt
001db8  eb000380          ADD      r3,r0,r0,LSL #2
001dbc  ebb20f43          CMP      r2,r3,LSL #1
001dc0  da0a              BGE      |L1.7640|
;;;3986   		{
;;;3987   		uAvarHndlOutUMinCnt++;
001dc2  f1020201          ADD      r2,r2,#1
001dc6  b210              SXTH     r0,r2
001dc8  8030              STRH     r0,[r6,#0]
;;;3988   		if(uAvarHndlOutUMinCnt>=(10*TZAS))
001dca  ebb00f43          CMP      r0,r3,LSL #1
001dce  db17              BLT      |L1.7680|
;;;3989   			{
;;;3990   			avar_u_out_hndl(2,out_U);
001dd0  2002              MOVS     r0,#2
001dd2  f7fffffe          BL       avar_u_out_hndl
001dd6  e013              B        |L1.7680|
                  |L1.7640|
;;;3991   			}
;;;3992   		}
;;;3993   	else uAvarHndlOutUMinCnt=(10*TZAS);
001dd8  eb000080          ADD      r0,r0,r0,LSL #2
001ddc  ea4f0040          LSL      r0,r0,#1
001de0  8030              STRH     r0,[r6,#0]
001de2  e00d              B        |L1.7680|
                  |L1.7652|
;;;3994   	}
;;;3995   else 
;;;3996   	{
;;;3997   	if(uAvarHndlOutUMinCnt>0)
001de4  f9b60000          LDRSH    r0,[r6,#0]  ; uAvarHndlOutUMinCnt
001de8  2800              CMP      r0,#0
001dea  dd08              BLE      |L1.7678|
;;;3998   		{
;;;3999   		uAvarHndlOutUMinCnt--;
001dec  f1a00001          SUB      r0,r0,#1
001df0  b200              SXTH     r0,r0
001df2  8030              STRH     r0,[r6,#0]
;;;4000   		if(uAvarHndlOutUMinCnt==0)
001df4  b920              CBNZ     r0,|L1.7680|
;;;4001   			{
;;;4002   			avar_u_out_hndl(0,out_U);
001df6  2000              MOVS     r0,#0
001df8  f7fffffe          BL       avar_u_out_hndl
001dfc  e000              B        |L1.7680|
                  |L1.7678|
;;;4003   			}
;;;4004   		}
;;;4005   	else uAvarHndlOutUMinCnt=0;
001dfe  8035              STRH     r5,[r6,#0]
                  |L1.7680|
;;;4006   	}
;;;4007   
;;;4008   if(in_U>UINMAX)
001e00  4e96              LDR      r6,|L1.8284|
001e02  4897              LDR      r0,|L1.8288|
;;;4009   	{
;;;4010   	if(uAvarHndlInUMaxCnt<(10*TZAS))
001e04  4f97              LDR      r7,|L1.8292|
001e06  f9b61000          LDRSH    r1,[r6,#0]            ;4008  ; in_U
001e0a  f9b00000          LDRSH    r0,[r0,#0]            ;4008  ; UINMAX
001e0e  4281              CMP      r1,r0                 ;4008
001e10  dd1a              BLE      |L1.7752|
001e12  f9b40000          LDRSH    r0,[r4,#0]  ; TZAS
001e16  f9b72000          LDRSH    r2,[r7,#0]  ; uAvarHndlInUMaxCnt
001e1a  eb000380          ADD      r3,r0,r0,LSL #2
001e1e  ebb20f43          CMP      r2,r3,LSL #1
001e22  da0b              BGE      |L1.7740|
;;;4011   		{
;;;4012   		uAvarHndlInUMaxCnt++;
001e24  f1020201          ADD      r2,r2,#1
001e28  b210              SXTH     r0,r2
001e2a  8038              STRH     r0,[r7,#0]
;;;4013   		if(uAvarHndlInUMaxCnt>=(10*TZAS))
001e2c  ebb00f43          CMP      r0,r3,LSL #1
001e30  db18              BLT      |L1.7780|
;;;4014   			{
;;;4015   			avar_u_in_hndl(1,in_U);
001e32  2001              MOVS     r0,#1
001e34  f7fffffe          BL       avar_u_in_hndl
001e38  e014              B        |L1.7780|
                  |L1.7738|
001e3a  e035              B        |L1.7848|
                  |L1.7740|
;;;4016   			}
;;;4017   		}
;;;4018   	else uAvarHndlInUMaxCnt=(10*TZAS);
001e3c  eb000080          ADD      r0,r0,r0,LSL #2
001e40  ea4f0040          LSL      r0,r0,#1
001e44  8038              STRH     r0,[r7,#0]
001e46  e00d              B        |L1.7780|
                  |L1.7752|
;;;4019   	}
;;;4020   else 
;;;4021   	{
;;;4022   	if(uAvarHndlInUMaxCnt>0)
001e48  f9b70000          LDRSH    r0,[r7,#0]  ; uAvarHndlInUMaxCnt
001e4c  2800              CMP      r0,#0
001e4e  dd08              BLE      |L1.7778|
;;;4023   		{
;;;4024   		uAvarHndlInUMaxCnt--;
001e50  f1a00001          SUB      r0,r0,#1
001e54  b200              SXTH     r0,r0
001e56  8038              STRH     r0,[r7,#0]
;;;4025   		if(uAvarHndlInUMaxCnt==0)
001e58  b920              CBNZ     r0,|L1.7780|
;;;4026   			{
;;;4027   			avar_u_in_hndl(0,in_U);
001e5a  2000              MOVS     r0,#0
001e5c  f7fffffe          BL       avar_u_in_hndl
001e60  e000              B        |L1.7780|
                  |L1.7778|
;;;4028   			}
;;;4029   		}
;;;4030   	else uAvarHndlInUMaxCnt=0;
001e62  803d              STRH     r5,[r7,#0]
                  |L1.7780|
;;;4031   	}
;;;4032   
;;;4033   if(in_U<UINMIN)
001e64  4880              LDR      r0,|L1.8296|
001e66  f9b61000          LDRSH    r1,[r6,#0]  ; in_U
;;;4034   	{
;;;4035   	if(uAvarHndlInUMinCnt<(10*TZAS))
001e6a  4e80              LDR      r6,|L1.8300|
001e6c  f9b00000          LDRSH    r0,[r0,#0]            ;4033  ; UINMIN
001e70  4281              CMP      r1,r0                 ;4033
001e72  da1a              BGE      |L1.7850|
001e74  f9b40000          LDRSH    r0,[r4,#0]  ; TZAS
001e78  f9b62000          LDRSH    r2,[r6,#0]  ; uAvarHndlInUMinCnt
001e7c  eb000380          ADD      r3,r0,r0,LSL #2
001e80  ebb20f43          CMP      r2,r3,LSL #1
001e84  da0b              BGE      |L1.7838|
;;;4036   		{
;;;4037   		uAvarHndlInUMinCnt++;
001e86  f1020201          ADD      r2,r2,#1
001e8a  b210              SXTH     r0,r2
001e8c  8030              STRH     r0,[r6,#0]
;;;4038   		if(uAvarHndlInUMinCnt>=(10*TZAS))
001e8e  ebb00f43          CMP      r0,r3,LSL #1
001e92  db09              BLT      |L1.7848|
;;;4039   			{
;;;4040   			avar_u_in_hndl(2,in_U);
001e94  e8bd41f0          POP      {r4-r8,lr}
001e98  2002              MOVS     r0,#2
001e9a  f7ffbffe          B.W      avar_u_in_hndl
                  |L1.7838|
;;;4041   			}
;;;4042   		}
;;;4043   	else uAvarHndlInUMinCnt=(10*TZAS);
001e9e  eb000080          ADD      r0,r0,r0,LSL #2
001ea2  ea4f0040          LSL      r0,r0,#1
001ea6  8030              STRH     r0,[r6,#0]
                  |L1.7848|
;;;4044   	}
;;;4045   else 
;;;4046   	{
;;;4047   	if(uAvarHndlInUMinCnt>0)
;;;4048   		{
;;;4049   		uAvarHndlInUMinCnt--;
;;;4050   		if(uAvarHndlInUMinCnt==0)
;;;4051   			{
;;;4052   			avar_u_in_hndl(0,in_U);
;;;4053   			}
;;;4054   		}
;;;4055   	else uAvarHndlInUMinCnt=0;
;;;4056   	}
;;;4057   }
001ea8  e5a1              B        |L1.6638|
                  |L1.7850|
001eaa  f9b60000          LDRSH    r0,[r6,#0]            ;4047  ; uAvarHndlInUMinCnt
001eae  2800              CMP      r0,#0                 ;4047
001eb0  dd09              BLE      |L1.7878|
001eb2  f1a00001          SUB      r0,r0,#1              ;4049
001eb6  b200              SXTH     r0,r0                 ;4049
001eb8  8030              STRH     r0,[r6,#0]            ;4049
001eba  2800              CMP      r0,#0                 ;4050
001ebc  d1f4              BNE      |L1.7848|
001ebe  e8bd41f0          POP      {r4-r8,lr}            ;4052
001ec2  f7ffbffe          B.W      avar_u_in_hndl
                  |L1.7878|
001ec6  8035              STRH     r5,[r6,#0]            ;4055
001ec8  e591              B        |L1.6638|
001eca  0000              DCW      0x0000
                  |L1.7884|
001ecc  4176746f          DCB      "Avtomat #2 is OFF",0
001ed0  6d617420
001ed4  23322069
001ed8  73204f46
001edc  4600    
001ede  00                DCB      0
001edf  00                DCB      0
                  |L1.7904|
001ee0  4176746f          DCB      "Avtomat #3 is OFF",0
001ee4  6d617420
001ee8  23332069
001eec  73204f46
001ef0  4600    
001ef2  00                DCB      0
001ef3  00                DCB      0
                  |L1.7924|
001ef4  4176746f          DCB      "Avtomat #4 is OFF",0
001ef8  6d617420
001efc  23342069
001f00  73204f46
001f04  4600    
001f06  00                DCB      0
001f07  00                DCB      0
                  |L1.7944|
001f08  4176746f          DCB      "Avtomat #5 is OFF",0
001f0c  6d617420
001f10  23352069
001f14  73204f46
001f18  4600    
001f1a  00                DCB      0
001f1b  00                DCB      0
                  |L1.7964|
001f1c  4176746f          DCB      "Avtomat #6 is OFF",0
001f20  6d617420
001f24  23362069
001f28  73204f46
001f2c  4600    
001f2e  00                DCB      0
001f2f  00                DCB      0
                  |L1.7984|
001f30  4176746f          DCB      "Avtomat #7 is OFF",0
001f34  6d617420
001f38  23372069
001f3c  73204f46
001f40  4600    
001f42  00                DCB      0
001f43  00                DCB      0
                  |L1.8004|
001f44  4176746f          DCB      "Avtomat #8 is OFF",0
001f48  6d617420
001f4c  23382069
001f50  73204f46
001f54  4600    
001f56  00                DCB      0
001f57  00                DCB      0
                  |L1.8024|
001f58  4176746f          DCB      "Avtomat #9 is OFF",0
001f5c  6d617420
001f60  23392069
001f64  73204f46
001f68  4600    
001f6a  00                DCB      0
001f6b  00                DCB      0
                  |L1.8044|
001f6c  4176746f          DCB      "Avtomat #1 is ON ",0
001f70  6d617420
001f74  23312069
001f78  73204f4e
001f7c  2000    
001f7e  00                DCB      0
001f7f  00                DCB      0
                  |L1.8064|
001f80  4176746f          DCB      "Avtomat #2 is ON ",0
001f84  6d617420
001f88  23322069
001f8c  73204f4e
001f90  2000    
001f92  00                DCB      0
001f93  00                DCB      0
                  |L1.8084|
001f94  4176746f          DCB      "Avtomat #3 is ON ",0
001f98  6d617420
001f9c  23332069
001fa0  73204f4e
001fa4  2000    
001fa6  00                DCB      0
001fa7  00                DCB      0
                  |L1.8104|
001fa8  4176746f          DCB      "Avtomat #4 is ON ",0
001fac  6d617420
001fb0  23342069
001fb4  73204f4e
001fb8  2000    
001fba  00                DCB      0
001fbb  00                DCB      0
                  |L1.8124|
001fbc  4176746f          DCB      "Avtomat #5 is ON ",0
001fc0  6d617420
001fc4  23352069
001fc8  73204f4e
001fcc  2000    
001fce  00                DCB      0
001fcf  00                DCB      0
                  |L1.8144|
001fd0  4176746f          DCB      "Avtomat #6 is ON ",0
001fd4  6d617420
001fd8  23362069
001fdc  73204f4e
001fe0  2000    
001fe2  00                DCB      0
001fe3  00                DCB      0
                  |L1.8164|
001fe4  4176746f          DCB      "Avtomat #7 is ON ",0
001fe8  6d617420
001fec  23372069
001ff0  73204f4e
001ff4  2000    
001ff6  00                DCB      0
001ff7  00                DCB      0
                  |L1.8184|
001ff8  4176746f          DCB      "Avtomat #8 is ON ",0
001ffc  6d617420
002000  23382069
002004  73204f4e
002008  2000    
00200a  00                DCB      0
00200b  00                DCB      0
                  |L1.8204|
00200c  4176746f          DCB      "Avtomat #9 is ON ",0
002010  6d617420
002014  23392069
002018  73204f4e
00201c  2000    
00201e  00                DCB      0
00201f  00                DCB      0
                  |L1.8224|
                          DCD      main_1Hz_cnt
                  |L1.8228|
                          DCD      out_U
                  |L1.8232|
                          DCD      UOUT
                  |L1.8236|
                          DCD      overloadHndlCnt
                  |L1.8240|
                          DCD      OVERLOAD_TIME
                  |L1.8244|
                          DCD      avar_vd_stat
                  |L1.8248|
                          DCD      Ib_ips_termokompensat
                  |L1.8252|
                          DCD      OVERLOAD_CURR
                  |L1.8256|
                          DCD      overloadHndlCnt1
                  |L1.8260|
                          DCD      bIBAT_SMKLBR
                  |L1.8264|
                          DCD      UOUTMAX
                  |L1.8268|
                          DCD      uAvarHndlOutUMaxCnt
                  |L1.8272|
                          DCD      TZAS
                  |L1.8276|
                          DCD      UOUTMIN
                  |L1.8280|
                          DCD      uAvarHndlOutUMinCnt
                  |L1.8284|
                          DCD      in_U
                  |L1.8288|
                          DCD      UINMAX
                  |L1.8292|
                          DCD      uAvarHndlInUMaxCnt
                  |L1.8296|
                          DCD      UINMIN
                  |L1.8300|
                          DCD      uAvarHndlInUMinCnt
                          ENDP

                  t_sys_avar_hndl PROC
;;;4059   //-----------------------------------------------
;;;4060   void t_sys_avar_hndl(void)
002070  b430              PUSH     {r4,r5}
;;;4061   {
;;;4062   
;;;4063   if(main_1Hz_cnt<10)return;
002072  48f8              LDR      r0,|L1.9300|
002074  f9b00000          LDRSH    r0,[r0,#0]  ; main_1Hz_cnt
002078  280a              CMP      r0,#0xa
00207a  db22              BLT      |L1.8386|
;;;4064   
;;;4065   if(sys_T>TSYSMAX)
00207c  48f6              LDR      r0,|L1.9304|
;;;4066   	{
;;;4067   	if(sysTAvarHndlCnt<(10*TZAS))
00207e  4cf8              LDR      r4,|L1.9312|
002080  f9b01000          LDRSH    r1,[r0,#0]            ;4065  ; sys_T
002084  48f5              LDR      r0,|L1.9308|
002086  f9b02000          LDRSH    r2,[r0,#0]            ;4065  ; TSYSMAX
00208a  f9b40000          LDRSH    r0,[r4,#0]
00208e  4291              CMP      r1,r2                 ;4065
002090  dd19              BLE      |L1.8390|
002092  4af4              LDR      r2,|L1.9316|
002094  f9b22000          LDRSH    r2,[r2,#0]  ; TZAS
002098  eb020382          ADD      r3,r2,r2,LSL #2
00209c  ebb00f43          CMP      r0,r3,LSL #1
0020a0  da0a              BGE      |L1.8376|
;;;4068   		{
;;;4069   		sysTAvarHndlCnt++;
0020a2  f1000001          ADD      r0,r0,#1
0020a6  b200              SXTH     r0,r0
0020a8  8020              STRH     r0,[r4,#0]
;;;4070   		if(sysTAvarHndlCnt>=(10*TZAS))
0020aa  ebb00f43          CMP      r0,r3,LSL #1
0020ae  db08              BLT      |L1.8386|
;;;4071   			{
;;;4072   			avar_sys_t_hndl(1,sys_T);
0020b0  bc30              POP      {r4,r5}
0020b2  2001              MOVS     r0,#1
0020b4  f7ffbffe          B.W      avar_sys_t_hndl
                  |L1.8376|
;;;4073   			}
;;;4074   		}
;;;4075   	else sysTAvarHndlCnt=(10*TZAS);
0020b8  eb020082          ADD      r0,r2,r2,LSL #2
0020bc  ea4f0040          LSL      r0,r0,#1
0020c0  8020              STRH     r0,[r4,#0]
                  |L1.8386|
;;;4076   	}
;;;4077   else 
;;;4078   	{
;;;4079   	if(sysTAvarHndlCnt>0)
;;;4080   		{
;;;4081   		sysTAvarHndlCnt--;
;;;4082   		if(sysTAvarHndlCnt==0)
;;;4083   			{
;;;4084   			avar_sys_t_hndl(0,sys_T);
;;;4085   			}
;;;4086   		}
;;;4087   	else sysTAvarHndlCnt=0;
;;;4088   	}
;;;4089   }
0020c2  bc30              POP      {r4,r5}
0020c4  4770              BX       lr
                  |L1.8390|
0020c6  2800              CMP      r0,#0                 ;4079
0020c8  dd08              BLE      |L1.8412|
0020ca  f1a00001          SUB      r0,r0,#1              ;4081
0020ce  b200              SXTH     r0,r0                 ;4081
0020d0  8020              STRH     r0,[r4,#0]            ;4081
0020d2  2800              CMP      r0,#0                 ;4082
0020d4  d1f5              BNE      |L1.8386|
0020d6  bc30              POP      {r4,r5}               ;4084
0020d8  f7ffbffe          B.W      avar_sys_t_hndl
                  |L1.8412|
0020dc  f04f0000          MOV      r0,#0                 ;4087
0020e0  8020              STRH     r0,[r4,#0]            ;4087
0020e2  e7ee              B        |L1.8386|
;;;4090   
                          ENDP

                  u_necc_hndl PROC
;;;4092   //-----------------------------------------------
;;;4093   void u_necc_hndl(void)
0020e4  b538              PUSH     {r3-r5,lr}
;;;4094   {
;;;4095   signed long temp_L;
;;;4096   signed long temp_SL;
;;;4097   //signed short temp_SS;
;;;4098   
;;;4099   //char i;
;;;4100   
;;;4101   //temp_SS=0;
;;;4102   signed short t[2];
;;;4103   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4104   
;;;4105   if(!TERMOKOMPENS)
0020e6  49e0              LDR      r1,|L1.9320|
;;;4106   	{
;;;4107   	//u_necc=U0B;
;;;4108   	//u_necc=UB20;
;;;4109   	}
;;;4110   else
;;;4111   	{
;;;4112   	if(ND_EXT[0])t[0]=20;
;;;4113   	else t[0]=t_ext[0];
;;;4114   
;;;4115   	mat_temper=t[0];
;;;4116   			
;;;4117   /*	if(mat_temper<0)temp_SL=UB0; 
;;;4118   	else 
;;;4119   		{
;;;4120   		if(mat_temper>40)mat_temper=40; 
;;;4121   		temp_SL=(UB20-UB0)*10;
;;;4122   		temp_SL*=mat_temper;
;;;4123   		temp_SL/=200;
;;;4124   		temp_SL+=UB0;
;;;4125   		}			  */
;;;4126   	if(spc_stat==spcVZ)
;;;4127   		{
;;;4128   		//temp_SL=UVZ;
;;;4129   		}
;;;4130   	u_necc=(unsigned int)temp_SL;
0020e8  4ce0              LDR      r4,|L1.9324|
0020ea  8809              LDRH     r1,[r1,#0]            ;4105  ; TERMOKOMPENS
0020ec  b181              CBZ      r1,|L1.8464|
0020ee  49e0              LDR      r1,|L1.9328|
0020f0  7809              LDRB     r1,[r1,#0]            ;4112  ; ND_EXT
0020f2  b121              CBZ      r1,|L1.8446|
0020f4  f04f0114          MOV      r1,#0x14              ;4112
0020f8  f8ad1000          STRH     r1,[sp,#0]            ;4112
0020fc  e003              B        |L1.8454|
                  |L1.8446|
0020fe  49dd              LDR      r1,|L1.9332|
002100  8809              LDRH     r1,[r1,#0]            ;4113  ; t_ext
002102  f8ad1000          STRH     r1,[sp,#0]            ;4113
                  |L1.8454|
002106  4adc              LDR      r2,|L1.9336|
002108  f9bd1000          LDRSH    r1,[sp,#0]            ;4115
00210c  6011              STR      r1,[r2,#0]            ;4115  ; mat_temper
00210e  8020              STRH     r0,[r4,#0]
                  |L1.8464|
;;;4131   	///u_necc=3456;
;;;4132   	}  
;;;4133   
;;;4134   //u_necc=2355;
;;;4135   
;;;4136   if(speedChIsOn)
002110  48da              LDR      r0,|L1.9340|
002112  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
002114  b110              CBZ      r0,|L1.8476|
;;;4137   	{
;;;4138   	u_necc=speedChrgVolt;
002116  48da              LDR      r0,|L1.9344|
002118  8800              LDRH     r0,[r0,#0]  ; speedChrgVolt
00211a  8020              STRH     r0,[r4,#0]
                  |L1.8476|
;;;4139   	}
;;;4140   
;;;4141   if(mess_find_unvol(MESS2UNECC_HNDL))
00211c  20be              MOVS     r0,#0xbe
00211e  f7fffffe          BL       mess_find_unvol
002122  b128              CBZ      r0,|L1.8496|
;;;4142   	{		
;;;4143   	if(mess_data[0]==PARAM_UNECC_SET)
002124  48d7              LDR      r0,|L1.9348|
002126  6801              LDR      r1,[r0,#0]  ; mess_data
002128  29bf              CMP      r1,#0xbf
00212a  d101              BNE      |L1.8496|
;;;4144   		{
;;;4145   		u_necc=mess_data[1];
00212c  6840              LDR      r0,[r0,#4]  ; mess_data
00212e  8020              STRH     r0,[r4,#0]
                  |L1.8496|
;;;4146   		}		
;;;4147   	}
;;;4148   if(ICA_EN)u_necc+=ica_u_necc;
002130  48d5              LDR      r0,|L1.9352|
002132  8800              LDRH     r0,[r0,#0]  ; ICA_EN
002134  b120              CBZ      r0,|L1.8512|
002136  49d5              LDR      r1,|L1.9356|
002138  8820              LDRH     r0,[r4,#0]  ; u_necc
00213a  8809              LDRH     r1,[r1,#0]  ; ica_u_necc
00213c  4408              ADD      r0,r0,r1
00213e  8020              STRH     r0,[r4,#0]
                  |L1.8512|
;;;4149   #endif
;;;4150   
;;;4151   
;;;4152   //#ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;4153   /*
;;;4154   #ifndef UKU_TELECORE2015
;;;4155   #ifndef UKU_TELECORE2017
;;;4156   if(unh_cnt0<10)
;;;4157   	{
;;;4158   	unh_cnt0++;
;;;4159   	if(unh_cnt0>=10)
;;;4160   		{
;;;4161   		unh_cnt0=0;
;;;4162   		b1Hz_unh=1;
;;;4163   		}
;;;4164   	}
;;;4165   
;;;4166   if(unh_cnt1<5)
;;;4167   	{
;;;4168   	unh_cnt1++;
;;;4169   	if(unh_cnt1==5)
;;;4170   		{
;;;4171   		unh_cnt1=0;
;;;4172   //		b2Hz_unh=1;
;;;4173   		}
;;;4174   	} 
;;;4175   
;;;4176   
;;;4177   
;;;4178   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;4179   	{		
;;;4180   	if(mess_data[0]==PARAM_UNECC_SET)
;;;4181   		{
;;;4182   		u_necc=mess_data[1];
;;;4183   		}		
;;;4184   	}
;;;4185   
;;;4186   
;;;4187   else if(b1Hz_unh)
;;;4188   	{
;;;4189   	
;;;4190   	if((BAT_IS_ON[0]!=bisON) && (BAT_IS_ON[1]!=bisON))
;;;4191   		{
;;;4192   		
;;;4193   		u_necc=U0B;
;;;4194   		}
;;;4195   	else 
;;;4196   		{
;;;4197   		if(BAT_TYPE==0) //если батаре€ обычна€
;;;4198   			{
;;;4199   			for(i=0;i<2;i++)
;;;4200   				{
;;;4201   				if(BAT_IS_ON[i]==bisON)
;;;4202   					{
;;;4203   					if(bat[i]._nd)t[i]=20;
;;;4204   					else t[i]=bat[i]._Tb;
;;;4205   					}
;;;4206   				else
;;;4207   					{
;;;4208   					t[i]=-20;
;;;4209   					}
;;;4210   				}
;;;4211   			if(t[0]>t[1])mat_temper=t[0];
;;;4212   			else mat_temper=t[1];
;;;4213   			
;;;4214   		
;;;4215   			if(mat_temper<0)temp_SL=UB0; 
;;;4216   			else 
;;;4217   				{
;;;4218   				if(mat_temper>40)mat_temper=40; 
;;;4219   				temp_SL=(UB20-UB0)*10;
;;;4220   				temp_SL*=mat_temper;
;;;4221   				temp_SL/=200;
;;;4222   				temp_SL+=UB0;
;;;4223   				}
;;;4224   			if(spc_stat==spcVZ)
;;;4225   				{
;;;4226   				temp_SL=UVZ;
;;;4227   				}
;;;4228   			u_necc=(unsigned int)temp_SL;
;;;4229   			}
;;;4230   		else if(BAT_TYPE==1) //если батаре€ китайска€
;;;4231   			{
;;;4232   			u_necc=U0B;
;;;4233   					
;;;4234   			u_necc=bat[0]._Ub+10;
;;;4235   
;;;4236   			
;;;4237   			if(spc_stat==spcVZ)
;;;4238   				{
;;;4239   				u_necc=UVZ;
;;;4240   				}
;;;4241   			if(u_necc>=UB0) u_necc=UB0;
;;;4242   			if(u_necc>=UB20) u_necc=UB20;
;;;4243   			}
;;;4244   		}  
;;;4245   	}
;;;4246   #endif
;;;4247   #endif*/
;;;4248   /*
;;;4249   #ifdef UKU_TELECORE2015
;;;4250   
;;;4251   if(unh_cnt0<10)
;;;4252   	{
;;;4253   	unh_cnt0++;
;;;4254   	if(unh_cnt0>=10)
;;;4255   		{
;;;4256   		unh_cnt0=0;
;;;4257   		b1Hz_unh=1;
;;;4258   		}
;;;4259   	}
;;;4260   
;;;4261   if(unh_cnt1<5)
;;;4262   	{
;;;4263   	unh_cnt1++;
;;;4264   	if(unh_cnt1==5)
;;;4265   		{
;;;4266   		unh_cnt1=0;
;;;4267   //		b2Hz_unh=1;
;;;4268   		}
;;;4269   	} 
;;;4270   
;;;4271   
;;;4272   
;;;4273   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;4274   	{		
;;;4275   	if(mess_data[0]==PARAM_UNECC_SET)
;;;4276   		{
;;;4277   		u_necc=mess_data[1];
;;;4278   		}		
;;;4279   	}
;;;4280   
;;;4281   
;;;4282   else if(b1Hz_unh)
;;;4283   	{
;;;4284   	b1Hz_unh=0;
;;;4285   
;;;4286   	if(BAT_TYPE==0)
;;;4287   		{
;;;4288   		if(bat[0]._nd)mat_temper=20;
;;;4289   		else mat_temper=bat[0]._Tb;
;;;4290   
;;;4291   			
;;;4292   		if(mat_temper<0)temp_SL=UB0; 
;;;4293   		else 
;;;4294   			{
;;;4295   			if(mat_temper>40)mat_temper=40; 
;;;4296   			temp_SL=(UB20-UB0)*10;
;;;4297   			temp_SL*=mat_temper;
;;;4298   			temp_SL/=200;
;;;4299   			temp_SL+=UB0;
;;;4300   			}
;;;4301   		if(spc_stat==spcVZ)
;;;4302   			{
;;;4303   			temp_SL=UVZ;
;;;4304   			}
;;;4305   		u_necc=(unsigned int)temp_SL;
;;;4306   	///u_necc=3456;
;;;4307   		}
;;;4308   	else if(BAT_TYPE==1)
;;;4309   		{
;;;4310   		
;;;4311   		gran(&DU_LI_BAT,1,30);
;;;4312   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;4313   		gran(&u_necc,0,UB0);
;;;4314   		gran(&u_necc,0,UB20);
;;;4315   		gran(&u_necc,0,540);		
;;;4316   
;;;4317   
;;;4318   		if(li_bat._batStat!=bsOK)
;;;4319   			{
;;;4320   			u_necc=U0B;
;;;4321   			}
;;;4322   		if(spc_stat==spcVZ)
;;;4323   			{
;;;4324   			u_necc=UVZ;
;;;4325   			}
;;;4326   
;;;4327   		}
;;;4328   	else if(BAT_TYPE==2)
;;;4329   		{
;;;4330   		u_necc=U0B;
;;;4331   		
;;;4332   		if(spc_stat==spcVZ)
;;;4333   			{
;;;4334   			u_necc=UVZ;
;;;4335   			}
;;;4336   	
;;;4337   		u_necc=UB0;
;;;4338   		}
;;;4339   
;;;4340   	else if(BAT_TYPE==3)
;;;4341   		{
;;;4342   		u_necc=U0B;
;;;4343   		
;;;4344   		if(spc_stat==spcVZ)
;;;4345   			{
;;;4346   			u_necc=UVZ;
;;;4347   			}
;;;4348   
;;;4349   		gran(&DU_LI_BAT,1,30);
;;;4350   
;;;4351   
;;;4352   		if(lakbNotErrorNum==0)
;;;4353   			{
;;;4354   			u_necc=U0B;
;;;4355   			}
;;;4356   		else 
;;;4357   			{
;;;4358   			signed short i;
;;;4359   			//signed short u_necc_max;
;;;4360   			//u_necc_max=0;
;;;4361   			char soc_flag=0;
;;;4362   
;;;4363   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;4364   				{
;;;4365   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;4366   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;4367   				}
;;;4368   
;;;4369   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;4370   			}
;;;4371   		gran(&u_necc,0,UB0);
;;;4372   		//gran(&u_necc,0,UB20);
;;;4373   		gran(&u_necc,0,540);
;;;4374   		}
;;;4375   	}
;;;4376   
;;;4377   #endif */
;;;4378   /*
;;;4379   #ifdef UKU_TELECORE2017
;;;4380   
;;;4381   if(unh_cnt0<10)
;;;4382   	{
;;;4383   	unh_cnt0++;
;;;4384   	if(unh_cnt0>=10)
;;;4385   		{
;;;4386   		unh_cnt0=0;
;;;4387   		b1Hz_unh=1;
;;;4388   		}
;;;4389   	}
;;;4390   
;;;4391   if(unh_cnt1<5)
;;;4392   	{
;;;4393   	unh_cnt1++;
;;;4394   	if(unh_cnt1==5)
;;;4395   		{
;;;4396   		unh_cnt1=0;
;;;4397   //		b2Hz_unh=1;
;;;4398   		}
;;;4399   	} 
;;;4400   
;;;4401   
;;;4402   
;;;4403   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;4404   	{		
;;;4405   	if(mess_data[0]==PARAM_UNECC_SET)
;;;4406   		{
;;;4407   		u_necc=mess_data[1];
;;;4408   		}		
;;;4409   	}
;;;4410   
;;;4411   
;;;4412   else if(b1Hz_unh)
;;;4413   	{
;;;4414   	b1Hz_unh=0;
;;;4415   
;;;4416   	if(BAT_TYPE==0)
;;;4417   		{
;;;4418   		if(bat[0]._nd)mat_temper=20;
;;;4419   		else mat_temper=bat[0]._Tb;
;;;4420   
;;;4421   			
;;;4422   		if(mat_temper<0)temp_SL=UB0; 
;;;4423   		else 
;;;4424   			{
;;;4425   			if(mat_temper>40)mat_temper=40; 
;;;4426   			temp_SL=(UB20-UB0)*10;
;;;4427   			temp_SL*=mat_temper;
;;;4428   			temp_SL/=200;
;;;4429   			temp_SL+=UB0;
;;;4430   			}
;;;4431   		if(spc_stat==spcVZ)
;;;4432   			{
;;;4433   			temp_SL=UVZ;
;;;4434   			}
;;;4435   		u_necc=(unsigned int)temp_SL;
;;;4436   	///u_necc=3456;
;;;4437   		}
;;;4438   	else if(BAT_TYPE==1)
;;;4439   		{
;;;4440   		
;;;4441   		gran(&DU_LI_BAT,1,30);
;;;4442   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;4443   		gran(&u_necc,0,UB0);
;;;4444   		gran(&u_necc,0,UB20);
;;;4445   		gran(&u_necc,0,540);		
;;;4446   
;;;4447   
;;;4448   		if(li_bat._batStat!=bsOK)
;;;4449   			{
;;;4450   			u_necc=U0B;
;;;4451   			}
;;;4452   		if(spc_stat==spcVZ)
;;;4453   			{
;;;4454   			u_necc=UVZ;
;;;4455   			}
;;;4456   		}
;;;4457   	else if(BAT_TYPE==2)
;;;4458   		{
;;;4459   		u_necc=U0B;
;;;4460   		
;;;4461   		if(spc_stat==spcVZ)
;;;4462   			{
;;;4463   			u_necc=UVZ;
;;;4464   			}
;;;4465   	
;;;4466   		u_necc=UB0;
;;;4467   		}
;;;4468   
;;;4469   	else if(BAT_TYPE==3)
;;;4470   		{
;;;4471   		u_necc=U0B;
;;;4472   		
;;;4473   		if(spc_stat==spcVZ)
;;;4474   			{
;;;4475   			u_necc=UVZ;
;;;4476   			}
;;;4477   
;;;4478   		gran(&DU_LI_BAT,1,30);
;;;4479   
;;;4480   
;;;4481   		if(lakbNotErrorNum==0)
;;;4482   			{
;;;4483   			u_necc=U0B;
;;;4484   			}
;;;4485   		else 
;;;4486   			{
;;;4487   			signed short i;
;;;4488   			//signed short u_necc_max;
;;;4489   			//u_necc_max=0;
;;;4490   			char soc_flag=0;
;;;4491   
;;;4492   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;4493   				{
;;;4494   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;4495   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;4496   				}
;;;4497   
;;;4498   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;4499   			}
;;;4500   		gran(&u_necc,0,UB0);
;;;4501   		//gran(&u_necc,0,UB20);
;;;4502   		gran(&u_necc,0,540);
;;;4503   		}
;;;4504   	}
;;;4505   
;;;4506   #endif 
;;;4507   */
;;;4508   //u_necc=2356;
;;;4509   //#endif//gran(&u_necc,400,UMAX);
;;;4510   
;;;4511   temp_L=(signed long) u_necc;
002140  f9b40000          LDRSH    r0,[r4,#0]  ; u_necc
;;;4512   temp_L*=98L;
002144  f04f0162          MOV      r1,#0x62
002148  fb00f101          MUL      r1,r0,r1
;;;4513   temp_L/=100L;
00214c  f04f0264          MOV      r2,#0x64
002150  fb91f1f2          SDIV     r1,r1,r2
;;;4514   u_necc_dn=(signed short)temp_L;
002154  4bce              LDR      r3,|L1.9360|
002156  8019              STRH     r1,[r3,#0]
;;;4515   
;;;4516   temp_L=(signed long) u_necc;
;;;4517   temp_L*=102L;
002158  f04f0166          MOV      r1,#0x66
00215c  fb00f001          MUL      r0,r0,r1
;;;4518   temp_L/=100L;
002160  fb90f0f2          SDIV     r0,r0,r2
;;;4519   u_necc_up=(signed short)temp_L;
002164  49cb              LDR      r1,|L1.9364|
002166  8008              STRH     r0,[r1,#0]
;;;4520   
;;;4521   
;;;4522   }
002168  bd38              POP      {r3-r5,pc}
;;;4523   
                          ENDP

                  num_necc_hndl PROC
;;;4525   //-----------------------------------------------
;;;4526   void num_necc_hndl(void)
00216a  e92d41f0          PUSH     {r4-r8,lr}
;;;4527   {
;;;4528   
;;;4529   static short num_necc_block_cnt;
;;;4530   if(num_necc_block_cnt) num_necc_block_cnt--;
00216e  4cca              LDR      r4,|L1.9368|
002170  f9b40026          LDRSH    r0,[r4,#0x26]  ; num_necc_block_cnt
002174  b110              CBZ      r0,|L1.8572|
002176  f1a00001          SUB      r0,r0,#1
00217a  84e0              STRH     r0,[r4,#0x26]
                  |L1.8572|
;;;4531   
;;;4532   Isumm_=Isumm;
00217c  48c7              LDR      r0,|L1.9372|
00217e  4dc8              LDR      r5,|L1.9376|
002180  8800              LDRH     r0,[r0,#0]  ; Isumm
002182  8028              STRH     r0,[r5,#0]
;;;4533   
;;;4534   if(bat[0]._Ib<0) Isumm_+=(abs(bat[0]._Ib))/10;
002184  4ec7              LDR      r6,|L1.9380|
002186  270a              MOVS     r7,#0xa
002188  f9b60008          LDRSH    r0,[r6,#8]  ; bat
00218c  2800              CMP      r0,#0
00218e  da06              BGE      |L1.8606|
002190  f7fffffe          BL       abs
002194  fb90f0f7          SDIV     r0,r0,r7
002198  8829              LDRH     r1,[r5,#0]  ; Isumm_
00219a  4408              ADD      r0,r0,r1
00219c  8028              STRH     r0,[r5,#0]
                  |L1.8606|
;;;4535   if(bat[1]._Ib<0) Isumm_+=(abs(bat[1]._Ib))/10;
00219e  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
0021a2  2800              CMP      r0,#0
0021a4  da06              BGE      |L1.8628|
0021a6  f7fffffe          BL       abs
0021aa  fb90f0f7          SDIV     r0,r0,r7
0021ae  8829              LDRH     r1,[r5,#0]  ; Isumm_
0021b0  4408              ADD      r0,r0,r1
0021b2  8028              STRH     r0,[r5,#0]
                  |L1.8628|
;;;4536   
;;;4537   num_necc_up=(Isumm_/((signed short)IMAX))+1;
0021b4  48bc              LDR      r0,|L1.9384|
0021b6  f9b51000          LDRSH    r1,[r5,#0]  ; Isumm_
0021ba  f9b00000          LDRSH    r0,[r0,#0]  ; IMAX
0021be  fb91f0f0          SDIV     r0,r1,r0
0021c2  f1000001          ADD      r0,r0,#1
0021c6  b2c0              UXTB     r0,r0
0021c8  74a0              STRB     r0,[r4,#0x12]
;;;4538   ////Isumm_+=(signed short)((IMAX*(10-KIMAX))/10);
;;;4539   ////Isumm_+=(signed short)(IMAX-IMIN);
;;;4540   
;;;4541   num_necc_down=(Isumm_/((signed short)IMIN))+1;
0021ca  4ab8              LDR      r2,|L1.9388|
0021cc  f9b22000          LDRSH    r2,[r2,#0]  ; IMIN
0021d0  fb91f1f2          SDIV     r1,r1,r2
0021d4  f1010101          ADD      r1,r1,#1
0021d8  b2c9              UXTB     r1,r1
0021da  74e1              STRB     r1,[r4,#0x13]
;;;4542   
;;;4543   if(num_necc_up>num_necc)
0021dc  4bb4              LDR      r3,|L1.9392|
;;;4544   	{
;;;4545   	num_necc=num_necc_up;
;;;4546   	num_necc_block_cnt=60;
0021de  f04f053c          MOV      r5,#0x3c
0021e2  f9b32000          LDRSH    r2,[r3,#0]            ;4543  ; num_necc
0021e6  4290              CMP      r0,r2                 ;4543
0021e8  dd02              BLE      |L1.8688|
0021ea  8018              STRH     r0,[r3,#0]            ;4545
0021ec  84e5              STRH     r5,[r4,#0x26]
0021ee  e005              B        |L1.8700|
                  |L1.8688|
;;;4547   	}
;;;4548   else if(num_necc_down<num_necc)
0021f0  4291              CMP      r1,r2
0021f2  da03              BGE      |L1.8700|
;;;4549   	{
;;;4550   	if(!num_necc_block_cnt)
0021f4  8ce0              LDRH     r0,[r4,#0x26]  ; num_necc_block_cnt
0021f6  b908              CBNZ     r0,|L1.8700|
;;;4551   		{
;;;4552   		num_necc=num_necc_down;
0021f8  8019              STRH     r1,[r3,#0]
;;;4553   		num_necc_block_cnt=60;
0021fa  84e5              STRH     r5,[r4,#0x26]
                  |L1.8700|
;;;4554   		}
;;;4555   	}
;;;4556   
;;;4557   /*if(PAR)*/ num_necc=NUMIST;
0021fc  48ad              LDR      r0,|L1.9396|
0021fe  f9b02000          LDRSH    r2,[r0,#0]  ; NUMIST
002202  801a              STRH     r2,[r3,#0]
;;;4558   
;;;4559   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4560   //if(bPARALLEL) num_necc=NUMIST;
;;;4561   #endif
;;;4562   
;;;4563   num_necc=NUMIST;
;;;4564   
;;;4565   gran(&num_necc,1,NUMIST);
002204  e8bd41f0          POP      {r4-r8,lr}
002208  2101              MOVS     r1,#1
00220a  48a9              LDR      r0,|L1.9392|
00220c  f7ffbffe          B.W      gran
;;;4566   
;;;4567   }
;;;4568   
                          ENDP

                  cntrl_hndl PROC
;;;4570   //-----------------------------------------------
;;;4571   void cntrl_hndl(void)
002210  e92d47f0          PUSH     {r4-r10,lr}
;;;4572   {
;;;4573   #define UBPSMAXPWM	2350
;;;4574   #define UBPSMINPWM	2100
;;;4575   
;;;4576   IZMAX_=IZMAX;
002214  48a8              LDR      r0,|L1.9400|
002216  f8df8280          LDR      r8,|L1.9368|
00221a  f9b01000          LDRSH    r1,[r0,#0]  ; IZMAX
00221e  f8a8103c          STRH     r1,[r8,#0x3c]
;;;4577   
;;;4578   //cntrl_hndl_plazma=10;
;;;4579   
;;;4580   if(speedChIsOn)IZMAX_=speedChrgCurr;
002222  4896              LDR      r0,|L1.9340|
002224  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
002226  b118              CBZ      r0,|L1.8752|
002228  48a4              LDR      r0,|L1.9404|
00222a  8800              LDRH     r0,[r0,#0]  ; speedChrgCurr
00222c  f8a8003c          STRH     r0,[r8,#0x3c]
                  |L1.8752|
;;;4581   
;;;4582   if(cntrl_stat_blok_cnt)cntrl_stat_blok_cnt--;
002230  f9b8004c          LDRSH    r0,[r8,#0x4c]  ; cntrl_stat_blok_cnt
002234  b118              CBZ      r0,|L1.8766|
002236  f1a00001          SUB      r0,r0,#1
00223a  f8a8004c          STRH     r0,[r8,#0x4c]
                  |L1.8766|
;;;4583   if(cntrl_stat_blok_cnt_)cntrl_stat_blok_cnt_--;
00223e  f9b8004e          LDRSH    r0,[r8,#0x4e]  ; cntrl_stat_blok_cnt_
002242  b118              CBZ      r0,|L1.8780|
002244  f1a00001          SUB      r0,r0,#1
002248  f8a8004e          STRH     r0,[r8,#0x4e]
                  |L1.8780|
;;;4584   
;;;4585   if((bat[0]._temper_stat&0x03)||(bat[1]._temper_stat&0x03))IZMAX_=IZMAX/10;
00224c  4895              LDR      r0,|L1.9380|
00224e  f04f070a          MOV      r7,#0xa
002252  f890203f          LDRB     r2,[r0,#0x3f]  ; bat
002256  0792              LSLS     r2,r2,#30
002258  d103              BNE      |L1.8802|
00225a  f890008b          LDRB     r0,[r0,#0x8b]  ; bat
00225e  0780              LSLS     r0,r0,#30
002260  d003              BEQ      |L1.8810|
                  |L1.8802|
002262  fb91f0f7          SDIV     r0,r1,r7
002266  f8a8003c          STRH     r0,[r8,#0x3c]
                  |L1.8810|
;;;4586   
;;;4587   
;;;4588   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4589   if((REG_SPEED<1)||(REG_SPEED>5)) REG_SPEED=1;
00226a  4895              LDR      r0,|L1.9408|
00226c  2201              MOVS     r2,#1
00226e  f9b01000          LDRSH    r1,[r0,#0]  ; REG_SPEED
002272  1e49              SUBS     r1,r1,#1
002274  2905              CMP      r1,#5
002276  d300              BCC      |L1.8826|
002278  8002              STRH     r2,[r0,#0]
                  |L1.8826|
;;;4590   if(ch_cnt0<(10*REG_SPEED))
00227a  f9b00000          LDRSH    r0,[r0,#0]  ; REG_SPEED
00227e  2400              MOVS     r4,#0                 ;4580
002280  eb000180          ADD      r1,r0,r0,LSL #2
002284  f8980007          LDRB     r0,[r8,#7]  ; ch_cnt0
002288  ebb00f41          CMP      r0,r1,LSL #1
00228c  da0b              BGE      |L1.8870|
;;;4591   	{
;;;4592   	ch_cnt0++;
00228e  f1000001          ADD      r0,r0,#1
002292  b2c0              UXTB     r0,r0
002294  f8880007          STRB     r0,[r8,#7]
;;;4593   	if(ch_cnt0>=10*REG_SPEED)
002298  ebb00f41          CMP      r0,r1,LSL #1
00229c  db03              BLT      |L1.8870|
;;;4594   		{
;;;4595   		ch_cnt0=0;
00229e  f8884007          STRB     r4,[r8,#7]
;;;4596   		b1Hz_ch=1;
0022a2  f8882008          STRB     r2,[r8,#8]
                  |L1.8870|
;;;4597   		}
;;;4598   	}
;;;4599   #endif
;;;4600   
;;;4601   
;;;4602   if(mess_find_unvol(MESS2CNTRL_HNDL))
0022a6  20e1              MOVS     r0,#0xe1
0022a8  f7fffffe          BL       mess_find_unvol
;;;4603   	{
;;;4604   	if(mess_data[0]==PARAM_CNTRL_STAT_PLUS)
0022ac  4d75              LDR      r5,|L1.9348|
;;;4605   		{
;;;4606   		cntrl_stat=cntrl_stat_old+mess_data[1];
;;;4607   		}
;;;4608   	else if(mess_data[0]==PARAM_CNTRL_STAT_MINUS)
;;;4609   		{
;;;4610   		cntrl_stat=cntrl_stat_old-mess_data[1];
;;;4611   		}
;;;4612   	else if(mess_data[0]==PARAM_CNTRL_STAT_STEP_DOWN)
;;;4613   		{
;;;4614   		static char cntrlStatIsDownCnt;
;;;4615   		cntrl_stat--;
;;;4616   
;;;4617   		if((cntrl_stat<=30)||(load_U<USIGN))
;;;4618   			{
;;;4619   			if(++cntrlStatIsDownCnt==250)mess_send(MESS2KB_HNDL,PARAM_CNTRL_IS_DOWN,0,10);
;;;4620   			}
;;;4621   		else 
;;;4622   			{
;;;4623   			cntrlStatIsDownCnt=0;
;;;4624   			}
;;;4625   
;;;4626   		}
;;;4627   	else if(mess_data[0]==PARAM_CNTRL_STAT_SET)
;;;4628   		{
;;;4629   		cntrl_stat=mess_data[1];
;;;4630   		}
;;;4631   
;;;4632   	else if(mess_data[0]==PARAM_CNTRL_STAT_FAST_REG)
;;;4633   		{
;;;4634   		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4635   		if(load_U>u_necc)
0022ae  f8dfc1bc          LDR      r12,|L1.9324|
;;;4636   			{
;;;4637   			cntrl_hndl_plazma=11;
;;;4638   			if(((bps_U-u_necc)>40)&&(cntrl_stat>0))cntrl_stat-=5;
0022b2  4b84              LDR      r3,|L1.9412|
;;;4639   			else if((cntrl_stat)&&b1Hz_ch)cntrl_stat--;
;;;4640   			}
;;;4641   		else if(bps_U<u_necc)
;;;4642   			{
;;;4643   			cntrl_hndl_plazma=12;	
;;;4644   			if(((u_necc-bps_U)>40)&&(cntrl_stat<2015))cntrl_stat+=5;
;;;4645   			else	if((cntrl_stat<2020)&&b1Hz_ch)cntrl_stat++;
;;;4646   			}
;;;4647   		#endif	
;;;4648   	 	}
;;;4649   	}
;;;4650   
;;;4651   #ifdef UKU_VD
;;;4652   else if((b1Hz_ch)&&((!bIBAT_SMKLBR)||(bps[8]._cnt>40)))
0022b4  4e84              LDR      r6,|L1.9416|
0022b6  2800              CMP      r0,#0                 ;4602
0022b8  d07e              BEQ      |L1.9144|
0022ba  6828              LDR      r0,[r5,#0]            ;4604  ; mess_data
0022bc  2864              CMP      r0,#0x64              ;4604
0022be  d009              BEQ      |L1.8916|
0022c0  2869              CMP      r0,#0x69              ;4608
0022c2  d00e              BEQ      |L1.8930|
0022c4  4981              LDR      r1,|L1.9420|
0022c6  286e              CMP      r0,#0x6e              ;4612
0022c8  d013              BEQ      |L1.8946|
0022ca  28e5              CMP      r0,#0xe5              ;4627
0022cc  d033              BEQ      |L1.9014|
0022ce  28e6              CMP      r0,#0xe6              ;4632
0022d0  d035              BEQ      |L1.9022|
0022d2  e166              B        |L1.9634|
                  |L1.8916|
0022d4  f8b81020          LDRH     r1,[r8,#0x20]         ;4606  ; cntrl_stat_old
0022d8  6868              LDR      r0,[r5,#4]            ;4606  ; mess_data
0022da  4408              ADD      r0,r0,r1              ;4606
0022dc  f8a8001e          STRH     r0,[r8,#0x1e]         ;4606
0022e0  e15f              B        |L1.9634|
                  |L1.8930|
0022e2  f8b81020          LDRH     r1,[r8,#0x20]         ;4610  ; cntrl_stat_old
0022e6  6868              LDR      r0,[r5,#4]            ;4610  ; mess_data
0022e8  eba10000          SUB      r0,r1,r0              ;4610
0022ec  f8a8001e          STRH     r0,[r8,#0x1e]         ;4610
0022f0  e157              B        |L1.9634|
                  |L1.8946|
0022f2  f8b8001e          LDRH     r0,[r8,#0x1e]         ;4615  ; cntrl_stat
0022f6  f1a00001          SUB      r0,r0,#1              ;4615
0022fa  b200              SXTH     r0,r0                 ;4615
0022fc  f8a8001e          STRH     r0,[r8,#0x1e]         ;4615
002300  281e              CMP      r0,#0x1e              ;4617
002302  dd06              BLE      |L1.8978|
002304  f9b10000          LDRSH    r0,[r1,#0]            ;4617  ; load_U
002308  4971              LDR      r1,|L1.9424|
00230a  f9b11000          LDRSH    r1,[r1,#0]            ;4617  ; USIGN
00230e  4288              CMP      r0,r1                 ;4617
002310  da0e              BGE      |L1.9008|
                  |L1.8978|
002312  f8980001          LDRB     r0,[r8,#1]            ;4619  ; cntrlStatIsDownCnt
002316  1c40              ADDS     r0,r0,#1              ;4619
002318  b2c0              UXTB     r0,r0                 ;4619
00231a  f8880001          STRB     r0,[r8,#1]            ;4619
00231e  28fa              CMP      r0,#0xfa              ;4619
002320  d105              BNE      |L1.9006|
002322  230a              MOVS     r3,#0xa               ;4619
002324  2200              MOVS     r2,#0                 ;4619
002326  21e7              MOVS     r1,#0xe7              ;4619
002328  20e6              MOVS     r0,#0xe6              ;4619
00232a  f7fffffe          BL       mess_send
                  |L1.9006|
00232e  e138              B        |L1.9634|
                  |L1.9008|
002330  f8884001          STRB     r4,[r8,#1]            ;4623
002334  e135              B        |L1.9634|
                  |L1.9014|
002336  6868              LDR      r0,[r5,#4]            ;4629  ; mess_data
002338  f8a8001e          STRH     r0,[r8,#0x1e]         ;4629
00233c  e131              B        |L1.9634|
                  |L1.9022|
00233e  f9b11000          LDRSH    r1,[r1,#0]            ;4635  ; load_U
002342  f9bc0000          LDRSH    r0,[r12,#0]           ;4635  ; u_necc
002346  4281              CMP      r1,r0                 ;4635
002348  dd1f              BLE      |L1.9098|
00234a  f04f010b          MOV      r1,#0xb               ;4637
00234e  f888101d          STRB     r1,[r8,#0x1d]         ;4637
002352  f9b31000          LDRSH    r1,[r3,#0]            ;4638  ; bps_U
002356  eba10000          SUB      r0,r1,r0              ;4638
00235a  2828              CMP      r0,#0x28              ;4638
00235c  dd08              BLE      |L1.9072|
00235e  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4638  ; cntrl_stat
002362  2800              CMP      r0,#0                 ;4638
002364  dd04              BLE      |L1.9072|
002366  f1a00005          SUB      r0,r0,#5              ;4638
00236a  f8a8001e          STRH     r0,[r8,#0x1e]         ;4638
00236e  e118              B        |L1.9634|
                  |L1.9072|
002370  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4639  ; cntrl_stat
002374  2800              CMP      r0,#0                 ;4639
002376  d007              BEQ      |L1.9096|
002378  f8981008          LDRB     r1,[r8,#8]            ;4639  ; b1Hz_ch
00237c  2900              CMP      r1,#0                 ;4639
00237e  d003              BEQ      |L1.9096|
002380  f1a00001          SUB      r0,r0,#1              ;4639
002384  f8a8001e          STRH     r0,[r8,#0x1e]         ;4639
                  |L1.9096|
002388  e10b              B        |L1.9634|
                  |L1.9098|
00238a  f9b31000          LDRSH    r1,[r3,#0]            ;4641  ; bps_U
00238e  4281              CMP      r1,r0                 ;4641
002390  da11              BGE      |L1.9142|
002392  f04f020c          MOV      r2,#0xc               ;4643
002396  f888201d          STRB     r2,[r8,#0x1d]         ;4643
00239a  eba00001          SUB      r0,r0,r1              ;4644
00239e  2828              CMP      r0,#0x28              ;4644
0023a0  dd0b              BLE      |L1.9146|
0023a2  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4644  ; cntrl_stat
0023a6  f24071df          MOV      r1,#0x7df             ;4644
0023aa  4288              CMP      r0,r1                 ;4644
0023ac  da05              BGE      |L1.9146|
0023ae  f1000005          ADD      r0,r0,#5              ;4644
0023b2  f8a8001e          STRH     r0,[r8,#0x1e]         ;4644
                  |L1.9142|
0023b6  e0f4              B        |L1.9634|
                  |L1.9144|
0023b8  e00d              B        |L1.9174|
                  |L1.9146|
0023ba  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4645  ; cntrl_stat
0023be  f24071e4          MOV      r1,#0x7e4             ;4645
0023c2  4288              CMP      r0,r1                 ;4645
0023c4  da33              BGE      |L1.9262|
0023c6  f8981008          LDRB     r1,[r8,#8]            ;4645  ; b1Hz_ch
0023ca  b381              CBZ      r1,|L1.9262|
0023cc  f1000001          ADD      r0,r0,#1              ;4645
0023d0  f8a8001e          STRH     r0,[r8,#0x1e]         ;4645
0023d4  e0e5              B        |L1.9634|
                  |L1.9174|
0023d6  f8980008          LDRB     r0,[r8,#8]  ; b1Hz_ch
0023da  b340              CBZ      r0,|L1.9262|
0023dc  483d              LDR      r0,|L1.9428|
0023de  8800              LDRH     r0,[r0,#0]  ; bIBAT_SMKLBR
0023e0  b118              CBZ      r0,|L1.9194|
0023e2  f89603c3          LDRB     r0,[r6,#0x3c3]  ; bps
0023e6  2828              CMP      r0,#0x28
0023e8  d921              BLS      |L1.9262|
                  |L1.9194|
;;;4653   	{
;;;4654   	cntrl_stat_new=cntrl_stat_old;
0023ea  f9b80020          LDRSH    r0,[r8,#0x20]  ; cntrl_stat_old
0023ee  f8a80038          STRH     r0,[r8,#0x38]
;;;4655   	cntrl_hndl_plazma=19;
0023f2  f04f0113          MOV      r1,#0x13
0023f6  f888101d          STRB     r1,[r8,#0x1d]
;;;4656   	if((Ibmax/10)>(2*IZMAX_))
0023fa  f9b8203a          LDRSH    r2,[r8,#0x3a]  ; Ibmax
0023fe  f8b8103c          LDRH     r1,[r8,#0x3c]  ; IZMAX_
002402  fb92f7f7          SDIV     r7,r2,r7
002406  ebb70f41          CMP      r7,r1,LSL #1
00240a  dd11              BLE      |L1.9264|
;;;4657   		{
;;;4658   		cntrl_hndl_plazma=20;
00240c  f04f0114          MOV      r1,#0x14
002410  f888101d          STRB     r1,[r8,#0x1d]
;;;4659             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
002414  f8b8104c          LDRH     r1,[r8,#0x4c]  ; cntrl_stat_blok_cnt
002418  b121              CBZ      r1,|L1.9252|
00241a  f1a00001          SUB      r0,r0,#1
00241e  f8a80038          STRH     r0,[r8,#0x38]
002422  e07d              B        |L1.9504|
                  |L1.9252|
;;;4660   		else	cntrl_stat_new-=10;
002424  f1a0000a          SUB      r0,r0,#0xa
002428  f8a80038          STRH     r0,[r8,#0x38]
00242c  e078              B        |L1.9504|
                  |L1.9262|
00242e  e0b8              B        |L1.9634|
                  |L1.9264|
;;;4661   		}		
;;;4662   	else if(((Ibmax/10)<(IZMAX_*2))&&(Ibmax>(IZMAX_*15)))
002430  da57              BGE      |L1.9442|
002432  ebc11901          RSB      r9,r1,r1,LSL #4
002436  4591              CMP      r9,r2
002438  da53              BGE      |L1.9442|
;;;4663   		{
;;;4664   		cntrl_hndl_plazma=21;
00243a  f04f0115          MOV      r1,#0x15
00243e  f888101d          STRB     r1,[r8,#0x1d]
;;;4665             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
002442  f8b8104c          LDRH     r1,[r8,#0x4c]  ; cntrl_stat_blok_cnt
002446  b121              CBZ      r1,|L1.9298|
002448  f1a00001          SUB      r0,r0,#1
00244c  f8a80038          STRH     r0,[r8,#0x38]
002450  e066              B        |L1.9504|
                  |L1.9298|
002452  e041              B        |L1.9432|
                  |L1.9300|
                          DCD      main_1Hz_cnt
                  |L1.9304|
                          DCD      sys_T
                  |L1.9308|
                          DCD      TSYSMAX
                  |L1.9312|
                          DCD      sysTAvarHndlCnt
                  |L1.9316|
                          DCD      TZAS
                  |L1.9320|
                          DCD      TERMOKOMPENS
                  |L1.9324|
                          DCD      u_necc
                  |L1.9328|
                          DCD      ND_EXT
                  |L1.9332|
                          DCD      t_ext
                  |L1.9336|
                          DCD      mat_temper
                  |L1.9340|
                          DCD      speedChIsOn
                  |L1.9344|
                          DCD      speedChrgVolt
                  |L1.9348|
                          DCD      mess_data
                  |L1.9352|
                          DCD      ICA_EN
                  |L1.9356|
                          DCD      ica_u_necc
                  |L1.9360|
                          DCD      u_necc_dn
                  |L1.9364|
                          DCD      u_necc_up
                  |L1.9368|
                          DCD      ||area_number.26||
                  |L1.9372|
                          DCD      Isumm
                  |L1.9376|
                          DCD      Isumm_
                  |L1.9380|
                          DCD      bat
                  |L1.9384|
                          DCD      IMAX
                  |L1.9388|
                          DCD      IMIN
                  |L1.9392|
                          DCD      num_necc
                  |L1.9396|
                          DCD      NUMIST
                  |L1.9400|
                          DCD      IZMAX
                  |L1.9404|
                          DCD      speedChrgCurr
                  |L1.9408|
                          DCD      REG_SPEED
                  |L1.9412|
                          DCD      bps_U
                  |L1.9416|
                          DCD      bps
                  |L1.9420|
                          DCD      load_U
                  |L1.9424|
                          DCD      USIGN
                  |L1.9428|
                          DCD      bIBAT_SMKLBR
                  |L1.9432|
;;;4666             else	cntrl_stat_new-=3;
0024d8  f1a00003          SUB      r0,r0,#3
0024dc  f8a80038          STRH     r0,[r8,#0x38]
0024e0  e01e              B        |L1.9504|
                  |L1.9442|
;;;4667   		}   
;;;4668   	else if((Ibmax<(IZMAX_*15))&&((Ibmax/10)>IZMAX_))
0024e2  ebc11901          RSB      r9,r1,r1,LSL #4
0024e6  4591              CMP      r9,r2
0024e8  dd0a              BLE      |L1.9472|
0024ea  428f              CMP      r7,r1
0024ec  dd08              BLE      |L1.9472|
;;;4669   		{
;;;4670   		cntrl_hndl_plazma=22;
0024ee  f04f0116          MOV      r1,#0x16
0024f2  f888101d          STRB     r1,[r8,#0x1d]
;;;4671   		cntrl_stat_new--;
0024f6  f1a00001          SUB      r0,r0,#1
0024fa  f8a80038          STRH     r0,[r8,#0x38]
0024fe  e00f              B        |L1.9504|
                  |L1.9472|
;;;4672   		}
;;;4673   		
;;;4674   	else if(bps_U<u_necc)
002500  f9b30000          LDRSH    r0,[r3,#0]  ; bps_U
002504  f9bc1000          LDRSH    r1,[r12,#0]  ; u_necc
002508  4288              CMP      r0,r1
00250a  da04              BGE      |L1.9494|
;;;4675   		{
;;;4676   		cntrl_hndl_plazma=23;
00250c  f04f0017          MOV      r0,#0x17
002510  f888001d          STRB     r0,[r8,#0x1d]
002514  e004              B        |L1.9504|
                  |L1.9494|
;;;4677   /*		if(bps_U<(u_necc-(UB0-UB20)))
;;;4678   			{
;;;4679   			cntrl_hndl_plazma=24;
;;;4680   			if(Ibmax<0)
;;;4681   				{
;;;4682   				cntrl_hndl_plazma=25;
;;;4683                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;4684   				else cntrl_stat_new+=10;
;;;4685   				}
;;;4686   			else if(Ibmax<(IZMAX_*5))
;;;4687   				{
;;;4688   				cntrl_hndl_plazma=26;
;;;4689                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;4690   				else	cntrl_stat_new+=2;
;;;4691   				}
;;;4692   			else if(Ibmax<((IZMAX_*10)))//(Ibmax<((IZMAX_*95)/10))
;;;4693   				{
;;;4694   				cntrl_hndl_plazma=27;
;;;4695   				cntrl_stat_new++;
;;;4696   				}					
;;;4697   			}	*/
;;;4698   /*		else if(bps_U<(u_necc-((UB0-UB20)/4)))
;;;4699   			{
;;;4700   			cntrl_hndl_plazma=28;
;;;4701   			if(Ibmax<(IZMAX_*5))
;;;4702   				{
;;;4703   				cntrl_hndl_plazma=29;
;;;4704                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;4705   				else	cntrl_stat_new+=2;
;;;4706   				}
;;;4707   			else if(Ibmax<((IZMAX_*10)))//(Ibmax<((IZMAX_*95)/10))
;;;4708   				{
;;;4709   				cntrl_hndl_plazma=30;
;;;4710   				cntrl_stat_new++;
;;;4711   				}					
;;;4712   			}
;;;4713   		else if(bps_U<(u_necc-1))
;;;4714   			{
;;;4715   			cntrl_hndl_plazma=31;
;;;4716   			if(Ibmax<((IZMAX_*10)))//(Ibmax<((IZMAX_*95)/10))
;;;4717   				{
;;;4718   				cntrl_hndl_plazma=32;
;;;4719   				cntrl_stat_new++;
;;;4720   				}					
;;;4721   			}	*/					
;;;4722   		}	
;;;4723   	else if((bps_U>u_necc)/*&&(!cntrl_blok)*/)
002516  dd03              BLE      |L1.9504|
;;;4724   		{ 	
;;;4725   		cntrl_hndl_plazma=33;
002518  f04f0021          MOV      r0,#0x21
00251c  f888001d          STRB     r0,[r8,#0x1d]
                  |L1.9504|
;;;4726   /*		if(bps_U>(u_necc+(UB0-UB20)))
;;;4727   			{
;;;4728   			cntrl_hndl_plazma=34;
;;;4729                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;4730   			else	cntrl_stat_new-=10;
;;;4731   			}
;;;4732   		else if(bps_U>(u_necc+((UB0-UB20)/4)))
;;;4733   			{
;;;4734   			cntrl_hndl_plazma=35;
;;;4735                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;4736   			else cntrl_stat_new-=2;
;;;4737   			}	
;;;4738   		else if(bps_U>(u_necc+1))
;;;4739   			{
;;;4740   			cntrl_hndl_plazma=36;
;;;4741   			cntrl_stat_new--;
;;;4742   			}*/					
;;;4743   		}
;;;4744   
;;;4745   	cntrl_stat_new=(short)((2000L*((long)(UOUT_-in_U+30)))/650L);
002520  48ff              LDR      r0,|L1.10528|
002522  f240228a          MOV      r2,#0x28a
002526  f9b01000          LDRSH    r1,[r0,#0]  ; UOUT_
00252a  48fe              LDR      r0,|L1.10532|
00252c  f9b00000          LDRSH    r0,[r0,#0]  ; in_U
002530  eba10000          SUB      r0,r1,r0
002534  f100001e          ADD      r0,r0,#0x1e
002538  f44f61fa          MOV      r1,#0x7d0
00253c  fb00f101          MUL      r1,r0,r1
002540  fb91f1f2          SDIV     r1,r1,r2
002544  f8a81038          STRH     r1,[r8,#0x38]
;;;4746   	if(((signed long)(UOUT_-in_U+30))<0L)cntrl_stat_new=0;
002548  2800              CMP      r0,#0
00254a  da01              BGE      |L1.9552|
00254c  f8a84038          STRH     r4,[r8,#0x38]
                  |L1.9552|
;;;4747   	gran(&cntrl_stat_new,10,2010);			
002550  f24072da          MOV      r2,#0x7da
002554  210a              MOVS     r1,#0xa
002556  48f4              LDR      r0,|L1.10536|
002558  f7fffffe          BL       gran
;;;4748   	cntrl_stat_old=cntrl_stat_new;
00255c  f8b80038          LDRH     r0,[r8,#0x38]  ; cntrl_stat_new
002560  f8a80020          STRH     r0,[r8,#0x20]
;;;4749   	cntrl_stat=cntrl_stat_new;
002564  f8a8001e          STRH     r0,[r8,#0x1e]
;;;4750   	cntrl_stat_buff[cntrl_stat_buff_ptr]=cntrl_stat_new;  //pwm_u_buff[pwm_u_buff_ptr]=pwm_u_;
002568  4af0              LDR      r2,|L1.10540|
00256a  f898100b          LDRB     r1,[r8,#0xb]  ; cntrl_stat_buff_ptr
00256e  f8220011          STRH     r0,[r2,r1,LSL #1]
;;;4751   	cntrl_stat_buff_ptr++;								   //pwm_u_buff_ptr++;
002572  f1010101          ADD      r1,r1,#1
002576  b2c8              UXTB     r0,r1
002578  f888000b          STRB     r0,[r8,#0xb]
;;;4752   	
;;;4753   	if(cntrl_stat_buff_ptr>=16)cntrl_stat_buff_ptr=0;	//if(pwm_u_buff_ptr>=16)pwm_u_buff_ptr=0;
00257c  2810              CMP      r0,#0x10
00257e  d301              BCC      |L1.9604|
002580  f888400b          STRB     r4,[r8,#0xb]
                  |L1.9604|
;;;4754   		{
;;;4755   		char i;
;;;4756   		signed long tempSL;
;;;4757   		tempSL=0;
002584  f04f0100          MOV      r1,#0
;;;4758   		for(i=0;i<16;i++)
002588  4608              MOV      r0,r1
                  |L1.9610|
;;;4759   			{
;;;4760   			tempSL+=(signed long)cntrl_stat_buff[i];			//tempSL+=(signed long)pwm_u_buff[i];
00258a  f9323010          LDRSH    r3,[r2,r0,LSL #1]
00258e  4419              ADD      r1,r1,r3
002590  f1000001          ADD      r0,r0,#1              ;4758
002594  b2c0              UXTB     r0,r0                 ;4758
002596  2810              CMP      r0,#0x10              ;4758
002598  d3f7              BCC      |L1.9610|
;;;4761   			}
;;;4762   		tempSL>>=4;
00259a  ea4f1021          ASR      r0,r1,#4
;;;4763   		cntrl_stat_buff_=(signed short)tempSL;
00259e  f8a80040          STRH     r0,[r8,#0x40]
                  |L1.9634|
;;;4764   		}
;;;4765   	//if(NUMSK)cntrl_stat=cntrl_stat_buff_;
;;;4766   
;;;4767   	}
;;;4768   
;;;4769   #endif
;;;4770   
;;;4771   iiii=0;
0025a2  f888400a          STRB     r4,[r8,#0xa]
;;;4772   for(i=0;i<NUMIST;i++)
0025a6  f8884009          STRB     r4,[r8,#9]
;;;4773        {
;;;4774   
;;;4775   	 //bps[i]._x_avg=0;
;;;4776   
;;;4777        /*if(bps[i]._cnt<30)iiii=1;*/
;;;4778   
;;;4779   	 bps[i]._x_=_x_reg+bps[i]._x_avg;
0025aa  4fe1              LDR      r7,|L1.10544|
0025ac  48e1              LDR      r0,|L1.10548|
0025ae  f9b72000          LDRSH    r2,[r7,#0]
0025b2  f9b03000          LDRSH    r3,[r0,#0]            ;4772
0025b6  e00c              B        |L1.9682|
                  |L1.9656|
0025b8  ebc01100          RSB      r1,r0,r0,LSL #4
0025bc  eb0601c1          ADD      r1,r6,r1,LSL #3
0025c0  f8b1c056          LDRH     r12,[r1,#0x56]
0025c4  4494              ADD      r12,r12,r2
0025c6  f8a1c054          STRH     r12,[r1,#0x54]
0025ca  f1000001          ADD      r0,r0,#1              ;4772
0025ce  f8880009          STRB     r0,[r8,#9]            ;4772
                  |L1.9682|
0025d2  f8980009          LDRB     r0,[r8,#9]            ;4772  ; i
0025d6  4298              CMP      r0,r3                 ;4772
0025d8  dbee              BLT      |L1.9656|
;;;4780   	 //if(bps[i]._flags_tu&0x01) bps[i]._cntrl_stat=0;
;;;4781        }
;;;4782   
;;;4783   /*if(iiii==0)
;;;4784        {
;;;4785        cntrl_stat=1200;	
;;;4786        cntrl_stat_old=1200;
;;;4787        cntrl_stat_new=1200;
;;;4788        }
;;;4789   gran(&cntrl_stat,10,2010); */
;;;4790   
;;;4791   //if(main_1Hz_cnt<10)	cntrl_stat=2000;
;;;4792   
;;;4793   if(++_x_reg_cnt>=100)
0025da  49d7              LDR      r1,|L1.10552|
;;;4794   	{
;;;4795   	_x_reg_cnt=0;
;;;4796   
;;;4797   	if((out_U<UOUT)&&(vd_U>20))
0025dc  4ed7              LDR      r6,|L1.10556|
0025de  8808              LDRH     r0,[r1,#0]            ;4793  ; _x_reg_cnt
0025e0  1c40              ADDS     r0,r0,#1              ;4793
0025e2  b200              SXTH     r0,r0                 ;4793
0025e4  8008              STRH     r0,[r1,#0]            ;4793
0025e6  2864              CMP      r0,#0x64              ;4793
0025e8  db1a              BLT      |L1.9760|
0025ea  800c              STRH     r4,[r1,#0]            ;4795
0025ec  48d4              LDR      r0,|L1.10560|
0025ee  4bd5              LDR      r3,|L1.10564|
0025f0  f9b01000          LDRSH    r1,[r0,#0]  ; out_U
0025f4  f9b60000          LDRSH    r0,[r6,#0]  ; UOUT
0025f8  4281              CMP      r1,r0
0025fa  da08              BGE      |L1.9742|
0025fc  f9b3c000          LDRSH    r12,[r3,#0]  ; vd_U
002600  f1bc0f14          CMP      r12,#0x14
002604  dd03              BLE      |L1.9742|
;;;4798   		{
;;;4799   		_x_reg++;
002606  f1020201          ADD      r2,r2,#1
00260a  803a              STRH     r2,[r7,#0]
00260c  e008              B        |L1.9760|
                  |L1.9742|
;;;4800   		}
;;;4801   	else if((out_U>UOUT)&&(vd_U>20))
00260e  4281              CMP      r1,r0
002610  dd06              BLE      |L1.9760|
002612  f9b30000          LDRSH    r0,[r3,#0]  ; vd_U
002616  2814              CMP      r0,#0x14
002618  dd02              BLE      |L1.9760|
;;;4802   		{
;;;4803   		_x_reg--;
00261a  f1a20201          SUB      r2,r2,#1
00261e  803a              STRH     r2,[r7,#0]
                  |L1.9760|
;;;4804   		}
;;;4805   	}
;;;4806   gran(&_x_reg,-50,50);
002620  2232              MOVS     r2,#0x32
002622  4251              RSBS     r1,r2,#0
002624  48c2              LDR      r0,|L1.10544|
002626  f7fffffe          BL       gran
;;;4807   gran(&_x_reg,UBPSMINPWM-UOUT,UBPSMAXPWM-UOUT);
00262a  8830              LDRH     r0,[r6,#0]  ; UOUT
00262c  f6a0112e          SUB      r1,r0,#0x92e
002630  4249              RSBS     r1,r1,#0
002632  f6a00034          SUB      r0,r0,#0x834
002636  b20a              SXTH     r2,r1
002638  4240              RSBS     r0,r0,#0
00263a  b201              SXTH     r1,r0
00263c  48bc              LDR      r0,|L1.10544|
00263e  f7fffffe          BL       gran
;;;4808   
;;;4809   if(mess_data[0]==PARAM_CNTRL_STAT_SET)
002642  6828              LDR      r0,[r5,#0]  ; mess_data
002644  28e5              CMP      r0,#0xe5
002646  d10c              BNE      |L1.9826|
;;;4810   		{
;;;4811   		if(cntrl_stat==1020)_x_reg=5000;
002648  f9b8001e          LDRSH    r0,[r8,#0x1e]  ; cntrl_stat
00264c  f5b07f7f          CMP      r0,#0x3fc
002650  d102              BNE      |L1.9816|
002652  f2413188          MOV      r1,#0x1388
002656  8039              STRH     r1,[r7,#0]
                  |L1.9816|
;;;4812   		if(cntrl_stat==30)_x_reg=-5000;
002658  281e              CMP      r0,#0x1e
00265a  d102              BNE      |L1.9826|
00265c  f64e4078          MOV      r0,#0xec78
002660  8038              STRH     r0,[r7,#0]
                  |L1.9826|
;;;4813   		}
;;;4814   
;;;4815   b1Hz_ch=0;
002662  f8884008          STRB     r4,[r8,#8]
;;;4816   }
002666  e8bd87f0          POP      {r4-r10,pc}
;;;4817   
                          ENDP

                  ext_drv PROC
;;;4819   //-----------------------------------------------
;;;4820   void ext_drv(void)
00266a  e92d5ff0          PUSH     {r4-r12,lr}
;;;4821   {
;;;4822   char i;
;;;4823   
;;;4824   
;;;4825   for(i=0;i<NUMSK;i++)
00266e  f04f0000          MOV      r0,#0
002672  4ab7              LDR      r2,|L1.10576|
;;;4826   	{
;;;4827   	#ifdef UKU_MGTS
;;;4828   	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;4829   	#endif
;;;4830   	#ifdef UKU_RSTKM
;;;4831   	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;4832   	#endif
;;;4833   	#ifdef UKU_3U
;;;4834   	if(adc_buff_[sk_buff_3U[i]]<2000)
;;;4835   	#endif
;;;4836   	#ifdef UKU_GLONASS
;;;4837   	if(adc_buff_[sk_buff_GLONASS[i]]<2000)
;;;4838   	#endif
;;;4839   	#ifdef UKU_KONTUR
;;;4840   	if(adc_buff_[sk_buff_KONTUR[i]]<2000)
;;;4841   	#endif
;;;4842   	#ifdef UKU_6U
;;;4843   	if(adc_buff_[sk_buff_6U[i]]<2000)
;;;4844   	#endif
;;;4845   	#ifdef UKU_220
;;;4846   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;4847   	#endif
;;;4848   	#ifdef UKU_220_V2
;;;4849   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;4850   	#endif
;;;4851   	#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4852   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;4853   	#endif
;;;4854   	#ifdef UKU_TELECORE2015	
;;;4855   	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;4856   	#endif
;;;4857   	#ifdef UKU_TELECORE2017
;;;4858   	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;4859   	#endif		
;;;4860   		{
;;;4861   		if(sk_cnt[i]<10)
002674  4bb4              LDR      r3,|L1.10568|
;;;4862   			{
;;;4863   			sk_cnt[i]++;
;;;4864   			if(sk_cnt[i]>=10)
;;;4865   				{
;;;4866   				sk_stat[i]=ssON;
002676  4db5              LDR      r5,|L1.10572|
002678  f04f0a01          MOV      r10,#1
;;;4867   				}
;;;4868   			}
;;;4869   		else 
;;;4870   			{
;;;4871   			sk_cnt[i]=10;
00267c  f04f0b0a          MOV      r11,#0xa
002680  4606              MOV      r6,r0                 ;4825
002682  f9b24000          LDRSH    r4,[r2,#0]            ;4825
002686  e026              B        |L1.9942|
                  |L1.9864|
002688  49b2              LDR      r1,|L1.10580|
00268a  4fa8              LDR      r7,|L1.10540|
00268c  5c09              LDRB     r1,[r1,r0]            ;4852
00268e  3f40              SUBS     r7,r7,#0x40           ;4852
002690  f9371011          LDRSH    r1,[r7,r1,LSL #1]     ;4852
002694  f5b16ffa          CMP      r1,#0x7d0             ;4852
002698  da0e              BGE      |L1.9912|
00269a  5619              LDRSB    r1,[r3,r0]            ;4861
00269c  290a              CMP      r1,#0xa               ;4861
00269e  da08              BGE      |L1.9906|
0026a0  f1010101          ADD      r1,r1,#1              ;4863
0026a4  b249              SXTB     r1,r1                 ;4863
0026a6  5419              STRB     r1,[r3,r0]            ;4863
0026a8  290a              CMP      r1,#0xa               ;4864
0026aa  db11              BLT      |L1.9936|
0026ac  f805a000          STRB     r10,[r5,r0]           ;4866
0026b0  e00e              B        |L1.9936|
                  |L1.9906|
0026b2  f803b000          STRB     r11,[r3,r0]
0026b6  e00b              B        |L1.9936|
                  |L1.9912|
;;;4872   			}
;;;4873                  
;;;4874   		}
;;;4875   	else
;;;4876   		{
;;;4877   		if(sk_cnt[i]>0)
0026b8  5619              LDRSB    r1,[r3,r0]
0026ba  2900              CMP      r1,#0
0026bc  dd07              BLE      |L1.9934|
;;;4878   			{
;;;4879   			sk_cnt[i]--;
0026be  f1a10101          SUB      r1,r1,#1
0026c2  b249              SXTB     r1,r1
0026c4  5419              STRB     r1,[r3,r0]
;;;4880   			if(sk_cnt[i]<=0)
0026c6  2900              CMP      r1,#0
0026c8  dc02              BGT      |L1.9936|
;;;4881   				{
;;;4882   				sk_stat[i]=ssOFF;
0026ca  542e              STRB     r6,[r5,r0]
0026cc  e000              B        |L1.9936|
                  |L1.9934|
;;;4883   				}
;;;4884   			}
;;;4885   		else 
;;;4886   			{
;;;4887   			sk_cnt[i]=0;
0026ce  541e              STRB     r6,[r3,r0]
                  |L1.9936|
0026d0  f1000001          ADD      r0,r0,#1              ;4825
0026d4  b2c0              UXTB     r0,r0                 ;4825
                  |L1.9942|
0026d6  42a0              CMP      r0,r4                 ;4825
0026d8  dbd6              BLT      |L1.9864|
;;;4888   			}
;;;4889   		}
;;;4890   	}
;;;4891   
;;;4892   for(i=0;i<NUMSK;i++)
0026da  f04f0400          MOV      r4,#0
;;;4893   	{
;;;4894   	if(((SK_SIGN[i]==0)&&(sk_stat[i]==ssON))||((SK_SIGN[i])&&(sk_stat[i]==ssOFF)) )
;;;4895   		{
;;;4896   		if(sk_av_cnt[i]<10)
0026de  f8df9278          LDR      r9,|L1.10584|
;;;4897   			{
;;;4898   			sk_av_cnt[i]++;
;;;4899   			if(sk_av_cnt[i]>=10)
;;;4900   				{
;;;4901   				sk_av_stat[i]=sasON;
0026e2  4f9e              LDR      r7,|L1.10588|
;;;4902   				}
;;;4903   			}
;;;4904   		else 
;;;4905   			{
;;;4906   			sk_av_cnt[i]=10;
;;;4907   			}
;;;4908   		}
;;;4909   	else
;;;4910   		{
;;;4911   		if(sk_av_cnt[i]>=0)
;;;4912   			{
;;;4913   			sk_av_cnt[i]--;
;;;4914   			if(sk_av_cnt[i]<=0)
;;;4915   				{
;;;4916   				sk_av_stat[i]=sasOFF;
;;;4917   				}
;;;4918   			}
;;;4919   		else 
;;;4920   			{
;;;4921   			sk_av_cnt[i]=0;
;;;4922   			}
;;;4923   		}
;;;4924   
;;;4925   #ifndef UKU_KONTUR
;;;4926   	if(sk_av_stat_old[i]!=sk_av_stat[i])
0026e4  f8df8278          LDR      r8,|L1.10592|
0026e8  e083              B        |L1.10226|
                  |L1.9962|
0026ea  489e              LDR      r0,|L1.10596|
0026ec  f9300014          LDRSH    r0,[r0,r4,LSL #1]     ;4894
0026f0  b910              CBNZ     r0,|L1.9976|
0026f2  5d29              LDRB     r1,[r5,r4]            ;4894
0026f4  2901              CMP      r1,#1                 ;4894
0026f6  d00f              BEQ      |L1.10008|
                  |L1.9976|
0026f8  b108              CBZ      r0,|L1.9982|
0026fa  5d28              LDRB     r0,[r5,r4]            ;4894
0026fc  b160              CBZ      r0,|L1.10008|
                  |L1.9982|
0026fe  f9190004          LDRSB    r0,[r9,r4]            ;4911
002702  2800              CMP      r0,#0                 ;4911
002704  db19              BLT      |L1.10042|
002706  f1a00001          SUB      r0,r0,#1              ;4913
00270a  b240              SXTB     r0,r0                 ;4913
00270c  f8090004          STRB     r0,[r9,r4]            ;4913
002710  2800              CMP      r0,#0                 ;4914
002712  dc14              BGT      |L1.10046|
002714  553e              STRB     r6,[r7,r4]            ;4916
002716  e012              B        |L1.10046|
                  |L1.10008|
002718  f9190004          LDRSB    r0,[r9,r4]            ;4896
00271c  280a              CMP      r0,#0xa               ;4896
00271e  da09              BGE      |L1.10036|
002720  f1000001          ADD      r0,r0,#1              ;4898
002724  b240              SXTB     r0,r0                 ;4898
002726  f8090004          STRB     r0,[r9,r4]            ;4898
00272a  280a              CMP      r0,#0xa               ;4899
00272c  db07              BLT      |L1.10046|
00272e  f807a004          STRB     r10,[r7,r4]           ;4901
002732  e004              B        |L1.10046|
                  |L1.10036|
002734  f809b004          STRB     r11,[r9,r4]           ;4906
002738  e001              B        |L1.10046|
                  |L1.10042|
00273a  f8096004          STRB     r6,[r9,r4]            ;4921
                  |L1.10046|
00273e  f8181004          LDRB     r1,[r8,r4]
002742  5d38              LDRB     r0,[r7,r4]
002744  4281              CMP      r1,r0
002746  d04e              BEQ      |L1.10214|
;;;4927   		{
;;;4928   		plazma_sk++;
002748  4a77              LDR      r2,|L1.10536|
00274a  3a38              SUBS     r2,r2,#0x38
00274c  8ed1              LDRH     r1,[r2,#0x36]  ; plazma_sk
00274e  f1010101          ADD      r1,r1,#1
002752  86d1              STRH     r1,[r2,#0x36]
;;;4929   		if(sk_av_stat[i]==sasON)
002754  2801              CMP      r0,#1
002756  d007              BEQ      |L1.10088|
;;;4930   			{
;;;4931   			if(i==0)snmp_trap_send("SK #1 Alarm",15,1,1);
;;;4932   			else if(i==1)
;;;4933   				{
;;;4934   				#ifndef UKU_TELEKORE2017
;;;4935   				snmp_trap_send("SK #2 Alarm",15,2,1);
;;;4936   				#endif
;;;4937   				#ifdef UKU_TELEKORE2017
;;;4938   				snmp_trap_send("Door open",15,2,1);
;;;4939   				#endif
;;;4940   				}
;;;4941   			else if(i==2)snmp_trap_send("SK #3 Alarm",15,3,1);
;;;4942   			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;4943   			}
;;;4944   		else 
;;;4945   			{
;;;4946   			if(i==0)snmp_trap_send("SK #1 Alarm is off",15,1,0);
002758  b354              CBZ      r4,|L1.10160|
;;;4947   			else if(i==1)
00275a  2c01              CMP      r4,#1
00275c  d02f              BEQ      |L1.10174|
;;;4948   				{
;;;4949   				#ifndef UKU_TELEKORE2017
;;;4950   				snmp_trap_send("SK #2 Alarm is off",15,2,0);
;;;4951   				#endif
;;;4952   				#ifdef UKU_TELEKORE2017
;;;4953   				snmp_trap_send("Door open clear",15,2,0);
;;;4954   				#endif
;;;4955   				}
;;;4956   			else if(i==2)snmp_trap_send("SK #3 Alarm is off",15,3,0);
00275e  2c02              CMP      r4,#2
002760  d034              BEQ      |L1.10188|
;;;4957   			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
002762  2c03              CMP      r4,#3
002764  d039              BEQ      |L1.10202|
002766  e03e              B        |L1.10214|
                  |L1.10088|
002768  b134              CBZ      r4,|L1.10104|
00276a  2c01              CMP      r4,#1                 ;4932
00276c  d00b              BEQ      |L1.10118|
00276e  2c02              CMP      r4,#2                 ;4941
002770  d010              BEQ      |L1.10132|
002772  2c03              CMP      r4,#3                 ;4942
002774  d015              BEQ      |L1.10146|
002776  e036              B        |L1.10214|
                  |L1.10104|
002778  2301              MOVS     r3,#1                 ;4931
00277a  461a              MOV      r2,r3                 ;4931
00277c  210f              MOVS     r1,#0xf               ;4931
00277e  a07a              ADR      r0,|L1.10600|
002780  f7fffffe          BL       snmp_trap_send
002784  e02f              B        |L1.10214|
                  |L1.10118|
002786  2301              MOVS     r3,#1                 ;4935
002788  2202              MOVS     r2,#2                 ;4935
00278a  210f              MOVS     r1,#0xf               ;4935
00278c  a079              ADR      r0,|L1.10612|
00278e  f7fffffe          BL       snmp_trap_send
002792  e028              B        |L1.10214|
                  |L1.10132|
002794  2301              MOVS     r3,#1                 ;4941
002796  2203              MOVS     r2,#3                 ;4941
002798  210f              MOVS     r1,#0xf               ;4941
00279a  a079              ADR      r0,|L1.10624|
00279c  f7fffffe          BL       snmp_trap_send
0027a0  e021              B        |L1.10214|
                  |L1.10146|
0027a2  2301              MOVS     r3,#1                 ;4942
0027a4  2204              MOVS     r2,#4                 ;4942
0027a6  210f              MOVS     r1,#0xf               ;4942
0027a8  a078              ADR      r0,|L1.10636|
0027aa  f7fffffe          BL       snmp_trap_send
0027ae  e01a              B        |L1.10214|
                  |L1.10160|
0027b0  2300              MOVS     r3,#0                 ;4946
0027b2  2201              MOVS     r2,#1                 ;4946
0027b4  210f              MOVS     r1,#0xf               ;4946
0027b6  a078              ADR      r0,|L1.10648|
0027b8  f7fffffe          BL       snmp_trap_send
0027bc  e013              B        |L1.10214|
                  |L1.10174|
0027be  2300              MOVS     r3,#0                 ;4950
0027c0  2202              MOVS     r2,#2                 ;4950
0027c2  210f              MOVS     r1,#0xf               ;4950
0027c4  a079              ADR      r0,|L1.10668|
0027c6  f7fffffe          BL       snmp_trap_send
0027ca  e00c              B        |L1.10214|
                  |L1.10188|
0027cc  2300              MOVS     r3,#0                 ;4956
0027ce  2203              MOVS     r2,#3                 ;4956
0027d0  210f              MOVS     r1,#0xf               ;4956
0027d2  a07b              ADR      r0,|L1.10688|
0027d4  f7fffffe          BL       snmp_trap_send
0027d8  e005              B        |L1.10214|
                  |L1.10202|
0027da  2300              MOVS     r3,#0
0027dc  2204              MOVS     r2,#4
0027de  210f              MOVS     r1,#0xf
0027e0  a07c              ADR      r0,|L1.10708|
0027e2  f7fffffe          BL       snmp_trap_send
                  |L1.10214|
;;;4958   			}
;;;4959   	 	}
;;;4960   #endif
;;;4961   
;;;4962   #ifdef UKU_KONTUR
;;;4963   	if(sk_av_stat_old[i]!=sk_av_stat[i])
;;;4964   		{
;;;4965   		plazma_sk++;
;;;4966   		if(sk_av_stat[i]==sasON)
;;;4967   			{
;;;4968   			if(i==0)snmp_trap_send("Door is opened",15,1,1);
;;;4969   			else if(i==1)snmp_trap_send("Smoke Alarm",15,2,1);
;;;4970   			else if(i==2)snmp_trap_send("Shock Sensor Alarm",15,3,1);
;;;4971   			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;4972   			}
;;;4973   		else 
;;;4974   			{
;;;4975   			if(i==0)snmp_trap_send("Door is closed",15,1,0);
;;;4976   			else if(i==1)snmp_trap_send("Smoke Alarm is off",15,2,0);
;;;4977   			else if(i==2)snmp_trap_send("Shock Sensor Alarm is off",15,3,0);
;;;4978   			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
;;;4979   			}
;;;4980   	 	}
;;;4981   #endif
;;;4982   	sk_av_stat_old[i]=sk_av_stat[i];
0027e6  5d38              LDRB     r0,[r7,r4]
0027e8  f8080004          STRB     r0,[r8,r4]
0027ec  f1040401          ADD      r4,r4,#1              ;4892
0027f0  b2e4              UXTB     r4,r4                 ;4892
                  |L1.10226|
0027f2  4857              LDR      r0,|L1.10576|
0027f4  f9b00000          LDRSH    r0,[r0,#0]            ;4892  ; NUMSK
0027f8  4284              CMP      r4,r0                 ;4892
0027fa  f6ffaf76          BLT      |L1.9962|
                  |L1.10238|
;;;4983   	}
;;;4984   }
0027fe  e8bd9ff0          POP      {r4-r12,pc}
;;;4985   
                          ENDP

                  zar_superviser_start PROC
;;;5022   //-----------------------------------------------
;;;5023   void zar_superviser_start(void)
002802  4a79              LDR      r2,|L1.10728|
;;;5024   {
;;;5025   sign_U[0]=1;
002804  f04f0001          MOV      r0,#1
002808  7010              STRB     r0,[r2,#0]
;;;5026   sign_I[0]=1;
00280a  4978              LDR      r1,|L1.10732|
00280c  7008              STRB     r0,[r1,#0]
;;;5027   sign_U[1]=1;
00280e  7050              STRB     r0,[r2,#1]
;;;5028   sign_I[1]=1;
002810  7048              STRB     r0,[r1,#1]
;;;5029   
;;;5030   }
002812  4770              BX       lr
;;;5031   
                          ENDP

                  zar_superviser_drv PROC
;;;4987   //-----------------------------------------------
;;;4988   void zar_superviser_drv(void)
002814  e92d5ff0          PUSH     {r4-r12,lr}
;;;4989   {
;;;4990   
;;;4991   if(((bat[0]._Ub>u_necc_up) || (bat[0]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[0]=0;
002818  4876              LDR      r0,|L1.10740|
00281a  f8df91dc          LDR      r9,|L1.10744|
00281e  f8df81d0          LDR      r8,|L1.10736|
002822  f9b0c000          LDRSH    r12,[r0,#0]  ; u_necc_up
002826  f9b90000          LDRSH    r0,[r9,#0]
00282a  4c3f              LDR      r4,|L1.10536|
00282c  ebc01100          RSB      r1,r0,r0,LSL #4
002830  3c38              SUBS     r4,r4,#0x38
002832  f9b87002          LDRSH    r7,[r8,#2]  ; bat
002836  f06f0a1d          MVN      r10,#0x1d
00283a  f06f0b95          MVN      r11,#0x95
00283e  2500              MOVS     r5,#0
002840  4e69              LDR      r6,|L1.10728|
002842  f9b40044          LDRSH    r0,[r4,#0x44]
002846  eb0a0281          ADD      r2,r10,r1,LSL #2
00284a  eb0b0381          ADD      r3,r11,r1,LSL #2
00284e  4567              CMP      r7,r12
002850  dc05              BGT      |L1.10334|
002852  f8dfc1a8          LDR      r12,|L1.10748|
002856  f9bcc000          LDRSH    r12,[r12,#0]  ; u_necc_dn
00285a  4567              CMP      r7,r12
00285c  da04              BGE      |L1.10344|
                  |L1.10334|
00285e  4282              CMP      r2,r0
002860  dd02              BLE      |L1.10344|
002862  4283              CMP      r3,r0
002864  da00              BGE      |L1.10344|
002866  7035              STRB     r5,[r6,#0]
                  |L1.10344|
;;;4992   
;;;4993   if(((bat[0]._Ib>(2*IKB)) || (bat[0]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[0]=0;
002868  4f65              LDR      r7,|L1.10752|
00286a  f9b8c008          LDRSH    r12,[r8,#8]  ; bat
00286e  f9b7e000          LDRSH    lr,[r7,#0]  ; IKB
002872  4f5e              LDR      r7,|L1.10732|
002874  ebbc0f4e          CMP      r12,lr,LSL #1
002878  dc04              BGT      |L1.10372|
00287a  f1ce0e00          RSB      lr,lr,#0
00287e  ebbc0f4e          CMP      r12,lr,LSL #1
002882  da04              BGE      |L1.10382|
                  |L1.10372|
002884  4282              CMP      r2,r0
002886  dd02              BLE      |L1.10382|
002888  4283              CMP      r3,r0
00288a  da00              BGE      |L1.10382|
00288c  703d              STRB     r5,[r7,#0]
                  |L1.10382|
;;;4994   																 
;;;4995   if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
00288e  f06f0209          MVN      r2,#9
002892  eb020181          ADD      r1,r2,r1,LSL #2
002896  4281              CMP      r1,r0
002898  d120              BNE      |L1.10460|
00289a  7da0              LDRB     r0,[r4,#0x16]  ; spc_stat
00289c  b9f0              CBNZ     r0,|L1.10460|
;;;4996   	{
;;;4997   	if((sign_U[0]==1) && (sign_I[0]==1) && (lc640_read_int(EE_BAT1_ZAR_CNT)!=BAT_C_REAL[0]) && (NUMBAT) && (!(bat[0]._av&1)))
00289e  7830              LDRB     r0,[r6,#0]  ; sign_U
0028a0  2801              CMP      r0,#1
0028a2  d11b              BNE      |L1.10460|
0028a4  7838              LDRB     r0,[r7,#0]  ; sign_I
0028a6  2801              CMP      r0,#1
0028a8  d118              BNE      |L1.10460|
0028aa  f44f70d6          MOV      r0,#0x1ac
0028ae  f7fffffe          BL       lc640_read_int
0028b2  4954              LDR      r1,|L1.10756|
0028b4  f9b11000          LDRSH    r1,[r1,#0]  ; BAT_C_REAL
0028b8  4288              CMP      r0,r1
0028ba  d00f              BEQ      |L1.10460|
0028bc  4852              LDR      r0,|L1.10760|
0028be  8800              LDRH     r0,[r0,#0]  ; NUMBAT
0028c0  b160              CBZ      r0,|L1.10460|
0028c2  f898003d          LDRB     r0,[r8,#0x3d]  ; bat
0028c6  07c0              LSLS     r0,r0,#31
0028c8  d108              BNE      |L1.10460|
;;;4998   		{
;;;4999   		lc640_write_int(EE_BAT1_ZAR_CNT,BAT_C_REAL[0]);
0028ca  f44f70d6          MOV      r0,#0x1ac
0028ce  f7fffffe          BL       lc640_write_int
;;;5000   		superviser_cnt++;
0028d2  484e              LDR      r0,|L1.10764|
0028d4  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
0028d6  f1010101          ADD      r1,r1,#1
0028da  7001              STRB     r1,[r0,#0]
                  |L1.10460|
;;;5001   		}
;;;5002   	
;;;5003   	}
;;;5004   
;;;5005   if(((bat[0]._Ub>u_necc_up) || (bat[1]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[1]=0;
0028dc  4845              LDR      r0,|L1.10740|
0028de  f9b81002          LDRSH    r1,[r8,#2]  ; bat
0028e2  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_up
0028e6  4281              CMP      r1,r0
0028e8  dc06              BGT      |L1.10488|
0028ea  4844              LDR      r0,|L1.10748|
0028ec  f9b8104e          LDRSH    r1,[r8,#0x4e]  ; bat
0028f0  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_dn
0028f4  4281              CMP      r1,r0
0028f6  da0e              BGE      |L1.10518|
                  |L1.10488|
0028f8  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
0028fc  f9b41044          LDRSH    r1,[r4,#0x44]  ; main_kb_cnt
002900  ebc01000          RSB      r0,r0,r0,LSL #4
002904  eb0a0280          ADD      r2,r10,r0,LSL #2
002908  428a              CMP      r2,r1
00290a  dd04              BLE      |L1.10518|
00290c  eb0b0080          ADD      r0,r11,r0,LSL #2
002910  4288              CMP      r0,r1
002912  da00              BGE      |L1.10518|
002914  7075              STRB     r5,[r6,#1]
                  |L1.10518|
;;;5006   
;;;5007   if(((bat[1]._Ib>(2*IKB)) || (bat[1]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[1]=0;
002916  f9b80054          LDRSH    r0,[r8,#0x54]  ; bat
00291a  4939              LDR      r1,|L1.10752|
00291c  e078              B        |L1.10768|
00291e  0000              DCW      0x0000
                  |L1.10528|
                          DCD      UOUT_
                  |L1.10532|
                          DCD      in_U
                  |L1.10536|
                          DCD      ||area_number.26||+0x38
                  |L1.10540|
                          DCD      ||.bss||+0x440
                  |L1.10544|
                          DCD      _x_reg
                  |L1.10548|
                          DCD      NUMIST
                  |L1.10552|
                          DCD      _x_reg_cnt
                  |L1.10556|
                          DCD      UOUT
                  |L1.10560|
                          DCD      out_U
                  |L1.10564|
                          DCD      vd_U
                  |L1.10568|
                          DCD      sk_cnt
                  |L1.10572|
                          DCD      sk_stat
                  |L1.10576|
                          DCD      NUMSK
                  |L1.10580|
                          DCD      ||area_number.20||
                  |L1.10584|
                          DCD      sk_av_cnt
                  |L1.10588|
                          DCD      sk_av_stat
                  |L1.10592|
                          DCD      sk_av_stat_old
                  |L1.10596|
                          DCD      SK_SIGN
                  |L1.10600|
002968  534b2023          DCB      "SK #1 Alarm",0
00296c  3120416c
002970  61726d00
                  |L1.10612|
002974  534b2023          DCB      "SK #2 Alarm",0
002978  3220416c
00297c  61726d00
                  |L1.10624|
002980  534b2023          DCB      "SK #3 Alarm",0
002984  3320416c
002988  61726d00
                  |L1.10636|
00298c  534b2023          DCB      "SK #4 Alarm",0
002990  3420416c
002994  61726d00
                  |L1.10648|
002998  534b2023          DCB      "SK #1 Alarm is off",0
00299c  3120416c
0029a0  61726d20
0029a4  6973206f
0029a8  666600  
0029ab  00                DCB      0
                  |L1.10668|
0029ac  534b2023          DCB      "SK #2 Alarm is off",0
0029b0  3220416c
0029b4  61726d20
0029b8  6973206f
0029bc  666600  
0029bf  00                DCB      0
                  |L1.10688|
0029c0  534b2023          DCB      "SK #3 Alarm is off",0
0029c4  3320416c
0029c8  61726d20
0029cc  6973206f
0029d0  666600  
0029d3  00                DCB      0
                  |L1.10708|
0029d4  534b2023          DCB      "SK #4 Alarm is off",0
0029d8  3420416c
0029dc  61726d20
0029e0  6973206f
0029e4  666600  
0029e7  00                DCB      0
                  |L1.10728|
                          DCD      sign_U
                  |L1.10732|
                          DCD      sign_I
                  |L1.10736|
                          DCD      bat
                  |L1.10740|
                          DCD      u_necc_up
                  |L1.10744|
                          DCD      TBAT
                  |L1.10748|
                          DCD      u_necc_dn
                  |L1.10752|
                          DCD      IKB
                  |L1.10756|
                          DCD      BAT_C_REAL
                  |L1.10760|
                          DCD      NUMBAT
                  |L1.10764|
                          DCD      superviser_cnt
                  |L1.10768|
002a10  f9b11000          LDRSH    r1,[r1,#0]  ; IKB
002a14  ebb00f41          CMP      r0,r1,LSL #1
002a18  dc03              BGT      |L1.10786|
002a1a  4249              RSBS     r1,r1,#0
002a1c  ebb00f41          CMP      r0,r1,LSL #1
002a20  da0e              BGE      |L1.10816|
                  |L1.10786|
002a22  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
002a26  f9b41044          LDRSH    r1,[r4,#0x44]  ; main_kb_cnt
002a2a  ebc01000          RSB      r0,r0,r0,LSL #4
002a2e  eb0a0280          ADD      r2,r10,r0,LSL #2
002a32  428a              CMP      r2,r1
002a34  dd04              BLE      |L1.10816|
002a36  eb0b0080          ADD      r0,r11,r0,LSL #2
002a3a  4288              CMP      r0,r1
002a3c  da00              BGE      |L1.10816|
002a3e  707d              STRB     r5,[r7,#1]
                  |L1.10816|
;;;5008   																 
;;;5009   if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
002a40  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
002a44  ebc01100          RSB      r1,r0,r0,LSL #4
002a48  f06f0009          MVN      r0,#9
002a4c  eb000081          ADD      r0,r0,r1,LSL #2
002a50  f9b41044          LDRSH    r1,[r4,#0x44]  ; main_kb_cnt
002a54  4288              CMP      r0,r1
002a56  d121              BNE      |L1.10908|
002a58  7da0              LDRB     r0,[r4,#0x16]  ; spc_stat
002a5a  b9f8              CBNZ     r0,|L1.10908|
;;;5010   	{
;;;5011   	if((sign_U[1]==1) && (sign_I[1]==1) && (lc640_read_int(EE_BAT2_ZAR_CNT)!=BAT_C_REAL[1]) && (NUMBAT==2) && (!(bat[1]._av&1)))
002a5c  7870              LDRB     r0,[r6,#1]  ; sign_U
002a5e  2801              CMP      r0,#1
002a60  d11c              BNE      |L1.10908|
002a62  7878              LDRB     r0,[r7,#1]  ; sign_I
002a64  2801              CMP      r0,#1
002a66  d119              BNE      |L1.10908|
002a68  f44f75e5          MOV      r5,#0x1ca
002a6c  4628              MOV      r0,r5
002a6e  f7fffffe          BL       lc640_read_int
002a72  49ff              LDR      r1,|L1.11888|
002a74  f9b11002          LDRSH    r1,[r1,#2]  ; BAT_C_REAL
002a78  4288              CMP      r0,r1
002a7a  d00f              BEQ      |L1.10908|
002a7c  48fd              LDR      r0,|L1.11892|
002a7e  8800              LDRH     r0,[r0,#0]  ; NUMBAT
002a80  2802              CMP      r0,#2
002a82  d10b              BNE      |L1.10908|
002a84  f8980089          LDRB     r0,[r8,#0x89]  ; bat
002a88  07c0              LSLS     r0,r0,#31
002a8a  d107              BNE      |L1.10908|
;;;5012   		{
;;;5013   		lc640_write_int(EE_BAT2_ZAR_CNT,BAT_C_REAL[1]);
002a8c  4628              MOV      r0,r5
002a8e  f7fffffe          BL       lc640_write_int
;;;5014   		superviser_cnt++;
002a92  48f9              LDR      r0,|L1.11896|
002a94  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
002a96  f1010101          ADD      r1,r1,#1
002a9a  7001              STRB     r1,[r0,#0]
                  |L1.10908|
;;;5015   		}
;;;5016   	
;;;5017   	}
;;;5018   
;;;5019   if(main_kb_cnt==((TBAT*60)-2)) zar_superviser_start();
002a9c  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
002aa0  f06f0101          MVN      r1,#1
002aa4  ebc01000          RSB      r0,r0,r0,LSL #4
002aa8  eb010080          ADD      r0,r1,r0,LSL #2
002aac  f9b41044          LDRSH    r1,[r4,#0x44]  ; main_kb_cnt
002ab0  4288              CMP      r0,r1
002ab2  d102              BNE      |L1.10938|
002ab4  e8bd5ff0          POP      {r4-r12,lr}
002ab8  e7fe              B        zar_superviser_start
                  |L1.10938|
;;;5020   }
002aba  e6a0              B        |L1.10238|
;;;5021   
                          ENDP

                  npn_hndl PROC
;;;5032   //-----------------------------------------------
;;;5033   void npn_hndl(void)
002abc  e92d03f0          PUSH     {r4-r9}
;;;5034   {
;;;5035   if(NPN_OUT!=npnoOFF)
002ac0  48ee              LDR      r0,|L1.11900|
;;;5036   	{
;;;5037   /*	if(NPN_SIGN==npnsAVNET)
;;;5038   		{
;;;5039   		if(net_av==1)
;;;5040   			{
;;;5041   			if(npn_tz_cnt<TZNPN)
;;;5042   				{
;;;5043   				npn_tz_cnt++;
;;;5044   				if(npn_tz_cnt==TZNPN)
;;;5045   					{
;;;5046   					npn_stat=npnsOFF;
;;;5047   					}
;;;5048   				}
;;;5049   			}
;;;5050   		else
;;;5051   			{
;;;5052   			if(npn_tz_cnt)
;;;5053   				{
;;;5054   				npn_tz_cnt--;
;;;5055   				if(npn_tz_cnt==0)
;;;5056   					{
;;;5057   					npn_stat=npnsON;
;;;5058   					}
;;;5059   				}
;;;5060   			}
;;;5061   		}*/
;;;5062   /*	if(NPN_SIGN==npnsULOAD)
;;;5063   		{
;;;5064   		if(load_U<UONPN)
;;;5065   			{
;;;5066   			if(npn_tz_cnt<TZNPN)
;;;5067   				{
;;;5068   				npn_tz_cnt++;
;;;5069   				if(npn_tz_cnt==TZNPN)
;;;5070   					{
;;;5071   					npn_stat=npnsOFF;
;;;5072   					}
;;;5073   				}
;;;5074   			}
;;;5075   		else if(load_U>UVNPN)
;;;5076   			{
;;;5077   			if(npn_tz_cnt)
;;;5078   				{
;;;5079   				npn_tz_cnt--;
;;;5080   				if(npn_tz_cnt==0)
;;;5081   					{
;;;5082   					npn_stat=npnsON;
;;;5083   					}
;;;5084   				}
;;;5085   			}
;;;5086   		}*/
;;;5087   
;;;5088   	if((load_U<UONPN)&&((net_Ua<UMN)||(net_Ub<UMN)||(net_Uc<UMN)))
;;;5089   		{
;;;5090   		if(npn_tz_cnt<TZNPN)
002ac2  4fef              LDR      r7,|L1.11904|
;;;5091   			{
;;;5092   			npn_tz_cnt++;
;;;5093   			if(npn_tz_cnt==TZNPN)
;;;5094   				{
;;;5095   				npn_stat=npnsOFF;
002ac4  4eef              LDR      r6,|L1.11908|
002ac6  7800              LDRB     r0,[r0,#0]            ;5035  ; NPN_OUT
002ac8  f04f0c00          MOV      r12,#0                ;5035
;;;5096   				}
;;;5097   			}
;;;5098   		}
;;;5099   	else if((load_U>UVNPN)&&(net_Ua>UMN)&&(net_Ub>UMN)&&(net_Uc>UMN))
;;;5100   		{
;;;5101   		if(npn_tz_cnt)
;;;5102   			{
;;;5103   			npn_tz_cnt--;
;;;5104   			if(npn_tz_cnt==0)
;;;5105   				{
;;;5106   				npn_stat=npnsON;
002acc  f04f0801          MOV      r8,#1
002ad0  b3e8              CBZ      r0,|L1.11086|
002ad2  48ed              LDR      r0,|L1.11912|
002ad4  4639              MOV      r1,r7                 ;5090
002ad6  f9b05000          LDRSH    r5,[r0,#0]            ;5088  ; load_U
002ada  48ec              LDR      r0,|L1.11916|
002adc  f9b11000          LDRSH    r1,[r1,#0]            ;5090
002ae0  f9b09000          LDRSH    r9,[r0,#0]            ;5088  ; UONPN
002ae4  48ea              LDR      r0,|L1.11920|
002ae6  454d              CMP      r5,r9                 ;5088
002ae8  f9b02000          LDRSH    r2,[r0,#0]            ;5088
002aec  48e9              LDR      r0,|L1.11924|
002aee  f9b03000          LDRSH    r3,[r0,#0]            ;5088
002af2  48e9              LDR      r0,|L1.11928|
002af4  f9b04000          LDRSH    r4,[r0,#0]            ;5088
002af8  48e8              LDR      r0,|L1.11932|
002afa  f9b00000          LDRSH    r0,[r0,#0]            ;5088
002afe  da13              BGE      |L1.11048|
002b00  4282              CMP      r2,r0                 ;5088
002b02  db03              BLT      |L1.11020|
002b04  4283              CMP      r3,r0                 ;5088
002b06  db01              BLT      |L1.11020|
002b08  4284              CMP      r4,r0                 ;5088
002b0a  da0d              BGE      |L1.11048|
                  |L1.11020|
002b0c  48e4              LDR      r0,|L1.11936|
002b0e  f9b02000          LDRSH    r2,[r0,#0]            ;5090  ; TZNPN
002b12  4291              CMP      r1,r2                 ;5090
002b14  da23              BGE      |L1.11102|
002b16  f1010101          ADD      r1,r1,#1              ;5092
002b1a  b208              SXTH     r0,r1                 ;5092
002b1c  8038              STRH     r0,[r7,#0]            ;5092
002b1e  4290              CMP      r0,r2                 ;5093
002b20  d11d              BNE      |L1.11102|
002b22  f886c000          STRB     r12,[r6,#0]           ;5095
002b26  e01a              B        |L1.11102|
                  |L1.11048|
002b28  f8dfc378          LDR      r12,|L1.11940|
002b2c  f9bcc000          LDRSH    r12,[r12,#0]          ;5099  ; UVNPN
002b30  4565              CMP      r5,r12                ;5099
002b32  dd14              BLE      |L1.11102|
002b34  4282              CMP      r2,r0                 ;5099
002b36  dd12              BLE      |L1.11102|
002b38  4283              CMP      r3,r0                 ;5099
002b3a  dd10              BLE      |L1.11102|
002b3c  4284              CMP      r4,r0                 ;5099
002b3e  dd0e              BLE      |L1.11102|
002b40  b169              CBZ      r1,|L1.11102|
002b42  f1a10101          SUB      r1,r1,#1              ;5103
002b46  b208              SXTH     r0,r1                 ;5103
002b48  8038              STRH     r0,[r7,#0]            ;5103
002b4a  b940              CBNZ     r0,|L1.11102|
002b4c  e000              B        |L1.11088|
                  |L1.11086|
002b4e  e002              B        |L1.11094|
                  |L1.11088|
002b50  f8868000          STRB     r8,[r6,#0]
002b54  e003              B        |L1.11102|
                  |L1.11094|
;;;5107   				}
;;;5108   			}
;;;5109   		}
;;;5110   	}
;;;5111   else
;;;5112   	{
;;;5113   	npn_tz_cnt=0;
002b56  f8a7c000          STRH     r12,[r7,#0]
;;;5114   	npn_stat=npnsON;
002b5a  f8868000          STRB     r8,[r6,#0]
                  |L1.11102|
;;;5115   	}
;;;5116   
;;;5117   if(npn_stat==npnsOFF) mess_send(MESS2RELE_HNDL,PARAM_RELE_NPN,1,15);
002b5e  7830              LDRB     r0,[r6,#0]  ; npn_stat
002b60  2800              CMP      r0,#0
002b62  d107              BNE      |L1.11124|
002b64  e8bd03f0          POP      {r4-r9}
002b68  230f              MOVS     r3,#0xf
002b6a  2201              MOVS     r2,#1
002b6c  216e              MOVS     r1,#0x6e
002b6e  20d2              MOVS     r0,#0xd2
002b70  f7ffbffe          B.W      mess_send
                  |L1.11124|
;;;5118   
;;;5119   
;;;5120   }
002b74  e8bd03f0          POP      {r4-r9}
002b78  4770              BX       lr
;;;5121   
                          ENDP

                  numOfForvardBps_hndl PROC
;;;5215   //-----------------------------------------------
;;;5216   void	numOfForvardBps_hndl(void)			//ѕрограмма смены первого источника дл€ равномерного износа Ѕѕ—ов
002b7a  e92d41f0          PUSH     {r4-r8,lr}
;;;5217   {
;;;5218   
;;;5219   numOfForvardBps_old=numOfForvardBps;
002b7e  4cca              LDR      r4,|L1.11944|
002b80  7ea0              LDRB     r0,[r4,#0x1a]  ; numOfForvardBps
002b82  76e0              STRB     r0,[r4,#0x1b]
;;;5220   
;;;5221   numOfForvardBps=0;
002b84  f04f0500          MOV      r5,#0
002b88  76a5              STRB     r5,[r4,#0x1a]
;;;5222   
;;;5223   //FORVARDBPSCHHOUR=10;
;;;5224   
;;;5225   if((FORVARDBPSCHHOUR<=0)||(FORVARDBPSCHHOUR>500))
002b8a  4ec8              LDR      r6,|L1.11948|
002b8c  f9b60000          LDRSH    r0,[r6,#0]  ; FORVARDBPSCHHOUR
002b90  2800              CMP      r0,#0
002b92  dd02              BLE      |L1.11162|
002b94  f5b07ffa          CMP      r0,#0x1f4
002b98  dd02              BLE      |L1.11168|
                  |L1.11162|
;;;5226   	{
;;;5227   	FORVARDBPSCHHOUR=0;
002b9a  8035              STRH     r5,[r6,#0]
                  |L1.11164|
;;;5228   	return;
;;;5229   	}
;;;5230   
;;;5231   numOfForvardBps_minCnt++;
;;;5232   
;;;5233   
;;;5234   if(numOfForvardBps_minCnt>=60)
;;;5235   	{
;;;5236   	numOfForvardBps_minCnt=0;
;;;5237   	numOfForvardBps_hourCnt=lc640_read_int(EE_FORVBPSHOURCNT);
;;;5238   	numOfForvardBps_hourCnt++;
;;;5239   	if(numOfForvardBps_hourCnt>=(FORVARDBPSCHHOUR*NUMIST))
;;;5240   		{
;;;5241   		numOfForvardBps_hourCnt=0;
;;;5242   		}
;;;5243   	lc640_write_int(EE_FORVBPSHOURCNT,numOfForvardBps_hourCnt);
;;;5244   	}
;;;5245   
;;;5246   numOfForvardBps=numOfForvardBps_hourCnt/FORVARDBPSCHHOUR;
;;;5247   
;;;5248   //if(numOfForvardBps)
;;;5249   //numOfForvardBps_old=numOfForvardBps; 
;;;5250   }
002b9c  e8bd81f0          POP      {r4-r8,pc}
                  |L1.11168|
002ba0  7f20              LDRB     r0,[r4,#0x1c]         ;5231  ; numOfForvardBps_minCnt
002ba2  f1000001          ADD      r0,r0,#1              ;5231
002ba6  b2c0              UXTB     r0,r0                 ;5231
002ba8  7720              STRB     r0,[r4,#0x1c]         ;5231
002baa  283c              CMP      r0,#0x3c              ;5234
002bac  d31a              BCC      |L1.11236|
002bae  7725              STRB     r5,[r4,#0x1c]         ;5236
002bb0  f44f7794          MOV      r7,#0x128             ;5237
002bb4  4638              MOV      r0,r7                 ;5237
002bb6  f7fffffe          BL       lc640_read_int
002bba  f1000001          ADD      r0,r0,#1              ;5238
002bbe  b200              SXTH     r0,r0                 ;5238
002bc0  f8a40050          STRH     r0,[r4,#0x50]         ;5238
002bc4  4aba              LDR      r2,|L1.11952|
002bc6  f9b61000          LDRSH    r1,[r6,#0]            ;5239  ; FORVARDBPSCHHOUR
002bca  f9b22000          LDRSH    r2,[r2,#0]            ;5239  ; NUMIST
002bce  fb01f102          MUL      r1,r1,r2              ;5239
002bd2  4281              CMP      r1,r0                 ;5239
002bd4  dc01              BGT      |L1.11226|
002bd6  f8a45050          STRH     r5,[r4,#0x50]         ;5241
                  |L1.11226|
002bda  f9b41050          LDRSH    r1,[r4,#0x50]         ;5243  ; numOfForvardBps_hourCnt
002bde  4638              MOV      r0,r7                 ;5243
002be0  f7fffffe          BL       lc640_write_int
                  |L1.11236|
002be4  f9b40050          LDRSH    r0,[r4,#0x50]         ;5246  ; numOfForvardBps_hourCnt
002be8  f9b61000          LDRSH    r1,[r6,#0]            ;5246  ; FORVARDBPSCHHOUR
002bec  fb90f0f1          SDIV     r0,r0,r1              ;5246
002bf0  76a0              STRB     r0,[r4,#0x1a]         ;5246
002bf2  e7d3              B        |L1.11164|
;;;5251   
                          ENDP

                  numOfForvardBps_init PROC
;;;5252   //-----------------------------------------------
;;;5253   void	numOfForvardBps_init(void)			//ѕрограмма сброса системы смены первого источника дл€ равномерного износа Ѕѕ—ов
002bf4  b510              PUSH     {r4,lr}
;;;5254   {									//ƒолжна вызыватьс€ при изменении кол-ва источников в структуре
;;;5255   lc640_write_int(EE_FORVBPSHOURCNT,0);
002bf6  2100              MOVS     r1,#0
002bf8  f44f7094          MOV      r0,#0x128
002bfc  f7fffffe          BL       lc640_write_int
;;;5256   numOfForvardBps_minCnt=58;
002c00  49a9              LDR      r1,|L1.11944|
002c02  f04f003a          MOV      r0,#0x3a
002c06  7708              STRB     r0,[r1,#0x1c]
;;;5257   }
002c08  bd10              POP      {r4,pc}
;;;5258   
                          ENDP

                  vent_resurs_hndl PROC
;;;5304   //-----------------------------------------------
;;;5305   void vent_resurs_hndl(void)
002c0a  e92d41f0          PUSH     {r4-r8,lr}
;;;5306   {
;;;5307   char i;
;;;5308   char crc_in,crc_eval;
;;;5309   
;;;5310   for(i=0;i<NUMIST;i++)
002c0e  f04f0200          MOV      r2,#0
002c12  48a7              LDR      r0,|L1.11952|
;;;5311   	{
;;;5312   	if((bps[i]._buff[7]&0xc0)==0x00)
002c14  4fa7              LDR      r7,|L1.11956|
002c16  f9b06000          LDRSH    r6,[r0,#0]            ;5310
002c1a  e06c              B        |L1.11510|
                  |L1.11292|
002c1c  ebc21002          RSB      r0,r2,r2,LSL #4
002c20  eb0700c0          ADD      r0,r7,r0,LSL #3
002c24  7b41              LDRB     r1,[r0,#0xd]
002c26  098b              LSRS     r3,r1,#6
002c28  d006              BEQ      |L1.11320|
;;;5313   		{
;;;5314   		bps[i]._vent_resurs_temp[0]=bps[i]._buff[7];
;;;5315   		}
;;;5316   	else if((bps[i]._buff[7]&0xc0)==0x40)
002c2a  2301              MOVS     r3,#1
002c2c  ebb31f91          CMP      r3,r1,LSR #6
002c30  d105              BNE      |L1.11326|
;;;5317   		{
;;;5318   		bps[i]._vent_resurs_temp[1]=bps[i]._buff[7];
002c32  f880105b          STRB     r1,[r0,#0x5b]
002c36  e00f              B        |L1.11352|
                  |L1.11320|
002c38  f880105a          STRB     r1,[r0,#0x5a]         ;5314
002c3c  e00c              B        |L1.11352|
                  |L1.11326|
;;;5319   		}
;;;5320   	else if((bps[i]._buff[7]&0xc0)==0x80)
002c3e  2302              MOVS     r3,#2
002c40  ebb31f91          CMP      r3,r1,LSR #6
002c44  d102              BNE      |L1.11340|
;;;5321   		{
;;;5322   		bps[i]._vent_resurs_temp[2]=bps[i]._buff[7];
002c46  f880105c          STRB     r1,[r0,#0x5c]
002c4a  e005              B        |L1.11352|
                  |L1.11340|
;;;5323   		}
;;;5324   	else if((bps[i]._buff[7]&0xc0)==0xc0)
002c4c  2303              MOVS     r3,#3
002c4e  ebb31f91          CMP      r3,r1,LSR #6
002c52  d101              BNE      |L1.11352|
;;;5325   		{
;;;5326   		bps[i]._vent_resurs_temp[3]=bps[i]._buff[7];
002c54  f880105d          STRB     r1,[r0,#0x5d]
                  |L1.11352|
;;;5327   		}
;;;5328   	crc_in=0;
;;;5329   	crc_in|=(bps[i]._vent_resurs_temp[0]&0x30)>>4;
002c58  f8101f5a          LDRB     r1,[r0,#0x5a]!
002c5c  f3c11401          UBFX     r4,r1,#4,#2
;;;5330   	crc_in|=(bps[i]._vent_resurs_temp[1]&0x30)>>2;
002c60  7843              LDRB     r3,[r0,#1]
002c62  f0030530          AND      r5,r3,#0x30
002c66  ea440595          ORR      r5,r4,r5,LSR #2
;;;5331   	crc_in|=(bps[i]._vent_resurs_temp[2]&0x30);
002c6a  7884              LDRB     r4,[r0,#2]
002c6c  f0040c30          AND      r12,r4,#0x30
002c70  ea4c0c05          ORR      r12,r12,r5
;;;5332   	crc_in|=(bps[i]._vent_resurs_temp[3]&0x30)<<2;
002c74  78c5              LDRB     r5,[r0,#3]
002c76  f1a0005a          SUB      r0,r0,#0x5a
002c7a  f0050830          AND      r8,r5,#0x30
002c7e  ea4c0c88          ORR      r12,r12,r8,LSL #2
;;;5333   
;;;5334   	crc_eval =bps[i]._vent_resurs_temp[0]&0x0f;
002c82  f001010f          AND      r1,r1,#0xf
;;;5335   	crc_eval^=bps[i]._vent_resurs_temp[1]&0x0f;
002c86  f003030f          AND      r3,r3,#0xf
002c8a  ea830801          EOR      r8,r3,r1
;;;5336   	crc_eval^=bps[i]._vent_resurs_temp[2]&0x0f;
002c8e  f004040f          AND      r4,r4,#0xf
002c92  ea840808          EOR      r8,r4,r8
;;;5337   	crc_eval^=bps[i]._vent_resurs_temp[3]&0x0f;
002c96  f005050f          AND      r5,r5,#0xf
002c9a  ea850808          EOR      r8,r5,r8
;;;5338   
;;;5339   	if(crc_eval==crc_in)
002c9e  45e0              CMP      r8,r12
002ca0  d113              BNE      |L1.11466|
;;;5340   		{
;;;5341   		unsigned short temp_US;
;;;5342   		temp_US=0;
;;;5343   
;;;5344   		temp_US|=(bps[i]._vent_resurs_temp[3]&0x0f);
;;;5345   		temp_US<<=4;
002ca2  ea4f1505          LSL      r5,r5,#4
;;;5346   		temp_US|=(bps[i]._vent_resurs_temp[2]&0x0f);
002ca6  ea440405          ORR      r4,r4,r5
;;;5347   		temp_US<<=4;
002caa  ea4f1404          LSL      r4,r4,#4
;;;5348   		temp_US|=(bps[i]._vent_resurs_temp[1]&0x0f);
002cae  ea430304          ORR      r3,r3,r4
;;;5349   		temp_US<<=4;
002cb2  ea4f5303          LSL      r3,r3,#20
002cb6  ea4f4313          LSR      r3,r3,#16
;;;5350   		temp_US|=(bps[i]._vent_resurs_temp[0]&0x0f);
002cba  ea410103          ORR      r1,r1,r3
;;;5351   
;;;5352   		if(bps[i]._vent_resurs!=temp_US)bps[i]._vent_resurs=temp_US;
002cbe  f8b0305e          LDRH     r3,[r0,#0x5e]
002cc2  428b              CMP      r3,r1
002cc4  d001              BEQ      |L1.11466|
002cc6  f8a0105e          STRH     r1,[r0,#0x5e]
                  |L1.11466|
;;;5353   		}
;;;5354   
;;;5355   	if(bps[i]._vent_resurs>TVENTMAX*10)
002cca  497b              LDR      r1,|L1.11960|
002ccc  f8b0305e          LDRH     r3,[r0,#0x5e]
002cd0  f9b11000          LDRSH    r1,[r1,#0]  ; TVENTMAX
002cd4  eb010181          ADD      r1,r1,r1,LSL #2
002cd8  ebb30f41          CMP      r3,r1,LSL #1
002cdc  dd04              BLE      |L1.11496|
;;;5356   		{
;;;5357   		bps[i]._av|=(1<<4);
002cde  7841              LDRB     r1,[r0,#1]
002ce0  f0410110          ORR      r1,r1,#0x10
002ce4  7041              STRB     r1,[r0,#1]
002ce6  e003              B        |L1.11504|
                  |L1.11496|
;;;5358   		}
;;;5359   	else bps[i]._av&=~(1<<4);
002ce8  7841              LDRB     r1,[r0,#1]
002cea  f0210110          BIC      r1,r1,#0x10
002cee  7041              STRB     r1,[r0,#1]
                  |L1.11504|
002cf0  f1020201          ADD      r2,r2,#1              ;5310
002cf4  b2d2              UXTB     r2,r2                 ;5310
                  |L1.11510|
002cf6  42b2              CMP      r2,r6                 ;5310
002cf8  db90              BLT      |L1.11292|
;;;5360   	}
;;;5361   }
002cfa  e74f              B        |L1.11164|
;;;5362   
                          ENDP

                  vent_hndl PROC
;;;5363   //-----------------------------------------------
;;;5364   void vent_hndl(void)
002cfc  e92d4ff0          PUSH     {r4-r11,lr}
;;;5365   {
002d00  b087              SUB      sp,sp,#0x1c
;;;5366   if(RELEVENTSIGN==rvsAKB)
002d02  486e              LDR      r0,|L1.11964|
;;;5367   	{
;;;5368   	if(vent_stat==0)
002d04  4c68              LDR      r4,|L1.11944|
;;;5369   		{
;;;5370   		if	(
;;;5371   			(BAT_IS_ON[0]==bisON)&&((bat[0]._Tb>TVENTON)||(bat[0]._nd))
002d06  496e              LDR      r1,|L1.11968|
;;;5372   			||
;;;5373   			(BAT_IS_ON[1]==bisON)&&((bat[1]._Tb>TVENTON)||(bat[1]._nd))
;;;5374   			)
;;;5375   			{
;;;5376   			vent_stat=1;
;;;5377   			}
;;;5378   		}
;;;5379   	else if(vent_stat==1)
;;;5380   		{
;;;5381   		if	(
;;;5382   			((BAT_IS_ON[0]!=bisON)||((BAT_IS_ON[0]==bisON)&&(bat[0]._Tb<TVENTOFF)&&(!bat[0]._nd)))
002d08  4a6e              LDR      r2,|L1.11972|
002d0a  7800              LDRB     r0,[r0,#0]            ;5366  ; RELEVENTSIGN
002d0c  f9943000          LDRSB    r3,[r4,#0]            ;5368
002d10  f9b11000          LDRSH    r1,[r1,#0]            ;5371
002d14  f9b22000          LDRSH    r2,[r2,#0]
002d18  b148              CBZ      r0,|L1.11566|
;;;5383   			&&
;;;5384   			((BAT_IS_ON[1]!=bisON)||((BAT_IS_ON[1]==bisON)&&(bat[1]._Tb<TVENTOFF)&&(!bat[1]._nd)))
;;;5385   			)
;;;5386   			{
;;;5387   			vent_stat=0;
;;;5388   			}
;;;5389   		}
;;;5390   	}
;;;5391   else if(RELEVENTSIGN==rvsBPS)
002d1a  2802              CMP      r0,#2
002d1c  d03c              BEQ      |L1.11672|
;;;5392   	{
;;;5393   /*	if	(
;;;5394   		(((bps[0]._flags_tm&0x06)||(bps[0]._cnt>=30)))||
;;;5395   		(((bps[1]._flags_tm&0x06)||(bps[1]._cnt>=30))&&(NUMIST>1))||
;;;5396   		(((bps[2]._flags_tm&0x06)||(bps[2]._cnt>=30))&&(NUMIST>2))||
;;;5397   		(((bps[3]._flags_tm&0x06)||(bps[3]._cnt>=30))&&(NUMIST>3))||
;;;5398   		(((bps[4]._flags_tm&0x06)||(bps[4]._cnt>=30))&&(NUMIST>4))||
;;;5399   		(((bps[5]._flags_tm&0x06)||(bps[5]._cnt>=30))&&(NUMIST>5))||
;;;5400   		(((bps[6]._flags_tm&0x06)||(bps[6]._cnt>=30))&&(NUMIST>6))
;;;5401   		)
;;;5402   		{
;;;5403   		vent_stat=1;
;;;5404   		}
;;;5405   	else vent_stat=0;
;;;5406   	*/
;;;5407   
;;;5408   	if	(
;;;5409   		((NUMIST)&&((bps[0]._Ti>TVENTON)||(bps[0]._cnt>=30)))
;;;5410   		||
;;;5411   		((NUMIST>1)&&((bps[1]._Ti>TVENTON)||(bps[1]._cnt>=30)))
;;;5412   		||
;;;5413   		((NUMIST>2)&&((bps[2]._Ti>TVENTON)||(bps[2]._cnt>=30)))
;;;5414   		||
;;;5415   		((NUMIST>3)&&((bps[3]._Ti>TVENTON)||(bps[3]._cnt>=30)))
;;;5416   		||
;;;5417   		((NUMIST>4)&&((bps[4]._Ti>TVENTON)||(bps[4]._cnt>=30)))
;;;5418   		||
;;;5419   		((NUMIST>5)&&((bps[5]._Ti>TVENTON)||(bps[5]._cnt>=30)))
;;;5420   		||
;;;5421   		((NUMIST>6)&&((bps[6]._Ti>TVENTON)||(bps[6]._cnt>=30)))
;;;5422   		||
;;;5423   		((NUMIST>7)&&((bps[7]._Ti>TVENTON)||(bps[7]._cnt>=30)))
;;;5424   		)
;;;5425   		{
;;;5426   		vent_stat=1;
;;;5427   		}
;;;5428   	else if(vent_stat==1)
;;;5429   		{
;;;5430   		if	(
;;;5431   			((!NUMIST)||((NUMIST)&&(bps[0]._Ti<TVENTOFF)&&(bps[0]._cnt<10)))
;;;5432   			&&
;;;5433   			((NUMIST<2)||((NUMIST>=2)&&(bps[1]._Ti<TVENTOFF)&&(bps[1]._cnt<10)))
;;;5434   			&&
;;;5435   			((NUMIST<3)||((NUMIST>=3)&&(bps[2]._Ti<TVENTOFF)&&(bps[2]._cnt<10)))
;;;5436   			&&
;;;5437   			((NUMIST<4)||((NUMIST>=4)&&(bps[3]._Ti<TVENTOFF)&&(bps[3]._cnt<10)))
;;;5438   			&&
;;;5439   			((NUMIST<5)||((NUMIST>=5)&&(bps[4]._Ti<TVENTOFF)&&(bps[4]._cnt<10)))
;;;5440   			&&
;;;5441   			((NUMIST<6)||((NUMIST>=6)&&(bps[5]._Ti<TVENTOFF)&&(bps[5]._cnt<10)))
;;;5442   			&&
;;;5443   			((NUMIST<7)||((NUMIST>=7)&&(bps[6]._Ti<TVENTOFF)&&(bps[6]._cnt<10)))
;;;5444   			&&
;;;5445   			((NUMIST<8)||((NUMIST>=8)&&(bps[7]._Ti<TVENTOFF)&&(bps[7]._cnt<10)))
;;;5446   			)
;;;5447   			{
;;;5448   			vent_stat=0;
;;;5449   			}
;;;5450   		}
;;;5451   	}
;;;5452   else if(RELEVENTSIGN==rvsEXT)
002d1e  2801              CMP      r0,#1
002d20  d07e              BEQ      |L1.11808|
;;;5453   	{
;;;5454   	if	(
;;;5455   		((NUMDT)&&((t_ext[0]>TVENTON)||(ND_EXT[0])))
;;;5456   		||
;;;5457   		((NUMDT>1)&&((t_ext[1]>TVENTON)||(ND_EXT[1])))
;;;5458   		||
;;;5459   		((NUMDT>2)&&((t_ext[2]>TVENTON)||(ND_EXT[2])))
;;;5460   		)
;;;5461   		{
;;;5462   		vent_stat=1;
;;;5463   		}
;;;5464   	else if(vent_stat==1)
;;;5465   		{
;;;5466   		if	(
;;;5467   			((!NUMDT)||((NUMDT)&&(t_ext[0]<TVENTOFF)&&(!ND_EXT[0])))
;;;5468   			&&
;;;5469   			((NUMDT<2)||((NUMDT>=2)&&(t_ext[1]<TVENTOFF)&&(!ND_EXT[1])))
;;;5470   			&&
;;;5471   			((NUMDT<3)||((NUMDT>=3)&&(t_ext[2]<TVENTOFF)&&(!ND_EXT[2])))
;;;5472   			)
;;;5473   			{
;;;5474   			vent_stat=0;
;;;5475   			}
;;;5476   		}
;;;5477   	}
;;;5478   else vent_stat=1;
002d22  f04f0001          MOV      r0,#1
002d26  7020              STRB     r0,[r4,#0]
                  |L1.11560|
;;;5479   }
002d28  b007              ADD      sp,sp,#0x1c
002d2a  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.11566|
002d2e  4f66              LDR      r7,|L1.11976|
002d30  f8df8198          LDR      r8,|L1.11980|
002d34  f9b7000a          LDRSH    r0,[r7,#0xa]          ;5371
002d38  7b3d              LDRB     r5,[r7,#0xc]          ;5371
002d3a  f9b76056          LDRSH    r6,[r7,#0x56]         ;5373
002d3e  f898c000          LDRB     r12,[r8,#0]           ;5370
002d42  f8977058          LDRB     r7,[r7,#0x58]         ;5373
002d46  f8988001          LDRB     r8,[r8,#1]            ;5373
002d4a  b12b              CBZ      r3,|L1.11608|
002d4c  2b01              CMP      r3,#1                 ;5379
002d4e  d1eb              BNE      |L1.11560|
002d50  f1bc0f55          CMP      r12,#0x55             ;5381
002d54  d115              BNE      |L1.11650|
002d56  e010              B        |L1.11642|
                  |L1.11608|
002d58  f1bc0f55          CMP      r12,#0x55             ;5370
002d5c  d102              BNE      |L1.11620|
002d5e  4288              CMP      r0,r1                 ;5371
002d60  dc07              BGT      |L1.11634|
002d62  b935              CBNZ     r5,|L1.11634|
                  |L1.11620|
002d64  f1b80f55          CMP      r8,#0x55              ;5373
002d68  d1de              BNE      |L1.11560|
002d6a  428e              CMP      r6,r1                 ;5373
002d6c  dc01              BGT      |L1.11634|
002d6e  2f00              CMP      r7,#0                 ;5373
002d70  d0da              BEQ      |L1.11560|
                  |L1.11634|
002d72  f04f0001          MOV      r0,#1                 ;5376
002d76  7020              STRB     r0,[r4,#0]            ;5376
002d78  e7d6              B        |L1.11560|
                  |L1.11642|
002d7a  4290              CMP      r0,r2                 ;5382
002d7c  dad4              BGE      |L1.11560|
002d7e  2d00              CMP      r5,#0                 ;5382
002d80  d1d2              BNE      |L1.11560|
                  |L1.11650|
002d82  f1b80f55          CMP      r8,#0x55              ;5384
002d86  d103              BNE      |L1.11664|
002d88  4296              CMP      r6,r2                 ;5384
002d8a  dacd              BGE      |L1.11560|
002d8c  2f00              CMP      r7,#0                 ;5384
002d8e  d1cb              BNE      |L1.11560|
                  |L1.11664|
002d90  f04f0000          MOV      r0,#0                 ;5387
002d94  7020              STRB     r0,[r4,#0]            ;5387
002d96  e7c7              B        |L1.11560|
                  |L1.11672|
002d98  4e46              LDR      r6,|L1.11956|
002d9a  4845              LDR      r0,|L1.11952|
002d9c  6ab5              LDR      r5,[r6,#0x28]         ;5409
002d9e  f9b00000          LDRSH    r0,[r0,#0]            ;5408  ; NUMIST
002da2  78f6              LDRB     r6,[r6,#3]            ;5409
002da4  b118              CBZ      r0,|L1.11694|
002da6  428d              CMP      r5,r1                 ;5409
002da8  dc61              BGT      |L1.11886|
002daa  2e1e              CMP      r6,#0x1e              ;5409
002dac  d25f              BCS      |L1.11886|
                  |L1.11694|
002dae  f8dfc104          LDR      r12,|L1.11956|
002db2  2801              CMP      r0,#1                 ;5411
002db4  f8dc70a0          LDR      r7,[r12,#0xa0]        ;5411
002db8  f89cc07b          LDRB     r12,[r12,#0x7b]       ;5411
002dbc  f8cdc018          STR      r12,[sp,#0x18]        ;5411
002dc0  dd06              BLE      |L1.11728|
002dc2  428f              CMP      r7,r1                 ;5411
002dc4  dc53              BGT      |L1.11886|
002dc6  f8ddc018          LDR      r12,[sp,#0x18]        ;5411
002dca  f1bc0f1e          CMP      r12,#0x1e             ;5411
002dce  d24e              BCS      |L1.11886|
                  |L1.11728|
002dd0  f8dfc0e0          LDR      r12,|L1.11956|
002dd4  2802              CMP      r0,#2                 ;5413
002dd6  f8dc8118          LDR      r8,[r12,#0x118]       ;5413
002dda  f8cd8014          STR      r8,[sp,#0x14]         ;5413
002dde  f89cc0f3          LDRB     r12,[r12,#0xf3]       ;5413
002de2  f8cdc010          STR      r12,[sp,#0x10]        ;5413
002de6  dd08              BLE      |L1.11770|
002de8  f8ddc014          LDR      r12,[sp,#0x14]        ;5413
002dec  458c              CMP      r12,r1                ;5413
002dee  dc3e              BGT      |L1.11886|
002df0  f8ddc010          LDR      r12,[sp,#0x10]        ;5413
002df4  f1bc0f1e          CMP      r12,#0x1e             ;5413
002df8  d239              BCS      |L1.11886|
                  |L1.11770|
002dfa  f8dfc0b8          LDR      r12,|L1.11956|
002dfe  2803              CMP      r0,#3                 ;5415
002e00  f8dc8190          LDR      r8,[r12,#0x190]       ;5415
002e04  f8cd800c          STR      r8,[sp,#0xc]          ;5415
002e08  f89cc16b          LDRB     r12,[r12,#0x16b]      ;5415
002e0c  f8cdc008          STR      r12,[sp,#8]           ;5415
002e10  dd0a              BLE      |L1.11816|
002e12  f8ddc00c          LDR      r12,[sp,#0xc]         ;5415
002e16  458c              CMP      r12,r1                ;5415
002e18  dc74              BGT      |L1.12036|
002e1a  f8ddc008          LDR      r12,[sp,#8]           ;5415
002e1e  e000              B        |L1.11810|
                  |L1.11808|
002e20  e0b2              B        |L1.12168|
                  |L1.11810|
002e22  f1bc0f1e          CMP      r12,#0x1e             ;5415
002e26  d26d              BCS      |L1.12036|
                  |L1.11816|
002e28  f8df8088          LDR      r8,|L1.11956|
002e2c  2804              CMP      r0,#4                 ;5417
002e2e  f8d8c208          LDR      r12,[r8,#0x208]       ;5417
002e32  f89881e3          LDRB     r8,[r8,#0x1e3]        ;5417
002e36  f8cd8004          STR      r8,[sp,#4]            ;5417
002e3a  dd06              BLE      |L1.11850|
002e3c  458c              CMP      r12,r1                ;5417
002e3e  dc61              BGT      |L1.12036|
002e40  f8dd8004          LDR      r8,[sp,#4]            ;5417
002e44  f1b80f1e          CMP      r8,#0x1e              ;5417
002e48  d25c              BCS      |L1.12036|
                  |L1.11850|
002e4a  f8df9068          LDR      r9,|L1.11956|
002e4e  2805              CMP      r0,#5                 ;5419
002e50  f8d98280          LDR      r8,[r9,#0x280]        ;5419
002e54  f899925b          LDRB     r9,[r9,#0x25b]        ;5419
002e58  f8cd9000          STR      r9,[sp,#0]            ;5419
002e5c  dd06              BLE      |L1.11884|
002e5e  4588              CMP      r8,r1                 ;5419
002e60  dc50              BGT      |L1.12036|
002e62  f8dd9000          LDR      r9,[sp,#0]            ;5419
002e66  f1b90f1e          CMP      r9,#0x1e              ;5419
002e6a  d24b              BCS      |L1.12036|
                  |L1.11884|
002e6c  e030              B        |L1.11984|
                  |L1.11886|
002e6e  e049              B        |L1.12036|
                  |L1.11888|
                          DCD      BAT_C_REAL
                  |L1.11892|
                          DCD      NUMBAT
                  |L1.11896|
                          DCD      superviser_cnt
                  |L1.11900|
                          DCD      NPN_OUT
                  |L1.11904|
                          DCD      npn_tz_cnt
                  |L1.11908|
                          DCD      npn_stat
                  |L1.11912|
                          DCD      load_U
                  |L1.11916|
                          DCD      UONPN
                  |L1.11920|
                          DCD      net_Ua
                  |L1.11924|
                          DCD      net_Ub
                  |L1.11928|
                          DCD      net_Uc
                  |L1.11932|
                          DCD      UMN
                  |L1.11936|
                          DCD      TZNPN
                  |L1.11940|
                          DCD      UVNPN
                  |L1.11944|
                          DCD      ||area_number.26||
                  |L1.11948|
                          DCD      FORVARDBPSCHHOUR
                  |L1.11952|
                          DCD      NUMIST
                  |L1.11956|
                          DCD      bps
                  |L1.11960|
                          DCD      TVENTMAX
                  |L1.11964|
                          DCD      RELEVENTSIGN
                  |L1.11968|
                          DCD      TVENTON
                  |L1.11972|
                          DCD      TVENTOFF
                  |L1.11976|
                          DCD      bat
                  |L1.11980|
                          DCD      BAT_IS_ON
                  |L1.11984|
002ed0  f8dfa184          LDR      r10,|L1.12376|
002ed4  2806              CMP      r0,#6                 ;5421
002ed6  f89ae2d3          LDRB     lr,[r10,#0x2d3]       ;5421
002eda  f8da92f8          LDR      r9,[r10,#0x2f8]       ;5421
002ede  dd04              BLE      |L1.12010|
002ee0  4589              CMP      r9,r1                 ;5421
002ee2  dc0f              BGT      |L1.12036|
002ee4  f1be0f1e          CMP      lr,#0x1e              ;5421
002ee8  d20c              BCS      |L1.12036|
                  |L1.12010|
002eea  f8dfb16c          LDR      r11,|L1.12376|
002eee  2807              CMP      r0,#7                 ;5423
002ef0  f8dba370          LDR      r10,[r11,#0x370]      ;5423
002ef4  f89bb34b          LDRB     r11,[r11,#0x34b]      ;5423
002ef8  dd08              BLE      |L1.12044|
002efa  458a              CMP      r10,r1                ;5423
002efc  dc02              BGT      |L1.12036|
002efe  f1bb0f1e          CMP      r11,#0x1e             ;5423
002f02  d303              BCC      |L1.12044|
                  |L1.12036|
002f04  f04f0001          MOV      r0,#1                 ;5426
002f08  7020              STRB     r0,[r4,#0]            ;5426
                  |L1.12042|
002f0a  e70d              B        |L1.11560|
                  |L1.12044|
002f0c  2b01              CMP      r3,#1                 ;5428
002f0e  d1fc              BNE      |L1.12042|
002f10  b118              CBZ      r0,|L1.12058|
002f12  4295              CMP      r5,r2                 ;5431
002f14  daf9              BGE      |L1.12042|
002f16  2e0a              CMP      r6,#0xa               ;5431
002f18  d2f7              BCS      |L1.12042|
                  |L1.12058|
002f1a  2802              CMP      r0,#2                 ;5433
002f1c  db04              BLT      |L1.12072|
002f1e  4297              CMP      r7,r2                 ;5433
002f20  daf3              BGE      |L1.12042|
002f22  9906              LDR      r1,[sp,#0x18]         ;5433
002f24  290a              CMP      r1,#0xa               ;5433
002f26  d2f0              BCS      |L1.12042|
                  |L1.12072|
002f28  2803              CMP      r0,#3                 ;5435
002f2a  db05              BLT      |L1.12088|
002f2c  9905              LDR      r1,[sp,#0x14]         ;5435
002f2e  4291              CMP      r1,r2                 ;5435
002f30  daeb              BGE      |L1.12042|
002f32  9904              LDR      r1,[sp,#0x10]         ;5435
002f34  290a              CMP      r1,#0xa               ;5435
002f36  d2e8              BCS      |L1.12042|
                  |L1.12088|
002f38  2804              CMP      r0,#4                 ;5437
002f3a  db05              BLT      |L1.12104|
002f3c  9903              LDR      r1,[sp,#0xc]          ;5437
002f3e  4291              CMP      r1,r2                 ;5437
002f40  dae3              BGE      |L1.12042|
002f42  9902              LDR      r1,[sp,#8]            ;5437
002f44  290a              CMP      r1,#0xa               ;5437
002f46  d2e0              BCS      |L1.12042|
                  |L1.12104|
002f48  2805              CMP      r0,#5                 ;5439
002f4a  db04              BLT      |L1.12118|
002f4c  4594              CMP      r12,r2                ;5439
002f4e  dadc              BGE      |L1.12042|
002f50  9901              LDR      r1,[sp,#4]            ;5439
002f52  290a              CMP      r1,#0xa               ;5439
002f54  d2d9              BCS      |L1.12042|
                  |L1.12118|
002f56  2806              CMP      r0,#6                 ;5441
002f58  db04              BLT      |L1.12132|
002f5a  4590              CMP      r8,r2                 ;5441
002f5c  dad5              BGE      |L1.12042|
002f5e  9900              LDR      r1,[sp,#0]            ;5441
002f60  290a              CMP      r1,#0xa               ;5441
002f62  d2d2              BCS      |L1.12042|
                  |L1.12132|
002f64  2807              CMP      r0,#7                 ;5443
002f66  db04              BLT      |L1.12146|
002f68  4591              CMP      r9,r2                 ;5443
002f6a  dace              BGE      |L1.12042|
002f6c  f1be0f0a          CMP      lr,#0xa               ;5443
002f70  d2cb              BCS      |L1.12042|
                  |L1.12146|
002f72  2808              CMP      r0,#8                 ;5445
002f74  db04              BLT      |L1.12160|
002f76  4592              CMP      r10,r2                ;5445
002f78  dac7              BGE      |L1.12042|
002f7a  f1bb0f0a          CMP      r11,#0xa              ;5445
002f7e  d2c4              BCS      |L1.12042|
                  |L1.12160|
002f80  f04f0000          MOV      r0,#0                 ;5448
002f84  7020              STRB     r0,[r4,#0]            ;5448
                  |L1.12166|
002f86  e6cf              B        |L1.11560|
                  |L1.12168|
002f88  4834              LDR      r0,|L1.12380|
002f8a  4d35              LDR      r5,|L1.12384|
002f8c  4e35              LDR      r6,|L1.12388|
002f8e  f9b00000          LDRSH    r0,[r0,#0]            ;5454  ; NUMDT
002f92  f9b55000          LDRSH    r5,[r5,#0]            ;5455
002f96  7836              LDRB     r6,[r6,#0]            ;5455
002f98  b110              CBZ      r0,|L1.12192|
002f9a  428d              CMP      r5,r1                 ;5455
002f9c  dc1d              BGT      |L1.12250|
002f9e  b9e6              CBNZ     r6,|L1.12250|
                  |L1.12192|
002fa0  4f2f              LDR      r7,|L1.12384|
002fa2  f8dfc0c0          LDR      r12,|L1.12388|
002fa6  2801              CMP      r0,#1                 ;5457
002fa8  f9b77002          LDRSH    r7,[r7,#2]            ;5457
002fac  f89cc001          LDRB     r12,[r12,#1]          ;5457
002fb0  dd04              BLE      |L1.12220|
002fb2  428f              CMP      r7,r1                 ;5457
002fb4  dc11              BGT      |L1.12250|
002fb6  f1bc0f00          CMP      r12,#0                ;5457
002fba  d10e              BNE      |L1.12250|
                  |L1.12220|
002fbc  f8df80a0          LDR      r8,|L1.12384|
002fc0  f8df90a0          LDR      r9,|L1.12388|
002fc4  2802              CMP      r0,#2                 ;5459
002fc6  f9b88004          LDRSH    r8,[r8,#4]            ;5459
002fca  f8999002          LDRB     r9,[r9,#2]            ;5459
002fce  dd08              BLE      |L1.12258|
002fd0  4588              CMP      r8,r1                 ;5459
002fd2  dc02              BGT      |L1.12250|
002fd4  f1b90f00          CMP      r9,#0                 ;5459
002fd8  d003              BEQ      |L1.12258|
                  |L1.12250|
002fda  f04f0001          MOV      r0,#1                 ;5462
002fde  7020              STRB     r0,[r4,#0]            ;5462
002fe0  e6a2              B        |L1.11560|
                  |L1.12258|
002fe2  2b01              CMP      r3,#1                 ;5464
002fe4  d191              BNE      |L1.12042|
002fe6  b118              CBZ      r0,|L1.12272|
002fe8  4295              CMP      r5,r2                 ;5467
002fea  da8e              BGE      |L1.12042|
002fec  2e00              CMP      r6,#0                 ;5467
002fee  d18c              BNE      |L1.12042|
                  |L1.12272|
002ff0  2802              CMP      r0,#2                 ;5469
002ff2  db04              BLT      |L1.12286|
002ff4  4297              CMP      r7,r2                 ;5469
002ff6  da88              BGE      |L1.12042|
002ff8  f1bc0f00          CMP      r12,#0                ;5469
002ffc  d185              BNE      |L1.12042|
                  |L1.12286|
002ffe  2803              CMP      r0,#3                 ;5471
003000  db04              BLT      |L1.12300|
003002  4590              CMP      r8,r2                 ;5471
003004  dabf              BGE      |L1.12166|
003006  f1b90f00          CMP      r9,#0                 ;5471
00300a  d1bc              BNE      |L1.12166|
                  |L1.12300|
00300c  f04f0000          MOV      r0,#0                 ;5474
003010  7020              STRB     r0,[r4,#0]            ;5474
003012  e689              B        |L1.11560|
;;;5480   
                          ENDP

                  vd_is_work_hndl PROC
;;;5481   //-----------------------------------------------
;;;5482   void vd_is_work_hndl(void)
003014  4814              LDR      r0,|L1.12392|
;;;5483   {
;;;5484   if(vd_U>20)
;;;5485   	{
;;;5486   	if(vd_is_work_cnt<5)vd_is_work_cnt++;
003016  4915              LDR      r1,|L1.12396|
003018  2200              MOVS     r2,#0
00301a  f9b03000          LDRSH    r3,[r0,#0]            ;5484  ; vd_U
00301e  7808              LDRB     r0,[r1,#0]
003020  2b14              CMP      r3,#0x14              ;5484
003022  dd09              BLE      |L1.12344|
003024  2805              CMP      r0,#5
003026  d203              BCS      |L1.12336|
003028  f1000001          ADD      r0,r0,#1
00302c  7008              STRB     r0,[r1,#0]
00302e  e007              B        |L1.12352|
                  |L1.12336|
;;;5487   	else vd_is_work_cnt=5;
003030  f04f0005          MOV      r0,#5
003034  7008              STRB     r0,[r1,#0]
003036  e003              B        |L1.12352|
                  |L1.12344|
;;;5488   	}
;;;5489   else
;;;5490   	{
;;;5491   	if(vd_is_work_cnt>0)vd_is_work_cnt--;
003038  b110              CBZ      r0,|L1.12352|
00303a  f1a00001          SUB      r0,r0,#1
00303e  7008              STRB     r0,[r1,#0]
                  |L1.12352|
;;;5492   	else vd_is_work_cnt=0;
;;;5493   	}
;;;5494   
;;;5495   if(vd_is_work_cnt==5) bVDISWORK=1;
003040  7808              LDRB     r0,[r1,#0]  ; vd_is_work_cnt
003042  490b              LDR      r1,|L1.12400|
003044  2805              CMP      r0,#5
003046  d003              BEQ      |L1.12368|
;;;5496   else if(vd_is_work_cnt==0) bVDISWORK=0;
003048  2800              CMP      r0,#0
00304a  d100              BNE      |L1.12366|
00304c  700a              STRB     r2,[r1,#0]
                  |L1.12366|
;;;5497   }
00304e  4770              BX       lr
                  |L1.12368|
003050  f04f0001          MOV      r0,#1                 ;5495
003054  7008              STRB     r0,[r1,#0]            ;5495
003056  4770              BX       lr
;;;5498   
                          ENDP

                  |L1.12376|
                          DCD      bps
                  |L1.12380|
                          DCD      NUMDT
                  |L1.12384|
                          DCD      t_ext
                  |L1.12388|
                          DCD      ND_EXT
                  |L1.12392|
                          DCD      vd_U
                  |L1.12396|
                          DCD      vd_is_work_cnt
                  |L1.12400|
                          DCD      bVDISWORK

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  samokalibr_init PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  4902              LDR      r1,|L2.12|
;;;246    {          
000002  f24060f9          MOV      r0,#0x6f9
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000006  f8a10042          STRH     r0,[r1,#0x42]
00000a  4770              BX       lr
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
;;;320    
                          ENDP

                  |L2.12|
                          DCD      ||area_number.26||

                          AREA ||area_number.3||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.3||, ||.text||
                  adc_drv6 PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;246    {          
000004  4c80              LDR      r4,|L3.520|
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000006  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000008  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
00000a  1a40              SUBS     r0,r0,r1
00000c  b200              SXTH     r0,r0
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  f7fffffe          BL       abs_pal
000012  1da5              ADDS     r5,r4,#6
000014  8028              STRH     r0,[r5,#0]
000016  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
00001a  1a40              SUBS     r0,r0,r1
00001c  b200              SXTH     r0,r0
00001e  f7fffffe          BL       abs_pal
000022  8068              STRH     r0,[r5,#2]
000024  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000026  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000028  1a40              SUBS     r0,r0,r1
00002a  b200              SXTH     r0,r0
00002c  f7fffffe          BL       abs_pal
000030  80a8              STRH     r0,[r5,#4]
000032  f44f7196          MOV      r1,#0x12c
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
000036  f1a4067a          SUB      r6,r4,#0x7a
00003a  4288              CMP      r0,r1
00003c  da02              BGE      |L3.68|
00003e  88a0              LDRH     r0,[r4,#4]            ;254  ; adc_self_ch_buff
000040  8570              STRH     r0,[r6,#0x2a]         ;254
000042  e00c              B        |L3.94|
                  |L3.68|
000044  f9b50002          LDRSH    r0,[r5,#2]            ;254  ; adc_self_ch_disp
000048  4288              CMP      r0,r1                 ;254
00004a  da02              BGE      |L3.82|
00004c  8860              LDRH     r0,[r4,#2]            ;255  ; adc_self_ch_buff
00004e  8570              STRH     r0,[r6,#0x2a]         ;255
000050  e005              B        |L3.94|
                  |L3.82|
000052  f9b50000          LDRSH    r0,[r5,#0]            ;255  ; adc_self_ch_disp
000056  4288              CMP      r0,r1
000058  da01              BGE      |L3.94|
00005a  8820              LDRH     r0,[r4,#0]            ;256  ; adc_self_ch_buff
00005c  8570              STRH     r0,[r6,#0x2a]         ;256
                  |L3.94|
00005e  78f7              LDRB     r7,[r6,#3]            ;256  ; adc_ch_net
000060  2200              MOVS     r2,#0                 ;256
000062  b3f7              CBZ      r7,|L3.226|
000064  79b3              LDRB     r3,[r6,#6]            ;256  ; adc_window_flag
000066  4869              LDR      r0,|L3.524|
000068  b18b              CBZ      r3,|L3.142|
00006a  f9b6102a          LDRSH    r1,[r6,#0x2a]         ;256  ; adc_result
00006e  6804              LDR      r4,[r0,#0]            ;257  ; main_power_buffer
000070  eb0404a1          ADD      r4,r4,r1,ASR #2       ;257
000074  6004              STR      r4,[r0,#0]            ;257  ; main_power_buffer
000076  6844              LDR      r4,[r0,#4]            ;257  ; main_power_buffer
000078  eb0404a1          ADD      r4,r4,r1,ASR #2       ;257
00007c  6044              STR      r4,[r0,#4]            ;247  ; main_power_buffer
00007e  6884              LDR      r4,[r0,#8]            ;258  ; main_power_buffer
000080  eb0404a1          ADD      r4,r4,r1,ASR #2       ;258
000084  6084              STR      r4,[r0,#8]            ;258  ; main_power_buffer
000086  68c4              LDR      r4,[r0,#0xc]          ;259  ; main_power_buffer
000088  eb0401a1          ADD      r1,r4,r1,ASR #2       ;259
00008c  60c1              STR      r1,[r0,#0xc]          ;258  ; main_power_buffer
                  |L3.142|
00008e  f9b6102a          LDRSH    r1,[r6,#0x2a]         ;258  ; adc_result
000092  2964              CMP      r1,#0x64
000094  da04              BGE      |L3.160|
000096  8df1              LDRH     r1,[r6,#0x2e]         ;259  ; adc_zero_cnt
000098  f1010101          ADD      r1,r1,#1              ;263
00009c  85f1              STRH     r1,[r6,#0x2e]         ;263
00009e  e000              B        |L3.162|
                  |L3.160|
0000a0  85f2              STRH     r2,[r6,#0x2e]         ;263
                  |L3.162|
0000a2  f9b6402e          LDRSH    r4,[r6,#0x2e]         ;265  ; adc_zero_cnt
0000a6  f44f61fa          MOV      r1,#0x7d0             ;267
0000aa  428c              CMP      r4,r1                 ;267
0000ac  db05              BLT      |L3.186|
0000ae  85f1              STRH     r1,[r6,#0x2e]         ;267
0000b0  6002              STR      r2,[r0,#0]            ;269  ; main_power_buffer
0000b2  6042              STR      r2,[r0,#4]            ;270  ; main_power_buffer
0000b4  6082              STR      r2,[r0,#8]            ;271  ; main_power_buffer
0000b6  60c2              STR      r2,[r0,#0xc]          ;271  ; main_power_buffer
0000b8  8532              STRH     r2,[r6,#0x28]         ;271
                  |L3.186|
0000ba  8df1              LDRH     r1,[r6,#0x2e]         ;271  ; adc_zero_cnt
0000bc  2905              CMP      r1,#5                 ;271
0000be  d14f              BNE      |L3.352|
0000c0  b1bb              CBZ      r3,|L3.242|
0000c2  8db1              LDRH     r1,[r6,#0x2c]         ;274  ; adc_gorb_cnt
0000c4  f1010101          ADD      r1,r1,#1              ;274
0000c8  b209              SXTH     r1,r1                 ;274
0000ca  85b1              STRH     r1,[r6,#0x2c]         ;274
0000cc  f5b17f00          CMP      r1,#0x200             ;276
0000d0  db00              BLT      |L3.212|
0000d2  85b2              STRH     r2,[r6,#0x2c]         ;278
                  |L3.212|
0000d4  f9b6102c          LDRSH    r1,[r6,#0x2c]         ;278  ; adc_gorb_cnt
0000d8  064c              LSLS     r4,r1,#25             ;278
0000da  d10a              BNE      |L3.242|
0000dc  ea4f11e1          ASR      r1,r1,#7              ;285
0000e0  e000              B        |L3.228|
                  |L3.226|
0000e2  e015              B        |L3.272|
                  |L3.228|
0000e4  f8504021          LDR      r4,[r0,r1,LSL #2]     ;285
0000e8  ea4f2424          ASR      r4,r4,#8              ;285
0000ec  8534              STRH     r4,[r6,#0x28]         ;285
0000ee  f8402021          STR      r2,[r0,r1,LSL #2]     ;287
                  |L3.242|
0000f2  f9b60030          LDRSH    r0,[r6,#0x30]         ;287  ; adc_window_cnt
0000f6  2896              CMP      r0,#0x96              ;288
0000f8  dd01              BLE      |L3.254|
0000fa  b103              CBZ      r3,|L3.254|
0000fc  71b2              STRB     r2,[r6,#6]            ;288
                  |L3.254|
0000fe  381f              SUBS     r0,r0,#0x1f           ;288
000100  2827              CMP      r0,#0x27              ;288
000102  d22d              BCS      |L3.352|
000104  79b0              LDRB     r0,[r6,#6]            ;289  ; adc_window_flag
000106  bb58              CBNZ     r0,|L3.352|
000108  f04f0001          MOV      r0,#1                 ;289
00010c  71b0              STRB     r0,[r6,#6]            ;291
00010e  e027              B        |L3.352|
                  |L3.272|
000110  483f              LDR      r0,|L3.528|
000112  7935              LDRB     r5,[r6,#4]            ;292  ; adc_ch
000114  7973              LDRB     r3,[r6,#5]            ;292  ; adc_ch_cnt
000116  eb001485          ADD      r4,r0,r5,LSL #6       ;292
00011a  f9b6102a          LDRSH    r1,[r6,#0x2a]         ;293  ; adc_result
00011e  f8441023          STR      r1,[r4,r3,LSL #2]     ;293
000122  0798              LSLS     r0,r3,#30             ;295
000124  d10f              BNE      |L3.326|
000126  4601              MOV      r1,r0                 ;296
                  |L3.296|
000128  f854c020          LDR      r12,[r4,r0,LSL #2]    ;296
00012c  4461              ADD      r1,r1,r12             ;296
00012e  f1000001          ADD      r0,r0,#1              ;297
000132  b2c0              UXTB     r0,r0                 ;297
000134  2810              CMP      r0,#0x10              ;299
000136  d3f7              BCC      |L3.296|
000138  ea4f1021          ASR      r0,r1,#4              ;299
00013c  4933              LDR      r1,|L3.524|
00013e  f1a10120          SUB      r1,r1,#0x20           ;300
000142  f8210015          STRH     r0,[r1,r5,LSL #1]     ;300
                  |L3.326|
000146  1c6d              ADDS     r5,r5,#1              ;302
000148  b2e8              UXTB     r0,r5                 ;303
00014a  7130              STRB     r0,[r6,#4]            ;303
00014c  2810              CMP      r0,#0x10              ;303
00014e  d307              BCC      |L3.352|
000150  7132              STRB     r2,[r6,#4]            ;303
000152  f1030301          ADD      r3,r3,#1              ;304
000156  b2d8              UXTB     r0,r3                 ;304
000158  7170              STRB     r0,[r6,#5]            ;306
00015a  2810              CMP      r0,#0x10              ;306
00015c  d300              BCC      |L3.352|
00015e  7172              STRB     r2,[r6,#5]            ;307
                  |L3.352|
000160  70b2              STRB     r2,[r6,#2]            ;307
000162  f1070701          ADD      r7,r7,#1              ;307
000166  f0070001          AND      r0,r7,#1              ;308
00016a  70f0              STRB     r0,[r6,#3]            ;308
00016c  4a29              LDR      r2,|L3.532|
00016e  b130              CBZ      r0,|L3.382|
000170  6810              LDR      r0,[r2,#0]            ;311
000172  f02000ff          BIC      r0,r0,#0xff           ;311
000176  f1000004          ADD      r0,r0,#4              ;311
00017a  6010              STR      r0,[r2,#0]            ;312
00017c  e03d              B        |L3.506|
                  |L3.382|
00017e  7931              LDRB     r1,[r6,#4]            ;312  ; adc_ch
000180  0708              LSLS     r0,r1,#28             ;314
000182  d406              BMI      |L3.402|
000184  6810              LDR      r0,[r2,#0]            ;314
000186  f02000ff          BIC      r0,r0,#0xff           ;315
00018a  f1000001          ADD      r0,r0,#1              ;315
00018e  6010              STR      r0,[r2,#0]            ;315
000190  e005              B        |L3.414|
                  |L3.402|
000192  6810              LDR      r0,[r2,#0]
000194  f02000ff          BIC      r0,r0,#0xff           ;259
000198  f1000002          ADD      r0,r0,#2              ;259
00019c  6010              STR      r0,[r2,#0]
                  |L3.414|
00019e  481e              LDR      r0,|L3.536|
0001a0  6803              LDR      r3,[r0,#0]
0001a2  f0435380          ORR      r3,r3,#0x10000000
0001a6  6003              STR      r3,[r0,#0]
0001a8  6a03              LDR      r3,[r0,#0x20]
0001aa  f0434380          ORR      r3,r3,#0x40000000
0001ae  6203              STR      r3,[r0,#0x20]
0001b0  6e03              LDR      r3,[r0,#0x60]
0001b2  f0436380          ORR      r3,r3,#0x4000000
0001b6  6603              STR      r3,[r0,#0x60]
0001b8  07cb              LSLS     r3,r1,#31
0001ba  d00a              BEQ      |L3.466|
0001bc  6943              LDR      r3,[r0,#0x14]
0001be  f0435380          ORR      r3,r3,#0x10000000
0001c2  6143              STR      r3,[r0,#0x14]
                  |L3.452|
0001c4  078b              LSLS     r3,r1,#30
0001c6  d409              BMI      |L3.476|
0001c8  6b43              LDR      r3,[r0,#0x34]
0001ca  f0234380          BIC      r3,r3,#0x40000000
0001ce  6343              STR      r3,[r0,#0x34]
0001d0  e008              B        |L3.484|
                  |L3.466|
0001d2  6943              LDR      r3,[r0,#0x14]
0001d4  f0235380          BIC      r3,r3,#0x10000000
0001d8  6143              STR      r3,[r0,#0x14]
0001da  e7f3              B        |L3.452|
                  |L3.476|
0001dc  6b43              LDR      r3,[r0,#0x34]
0001de  f0434380          ORR      r3,r3,#0x40000000
0001e2  6343              STR      r3,[r0,#0x34]
                  |L3.484|
0001e4  0749              LSLS     r1,r1,#29
0001e6  d404              BMI      |L3.498|
0001e8  6f41              LDR      r1,[r0,#0x74]
0001ea  f0216180          BIC      r1,r1,#0x4000000
0001ee  6741              STR      r1,[r0,#0x74]
0001f0  e003              B        |L3.506|
                  |L3.498|
0001f2  6f41              LDR      r1,[r0,#0x74]
0001f4  f0416180          ORR      r1,r1,#0x4000000
0001f8  6741              STR      r1,[r0,#0x74]
                  |L3.506|
0001fa  6810              LDR      r0,[r2,#0]
0001fc  f0407080          ORR      r0,r0,#0x1000000
000200  6010              STR      r0,[r2,#0]
000202  e8bd81f0          POP      {r4-r8,pc}
;;;320    
                          ENDP

000206  0000              DCW      0x0000
                  |L3.520|
                          DCD      ||area_number.26||+0x7a
                  |L3.524|
                          DCD      ||.bss||+0x420
                  |L3.528|
                          DCD      ||.bss||
                  |L3.532|
                          DCD      0x40034000
                  |L3.536|
                          DCD      0x2009c000

                          AREA ||area_number.4||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.4||, ||.text||
                  inv_drv PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  b570              PUSH     {r4-r6,lr}
;;;246    {          
000002  4604              MOV      r4,r0
000004  f04f0207          MOV      r2,#7
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000008  f04f0101          MOV      r1,#1
00000c  48a4              LDR      r0,|L4.672|
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  f7fffffe          BL       gran_char
000012  48a4              LDR      r0,|L4.676|
000014  eb040144          ADD      r1,r4,r4,LSL #1
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  eb001541          ADD      r5,r0,r1,LSL #5
00001c  f8950047          LDRB     r0,[r5,#0x47]
000020  f8951046          LDRB     r1,[r5,#0x46]
000024  ea800001          EOR      r0,r0,r1
000028  4a9f              LDR      r2,|L4.680|
00002a  b100              CBZ      r0,|L4.46|
00002c  7050              STRB     r0,[r2,#1]
                  |L4.46|
00002e  ea010100          AND      r1,r1,r0
000032  b101              CBZ      r1,|L4.54|
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
000034  7091              STRB     r1,[r2,#2]
                  |L4.54|
000036  ea000301          AND      r3,r0,r1
00003a  07db              LSLS     r3,r3,#31
00003c  d027              BEQ      |L4.142|
00003e  78d0              LDRB     r0,[r2,#3]            ;254  ; plazma_inv
000040  f1000001          ADD      r0,r0,#1              ;254
000044  70d0              STRB     r0,[r2,#3]            ;254
000046  b134              CBZ      r4,|L4.86|
000048  2c01              CMP      r4,#1                 ;254
00004a  d00b              BEQ      |L4.100|
00004c  2c02              CMP      r4,#2                 ;255
00004e  d010              BEQ      |L4.114|
000050  2c03              CMP      r4,#3                 ;255
000052  d015              BEQ      |L4.128|
000054  e120              B        |L4.664|
                  |L4.86|
000056  2301              MOVS     r3,#1
000058  461a              MOV      r2,r3                 ;256
00005a  210e              MOVS     r1,#0xe               ;256
00005c  a093              ADR      r0,|L4.684|
00005e  f7fffffe          BL       snmp_trap_send
000062  e119              B        |L4.664|
                  |L4.100|
000064  2301              MOVS     r3,#1                 ;256
000066  2202              MOVS     r2,#2                 ;256
000068  210e              MOVS     r1,#0xe               ;256
00006a  a097              ADR      r0,|L4.712|
00006c  f7fffffe          BL       snmp_trap_send
000070  e112              B        |L4.664|
                  |L4.114|
000072  2301              MOVS     r3,#1                 ;257
000074  2203              MOVS     r2,#3                 ;257
000076  210e              MOVS     r1,#0xe               ;257
000078  a09a              ADR      r0,|L4.740|
00007a  f7fffffe          BL       snmp_trap_send
00007e  e10b              B        |L4.664|
                  |L4.128|
000080  2301              MOVS     r3,#1                 ;258
000082  2204              MOVS     r2,#4                 ;258
000084  210e              MOVS     r1,#0xe               ;258
000086  a09e              ADR      r0,|L4.768|
000088  f7fffffe          BL       snmp_trap_send
00008c  e104              B        |L4.664|
                  |L4.142|
00008e  0783              LSLS     r3,r0,#30             ;258
000090  d529              BPL      |L4.230|
000092  078b              LSLS     r3,r1,#30
000094  d527              BPL      |L4.230|
000096  78d0              LDRB     r0,[r2,#3]            ;259  ; plazma_inv
000098  f1000001          ADD      r0,r0,#1              ;263
00009c  70d0              STRB     r0,[r2,#3]            ;263
00009e  b134              CBZ      r4,|L4.174|
0000a0  2c01              CMP      r4,#1                 ;263
0000a2  d00b              BEQ      |L4.188|
0000a4  2c02              CMP      r4,#2                 ;266
0000a6  d010              BEQ      |L4.202|
0000a8  2c03              CMP      r4,#3                 ;267
0000aa  d015              BEQ      |L4.216|
0000ac  e0f4              B        |L4.664|
                  |L4.174|
0000ae  2302              MOVS     r3,#2                 ;267
0000b0  2201              MOVS     r2,#1                 ;269
0000b2  210e              MOVS     r1,#0xe               ;270
0000b4  a099              ADR      r0,|L4.796|
0000b6  f7fffffe          BL       snmp_trap_send
0000ba  e0ed              B        |L4.664|
                  |L4.188|
0000bc  2302              MOVS     r3,#2                 ;271
0000be  461a              MOV      r2,r3                 ;273
0000c0  210e              MOVS     r1,#0xe               ;274
0000c2  a09d              ADR      r0,|L4.824|
0000c4  f7fffffe          BL       snmp_trap_send
0000c8  e0e6              B        |L4.664|
                  |L4.202|
0000ca  2302              MOVS     r3,#2                 ;274
0000cc  2203              MOVS     r2,#3                 ;276
0000ce  210e              MOVS     r1,#0xe               ;277
0000d0  a0a0              ADR      r0,|L4.852|
0000d2  f7fffffe          BL       snmp_trap_send
0000d6  e0df              B        |L4.664|
                  |L4.216|
0000d8  2302              MOVS     r3,#2                 ;278
0000da  2204              MOVS     r2,#4                 ;285
0000dc  210e              MOVS     r1,#0xe               ;285
0000de  a0a4              ADR      r0,|L4.880|
0000e0  f7fffffe          BL       snmp_trap_send
0000e4  e0d8              B        |L4.664|
                  |L4.230|
0000e6  0743              LSLS     r3,r0,#29             ;285
0000e8  d529              BPL      |L4.318|
0000ea  074b              LSLS     r3,r1,#29             ;285
0000ec  d527              BPL      |L4.318|
0000ee  78d0              LDRB     r0,[r2,#3]            ;287  ; plazma_inv
0000f0  f1000001          ADD      r0,r0,#1              ;287
0000f4  70d0              STRB     r0,[r2,#3]            ;288
0000f6  b134              CBZ      r4,|L4.262|
0000f8  2c01              CMP      r4,#1                 ;288
0000fa  d00b              BEQ      |L4.276|
0000fc  2c02              CMP      r4,#2                 ;288
0000fe  d010              BEQ      |L4.290|
000100  2c03              CMP      r4,#3                 ;288
000102  d015              BEQ      |L4.304|
000104  e0c8              B        |L4.664|
                  |L4.262|
000106  2303              MOVS     r3,#3                 ;289
000108  2201              MOVS     r2,#1                 ;289
00010a  210e              MOVS     r1,#0xe               ;289
00010c  a09f              ADR      r0,|L4.908|
00010e  f7fffffe          BL       snmp_trap_send
000112  e0c1              B        |L4.664|
                  |L4.276|
000114  2303              MOVS     r3,#3                 ;292
000116  2202              MOVS     r2,#2                 ;292
000118  210e              MOVS     r1,#0xe               ;292
00011a  a0a3              ADR      r0,|L4.936|
00011c  f7fffffe          BL       snmp_trap_send
000120  e0ba              B        |L4.664|
                  |L4.290|
000122  2303              MOVS     r3,#3                 ;295
000124  461a              MOV      r2,r3                 ;296
000126  210e              MOVS     r1,#0xe               ;296
000128  a0a6              ADR      r0,|L4.964|
00012a  f7fffffe          BL       snmp_trap_send
00012e  e0b3              B        |L4.664|
                  |L4.304|
000130  2303              MOVS     r3,#3                 ;297
000132  2204              MOVS     r2,#4                 ;297
000134  210e              MOVS     r1,#0xe               ;299
000136  a0aa              ADR      r0,|L4.992|
000138  f7fffffe          BL       snmp_trap_send
00013c  e0ac              B        |L4.664|
                  |L4.318|
00013e  0703              LSLS     r3,r0,#28             ;300
000140  d529              BPL      |L4.406|
000142  070b              LSLS     r3,r1,#28             ;300
000144  d527              BPL      |L4.406|
000146  78d0              LDRB     r0,[r2,#3]            ;302  ; plazma_inv
000148  f1000001          ADD      r0,r0,#1              ;303
00014c  70d0              STRB     r0,[r2,#3]            ;303
00014e  b134              CBZ      r4,|L4.350|
000150  2c01              CMP      r4,#1                 ;303
000152  d00b              BEQ      |L4.364|
000154  2c02              CMP      r4,#2                 ;304
000156  d010              BEQ      |L4.378|
000158  2c03              CMP      r4,#3                 ;306
00015a  d015              BEQ      |L4.392|
00015c  e09c              B        |L4.664|
                  |L4.350|
00015e  2304              MOVS     r3,#4                 ;307
000160  2201              MOVS     r2,#1                 ;307
000162  210e              MOVS     r1,#0xe               ;307
000164  a0a5              ADR      r0,|L4.1020|
000166  f7fffffe          BL       snmp_trap_send
00016a  e095              B        |L4.664|
                  |L4.364|
00016c  2304              MOVS     r3,#4                 ;310
00016e  2202              MOVS     r2,#2                 ;310
000170  210e              MOVS     r1,#0xe               ;311
000172  a0ab              ADR      r0,|L4.1056|
000174  f7fffffe          BL       snmp_trap_send
000178  e08e              B        |L4.664|
                  |L4.378|
00017a  2304              MOVS     r3,#4                 ;312
00017c  2203              MOVS     r2,#3                 ;312
00017e  210e              MOVS     r1,#0xe               ;312
000180  a0b0              ADR      r0,|L4.1092|
000182  f7fffffe          BL       snmp_trap_send
000186  e087              B        |L4.664|
                  |L4.392|
000188  2304              MOVS     r3,#4                 ;315
00018a  461a              MOV      r2,r3                 ;315
00018c  210e              MOVS     r1,#0xe               ;315
00018e  a0b6              ADR      r0,|L4.1128|
000190  f7fffffe          BL       snmp_trap_send
000194  e080              B        |L4.664|
                  |L4.406|
000196  06c3              LSLS     r3,r0,#27             ;259
000198  d529              BPL      |L4.494|
00019a  06cb              LSLS     r3,r1,#27
00019c  d527              BPL      |L4.494|
00019e  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0001a0  f1000001          ADD      r0,r0,#1
0001a4  70d0              STRB     r0,[r2,#3]
0001a6  b134              CBZ      r4,|L4.438|
0001a8  2c01              CMP      r4,#1
0001aa  d00b              BEQ      |L4.452|
0001ac  2c02              CMP      r4,#2
0001ae  d010              BEQ      |L4.466|
0001b0  2c03              CMP      r4,#3
0001b2  d015              BEQ      |L4.480|
0001b4  e070              B        |L4.664|
                  |L4.438|
0001b6  2305              MOVS     r3,#5
0001b8  2201              MOVS     r2,#1
0001ba  210e              MOVS     r1,#0xe
0001bc  a0b3              ADR      r0,|L4.1164|
0001be  f7fffffe          BL       snmp_trap_send
0001c2  e069              B        |L4.664|
                  |L4.452|
0001c4  2305              MOVS     r3,#5
0001c6  2202              MOVS     r2,#2
0001c8  210e              MOVS     r1,#0xe
0001ca  a0b9              ADR      r0,|L4.1200|
0001cc  f7fffffe          BL       snmp_trap_send
0001d0  e062              B        |L4.664|
                  |L4.466|
0001d2  2305              MOVS     r3,#5
0001d4  2203              MOVS     r2,#3
0001d6  210e              MOVS     r1,#0xe
0001d8  a0be              ADR      r0,|L4.1236|
0001da  f7fffffe          BL       snmp_trap_send
0001de  e05b              B        |L4.664|
                  |L4.480|
0001e0  2305              MOVS     r3,#5
0001e2  2204              MOVS     r2,#4
0001e4  210e              MOVS     r1,#0xe
0001e6  a0c4              ADR      r0,|L4.1272|
0001e8  f7fffffe          BL       snmp_trap_send
0001ec  e054              B        |L4.664|
                  |L4.494|
0001ee  0683              LSLS     r3,r0,#26
0001f0  d529              BPL      |L4.582|
0001f2  068b              LSLS     r3,r1,#26
0001f4  d527              BPL      |L4.582|
0001f6  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0001f8  f1000001          ADD      r0,r0,#1
0001fc  70d0              STRB     r0,[r2,#3]
0001fe  b134              CBZ      r4,|L4.526|
000200  2c01              CMP      r4,#1
000202  d00b              BEQ      |L4.540|
000204  2c02              CMP      r4,#2
000206  d010              BEQ      |L4.554|
000208  2c03              CMP      r4,#3
00020a  d015              BEQ      |L4.568|
00020c  e044              B        |L4.664|
                  |L4.526|
00020e  2306              MOVS     r3,#6
000210  2201              MOVS     r2,#1
000212  210e              MOVS     r1,#0xe
000214  a0c1              ADR      r0,|L4.1308|
000216  f7fffffe          BL       snmp_trap_send
00021a  e03d              B        |L4.664|
                  |L4.540|
00021c  2306              MOVS     r3,#6
00021e  2202              MOVS     r2,#2
000220  210e              MOVS     r1,#0xe
000222  a0c7              ADR      r0,|L4.1344|
000224  f7fffffe          BL       snmp_trap_send
000228  e036              B        |L4.664|
                  |L4.554|
00022a  2306              MOVS     r3,#6
00022c  2203              MOVS     r2,#3
00022e  210e              MOVS     r1,#0xe
000230  a0cc              ADR      r0,|L4.1380|
000232  f7fffffe          BL       snmp_trap_send
000236  e02f              B        |L4.664|
                  |L4.568|
000238  2306              MOVS     r3,#6
00023a  2204              MOVS     r2,#4
00023c  210e              MOVS     r1,#0xe
00023e  a0d2              ADR      r0,|L4.1416|
000240  f7fffffe          BL       snmp_trap_send
000244  e028              B        |L4.664|
                  |L4.582|
000246  b300              CBZ      r0,|L4.650|
000248  b9f9              CBNZ     r1,|L4.650|
00024a  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
00024c  f1000001          ADD      r0,r0,#1
000250  70d0              STRB     r0,[r2,#3]
000252  b134              CBZ      r4,|L4.610|
000254  2c01              CMP      r4,#1
000256  d00b              BEQ      |L4.624|
000258  2c02              CMP      r4,#2
00025a  d010              BEQ      |L4.638|
00025c  2c03              CMP      r4,#3
00025e  d015              BEQ      |L4.652|
000260  e01a              B        |L4.664|
                  |L4.610|
000262  2300              MOVS     r3,#0
000264  2201              MOVS     r2,#1
000266  210e              MOVS     r1,#0xe
000268  a0d0              ADR      r0,|L4.1452|
00026a  f7fffffe          BL       snmp_trap_send
00026e  e013              B        |L4.664|
                  |L4.624|
000270  2300              MOVS     r3,#0
000272  2202              MOVS     r2,#2
000274  210e              MOVS     r1,#0xe
000276  a0d2              ADR      r0,|L4.1472|
000278  f7fffffe          BL       snmp_trap_send
00027c  e00c              B        |L4.664|
                  |L4.638|
00027e  2300              MOVS     r3,#0
000280  2203              MOVS     r2,#3
000282  210e              MOVS     r1,#0xe
000284  a0d3              ADR      r0,|L4.1492|
000286  f7fffffe          BL       snmp_trap_send
                  |L4.650|
00028a  e005              B        |L4.664|
                  |L4.652|
00028c  2300              MOVS     r3,#0
00028e  2204              MOVS     r2,#4
000290  210e              MOVS     r1,#0xe
000292  a0d5              ADR      r0,|L4.1512|
000294  f7fffffe          BL       snmp_trap_send
                  |L4.664|
000298  f8150f46          LDRB     r0,[r5,#0x46]!
00029c  7068              STRB     r0,[r5,#1]
00029e  bd70              POP      {r4-r6,pc}
;;;320    
                          ENDP

                  |L4.672|
                          DCD      first_inv_slot
                  |L4.676|
                          DCD      inv
                  |L4.680|
                          DCD      ||area_number.26||+0x70
                  |L4.684|
0002ac  496e7665          DCB      "Invertor #1 Alarm, overload",0
0002b0  72746f72
0002b4  20233120
0002b8  416c6172
0002bc  6d2c206f
0002c0  7665726c
0002c4  6f616400
                  |L4.712|
0002c8  496e7665          DCB      "Invertor #2 Alarm, overload",0
0002cc  72746f72
0002d0  20233220
0002d4  416c6172
0002d8  6d2c206f
0002dc  7665726c
0002e0  6f616400
                  |L4.740|
0002e4  496e7665          DCB      "Invertor #3 Alarm, overload",0
0002e8  72746f72
0002ec  20233320
0002f0  416c6172
0002f4  6d2c206f
0002f8  7665726c
0002fc  6f616400
                  |L4.768|
000300  496e7665          DCB      "Invertor #4 Alarm, overload",0
000304  72746f72
000308  20233420
00030c  416c6172
000310  6d2c206f
000314  7665726c
000318  6f616400
                  |L4.796|
00031c  496e7665          DCB      "Invertor #1 Alarm, overheat",0
000320  72746f72
000324  20233120
000328  416c6172
00032c  6d2c206f
000330  76657268
000334  65617400
                  |L4.824|
000338  496e7665          DCB      "Invertor #2 Alarm, overheat",0
00033c  72746f72
000340  20233220
000344  416c6172
000348  6d2c206f
00034c  76657268
000350  65617400
                  |L4.852|
000354  496e7665          DCB      "Invertor #3 Alarm, overheat",0
000358  72746f72
00035c  20233320
000360  416c6172
000364  6d2c206f
000368  76657268
00036c  65617400
                  |L4.880|
000370  496e7665          DCB      "Invertor #4 Alarm, overheat",0
000374  72746f72
000378  20233420
00037c  416c6172
000380  6d2c206f
000384  76657268
000388  65617400
                  |L4.908|
00038c  496e7665          DCB      "Invertor #1 Alarm, is warm",0
000390  72746f72
000394  20233120
000398  416c6172
00039c  6d2c2069
0003a0  73207761
0003a4  726d00  
0003a7  00                DCB      0
                  |L4.936|
0003a8  496e7665          DCB      "Invertor #2 Alarm, is warm",0
0003ac  72746f72
0003b0  20233220
0003b4  416c6172
0003b8  6d2c2069
0003bc  73207761
0003c0  726d00  
0003c3  00                DCB      0
                  |L4.964|
0003c4  496e7665          DCB      "Invertor #3 Alarm, is warm",0
0003c8  72746f72
0003cc  20233320
0003d0  416c6172
0003d4  6d2c2069
0003d8  73207761
0003dc  726d00  
0003df  00                DCB      0
                  |L4.992|
0003e0  496e7665          DCB      "Invertor #4 Alarm, is warm",0
0003e4  72746f72
0003e8  20233420
0003ec  416c6172
0003f0  6d2c2069
0003f4  73207761
0003f8  726d00  
0003fb  00                DCB      0
                  |L4.1020|
0003fc  496e7665          DCB      "Invertor #1 Alarm, voltage is up",0
000400  72746f72
000404  20233120
000408  416c6172
00040c  6d2c2076
000410  6f6c7461
000414  67652069
000418  73207570
00041c  00      
00041d  00                DCB      0
00041e  00                DCB      0
00041f  00                DCB      0
                  |L4.1056|
000420  496e7665          DCB      "Invertor #2 Alarm, voltage is up",0
000424  72746f72
000428  20233220
00042c  416c6172
000430  6d2c2076
000434  6f6c7461
000438  67652069
00043c  73207570
000440  00      
000441  00                DCB      0
000442  00                DCB      0
000443  00                DCB      0
                  |L4.1092|
000444  496e7665          DCB      "Invertor #3 Alarm, voltage is up",0
000448  72746f72
00044c  20233320
000450  416c6172
000454  6d2c2076
000458  6f6c7461
00045c  67652069
000460  73207570
000464  00      
000465  00                DCB      0
000466  00                DCB      0
000467  00                DCB      0
                  |L4.1128|
000468  496e7665          DCB      "Invertor #4 Alarm, voltage is up",0
00046c  72746f72
000470  20233420
000474  416c6172
000478  6d2c2076
00047c  6f6c7461
000480  67652069
000484  73207570
000488  00      
000489  00                DCB      0
00048a  00                DCB      0
00048b  00                DCB      0
                  |L4.1164|
00048c  496e7665          DCB      "Invertor #1 Alarm, voltage is down",0
000490  72746f72
000494  20233120
000498  416c6172
00049c  6d2c2076
0004a0  6f6c7461
0004a4  67652069
0004a8  7320646f
0004ac  776e00  
0004af  00                DCB      0
                  |L4.1200|
0004b0  496e7665          DCB      "Invertor #2 Alarm, voltage is down",0
0004b4  72746f72
0004b8  20233220
0004bc  416c6172
0004c0  6d2c2076
0004c4  6f6c7461
0004c8  67652069
0004cc  7320646f
0004d0  776e00  
0004d3  00                DCB      0
                  |L4.1236|
0004d4  496e7665          DCB      "Invertor #3 Alarm, voltage is down",0
0004d8  72746f72
0004dc  20233320
0004e0  416c6172
0004e4  6d2c2076
0004e8  6f6c7461
0004ec  67652069
0004f0  7320646f
0004f4  776e00  
0004f7  00                DCB      0
                  |L4.1272|
0004f8  496e7665          DCB      "Invertor #4 Alarm, voltage is down",0
0004fc  72746f72
000500  20233420
000504  416c6172
000508  6d2c2076
00050c  6f6c7461
000510  67652069
000514  7320646f
000518  776e00  
00051b  00                DCB      0
                  |L4.1308|
00051c  496e7665          DCB      "Invertor #1 Alarm, output is offed",0
000520  72746f72
000524  20233120
000528  416c6172
00052c  6d2c206f
000530  75747075
000534  74206973
000538  206f6666
00053c  656400  
00053f  00                DCB      0
                  |L4.1344|
000540  496e7665          DCB      "Invertor #2 Alarm, output is offed",0
000544  72746f72
000548  20233220
00054c  416c6172
000550  6d2c206f
000554  75747075
000558  74206973
00055c  206f6666
000560  656400  
000563  00                DCB      0
                  |L4.1380|
000564  496e7665          DCB      "Invertor #3 Alarm, output is offed",0
000568  72746f72
00056c  20233320
000570  416c6172
000574  6d2c206f
000578  75747075
00057c  74206973
000580  206f6666
000584  656400  
000587  00                DCB      0
                  |L4.1416|
000588  496e7665          DCB      "Invertor #4 Alarm, output is offed",0
00058c  72746f72
000590  20233420
000594  416c6172
000598  6d2c206f
00059c  75747075
0005a0  74206973
0005a4  206f6666
0005a8  656400  
0005ab  00                DCB      0
                  |L4.1452|
0005ac  496e7665          DCB      "Invertor #1 is norm",0
0005b0  72746f72
0005b4  20233120
0005b8  6973206e
0005bc  6f726d00
                  |L4.1472|
0005c0  496e7665          DCB      "Invertor #2 is norm",0
0005c4  72746f72
0005c8  20233220
0005cc  6973206e
0005d0  6f726d00
                  |L4.1492|
0005d4  496e7665          DCB      "Invertor #3 is norm",0
0005d8  72746f72
0005dc  20233320
0005e0  6973206e
0005e4  6f726d00
                  |L4.1512|
0005e8  496e7665          DCB      "Invertor #4 is norm",0
0005ec  72746f72
0005f0  20233420
0005f4  6973206e
0005f8  6f726d00

                          AREA ||area_number.5||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.5||, ||.text||
                  ipsBlckHndl PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  b510              PUSH     {r4,lr}
;;;246    {          
000002  4b15              LDR      r3,|L5.88|
000004  f04f0000          MOV      r0,#0
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000008  8018              STRH     r0,[r3,#0]
00000a  4814              LDR      r0,|L5.92|
00000c  f04f0401          MOV      r4,#1
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
000010  f44f62fa          MOV      r2,#0x7d0
000014  f9b01000          LDRSH    r1,[r0,#0]  ; ipsBlckSrc
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  4811              LDR      r0,|L5.96|
00001a  2901              CMP      r1,#1
00001c  f9b00000          LDRSH    r0,[r0,#0]
000020  d006              BEQ      |L5.48|
000022  2902              CMP      r1,#2
000024  d10f              BNE      |L5.70|
000026  490f              LDR      r1,|L5.100|
000028  f9b1101a          LDRSH    r1,[r1,#0x1a]
00002c  b160              CBZ      r0,|L5.72|
00002e  e00d              B        |L5.76|
                  |L5.48|
000030  490c              LDR      r1,|L5.100|
000032  f9b11016          LDRSH    r1,[r1,#0x16]
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
000036  b908              CBNZ     r0,|L5.60|
000038  4291              CMP      r1,r2                 ;249
00003a  dc03              BGT      |L5.68|
                  |L5.60|
00003c  2801              CMP      r0,#1                 ;254
00003e  d102              BNE      |L5.70|
000040  4291              CMP      r1,r2                 ;254
000042  da00              BGE      |L5.70|
                  |L5.68|
000044  801c              STRH     r4,[r3,#0]            ;254
                  |L5.70|
000046  bd10              POP      {r4,pc}               ;254
                  |L5.72|
000048  4291              CMP      r1,r2                 ;254
00004a  dc03              BGT      |L5.84|
                  |L5.76|
00004c  2801              CMP      r0,#1                 ;255
00004e  d1fa              BNE      |L5.70|
000050  4291              CMP      r1,r2                 ;255
000052  daf8              BGE      |L5.70|
                  |L5.84|
000054  801c              STRH     r4,[r3,#0]            ;255
000056  bd10              POP      {r4,pc}
;;;320    
                          ENDP

                  |L5.88|
                          DCD      ipsBlckStat
                  |L5.92|
                          DCD      ipsBlckSrc
                  |L5.96|
                          DCD      ipsBlckLog
                  |L5.100|
                          DCD      ||.bss||+0x400

                          AREA ||area_number.6||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.6||, ||.text||
                  bat_hndl PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  b570              PUSH     {r4-r6,lr}
;;;246    {          
000002  20c8              MOVS     r0,#0xc8
000004  f7fffffe          BL       mess_find_unvol
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000008  493a              LDR      r1,|L6.244|
00000a  2200              MOVS     r2,#0
00000c  b3a8              CBZ      r0,|L6.122|
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  4b3a              LDR      r3,|L6.248|
000010  2401              MOVS     r4,#1
000012  6818              LDR      r0,[r3,#0]  ; mess_data
000014  28c9              CMP      r0,#0xc9
000016  d01c              BEQ      |L6.82|
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  28ca              CMP      r0,#0xca
00001a  d02f              BEQ      |L6.124|
00001c  4610              MOV      r0,r2
                  |L6.30|
00001e  eb000340          ADD      r3,r0,r0,LSL #1
000022  eb031300          ADD      r3,r3,r0,LSL #4
000026  f8012023          STRB     r2,[r1,r3,LSL #2]
00002a  f1000001          ADD      r0,r0,#1
00002e  b2c0              UXTB     r0,r0
000030  2802              CMP      r0,#2
000032  d3f4              BCC      |L6.30|
                  |L6.52|
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
000034  f04f0000          MOV      r0,#0
                  |L6.56|
000038  eb000340          ADD      r3,r0,r0,LSL #1       ;249
00003c  eb031300          ADD      r3,r3,r0,LSL #4       ;254
000040  f8115023          LDRB     r5,[r1,r3,LSL #2]     ;254
000044  2d14              CMP      r5,#0x14              ;254
000046  d939              BLS      |L6.188|
000048  eb010383          ADD      r3,r1,r3,LSL #2       ;254
00004c  f883403c          STRB     r4,[r3,#0x3c]         ;255
000050  e038              B        |L6.196|
                  |L6.82|
000052  f04f0000          MOV      r0,#0                 ;255
                  |L6.86|
000056  eb000340          ADD      r3,r0,r0,LSL #1
00005a  eb031500          ADD      r5,r3,r0,LSL #4       ;256
00005e  f8113025          LDRB     r3,[r1,r5,LSL #2]     ;256
000062  2b32              CMP      r3,#0x32              ;256
000064  d203              BCS      |L6.110|
000066  f1030301          ADD      r3,r3,#1              ;256
00006a  f8013025          STRB     r3,[r1,r5,LSL #2]     ;256
                  |L6.110|
00006e  f1000001          ADD      r0,r0,#1              ;257
000072  b2c0              UXTB     r0,r0                 ;257
000074  2802              CMP      r0,#2                 ;257
000076  d3ee              BCC      |L6.86|
000078  e7dc              B        |L6.52|
                  |L6.122|
00007a  e029              B        |L6.208|
                  |L6.124|
00007c  f04f0000          MOV      r0,#0                 ;247
000080  685e              LDR      r6,[r3,#4]            ;258
                  |L6.130|
000082  fa04f300          LSL      r3,r4,r0              ;258
000086  421e              TST      r6,r3                 ;259
000088  d00c              BEQ      |L6.164|
00008a  eb000340          ADD      r3,r0,r0,LSL #1       ;259
00008e  eb031500          ADD      r5,r3,r0,LSL #4       ;258
000092  f8113025          LDRB     r3,[r1,r5,LSL #2]
000096  2b32              CMP      r3,#0x32              ;259
000098  d20a              BCS      |L6.176|
00009a  f1030301          ADD      r3,r3,#1              ;263
00009e  f8013025          STRB     r3,[r1,r5,LSL #2]     ;263
0000a2  e005              B        |L6.176|
                  |L6.164|
0000a4  eb000340          ADD      r3,r0,r0,LSL #1       ;266
0000a8  eb031300          ADD      r3,r3,r0,LSL #4       ;267
0000ac  f8012023          STRB     r2,[r1,r3,LSL #2]     ;267
                  |L6.176|
0000b0  f1000001          ADD      r0,r0,#1              ;269
0000b4  b2c0              UXTB     r0,r0                 ;271
0000b6  2802              CMP      r0,#2                 ;271
0000b8  d3e3              BCC      |L6.130|
0000ba  e7bb              B        |L6.52|
                  |L6.188|
0000bc  eb010383          ADD      r3,r1,r3,LSL #2       ;271
0000c0  f883203c          STRB     r2,[r3,#0x3c]         ;274
                  |L6.196|
0000c4  f1000001          ADD      r0,r0,#1              ;274
0000c8  b2c0              UXTB     r0,r0                 ;274
0000ca  2802              CMP      r0,#2                 ;274
0000cc  d3b4              BCC      |L6.56|
0000ce  bd70              POP      {r4-r6,pc}            ;277
                  |L6.208|
0000d0  f04f0000          MOV      r0,#0                 ;278
                  |L6.212|
0000d4  eb000340          ADD      r3,r0,r0,LSL #1       ;278
0000d8  eb031300          ADD      r3,r3,r0,LSL #4       ;278
0000dc  f8012023          STRB     r2,[r1,r3,LSL #2]     ;285
0000e0  eb010383          ADD      r3,r1,r3,LSL #2       ;285
0000e4  f883203c          STRB     r2,[r3,#0x3c]         ;285
0000e8  f1000001          ADD      r0,r0,#1              ;285
0000ec  b2c0              UXTB     r0,r0                 ;285
0000ee  2802              CMP      r0,#2                 ;287
0000f0  d3f0              BCC      |L6.212|
0000f2  bd70              POP      {r4-r6,pc}            ;287
;;;320    
                          ENDP

                  |L6.244|
                          DCD      bat
                  |L6.248|
                          DCD      mess_data

                          AREA ||area_number.7||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.7||, ||.text||
                  klimat_hndl PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;246    {          
000004  4d66              LDR      r5,|L7.416|
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000006  4867              LDR      r0,|L7.420|
000008  4c67              LDR      r4,|L7.424|
00000a  f9b51000          LDRSH    r1,[r5,#0]  ; t_box
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  f9b02000          LDRSH    r2,[r0,#0]  ; TBOXMAX
000012  f9b40000          LDRSH    r0,[r4,#0]
000016  4291              CMP      r1,r2
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  dd03              BLE      |L7.34|
00001a  f1000001          ADD      r0,r0,#1
00001e  8020              STRH     r0,[r4,#0]
000020  e003              B        |L7.42|
                  |L7.34|
000022  da02              BGE      |L7.42|
000024  f1a00001          SUB      r0,r0,#1
000028  8020              STRH     r0,[r4,#0]
                  |L7.42|
00002a  2206              MOVS     r2,#6
00002c  2100              MOVS     r1,#0
00002e  485e              LDR      r0,|L7.424|
000030  f7fffffe          BL       gran
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
000034  f9b40000          LDRSH    r0,[r4,#0]  ; av_tbox_cnt
000038  495c              LDR      r1,|L7.428|
00003a  2601              MOVS     r6,#1
00003c  2805              CMP      r0,#5                 ;254
00003e  dd00              BLE      |L7.66|
000040  700e              STRB     r6,[r1,#0]            ;254
                  |L7.66|
000042  2400              MOVS     r4,#0                 ;254
000044  2801              CMP      r0,#1                 ;254
000046  da00              BGE      |L7.74|
000048  700c              STRB     r4,[r1,#0]            ;254
                  |L7.74|
00004a  4959              LDR      r1,|L7.432|
00004c  f9b50000          LDRSH    r0,[r5,#0]            ;255  ; t_box
000050  4a58              LDR      r2,|L7.436|
000052  f9b11000          LDRSH    r1,[r1,#0]            ;255  ; TBOXREG
000056  4f58              LDR      r7,|L7.440|
000058  1e8b              SUBS     r3,r1,#2              ;256
00005a  4298              CMP      r0,r3                 ;256
00005c  da0f              BGE      |L7.126|
00005e  f9921000          LDRSB    r1,[r2,#0]            ;256  ; t_box_cnt
000062  291e              CMP      r1,#0x1e              ;256
000064  da1e              BGE      |L7.164|
000066  f1010101          ADD      r1,r1,#1              ;256
00006a  b249              SXTB     r1,r1                 ;256
00006c  7011              STRB     r1,[r2,#0]
00006e  291e              CMP      r1,#0x1e              ;257
000070  db18              BLT      |L7.164|
000072  8839              LDRH     r1,[r7,#0]            ;257  ; main_vent_pos
000074  f1a10101          SUB      r1,r1,#1              ;257
000078  8039              STRH     r1,[r7,#0]            ;257
00007a  7014              STRB     r4,[r2,#0]
00007c  e012              B        |L7.164|
                  |L7.126|
00007e  4288              CMP      r0,r1                 ;258
000080  dd0f              BLE      |L7.162|
000082  f9921000          LDRSB    r1,[r2,#0]            ;258  ; t_box_cnt
000086  291e              CMP      r1,#0x1e              ;259
000088  da0c              BGE      |L7.164|
00008a  f1010101          ADD      r1,r1,#1              ;259
00008e  b249              SXTB     r1,r1                 ;258
000090  7011              STRB     r1,[r2,#0]            ;258
000092  291e              CMP      r1,#0x1e
000094  db06              BLT      |L7.164|
000096  8839              LDRH     r1,[r7,#0]            ;259  ; main_vent_pos
000098  f1010101          ADD      r1,r1,#1              ;263
00009c  8039              STRH     r1,[r7,#0]            ;263
00009e  7014              STRB     r4,[r2,#0]            ;263
0000a0  e000              B        |L7.164|
                  |L7.162|
0000a2  7014              STRB     r4,[r2,#0]            ;265
                  |L7.164|
0000a4  4945              LDR      r1,|L7.444|
0000a6  f9b11000          LDRSH    r1,[r1,#0]            ;267  ; TBOXVENTMAX
0000aa  4288              CMP      r0,r1                 ;267
0000ac  dd05              BLE      |L7.186|
0000ae  2214              MOVS     r2,#0x14              ;267
0000b0  2100              MOVS     r1,#0                 ;269
0000b2  4841              LDR      r0,|L7.440|
0000b4  f7fffffe          BL       gran
0000b8  e007              B        |L7.202|
                  |L7.186|
0000ba  4841              LDR      r0,|L7.448|
0000bc  2100              MOVS     r1,#0                 ;271
0000be  8800              LDRH     r0,[r0,#0]            ;273  ; pos_vent
0000c0  3009              ADDS     r0,r0,#9              ;274
0000c2  b202              SXTH     r2,r0                 ;274
0000c4  483c              LDR      r0,|L7.440|
0000c6  f7fffffe          BL       gran
                  |L7.202|
0000ca  20f0              MOVS     r0,#0xf0              ;274
0000cc  f7fffffe          BL       mess_find_unvol
0000d0  b128              CBZ      r0,|L7.222|
0000d2  483c              LDR      r0,|L7.452|
0000d4  6801              LDR      r1,[r0,#0]            ;278  ; mess_data
0000d6  29f1              CMP      r1,#0xf1              ;278
0000d8  d101              BNE      |L7.222|
0000da  6840              LDR      r0,[r0,#4]            ;285  ; mess_data
0000dc  8038              STRH     r0,[r7,#0]            ;285
                  |L7.222|
0000de  f9b71000          LDRSH    r1,[r7,#0]            ;285  ; main_vent_pos
0000e2  4839              LDR      r0,|L7.456|
0000e4  2901              CMP      r1,#1                 ;285
0000e6  dc01              BGT      |L7.236|
0000e8  7006              STRB     r6,[r0,#0]            ;285
0000ea  e000              B        |L7.238|
                  |L7.236|
0000ec  7004              STRB     r4,[r0,#0]            ;285
                  |L7.238|
0000ee  4837              LDR      r0,|L7.460|
0000f0  f8df80dc          LDR      r8,|L7.464|
0000f4  f9b00000          LDRSH    r0,[r0,#0]            ;288  ; TBATDISABLE
0000f8  f1a00132          SUB      r1,r0,#0x32           ;288
0000fc  2928              CMP      r1,#0x28              ;288
0000fe  d821              BHI      |L7.324|
000100  f9b51000          LDRSH    r1,[r5,#0]            ;288  ; t_box
000104  4f33              LDR      r7,|L7.468|
000106  4281              CMP      r1,r0                 ;289
000108  dd03              BLE      |L7.274|
00010a  8838              LDRH     r0,[r7,#0]            ;289  ; tbatdisable_cnt
00010c  f1000001          ADD      r0,r0,#1              ;291
000110  8038              STRH     r0,[r7,#0]            ;292
                  |L7.274|
000112  4831              LDR      r0,|L7.472|
000114  f9b00000          LDRSH    r0,[r0,#0]            ;292  ; TBATENABLE
000118  4281              CMP      r1,r0                 ;292
00011a  da03              BGE      |L7.292|
00011c  8838              LDRH     r0,[r7,#0]            ;293  ; tbatdisable_cnt
00011e  f1a00001          SUB      r0,r0,#1              ;293
000122  8038              STRH     r0,[r7,#0]            ;295
                  |L7.292|
000124  2206              MOVS     r2,#6                 ;296
000126  2100              MOVS     r1,#0                 ;296
000128  482a              LDR      r0,|L7.468|
00012a  f7fffffe          BL       gran
00012e  f9b70000          LDRSH    r0,[r7,#0]            ;297  ; tbatdisable_cnt
000132  2805              CMP      r0,#5                 ;297
000134  dd01              BLE      |L7.314|
000136  f8886000          STRB     r6,[r8,#0]            ;299
                  |L7.314|
00013a  2801              CMP      r0,#1                 ;300
00013c  da04              BGE      |L7.328|
00013e  f8884000          STRB     r4,[r8,#0]            ;300
000142  e001              B        |L7.328|
                  |L7.324|
000144  f8884000          STRB     r4,[r8,#0]            ;302
                  |L7.328|
000148  4824              LDR      r0,|L7.476|
00014a  4f25              LDR      r7,|L7.480|
00014c  f9b00000          LDRSH    r0,[r0,#0]            ;303  ; TLOADDISABLE
000150  f1a00132          SUB      r1,r0,#0x32           ;303
000154  291e              CMP      r1,#0x1e              ;304
000156  d820              BHI      |L7.410|
000158  f9b51000          LDRSH    r1,[r5,#0]            ;306  ; t_box
00015c  4d21              LDR      r5,|L7.484|
00015e  4281              CMP      r1,r0                 ;307
000160  dd03              BLE      |L7.362|
000162  8828              LDRH     r0,[r5,#0]            ;307  ; tloaddisable_cnt
000164  f1000001          ADD      r0,r0,#1              ;307
000168  8028              STRH     r0,[r5,#0]            ;308
                  |L7.362|
00016a  481f              LDR      r0,|L7.488|
00016c  f9b00000          LDRSH    r0,[r0,#0]            ;310  ; TLOADENABLE
000170  4281              CMP      r1,r0                 ;311
000172  da03              BGE      |L7.380|
000174  8828              LDRH     r0,[r5,#0]            ;311  ; tloaddisable_cnt
000176  f1a00001          SUB      r0,r0,#1              ;311
00017a  8028              STRH     r0,[r5,#0]            ;312
                  |L7.380|
00017c  2206              MOVS     r2,#6                 ;312
00017e  2100              MOVS     r1,#0                 ;312
000180  4818              LDR      r0,|L7.484|
000182  f7fffffe          BL       gran
000186  f9b50000          LDRSH    r0,[r5,#0]            ;315  ; tloaddisable_cnt
00018a  2805              CMP      r0,#5                 ;315
00018c  dd00              BLE      |L7.400|
00018e  703e              STRB     r6,[r7,#0]            ;315
                  |L7.400|
000190  2801              CMP      r0,#1
000192  da00              BGE      |L7.406|
000194  703c              STRB     r4,[r7,#0]            ;259
                  |L7.406|
000196  e8bd81f0          POP      {r4-r8,pc}            ;259
                  |L7.410|
00019a  703c              STRB     r4,[r7,#0]
00019c  e7fb              B        |L7.406|
;;;320    
                          ENDP

00019e  0000              DCW      0x0000
                  |L7.416|
                          DCD      t_box
                  |L7.420|
                          DCD      TBOXMAX
                  |L7.424|
                          DCD      av_tbox_cnt
                  |L7.428|
                          DCD      av_tbox_stat
                  |L7.432|
                          DCD      TBOXREG
                  |L7.436|
                          DCD      t_box_cnt
                  |L7.440|
                          DCD      main_vent_pos
                  |L7.444|
                          DCD      TBOXVENTMAX
                  |L7.448|
                          DCD      pos_vent
                  |L7.452|
                          DCD      mess_data
                  |L7.456|
                          DCD      mixer_vent_stat
                  |L7.460|
                          DCD      TBATDISABLE
                  |L7.464|
                          DCD      tbatdisable_stat
                  |L7.468|
                          DCD      tbatdisable_cnt
                  |L7.472|
                          DCD      TBATENABLE
                  |L7.476|
                          DCD      TLOADDISABLE
                  |L7.480|
                          DCD      tloaddisable_stat
                  |L7.484|
                          DCD      tloaddisable_cnt
                  |L7.488|
                          DCD      TLOADENABLE

                          AREA ||area_number.8||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.8||, ||.text||
                  speedChargeHndl PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  b5f8              PUSH     {r3-r7,lr}
;;;246    {          
000002  4f43              LDR      r7,|L8.272|
000004  4d43              LDR      r5,|L8.276|
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000006  2400              MOVS     r4,#0
000008  8838              LDRH     r0,[r7,#0]  ; speedChIsOn
00000a  b198              CBZ      r0,|L8.52|
00000c  4a42              LDR      r2,|L8.280|
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  6811              LDR      r1,[r2,#0]  ; speedChTimeCnt
000010  f1010101          ADD      r1,r1,#1
000014  6011              STR      r1,[r2,#0]  ; speedChTimeCnt
000016  4841              LDR      r0,|L8.284|
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  f9b00000          LDRSH    r0,[r0,#0]  ; speedChrgTimeInHour
00001c  ebc01340          RSB      r3,r0,r0,LSL #5
000020  ebc32000          RSB      r0,r3,r0,LSL #8
000024  ebb11f00          CMP      r1,r0,LSL #4
000028  db00              BLT      |L8.44|
00002a  803c              STRH     r4,[r7,#0]
                  |L8.44|
00002c  8828              LDRH     r0,[r5,#0]  ; speedChrgBlckStat
00002e  b108              CBZ      r0,|L8.52|
000030  803c              STRH     r4,[r7,#0]
000032  6014              STR      r4,[r2,#0]  ; speedChTimeCnt
                  |L8.52|
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
000034  483a              LDR      r0,|L8.288|
000036  2601              MOVS     r6,#1
000038  8800              LDRH     r0,[r0,#0]            ;249  ; speedChrgAvtEn
00003a  b300              CBZ      r0,|L8.126|
00003c  8838              LDRH     r0,[r7,#0]            ;254  ; speedChIsOn
00003e  b9f0              CBNZ     r0,|L8.126|
000040  4838              LDR      r0,|L8.292|
000042  4939              LDR      r1,|L8.296|
000044  f9b00000          LDRSH    r0,[r0,#0]            ;254  ; load_U
000048  f9b11000          LDRSH    r1,[r1,#0]            ;254  ; u_necc
00004c  4288              CMP      r0,r1                 ;255
00004e  da16              BGE      |L8.126|
000050  1a08              SUBS     r0,r1,r0              ;255
000052  4936              LDR      r1,|L8.300|
000054  f9b11000          LDRSH    r1,[r1,#0]            ;255  ; speedChrgDU
000058  4288              CMP      r0,r1                 ;256
00005a  dd10              BLE      |L8.126|
00005c  4834              LDR      r0,|L8.304|
00005e  210a              MOVS     r1,#0xa               ;256
000060  f9b00000          LDRSH    r0,[r0,#0]            ;256  ; Ib_ips_termokompensat
000064  fb90f0f1          SDIV     r0,r0,r1              ;256
000068  4932              LDR      r1,|L8.308|
00006a  8809              LDRH     r1,[r1,#0]            ;256  ; IZMAX
00006c  1a40              SUBS     r0,r0,r1
00006e  b200              SXTH     r0,r0                 ;257
000070  f7fffffe          BL       abs
000074  2805              CMP      r0,#5                 ;257
000076  da02              BGE      |L8.126|
000078  8828              LDRH     r0,[r5,#0]            ;257  ; speedChrgBlckStat
00007a  b900              CBNZ     r0,|L8.126|
00007c  803e              STRH     r6,[r7,#0]            ;247
                  |L8.126|
00007e  482e              LDR      r0,|L8.312|
000080  f9b00000          LDRSH    r0,[r0,#0]            ;258  ; speedChrgBlckSrc
000084  2801              CMP      r0,#1                 ;258
000086  d003              BEQ      |L8.144|
000088  2802              CMP      r0,#2                 ;259
00008a  d001              BEQ      |L8.144|
00008c  802c              STRH     r4,[r5,#0]            ;258
00008e  e026              B        |L8.222|
                  |L8.144|
000090  802c              STRH     r4,[r5,#0]            ;258
000092  4b2a              LDR      r3,|L8.316|
000094  492a              LDR      r1,|L8.320|
000096  f44f62fa          MOV      r2,#0x7d0             ;259
00009a  2801              CMP      r0,#1                 ;263
00009c  d002              BEQ      |L8.164|
00009e  2802              CMP      r0,#2                 ;263
0000a0  d00f              BEQ      |L8.194|
0000a2  e01c              B        |L8.222|
                  |L8.164|
0000a4  f9b30000          LDRSH    r0,[r3,#0]            ;266  ; speedChrgBlckLog
0000a8  b918              CBNZ     r0,|L8.178|
0000aa  f9b13016          LDRSH    r3,[r1,#0x16]         ;267  ; adc_buff_
0000ae  4293              CMP      r3,r2                 ;267
0000b0  dc05              BGT      |L8.190|
                  |L8.178|
0000b2  2801              CMP      r0,#1                 ;270
0000b4  d113              BNE      |L8.222|
0000b6  f9b10016          LDRSH    r0,[r1,#0x16]         ;271  ; adc_buff_
0000ba  4290              CMP      r0,r2                 ;271
0000bc  da0f              BGE      |L8.222|
                  |L8.190|
0000be  802e              STRH     r6,[r5,#0]            ;273
0000c0  e00d              B        |L8.222|
                  |L8.194|
0000c2  f9b30000          LDRSH    r0,[r3,#0]            ;274  ; speedChrgBlckLog
0000c6  b918              CBNZ     r0,|L8.208|
0000c8  f9b1301a          LDRSH    r3,[r1,#0x1a]         ;274  ; adc_buff_
0000cc  4293              CMP      r3,r2                 ;276
0000ce  dc05              BGT      |L8.220|
                  |L8.208|
0000d0  2801              CMP      r0,#1                 ;278
0000d2  d104              BNE      |L8.222|
0000d4  f9b1001a          LDRSH    r0,[r1,#0x1a]         ;278  ; adc_buff_
0000d8  4290              CMP      r0,r2                 ;278
0000da  da00              BGE      |L8.222|
                  |L8.220|
0000dc  802e              STRH     r6,[r5,#0]            ;285
                  |L8.222|
0000de  8828              LDRH     r0,[r5,#0]            ;285  ; speedChrgBlckStat
0000e0  4918              LDR      r1,|L8.324|
0000e2  2801              CMP      r0,#1                 ;285
0000e4  d001              BEQ      |L8.234|
0000e6  700c              STRB     r4,[r1,#0]            ;285
                  |L8.232|
0000e8  bdf8              POP      {r3-r7,pc}            ;285
                  |L8.234|
0000ea  7808              LDRB     r0,[r1,#0]            ;285  ; speedChrgShowCnt
0000ec  f1000001          ADD      r0,r0,#1              ;285
0000f0  b2c0              UXTB     r0,r0                 ;287
0000f2  7008              STRB     r0,[r1,#0]            ;287
0000f4  281e              CMP      r0,#0x1e              ;288
0000f6  d3f7              BCC      |L8.232|
0000f8  700c              STRB     r4,[r1,#0]            ;288
0000fa  f2413088          MOV      r0,#0x1388            ;288
0000fe  9000              STR      r0,[sp,#0]            ;288
000100  a311              ADR      r3,|L8.328|
000102  a217              ADR      r2,|L8.352|
000104  a11c              ADR      r1,|L8.376|
000106  a022              ADR      r0,|L8.400|
000108  f7fffffe          BL       show_mess
00010c  bdf8              POP      {r3-r7,pc}            ;291
;;;320    
                          ENDP

00010e  0000              DCW      0x0000
                  |L8.272|
                          DCD      speedChIsOn
                  |L8.276|
                          DCD      speedChrgBlckStat
                  |L8.280|
                          DCD      speedChTimeCnt
                  |L8.284|
                          DCD      speedChrgTimeInHour
                  |L8.288|
                          DCD      speedChrgAvtEn
                  |L8.292|
                          DCD      load_U
                  |L8.296|
                          DCD      u_necc
                  |L8.300|
                          DCD      speedChrgDU
                  |L8.304|
                          DCD      Ib_ips_termokompensat
                  |L8.308|
                          DCD      IZMAX
                  |L8.312|
                          DCD      speedChrgBlckSrc
                  |L8.316|
                          DCD      speedChrgBlckLog
                  |L8.320|
                          DCD      ||.bss||+0x400
                  |L8.324|
                          DCD      speedChrgShowCnt
                  |L8.328|
000148  20202020          DCB      "                    ",0
00014c  20202020
000150  20202020
000154  20202020
000158  20202020
00015c  00      
00015d  00                DCB      0
00015e  00                DCB      0
00015f  00                DCB      0
                  |L8.352|
000160  20202020          DCB      "     ",199,192,207,208,197,217,197,205,"!!!    ",0
000164  20c7c0cf
000168  d0c5d9c5
00016c  cd212121
000170  20202020
000174  00      
000175  00                DCB      0
000176  00                DCB      0
000177  00                DCB      0
                  |L8.376|
000178  20202020          DCB      "       ",199,192,208,223,196,"        ",0
00017c  202020c7
000180  c0d0dfc4
000184  20202020
000188  20202020
00018c  00      
00018d  00                DCB      0
00018e  00                DCB      0
00018f  00                DCB      0
                  |L8.400|
000190  20202020          DCB      "     ",211,209,202,206,208,197,205,205,219,201,"     ",0
000194  20d3d1ca
000198  ced0c5cd
00019c  cddbc920
0001a0  20202020
0001a4  00      
0001a5  00                DCB      0
0001a6  00                DCB      0
0001a7  00                DCB      0

                          AREA ||area_number.9||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.9||, ||.text||
                  speedChargeStartStop PROC
;;;244    //-----------------------------------------------
;;;245    void ke_start(char in)
000000  b508              PUSH     {r3,lr}
;;;246    {          
000002  480c              LDR      r0,|L9.52|
000004  2100              MOVS     r1,#0
;;;247    ke_start_stat=(enum_ke_start_stat)0;		 
000006  8802              LDRH     r2,[r0,#0]  ; speedChIsOn
000008  b10a              CBZ      r2,|L9.14|
00000a  8001              STRH     r1,[r0,#0]
00000c  bd08              POP      {r3,pc}
                  |L9.14|
;;;248    
;;;249    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  4a0a              LDR      r2,|L9.56|
000010  8812              LDRH     r2,[r2,#0]  ; speedChrgBlckStat
000012  b14a              CBZ      r2,|L9.40|
000014  f44f60fa          MOV      r0,#0x7d0
;;;250    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;251    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;252    #endif
;;;253    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  9000              STR      r0,[sp,#0]
00001a  a308              ADR      r3,|L9.60|
00001c  a20d              ADR      r2,|L9.84|
00001e  a113              ADR      r1,|L9.108|
000020  a018              ADR      r0,|L9.132|
000022  f7fffffe          BL       show_mess
000026  bd08              POP      {r3,pc}
                  |L9.40|
000028  f04f0201          MOV      r2,#1
00002c  8002              STRH     r2,[r0,#0]
00002e  481b              LDR      r0,|L9.156|
000030  6001              STR      r1,[r0,#0]  ; speedChTimeCnt
000032  bd08              POP      {r3,pc}
;;;254    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;255    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;256    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;257    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;259    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;260    else 
;;;261    	{
;;;262    
;;;263    	ke_start_stat=kssYES;
;;;264    
;;;265    	spc_stat=spcKE;
;;;266    	__ee_spc_stat=spcKE;
;;;267    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;268    	
;;;269    	spc_bat=in;
;;;270    	__ee_spc_bat=in;
;;;271    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;272    
;;;273    	bat[in]._zar_cnt_ke=0;
;;;274    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;275    	
;;;276    	spc_phase=0;
;;;277    	__ee_spc_phase=0;
;;;278    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;279    
;;;280    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;281    
;;;282    		{					
;;;283    		signed short temp_temp;
;;;284    		signed char temp;
;;;285    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;286    		    
;;;287    		temp=LPC_RTC->YEAR;
;;;288    		gran_char(&temp,1,99);
;;;289    		*((char*)(&(ke_date[0])))=temp;
;;;290    			
;;;291    		temp=LPC_RTC->MONTH;
;;;292    		gran_char(&temp,1,12);
;;;293    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;294    		
;;;295    		temp=LPC_RTC->DOM;
;;;296    		gran_char(&temp,1,31);
;;;297    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;298    				
;;;299    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;300    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;301    
;;;302    		temp=LPC_RTC->HOUR;
;;;303    		gran_char(&temp,0,23);
;;;304    		*((char*)(&(ke_date[1])))=temp;
;;;305                   
;;;306    		temp=LPC_RTC->MIN;
;;;307    		gran_char(&temp,0,59);
;;;308    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;309    	          
;;;310    		temp=LPC_RTC->SEC;
;;;311    		gran_char(&temp,0,59);
;;;312    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;313    			
;;;314    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;315    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;316    		}
;;;317    
;;;318    	}
;;;319    }
;;;320    
                          ENDP

                  |L9.52|
                          DCD      speedChIsOn
                  |L9.56|
                          DCD      speedChrgBlckStat
                  |L9.60|
00003c  20202020          DCB      "                    ",0
000040  20202020
000044  20202020
000048  20202020
00004c  20202020
000050  00      
000051  00                DCB      0
000052  00                DCB      0
000053  00                DCB      0
                  |L9.84|
000054  20202020          DCB      "    ",231,224,225,235,238,234,232,240,238,226,224,237,"!"
000058  e7e0e1eb
00005c  eeeae8f0
000060  eee2e0ed
000064  21      
000065  20202000          DCB      "   ",0
000069  00                DCB      0
00006a  00                DCB      0
00006b  00                DCB      0
                  |L9.108|
00006c  20202020          DCB      "       ",231,224,240,255,228,"        ",0
000070  202020e7
000074  e0f0ffe4
000078  20202020
00007c  20202020
000080  00      
000081  00                DCB      0
000082  00                DCB      0
000083  00                DCB      0
                  |L9.132|
000084  20202020          DCB      "     ",211,241,234,238,240,229,237,237,251,233,"     ",0
000088  20d3f1ea
00008c  eef0e5ed
000090  edfbe920
000094  20202020
000098  00      
000099  00                DCB      0
00009a  00                DCB      0
00009b  00                DCB      0
                  |L9.156|
                          DCD      speedChTimeCnt

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  adc_buff
                          %        1024
                  adc_buff_
                          %        32
                  main_power_buffer
                          %        32
                  cntrl_stat_buff
                          %        64

                          AREA ||area_number.12||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.12||, ||.bss||
                  adc_buff_max
                          %        24

                          AREA ||area_number.13||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.13||, ||.bss||
                  net_buff
                          %        64

                          AREA ||.constdata||, DATA, READONLY, ALIGN=0

                  sk_buff_KONTUR
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.16||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.16||, ||.constdata||
                  sk_buff_RSTKM
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.17||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.17||, ||.constdata||
                  sk_buff_GLONASS
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.18||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.18||, ||.constdata||
                  sk_buff_3U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.19||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.19||, ||.constdata||
                  sk_buff_6U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.20||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.20||, ||.constdata||
                  sk_buff_220
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.21||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.21||, ||.constdata||
                  sk_buff_TELECORE2015
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||.data||, DATA, ALIGN=1

                  adc_buff_min
000000  13881388          DCW      0x1388,0x1388
000004  13881388          DCW      0x1388,0x1388
000008  13881388          DCW      0x1388,0x1388
00000c  13881388          DCW      0x1388,0x1388
000010  13881388          DCW      0x1388,0x1388
                          DCDU     0x00000000

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  unet_buff_min
000000  1388              DCW      0x1388

                          AREA ||area_number.24||, DATA, ALIGN=0

                          EXPORTAS ||area_number.24||, ||.data||
                  adc_stat
000000  01                DCB      0x01

                          AREA ||area_number.25||, DATA, ALIGN=1

                          EXPORTAS ||area_number.25||, ||.data||
                  bat_ver_cnt
000000  0096              DCW      0x0096

                          AREA ||area_number.26||, DATA, ALIGN=2

                          EXPORTAS ||area_number.26||, ||.data||
                  vent_stat
000000  00                DCB      0x00
                  cntrlStatIsDownCnt
000001  00                DCB      0x00
                  adc_self_ch_cnt
000002  00                DCB      0x00
                  adc_ch_net
000003  00                DCB      0x00
                  adc_ch
000004  00                DCB      0x00
                  adc_ch_cnt
000005  00                DCB      0x00
                  adc_window_flag
000006  00                DCB      0x00
                  ch_cnt0
000007  00                DCB      0x00
                  b1Hz_ch
000008  00                DCB      0x00
                  i
000009  00                DCB      0x00
                  iiii
00000a  00                DCB      0x00
                  cntrl_stat_buff_ptr
00000b  00                DCB      0x00
                  bAVG
00000c  00                DCB      0x00
                  avg_cnt_
00000d  00                DCB      0x00
                  avg_num
00000e  00                DCB      0x00
                  bAVG_BLOCK
00000f  00                DCB      0x00
                  bAVG_DIR
000010  00                DCB      0x00
                  num_of_wrks_bps
000011  00                DCB      0x00
                  num_necc_up
000012  00                DCB      0x00
                  num_necc_down
000013  00                DCB      0x00
                  sh_cnt0
000014  00                DCB      0x00
                  b1Hz_sh
000015  00                DCB      0x00
                  spc_stat
000016  00                DCB      0x00
                  spc_bat
000017  00                DCB      0x00
                  spc_phase
000018  00                DCB      0x00
                  ke_start_stat
000019  00                DCB      0x00
                  numOfForvardBps
00001a  00                DCB      0x00
                  numOfForvardBps_old
00001b  00                DCB      0x00
                  numOfForvardBps_minCnt
00001c  00                DCB      0x00
                  cntrl_hndl_plazma
00001d  00                DCB      0x00
                  cntrl_stat
00001e  04b0              DCW      0x04b0
                  cntrl_stat_old
000020  04b0              DCW      0x04b0
                  avg_main_cnt
000022  0014              DCW      0x0014
                  u_out_reg_main_cnt
000024  000a              DCW      0x000a
                  num_necc_block_cnt
000026  0000              DCB      0x00,0x00
                  net_buff_
000028  0000              DCB      0x00,0x00
                  adc_result
00002a  0000              DCB      0x00,0x00
                  adc_gorb_cnt
00002c  0000              DCB      0x00,0x00
                  adc_zero_cnt
00002e  0000              DCB      0x00,0x00
                  adc_window_cnt
000030  0000              DCB      0x00,0x00
                  adc_net_buff_cnt
000032  0000              DCB      0x00,0x00
                  rele_on_cnt
000034  0000              DCB      0x00,0x00
                  plazma_sk
000036  0000              DCB      0x00,0x00
                  cntrl_stat_new
000038  0000              DCB      0x00,0x00
                  Ibmax
00003a  0000              DCB      0x00,0x00
                  IZMAX_
00003c  0000              DCB      0x00,0x00
                  Ubpsmax
00003e  0000              DCB      0x00,0x00
                  cntrl_stat_buff_
000040  0000              DCB      0x00,0x00
                  samokalibr_cnt
000042  0000              DCB      0x00,0x00
                  main_kb_cnt
000044  0000              DCB      0x00,0x00
                  __ee_spc_stat
000046  0000              DCB      0x00,0x00
                  __ee_spc_bat
000048  0000              DCB      0x00,0x00
                  __ee_spc_phase
00004a  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt
00004c  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt_
00004e  0000              DCB      0x00,0x00
                  numOfForvardBps_hourCnt
000050  00000000          DCB      0x00,0x00,0x00,0x00
                  i_avg_max
                          DCD      0x00000000
                  i_avg_min
                          DCD      0x00000000
                  i_avg_summ
                          DCD      0x00000000
                  i_avg
                          DCD      0x00000000
                  avg
                          DCD      0x00000000
                  bps_on_mask
                          DCD      0x00000000
                  bps_off_mask
                          DCD      0x00000000
                  plazma_inv
                          DCD      0x00000000
                  net_metr_buff_
                          DCD      0x00000000
000078  0000              DCB      0x00,0x00
                  adc_self_ch_buff
00007a  0000              DCB      0x00,0x00
                          DCD      0x00000000
                  adc_self_ch_disp
                          DCD      0x00000000
000084  00000000          DCB      0x00,0x00,0x00,0x00
                  ke_date
                          %        8

                          AREA ||area_number.27||, DATA, ALIGN=1

                          EXPORTAS ||area_number.27||, ||.data||
                  unet_buff_max
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.28||, DATA, ALIGN=0

                          EXPORTAS ||area_number.28||, ||.data||
                  adc_cnt
000000  00                DCB      0x00

                          AREA ||area_number.29||, DATA, ALIGN=0

                          EXPORTAS ||area_number.29||, ||.data||
                  adc_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.30||, DATA, ALIGN=1

                          EXPORTAS ||area_number.30||, ||.data||
                  zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.31||, DATA, ALIGN=0

                          EXPORTAS ||area_number.31||, ||.data||
                  net_buff_cnt
000000  00                DCB      0x00

                          AREA ||area_number.32||, DATA, ALIGN=1

                          EXPORTAS ||area_number.32||, ||.data||
                  ADWR
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.33||, DATA, ALIGN=1

                          EXPORTAS ||area_number.33||, ||.data||
                  period_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.34||, DATA, ALIGN=1

                          EXPORTAS ||area_number.34||, ||.data||
                  non_zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.35||, DATA, ALIGN=0

                          EXPORTAS ||area_number.35||, ||.data||
                  rele_stat
000000  00                DCB      0x00

                          AREA ||area_number.36||, DATA, ALIGN=0

                          EXPORTAS ||area_number.36||, ||.data||
                  bRELE_OUT
000000  00                DCB      0x00

                          AREA ||area_number.37||, DATA, ALIGN=2

                          EXPORTAS ||area_number.37||, ||.data||
                  main_power_buffer_
                          DCD      0x00000000

                          AREA ||area_number.38||, DATA, ALIGN=1

                          EXPORTAS ||area_number.38||, ||.data||
                  main_power_buffer_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.39||, DATA, ALIGN=1

                          EXPORTAS ||area_number.39||, ||.data||
                  adc_buff_out_
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00

                          AREA ||area_number.40||, DATA, ALIGN=1

                          EXPORTAS ||area_number.40||, ||.data||
                  plazma_adc_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.41||, DATA, ALIGN=0

                          EXPORTAS ||area_number.41||, ||.data||
                  unh_cnt0
000000  00                DCB      0x00

                          AREA ||area_number.42||, DATA, ALIGN=0

                          EXPORTAS ||area_number.42||, ||.data||
                  unh_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.43||, DATA, ALIGN=0

                          EXPORTAS ||area_number.43||, ||.data||
                  b1Hz_unh
000000  00                DCB      0x00

                          AREA ||area_number.44||, DATA, ALIGN=0

                          EXPORTAS ||area_number.44||, ||.data||
                  ch_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.45||, DATA, ALIGN=0

                          EXPORTAS ||area_number.45||, ||.data||
                  b1_30Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.46||, DATA, ALIGN=0

                          EXPORTAS ||area_number.46||, ||.data||
                  ch_cnt2
000000  00                DCB      0x00

                          AREA ||area_number.47||, DATA, ALIGN=0

                          EXPORTAS ||area_number.47||, ||.data||
                  b1_10Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.48||, DATA, ALIGN=1

                          EXPORTAS ||area_number.48||, ||.data||
                  IZMAX_70
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.49||, DATA, ALIGN=1

                          EXPORTAS ||area_number.49||, ||.data||
                  IZMAX_130
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.50||, DATA, ALIGN=1

                          EXPORTAS ||area_number.50||, ||.data||
                  cntrl_stat_blck_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.51||, DATA, ALIGN=1

                          EXPORTAS ||area_number.51||, ||.data||
                  kb_cnt_1lev
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.52||, DATA, ALIGN=1

                          EXPORTAS ||area_number.52||, ||.data||
                  kb_cnt_2lev
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.53||, DATA, ALIGN=0

                          EXPORTAS ||area_number.53||, ||.data||
                  kb_full_ver
000000  00                DCB      0x00

                          AREA ||area_number.54||, DATA, ALIGN=0

                          EXPORTAS ||area_number.54||, ||.data||
                  kb_start
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.55||, DATA, ALIGN=0

                          EXPORTAS ||area_number.55||, ||.data||
                  kb_start_ips
000000  00                DCB      0x00

                          AREA ||area_number.56||, DATA, ALIGN=1

                          EXPORTAS ||area_number.56||, ||.data||
                  ibat_ips
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.57||, DATA, ALIGN=1

                          EXPORTAS ||area_number.57||, ||.data||
                  ibat_ips_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.58||, DATA, ALIGN=0

                          EXPORTAS ||area_number.58||, ||.data||
                  bps_all_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.59||, DATA, ALIGN=0

                          EXPORTAS ||area_number.59||, ||.data||
                  bps_mask_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.60||, DATA, ALIGN=0

                          EXPORTAS ||area_number.60||, ||.data||
                  bps_mask_on_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.61||, DATA, ALIGN=0

                          EXPORTAS ||area_number.61||, ||.data||
                  bps_hndl_2sec_cnt
000000  00                DCB      0x00

                          AREA ||area_number.62||, DATA, ALIGN=1

                          EXPORTAS ||area_number.62||, ||.data||
                  vz_cnt_s
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.63||, DATA, ALIGN=1

                          EXPORTAS ||area_number.63||, ||.data||
                  vz_cnt_s_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.64||, DATA, ALIGN=1

                          EXPORTAS ||area_number.64||, ||.data||
                  vz_cnt_h
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.65||, DATA, ALIGN=1

                          EXPORTAS ||area_number.65||, ||.data||
                  vz_cnt_h_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.66||, DATA, ALIGN=0

                          EXPORTAS ||area_number.66||, ||.data||
                  bAVZ
000000  00                DCB      0x00

                          AREA ||area_number.67||, DATA, ALIGN=1

                          EXPORTAS ||area_number.67||, ||.data||
                  cnt_end_ke
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.68||, DATA, ALIGN=1

                          EXPORTAS ||area_number.68||, ||.data||
                  __ee_vz_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.69||, DATA, ALIGN=1

                          EXPORTAS ||area_number.69||, ||.data||
                  cntrl_stat_blok_cnt_plus
                          DCDU     0x00000000

                          AREA ||area_number.70||, DATA, ALIGN=1

                          EXPORTAS ||area_number.70||, ||.data||
                  cntrl_stat_blok_cnt_minus
                          DCDU     0x00000000

                          AREA ||area_number.71||, DATA, ALIGN=0

                          EXPORTAS ||area_number.71||, ||.data||
                  plazma_bat
000000  00                DCB      0x00

                          AREA ||area_number.72||, DATA, ALIGN=0

                          EXPORTAS ||area_number.72||, ||.data||
                  plazma_cntrl_stat
000000  00                DCB      0x00
