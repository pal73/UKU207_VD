; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\control.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\control.d --feedback=.\EXE\UKU_VD.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_VD -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\control.crf control.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  ke_start PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  e92d41fc          PUSH     {r2-r8,lr}
;;;245    {          
000004  4606              MOV      r6,r0
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000006  f04f0700          MOV      r7,#0
00000a  4dff              LDR      r5,|L1.1032|
00000c  766f              STRB     r7,[r5,#0x19]
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  7da8              LDRB     r0,[r5,#0x16]  ; spc_stat
000010  f04f0301          MOV      r3,#1
000014  2802              CMP      r0,#2
000016  d00f              BEQ      |L1.56|
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  eb060146          ADD      r1,r6,r6,LSL #1
00001c  eb011206          ADD      r2,r1,r6,LSL #4
000020  49fa              LDR      r1,|L1.1036|
000022  eb010482          ADD      r4,r1,r2,LSL #2
000026  f894103d          LDRB     r1,[r4,#0x3d]
00002a  07ca              LSLS     r2,r1,#31
00002c  d006              BEQ      |L1.60|
00002e  f04f0066          MOV      r0,#0x66
000032  7668              STRB     r0,[r5,#0x19]
                  |L1.52|
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
000034  e8bd81fc          POP      {r2-r8,pc}
                  |L1.56|
000038  766b              STRB     r3,[r5,#0x19]         ;248
00003a  e7fb              B        |L1.52|
                  |L1.60|
00003c  f894203f          LDRB     r2,[r4,#0x3f]         ;253
000040  0792              LSLS     r2,r2,#30             ;253
000042  d503              BPL      |L1.76|
000044  f04f0067          MOV      r0,#0x67              ;253
000048  7668              STRB     r0,[r5,#0x19]         ;253
00004a  e7f3              B        |L1.52|
                  |L1.76|
00004c  0789              LSLS     r1,r1,#30             ;254
00004e  d503              BPL      |L1.88|
000050  f04f0068          MOV      r0,#0x68              ;254
000054  7668              STRB     r0,[r5,#0x19]         ;254
000056  e7ed              B        |L1.52|
                  |L1.88|
000058  4aed              LDR      r2,|L1.1040|
00005a  f9b41008          LDRSH    r1,[r4,#8]            ;255
00005e  f9b22000          LDRSH    r2,[r2,#0]            ;255  ; IKB
000062  4291              CMP      r1,r2                 ;255
000064  dd03              BLE      |L1.110|
000066  f04f0069          MOV      r0,#0x69              ;255
00006a  7668              STRB     r0,[r5,#0x19]         ;255
00006c  e7e2              B        |L1.52|
                  |L1.110|
00006e  4252              RSBS     r2,r2,#0              ;256
000070  4291              CMP      r1,r2                 ;256
000072  da03              BGE      |L1.124|
000074  f04f006a          MOV      r0,#0x6a              ;256
000078  7668              STRB     r0,[r5,#0x19]         ;256
00007a  e7db              B        |L1.52|
                  |L1.124|
00007c  49e2              LDR      r1,|L1.1032|
00007e  2801              CMP      r0,#1                 ;257
000080  7dc9              LDRB     r1,[r1,#0x17]         ;257
000082  d100              BNE      |L1.134|
000084  b111              CBZ      r1,|L1.140|
                  |L1.134|
000086  2801              CMP      r0,#1                 ;258
000088  d004              BEQ      |L1.148|
00008a  e005              B        |L1.152|
                  |L1.140|
00008c  f04f006b          MOV      r0,#0x6b              ;257
000090  7668              STRB     r0,[r5,#0x19]         ;257
000092  e7cf              B        |L1.52|
                  |L1.148|
000094  2901              CMP      r1,#1                 ;258
000096  d07d              BEQ      |L1.404|
                  |L1.152|
000098  f1050516          ADD      r5,r5,#0x16           ;262
00009c  f04f0064          MOV      r0,#0x64              ;262
0000a0  70e8              STRB     r0,[r5,#3]            ;262
0000a2  702b              STRB     r3,[r5,#0]            ;264
0000a4  866b              STRH     r3,[r5,#0x32]         ;265
0000a6  4619              MOV      r1,r3                 ;266
0000a8  f44f70f8          MOV      r0,#0x1f0             ;266
0000ac  f7fffffe          BL       lc640_write_int
0000b0  706e              STRB     r6,[r5,#1]            ;268
0000b2  86ae              STRH     r6,[r5,#0x34]         ;269
0000b4  4631              MOV      r1,r6                 ;270
0000b6  f44f70fa          MOV      r0,#0x1f4             ;270
0000ba  f7fffffe          BL       lc640_write_int
0000be  61a7              STR      r7,[r4,#0x18]         ;272
0000c0  48d4              LDR      r0,|L1.1044|
0000c2  2100              MOVS     r1,#0                 ;273
0000c4  f9300016          LDRSH    r0,[r0,r6,LSL #1]     ;273
0000c8  f7fffffe          BL       lc640_write_int
0000cc  70af              STRB     r7,[r5,#2]            ;275
0000ce  86ef              STRH     r7,[r5,#0x36]         ;276
0000d0  4639              MOV      r1,r7                 ;277
0000d2  f44f70fb          MOV      r0,#0x1f6             ;277
0000d6  f7fffffe          BL       lc640_write_int
0000da  48cf              LDR      r0,|L1.1048|
0000dc  8800              LDRH     r0,[r0,#0]            ;284  ; bat_u_old_cnt
0000de  f1000001          ADD      r0,r0,#1              ;284
0000e2  f0000007          AND      r0,r0,#7              ;284
0000e6  eb040040          ADD      r0,r4,r0,LSL #1       ;284
0000ea  8c00              LDRH     r0,[r0,#0x20]         ;284
0000ec  9001              STR      r0,[sp,#4]            ;284
0000ee  4dcb              LDR      r5,|L1.1052|
0000f0  8ba8              LDRH     r0,[r5,#0x1c]         ;286
0000f2  9000              STR      r0,[sp,#0]            ;286
0000f4  f04f0263          MOV      r2,#0x63              ;287
0000f8  f04f0101          MOV      r1,#1                 ;287
0000fc  4668              MOV      r0,sp                 ;287
0000fe  f7fffffe          BL       gran_char
000102  4cc1              LDR      r4,|L1.1032|
000104  f89d0000          LDRB     r0,[sp,#0]            ;288
000108  3480              ADDS     r4,r4,#0x80           ;288
00010a  7020              STRB     r0,[r4,#0]            ;288
00010c  7e28              LDRB     r0,[r5,#0x18]         ;290
00010e  9000              STR      r0,[sp,#0]            ;290
000110  220c              MOVS     r2,#0xc               ;291
000112  2101              MOVS     r1,#1                 ;291
000114  4668              MOV      r0,sp                 ;291
000116  f7fffffe          BL       gran_char
00011a  f89d0000          LDRB     r0,[sp,#0]            ;292
00011e  7060              STRB     r0,[r4,#1]            ;292
000120  7b28              LDRB     r0,[r5,#0xc]          ;294
000122  9000              STR      r0,[sp,#0]            ;294
000124  221f              MOVS     r2,#0x1f              ;295
000126  2101              MOVS     r1,#1                 ;295
000128  4668              MOV      r0,sp                 ;295
00012a  f7fffffe          BL       gran_char
00012e  f89d0000          LDRB     r0,[sp,#0]            ;296
000132  70a0              STRB     r0,[r4,#2]            ;296
000134  f89d0004          LDRB     r0,[sp,#4]            ;298
000138  70e0              STRB     r0,[r4,#3]            ;298
00013a  f44f70fc          MOV      r0,#0x1f8             ;299
00013e  6821              LDR      r1,[r4,#0]            ;299  ; ke_date
000140  f7fffffe          BL       lc640_write_long
000144  7a28              LDRB     r0,[r5,#8]            ;301
000146  9000              STR      r0,[sp,#0]            ;301
000148  2217              MOVS     r2,#0x17              ;302
00014a  2100              MOVS     r1,#0                 ;302
00014c  4668              MOV      r0,sp                 ;302
00014e  f7fffffe          BL       gran_char
000152  f89d0000          LDRB     r0,[sp,#0]            ;303
000156  7120              STRB     r0,[r4,#4]            ;303
000158  7928              LDRB     r0,[r5,#4]            ;305
00015a  9000              STR      r0,[sp,#0]            ;305
00015c  223b              MOVS     r2,#0x3b              ;306
00015e  2100              MOVS     r1,#0                 ;306
000160  4668              MOV      r0,sp                 ;306
000162  f7fffffe          BL       gran_char
000166  f89d0000          LDRB     r0,[sp,#0]            ;307
00016a  7160              STRB     r0,[r4,#5]            ;307
00016c  7828              LDRB     r0,[r5,#0]            ;309
00016e  9000              STR      r0,[sp,#0]            ;309
000170  223b              MOVS     r2,#0x3b              ;310
000172  2100              MOVS     r1,#0                 ;310
000174  4668              MOV      r0,sp                 ;310
000176  f7fffffe          BL       gran_char
00017a  f89d0000          LDRB     r0,[sp,#0]            ;311
00017e  71a0              STRB     r0,[r4,#6]            ;311
000180  f89d0005          LDRB     r0,[sp,#5]            ;313
000184  71e0              STRB     r0,[r4,#7]            ;313
000186  f44f70fe          MOV      r0,#0x1fc             ;314
00018a  6861              LDR      r1,[r4,#4]            ;314  ; ke_date
00018c  f7fffffe          BL       lc640_write_long
000190  e750              B        |L1.52|
000192  e7ff              B        |L1.404|
                  |L1.404|
000194  f04f006c          MOV      r0,#0x6c              ;258
000198  7668              STRB     r0,[r5,#0x19]         ;258
00019a  e74b              B        |L1.52|
;;;319    
                          ENDP

                  samokalibr_hndl PROC
;;;326    //-----------------------------------------------
;;;327    void samokalibr_hndl(void)
00019c  e92d47f0          PUSH     {r4-r10,lr}
;;;328    {
;;;329    if(++samokalibr_cnt>=1800)samokalibr_cnt=0;
0001a0  4c99              LDR      r4,|L1.1032|
0001a2  f8b40040          LDRH     r0,[r4,#0x40]  ; samokalibr_cnt
0001a6  1c40              ADDS     r0,r0,#1
0001a8  b200              SXTH     r0,r0
0001aa  f8a40040          STRH     r0,[r4,#0x40]
0001ae  f5b06fe1          CMP      r0,#0x708
0001b2  db03              BLT      |L1.444|
0001b4  f04f0000          MOV      r0,#0
0001b8  f8a40040          STRH     r0,[r4,#0x40]
                  |L1.444|
;;;330    
;;;331    if(samokalibr_cnt>=1785U)
0001bc  f9b40040          LDRSH    r0,[r4,#0x40]  ; samokalibr_cnt
0001c0  f5b06fdf          CMP      r0,#0x6f8
0001c4  d911              BLS      |L1.490|
;;;332    	{
;;;333    	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,15);
0001c6  230f              MOVS     r3,#0xf
0001c8  2201              MOVS     r2,#1
0001ca  2164              MOVS     r1,#0x64
0001cc  20d2              MOVS     r0,#0xd2
0001ce  f7fffffe          BL       mess_send
;;;334    	mess_send(MESS2IND_HNDL,PARAM_SAMOKALIBR,0,15);
0001d2  230f              MOVS     r3,#0xf
0001d4  2200              MOVS     r2,#0
0001d6  21d8              MOVS     r1,#0xd8
0001d8  20d7              MOVS     r0,#0xd7
0001da  f7fffffe          BL       mess_send
;;;335    	mess_send(MESS2MATEMAT,PARAM_SAMOKALIBR,0,15);
0001de  230f              MOVS     r3,#0xf
0001e0  2200              MOVS     r2,#0
0001e2  21d8              MOVS     r1,#0xd8
0001e4  20dc              MOVS     r0,#0xdc
0001e6  f7fffffe          BL       mess_send
                  |L1.490|
;;;336    	} 
;;;337    
;;;338    if(samokalibr_cnt==1799U)
0001ea  f9b40040          LDRSH    r0,[r4,#0x40]  ; samokalibr_cnt
0001ee  f5a061e0          SUB      r1,r0,#0x700
0001f2  3907              SUBS     r1,#7
0001f4  d133              BNE      |L1.606|
;;;339    	{
;;;340    	if((Kibat0[0]!=ad7705_buff_[0])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[0],ad7705_buff_[0]);
0001f6  4d8a              LDR      r5,|L1.1056|
0001f8  4c8a              LDR      r4,|L1.1060|
0001fa  4e84              LDR      r6,|L1.1036|
0001fc  8828              LDRH     r0,[r5,#0]  ; Kibat0
0001fe  8821              LDRH     r1,[r4,#0]  ; ad7705_buff_
000200  270a              MOVS     r7,#0xa
000202  f8df8224          LDR      r8,|L1.1064|
000206  f8df9224          LDR      r9,|L1.1068|
00020a  4288              CMP      r0,r1
00020c  d010              BEQ      |L1.560|
00020e  f9b60008          LDRSH    r0,[r6,#8]  ; bat
000212  fb90f0f7          SDIV     r0,r0,r7
000216  b200              SXTH     r0,r0
000218  f7fffffe          BL       abs
00021c  f9b81000          LDRSH    r1,[r8,#0]  ; IZMAX
000220  4288              CMP      r0,r1
000222  da05              BGE      |L1.560|
000224  f9b41000          LDRSH    r1,[r4,#0]  ; ad7705_buff_
000228  f9b90000          LDRSH    r0,[r9,#0]  ; ADR_KI0BAT
00022c  f7fffffe          BL       lc640_write_int
                  |L1.560|
;;;341    	if((Kibat0[1]!=ad7705_buff_[1])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[1],ad7705_buff_[1]);
000230  8868              LDRH     r0,[r5,#2]  ; Kibat0
000232  8861              LDRH     r1,[r4,#2]  ; ad7705_buff_
000234  4288              CMP      r0,r1
000236  d012              BEQ      |L1.606|
000238  f9b60008          LDRSH    r0,[r6,#8]  ; bat
00023c  fb90f0f7          SDIV     r0,r0,r7
000240  b200              SXTH     r0,r0
000242  f7fffffe          BL       abs
000246  f9b81000          LDRSH    r1,[r8,#0]  ; IZMAX
00024a  4288              CMP      r0,r1
00024c  da07              BGE      |L1.606|
00024e  f9b41002          LDRSH    r1,[r4,#2]  ; ad7705_buff_
000252  f9b90002          LDRSH    r0,[r9,#2]  ; ADR_KI0BAT
000256  e8bd47f0          POP      {r4-r10,lr}
00025a  f7ffbffe          B.W      lc640_write_int
                  |L1.606|
;;;342    	
;;;343    	}	 	
;;;344    }
00025e  e8bd87f0          POP      {r4-r10,pc}
;;;345    
                          ENDP

                  ubat_old_drv PROC
;;;348    //-----------------------------------------------
;;;349    void ubat_old_drv(void)
000262  b510              PUSH     {r4,lr}
;;;350    {        
;;;351    bat_u_old_cnt++;
000264  4c6c              LDR      r4,|L1.1048|
000266  8820              LDRH     r0,[r4,#0]  ; bat_u_old_cnt
000268  f1000001          ADD      r0,r0,#1
00026c  8020              STRH     r0,[r4,#0]
;;;352    gran_ring(&bat_u_old_cnt,0,8);
00026e  f04f0208          MOV      r2,#8
000272  f04f0100          MOV      r1,#0
000276  4620              MOV      r0,r4
000278  f7fffffe          BL       gran_ring
;;;353    
;;;354    bat[0]._u_old[bat_u_old_cnt]=bat[0]._Ub;
00027c  4963              LDR      r1,|L1.1036|
00027e  f9b40000          LDRSH    r0,[r4,#0]  ; bat_u_old_cnt
000282  eb010040          ADD      r0,r1,r0,LSL #1
000286  884a              LDRH     r2,[r1,#2]  ; bat
000288  8402              STRH     r2,[r0,#0x20]
;;;355    bat[1]._u_old[bat_u_old_cnt]=bat[1]._Ub;
00028a  f8b1104e          LDRH     r1,[r1,#0x4e]  ; bat
00028e  f8a0106c          STRH     r1,[r0,#0x6c]
;;;356    }
000292  bd10              POP      {r4,pc}
;;;357    /*
                          ENDP

                  matemat PROC
;;;394    //-----------------------------------------------
;;;395    void matemat(void)
000294  e92d4ffe          PUSH     {r1-r11,lr}
;;;396    {
;;;397    //signed short temp_SS;
;;;398    signed long temp_SL/*,temp_SL_*/;
;;;399    char /*temp,*/i;
;;;400    //signed short temp_SS;
;;;401    
;;;402    #ifdef UKU_MGTS
;;;403    //напр€жение сети
;;;404    temp_SL=(signed long)net_buff_;
;;;405    temp_SL*=Kunet;
;;;406    temp_SL/=110000L;
;;;407    net_U=(signed short)temp_SL;
;;;408    #endif
;;;409    
;;;410    #ifdef UKU_RSTKM
;;;411    //напр€жение сети
;;;412    temp_SL=(signed long)net_buff_;
;;;413    temp_SL*=Kunet;
;;;414    temp_SL/=110000L;
;;;415    net_U=(signed short)temp_SL;
;;;416    #endif
;;;417    
;;;418    #ifdef UKU_3U
;;;419    //напр€жение сети
;;;420    temp_SL=(signed long)net_buff_;
;;;421    temp_SL*=Kunet;
;;;422    temp_SL/=36000L;
;;;423    net_U=(signed short)temp_SL;
;;;424    #endif
;;;425    
;;;426    #ifdef UKU_6U
;;;427    //напр€жение сети
;;;428    
;;;429    if((AUSW_MAIN%10)||(AUSW_MAIN==2400)||(AUSW_MAIN==4800)||(AUSW_MAIN==6000))
;;;430    	{
;;;431    
;;;432    	if(bps[11]._device==dNET_METR)
;;;433    		{
;;;434    		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;435    		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;436    		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;437    
;;;438    		temp_SL=(signed long)net_metr_buff_[0];
;;;439    		temp_SL*=KunetA;
;;;440    		temp_SL/=6000L;
;;;441    		net_Ua=(signed short)temp_SL;
;;;442    	
;;;443    		temp_SL=(signed long)net_metr_buff_[1];
;;;444    		temp_SL*=KunetB;
;;;445    		temp_SL/=6000L;
;;;446    		net_Ub=(signed short)temp_SL;
;;;447    	
;;;448    		temp_SL=(signed long)net_metr_buff_[2];
;;;449    		temp_SL*=KunetC;
;;;450    		temp_SL/=6000L;
;;;451    		net_Uc=(signed short)temp_SL;
;;;452    		}
;;;453    	else
;;;454    		{
;;;455    		temp_SL=(signed long)net_buff_;
;;;456    		temp_SL*=KunetA;
;;;457    		temp_SL/=110000L;
;;;458    		net_Ua=(signed short)temp_SL;
;;;459    	
;;;460    		temp_SL=(signed long)adc_buff_[3];
;;;461    		temp_SL*=KunetB;
;;;462    		temp_SL/=6000L;
;;;463    		net_Ub=(signed short)temp_SL;
;;;464    	
;;;465    		temp_SL=(signed long)adc_buff_[10];
;;;466    		temp_SL*=KunetC;
;;;467    		temp_SL/=6000L;
;;;468    		net_Uc=(signed short)temp_SL;
;;;469    		}
;;;470    
;;;471    	net_U=net_Ua;
;;;472    	if(net_Ub<net_U)net_U=net_Ub;
;;;473    	if(net_Uc<net_U)net_U=net_Uc;
;;;474    	}
;;;475    else 
;;;476    	{
;;;477    	temp_SL=(signed long)net_buff_;
;;;478    	temp_SL*=Kunet;
;;;479    	temp_SL/=110000L;
;;;480    	net_U=(signed short)temp_SL;
;;;481    	}
;;;482    
;;;483    
;;;484    
;;;485    
;;;486    #endif
;;;487    
;;;488    #ifdef UKU_GLONASS
;;;489    //напр€жение сети
;;;490    temp_SL=(signed long)net_buff_;
;;;491    temp_SL*=Kunet;
;;;492    temp_SL/=110000L;
;;;493    net_U=(signed short)temp_SL;
;;;494    #endif
;;;495    
;;;496    #ifdef UKU_KONTUR
;;;497    //напр€жение сети
;;;498    temp_SL=(signed long)net_buff_;
;;;499    temp_SL*=Kunet;
;;;500    temp_SL/=110000L;
;;;501    net_U=(signed short)temp_SL;
;;;502    #endif
;;;503    
;;;504    
;;;505    #ifdef UKU_220_V2
;;;506    //напр€жение сети
;;;507    
;;;508    if(AUSW_MAIN==22033)
;;;509    	{
;;;510    	temp_SL=(signed long)net_buff_;
;;;511    	temp_SL*=KunetA;
;;;512    	temp_SL/=6000L;
;;;513    	net_Ua=(signed short)temp_SL;
;;;514    
;;;515    	temp_SL=(signed long)adc_buff_[3];
;;;516    	temp_SL*=KunetB;
;;;517    	temp_SL/=6000L;
;;;518    	net_Ub=(signed short)temp_SL;
;;;519    
;;;520    	temp_SL=(signed long)adc_buff_[10];
;;;521    	temp_SL*=KunetC;
;;;522    	temp_SL/=6000L;
;;;523    	net_Uc=(signed short)temp_SL;
;;;524    
;;;525    	net_U=net_Ua;
;;;526    	if(net_Ub<net_U)net_U=net_Ub;
;;;527    	if(net_Uc<net_U)net_U=net_Uc;
;;;528    	}
;;;529    else
;;;530    	{
;;;531    	temp_SL=(signed long)net_buff_;
;;;532    	temp_SL*=Kunet;
;;;533    	temp_SL/=5000L;
;;;534    	net_U=(signed short)temp_SL;
;;;535    	}
;;;536    #endif
;;;537    
;;;538    
;;;539    #ifdef UKU_220
;;;540    //напр€жение сети
;;;541    
;;;542    if(AUSW_MAIN==22035)
;;;543    	{
;;;544    	temp_SL=(signed long)net_buff_;
;;;545    	temp_SL*=KunetA;
;;;546    	temp_SL/=6000L;
;;;547    	net_Ua=(signed short)temp_SL;
;;;548    
;;;549    	temp_SL=(signed long)adc_buff_[3];
;;;550    	temp_SL*=KunetB;
;;;551    	temp_SL/=6000L;
;;;552    	net_Ub=(signed short)temp_SL;
;;;553    
;;;554    	temp_SL=(signed long)adc_buff_[10];
;;;555    	temp_SL*=KunetC;
;;;556    	temp_SL/=6000L;
;;;557    	net_Uc=(signed short)temp_SL;
;;;558    
;;;559    	net_U=net_Ua;
;;;560    	if(net_Ub<net_U)net_U=net_Ub;
;;;561    	if(net_Uc<net_U)net_U=net_Uc;
;;;562    	}
;;;563    else
;;;564    	{
;;;565    	temp_SL=(signed long)net_buff_;
;;;566    	temp_SL*=Kunet;
;;;567    	#ifdef _ACDC_
;;;568    	temp_SL/=500L;
;;;569    	#else
;;;570    	temp_SL/=5000L;
;;;571    	#endif
;;;572    	net_U=(signed short)temp_SL;
;;;573    	
;;;574    	}
;;;575    #endif
;;;576    
;;;577    #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;578    //напр€жение сети
;;;579    
;;;580    
;;;581    	if(bps[11]._device==dNET_METR)
000298  4865              LDR      r0,|L1.1072|
;;;582    		{
;;;583    		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;584    		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;585    		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;586    
;;;587    		temp_SL=(signed long)net_metr_buff_[2];
;;;588    		temp_SL*=KunetA;
00029a  4a66              LDR      r2,|L1.1076|
;;;589    		temp_SL/=6000L;
;;;590    		net_Ua=(signed short)temp_SL;
;;;591    	
;;;592    		temp_SL=(signed long)net_metr_buff_[1];
;;;593    		temp_SL*=KunetB;
00029c  4967              LDR      r1,|L1.1084|
00029e  f8900478          LDRB     r0,[r0,#0x478]        ;581  ; bps
0002a2  9002              STR      r0,[sp,#8]            ;588
;;;594    		temp_SL/=6000L;
;;;595    		net_Ub=(signed short)temp_SL;
;;;596    	
;;;597    		temp_SL=(signed long)net_metr_buff_[0];
;;;598    		temp_SL*=KunetC;
0002a4  4b66              LDR      r3,|L1.1088|
0002a6  f9b2b000          LDRSH    r11,[r2,#0]           ;588
0002aa  f9b11000          LDRSH    r1,[r1,#0]            ;593
0002ae  9101              STR      r1,[sp,#4]
0002b0  f9b31000          LDRSH    r1,[r3,#0]
0002b4  4d60              LDR      r5,|L1.1080|
0002b6  4b63              LDR      r3,|L1.1092|
;;;599    		temp_SL/=6000L;
;;;600    		net_Uc=(signed short)temp_SL;
0002b8  4e63              LDR      r6,|L1.1096|
;;;601    
;;;602    		net_F3=((signed short)bps[11]._buff[6])+(((signed short)bps[11]._buff[7])<<8);
;;;603    
;;;604    		net_U=net_Ua;
0002ba  4c64              LDR      r4,|L1.1100|
;;;605    		if(net_Ub<net_U)net_U=net_Ub;
;;;606    		if(net_Uc<net_U)net_U=net_Uc;
;;;607    		}
;;;608    	  else if(AUSW_MAIN==22033)
0002bc  f8dfa190          LDR      r10,|L1.1104|
0002c0  f2456711          MOV      r7,#0x5611
;;;609    	{
;;;610    	temp_SL=(signed long)net_buff_;
;;;611    	temp_SL*=KunetA;
;;;612    	temp_SL/=4000L;
;;;613    	net_Ua=(signed short)temp_SL;
;;;614    
;;;615    	temp_SL=(signed long)adc_buff_[3];
;;;616    	temp_SL*=KunetB;
;;;617    	temp_SL/=6000L;
;;;618    	net_Ub=(signed short)temp_SL;
;;;619    
;;;620    	temp_SL=(signed long)adc_buff_[10];
;;;621    	temp_SL*=KunetC;
;;;622    	temp_SL/=6000L;
;;;623    	net_Uc=(signed short)temp_SL;
;;;624    
;;;625    	net_U=net_Ua;
;;;626    	if(net_Ub<net_U)net_U=net_Ub;
;;;627    	if(net_Uc<net_U)net_U=net_Uc;
;;;628    	}
;;;629    else if((AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043)||(AUSW_MAIN==22018))
;;;630    	{
;;;631    	temp_SL=(signed long)net_buff_;
;;;632    	temp_SL*=KunetA;
;;;633    	temp_SL/=40000L;
;;;634    	net_Ua=(signed short)temp_SL;
;;;635    
;;;636    	temp_SL=(signed long)adc_buff_[3];
;;;637    	temp_SL*=KunetB;
;;;638    	temp_SL/=6000L;
;;;639    	net_Ub=(signed short)temp_SL;
;;;640    
;;;641    	temp_SL=(signed long)adc_buff_[10];
;;;642    	temp_SL*=KunetC;
;;;643    	temp_SL/=6000L;
;;;644    	net_Uc=(signed short)temp_SL;
;;;645    
;;;646    	net_U=net_Ua;
;;;647    	if(net_Ub<net_U)net_U=net_Ub;
;;;648    	if(net_Uc<net_U)net_U=net_Uc;
;;;649    	}
;;;650    else	if((AUSW_MAIN==22010)||(AUSW_MAIN==22011) )
0002c4  f24559fa          MOV      r9,#0x55fa
0002c8  9100              STR      r1,[sp,#0]            ;581
0002ca  2807              CMP      r0,#7                 ;581
0002cc  d038              BEQ      |L1.832|
0002ce  494e              LDR      r1,|L1.1032|
0002d0  f8dfc180          LDR      r12,|L1.1108|
0002d4  f8df8164          LDR      r8,|L1.1084|
0002d8  8d0a              LDRH     r2,[r1,#0x28]         ;610
0002da  4956              LDR      r1,|L1.1076|
0002dc  f9b88000          LDRSH    r8,[r8,#0]            ;593
0002e0  f2417b70          MOV      r11,#0x1770           ;589
0002e4  f9b11000          LDRSH    r1,[r1,#0]            ;588
0002e8  f8ba0000          LDRH     r0,[r10,#0]           ;608  ; AUSW_MAIN
0002ec  434a              MULS     r2,r1,r2              ;611
0002ee  f9bc1006          LDRSH    r1,[r12,#6]           ;615
0002f2  f9bcc014          LDRSH    r12,[r12,#0x14]       ;620
0002f6  fb01f108          MUL      r1,r1,r8              ;616
0002fa  f8df8144          LDR      r8,|L1.1088|
0002fe  fb91f1fb          SDIV     r1,r1,r11             ;617
000302  f9b88000          LDRSH    r8,[r8,#0]            ;598
000306  b209              SXTH     r1,r1                 ;618
000308  fb0cfc08          MUL      r12,r12,r8            ;621
00030c  fb9cfcfb          SDIV     r12,r12,r11           ;622
000310  fa0ffc8c          SXTH     r12,r12               ;623
000314  42b8              CMP      r0,r7                 ;608
000316  d158              BNE      |L1.970|
000318  f44f607a          MOV      r0,#0xfa0             ;612
00031c  fb92f0f0          SDIV     r0,r2,r0              ;612
000320  b200              SXTH     r0,r0                 ;613
000322  8028              STRH     r0,[r5,#0]            ;613
000324  8019              STRH     r1,[r3,#0]            ;618
000326  f8a6c000          STRH     r12,[r6,#0]           ;623
00032a  8020              STRH     r0,[r4,#0]            ;625
00032c  4281              CMP      r1,r0                 ;626
00032e  da00              BGE      |L1.818|
000330  8021              STRH     r1,[r4,#0]            ;626
                  |L1.818|
000332  f9b40000          LDRSH    r0,[r4,#0]            ;627  ; net_U
000336  4584              CMP      r12,r0                ;627
000338  da01              BGE      |L1.830|
00033a  f8a4c000          STRH     r12,[r4,#0]           ;627
                  |L1.830|
00033e  e0aa              B        |L1.1174|
                  |L1.832|
000340  4845              LDR      r0,|L1.1112|
000342  f8dfc0c4          LDR      r12,|L1.1032|
000346  7802              LDRB     r2,[r0,#0]            ;583  ; bps
000348  7841              LDRB     r1,[r0,#1]            ;583  ; bps
00034a  f10c0c6c          ADD      r12,r12,#0x6c         ;583
00034e  eb022101          ADD      r1,r2,r1,LSL #8       ;583
000352  fa1ff881          UXTH     r8,r1                 ;583
000356  f8ac8000          STRH     r8,[r12,#0]           ;583
00035a  7881              LDRB     r1,[r0,#2]            ;584  ; bps
00035c  78c2              LDRB     r2,[r0,#3]            ;584  ; bps
00035e  eb012102          ADD      r1,r1,r2,LSL #8       ;584
000362  b28a              UXTH     r2,r1                 ;584
000364  f8ac2002          STRH     r2,[r12,#2]           ;584
000368  7901              LDRB     r1,[r0,#4]            ;585  ; bps
00036a  f890e005          LDRB     lr,[r0,#5]            ;585  ; bps
00036e  eb01210e          ADD      r1,r1,lr,LSL #8       ;585
000372  b289              UXTH     r1,r1                 ;585
000374  f8ac1004          STRH     r1,[r12,#4]           ;585
000378  fb01f10b          MUL      r1,r1,r11             ;588
00037c  f2417c70          MOV      r12,#0x1770           ;589
000380  fb91f1fc          SDIV     r1,r1,r12             ;589
000384  fa0ffb81          SXTH     r11,r1                ;590
000388  f8a5b000          STRH     r11,[r5,#0]           ;590
00038c  9901              LDR      r1,[sp,#4]            ;593
00038e  fb02f201          MUL      r2,r2,r1              ;593
000392  fb92f1fc          SDIV     r1,r2,r12             ;594
000396  b209              SXTH     r1,r1                 ;595
000398  8019              STRH     r1,[r3,#0]            ;595
00039a  9a00              LDR      r2,[sp,#0]            ;598
00039c  fb08f802          MUL      r8,r8,r2              ;598
0003a0  fb98f2fc          SDIV     r2,r8,r12             ;599
0003a4  b212              SXTH     r2,r2                 ;600
0003a6  8032              STRH     r2,[r6,#0]            ;600
0003a8  7983              LDRB     r3,[r0,#6]            ;602  ; bps
0003aa  79c0              LDRB     r0,[r0,#7]            ;602  ; bps
0003ac  eb032000          ADD      r0,r3,r0,LSL #8       ;602
0003b0  4b2a              LDR      r3,|L1.1116|
0003b2  8018              STRH     r0,[r3,#0]            ;602
0003b4  f8a4b000          STRH     r11,[r4,#0]           ;604
0003b8  4559              CMP      r1,r11                ;605
0003ba  da00              BGE      |L1.958|
0003bc  8021              STRH     r1,[r4,#0]            ;605
                  |L1.958|
0003be  f9b40000          LDRSH    r0,[r4,#0]            ;606  ; net_U
0003c2  4282              CMP      r2,r0                 ;606
0003c4  da67              BGE      |L1.1174|
0003c6  8022              STRH     r2,[r4,#0]            ;606
0003c8  e065              B        |L1.1174|
                  |L1.970|
0003ca  f5a048ac          SUB      r8,r0,#0x5600         ;629
0003ce  f1b8082f          SUBS     r8,r8,#0x2f           ;629
0003d2  d008              BEQ      |L1.998|
0003d4  f1180828          ADDS     r8,r8,#0x28           ;629
0003d8  d005              BEQ      |L1.998|
0003da  f1b80814          SUBS     r8,r8,#0x14           ;629
0003de  d002              BEQ      |L1.998|
0003e0  f1180819          ADDS     r8,r8,#0x19           ;629
0003e4  d140              BNE      |L1.1128|
                  |L1.998|
0003e6  f6494040          MOV      r0,#0x9c40            ;633
0003ea  fb92f0f0          SDIV     r0,r2,r0              ;633
0003ee  b200              SXTH     r0,r0                 ;634
0003f0  8028              STRH     r0,[r5,#0]            ;634
0003f2  8019              STRH     r1,[r3,#0]            ;639
0003f4  f8a6c000          STRH     r12,[r6,#0]           ;644
0003f8  8020              STRH     r0,[r4,#0]            ;646
0003fa  4281              CMP      r1,r0                 ;647
0003fc  da00              BGE      |L1.1024|
0003fe  8021              STRH     r1,[r4,#0]            ;647
                  |L1.1024|
000400  f9b40000          LDRSH    r0,[r4,#0]            ;648  ; net_U
000404  4584              CMP      r12,r0                ;648
000406  e02b              B        |L1.1120|
                  |L1.1032|
                          DCD      ||area_number.26||
                  |L1.1036|
                          DCD      bat
                  |L1.1040|
                          DCD      IKB
                  |L1.1044|
                          DCD      ADR_EE_BAT_ZAR_CNT_KE
                  |L1.1048|
                          DCD      bat_u_old_cnt
                  |L1.1052|
                          DCD      0x40024020
                  |L1.1056|
                          DCD      Kibat0
                  |L1.1060|
                          DCD      ad7705_buff_
                  |L1.1064|
                          DCD      IZMAX
                  |L1.1068|
                          DCD      ADR_KI0BAT
                  |L1.1072|
                          DCD      bps
                  |L1.1076|
                          DCD      KunetA
                  |L1.1080|
                          DCD      net_Ua
                  |L1.1084|
                          DCD      KunetB
                  |L1.1088|
                          DCD      KunetC
                  |L1.1092|
                          DCD      net_Ub
                  |L1.1096|
                          DCD      net_Uc
                  |L1.1100|
                          DCD      net_U
                  |L1.1104|
                          DCD      AUSW_MAIN
                  |L1.1108|
                          DCD      ||.bss||+0x400
                  |L1.1112|
                          DCD      bps+0x47e
                  |L1.1116|
                          DCD      net_F3
                  |L1.1120|
000460  da19              BGE      |L1.1174|
000462  f8a4c000          STRH     r12,[r4,#0]           ;648
000466  e016              B        |L1.1174|
                  |L1.1128|
;;;651    	{
;;;652    	temp_SL=(signed long)net_buff_;
;;;653    	temp_SL*=Kunet;
000468  49ff              LDR      r1,|L1.2152|
00046a  f9b12000          LDRSH    r2,[r1,#0]
00046e  49ff              LDR      r1,|L1.2156|
000470  8d09              LDRH     r1,[r1,#0x28]         ;610
000472  4351              MULS     r1,r2,r1
000474  4548              CMP      r0,r9                 ;650
000476  d003              BEQ      |L1.1152|
000478  f5a042aa          SUB      r2,r0,#0x5500         ;650
00047c  3afb              SUBS     r2,r2,#0xfb           ;650
00047e  d105              BNE      |L1.1164|
                  |L1.1152|
;;;654    	temp_SL/=35000L;
000480  f64800b8          MOV      r0,#0x88b8
000484  fb91f0f0          SDIV     r0,r1,r0
;;;655    	net_U=(signed short)temp_SL;
000488  8020              STRH     r0,[r4,#0]
00048a  e004              B        |L1.1174|
                  |L1.1164|
;;;656    	
;;;657    	}
;;;658    else
;;;659    	{
;;;660    	temp_SL=(signed long)net_buff_;
;;;661    	temp_SL*=Kunet;
;;;662    	#ifdef _ACDC_
;;;663    	temp_SL/=500L;
00048c  f44f70fa          MOV      r0,#0x1f4
000490  fb91f0f0          SDIV     r0,r1,r0
;;;664    	#else
;;;665    	temp_SL/=5000L;
;;;666    	#endif
;;;667    	net_U=(signed short)temp_SL;
000494  8020              STRH     r0,[r4,#0]
                  |L1.1174|
;;;668    	
;;;669    	}
;;;670    if(bps[11]._device!=dNET_METR) net_F3=net_F;
000496  9802              LDR      r0,[sp,#8]
000498  2807              CMP      r0,#7
00049a  d003              BEQ      |L1.1188|
00049c  48f4              LDR      r0,|L1.2160|
00049e  8801              LDRH     r1,[r0,#0]  ; net_F
0004a0  48f4              LDR      r0,|L1.2164|
0004a2  8001              STRH     r1,[r0,#0]
                  |L1.1188|
;;;671    #endif
;;;672    
;;;673    #ifdef UKU_TELECORE2015
;;;674    //напр€жение сети
;;;675    temp_SL=(signed long)net_buff_;
;;;676    temp_SL*=Kunet;
;;;677    temp_SL/=110000L;
;;;678    net_U=(signed short)temp_SL;
;;;679    #endif
;;;680    
;;;681    #ifdef UKU_TELECORE2017
;;;682    //напр€жение сети
;;;683    temp_SL=(signed long)net_buff_;
;;;684    temp_SL*=Kunet;
;;;685    temp_SL/=110000L;
;;;686    net_U=(signed short)temp_SL;
;;;687    #endif
;;;688    
;;;689    //Ќапр€жени€ батарей
;;;690    temp_SL=(signed long)adc_buff_[0];
0004a4  4ef4              LDR      r6,|L1.2168|
0004a6  f9b62000          LDRSH    r2,[r6,#0]  ; adc_buff_
;;;691    temp_SL*=Kubat[0];
0004aa  49f4              LDR      r1,|L1.2172|
0004ac  f9b10000          LDRSH    r0,[r1,#0]  ; Kubat
0004b0  4350              MULS     r0,r2,r0
;;;692    temp_SL/=2000L;
0004b2  f44f68fa          MOV      r8,#0x7d0
0004b6  fb90f0f8          SDIV     r0,r0,r8
;;;693    bat[0]._Ub=(signed short)temp_SL;
0004ba  4df1              LDR      r5,|L1.2176|
0004bc  8068              STRH     r0,[r5,#2]
;;;694    
;;;695    #ifdef UKU_220
;;;696    //Ќапр€жени€ батарей
;;;697    temp_SL=(signed long)adc_buff_[0];
;;;698    temp_SL*=Kubat[0];
;;;699    temp_SL/=400L;
;;;700    bat[0]._Ub=(signed short)temp_SL;
;;;701    #endif
;;;702    
;;;703    #ifdef UKU_220_V2
;;;704    //Ќапр€жени€ батарей
;;;705    temp_SL=(signed long)adc_buff_[0];
;;;706    temp_SL*=Kubat[0];
;;;707    temp_SL/=400L;
;;;708    bat[0]._Ub=(signed short)temp_SL;
;;;709    #endif
;;;710    
;;;711    temp_SL=(signed long)adc_buff_[4];
0004be  f9b63008          LDRSH    r3,[r6,#8]  ; adc_buff_
;;;712    temp_SL*=Kubatm[0];
0004c2  4af0              LDR      r2,|L1.2180|
0004c4  f9b20000          LDRSH    r0,[r2,#0]  ; Kubatm
0004c8  fb00f003          MUL      r0,r0,r3
;;;713    temp_SL/=700L;
0004cc  f44f732f          MOV      r3,#0x2bc
0004d0  fb90f0f3          SDIV     r0,r0,r3
;;;714    bat[0]._Ubm=(signed short)temp_SL;
0004d4  80a8              STRH     r0,[r5,#4]
;;;715    
;;;716    #ifdef UKU_KONTUR
;;;717    temp_SL=(signed long)adc_buff_[4];
;;;718    temp_SL*=Kubatm[0];
;;;719    temp_SL/=2000L;
;;;720    bat[0]._Ubm=(signed short)temp_SL;
;;;721    #endif
;;;722    
;;;723    temp_SL=(signed long)adc_buff_[12];
0004d6  f9b60018          LDRSH    r0,[r6,#0x18]  ; adc_buff_
;;;724    temp_SL*=Kubat[1];
0004da  f9b11002          LDRSH    r1,[r1,#2]  ; Kubat
0004de  fb01f100          MUL      r1,r1,r0
;;;725    temp_SL/=2000L;
0004e2  fb91f0f8          SDIV     r0,r1,r8
;;;726    bat[1]._Ub=(signed short)temp_SL;
0004e6  f8a5004e          STRH     r0,[r5,#0x4e]
;;;727    
;;;728    #ifdef UKU_220
;;;729    temp_SL=(signed long)adc_buff_[12];
;;;730    temp_SL*=Kubat[1];
;;;731    temp_SL/=400L;
;;;732    bat[1]._Ub=(signed short)temp_SL;
;;;733    #endif
;;;734    
;;;735    #ifdef UKU_220_V2
;;;736    temp_SL=(signed long)adc_buff_[12];
;;;737    temp_SL*=Kubat[1];
;;;738    temp_SL/=400L;
;;;739    bat[1]._Ub=(signed short)temp_SL;
;;;740    #endif
;;;741    
;;;742    temp_SL=(signed long)adc_buff_[1];
0004ea  f9b61002          LDRSH    r1,[r6,#2]  ; adc_buff_
;;;743    temp_SL*=Kubatm[1];
0004ee  f9b20002          LDRSH    r0,[r2,#2]  ; Kubatm
0004f2  fb00f001          MUL      r0,r0,r1
;;;744    temp_SL/=700L;
0004f6  fb90f0f3          SDIV     r0,r0,r3
;;;745    bat[1]._Ubm=(signed short)temp_SL;
0004fa  f8a50050          STRH     r0,[r5,#0x50]
;;;746    #ifdef UKU_KONTUR
;;;747    temp_SL=(signed long)adc_buff_[1];
;;;748    temp_SL*=Kubatm[1];
;;;749    temp_SL/=2000L;
;;;750    bat[1]._Ubm=(signed short)temp_SL;
;;;751    #endif
;;;752    
;;;753    #ifdef UKU_TELECORE2015
;;;754    temp_SL=(signed long)adc_buff_[2];
;;;755    temp_SL*=Kubat[0];
;;;756    temp_SL/=2000L;
;;;757    bat[0]._Ub=(signed short)temp_SL;
;;;758    #endif
;;;759    
;;;760    /*
;;;761    //“оки батарей
;;;762    if(!mess_find_unvol(MESS2MATEMAT))
;;;763    	{
;;;764    	temp_SL=(signed long)ad7705_buff_[0];
;;;765    	temp_SL-=(signed long)Kibat0[0];
;;;766    	temp_SL*=(signed long)Kibat1[0];
;;;767    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;768    	else temp_SL/=1000L;
;;;769    	bat[0]._Ib=(signed short)temp_SL;
;;;770    
;;;771    	temp_SL=(signed long)ad7705_buff_[1];
;;;772    	temp_SL-=(signed long)Kibat0[1];
;;;773    	temp_SL*=(signed long)Kibat1[1];
;;;774    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;775    	else temp_SL/=1000L;
;;;776    	bat[1]._Ib=(signed short)temp_SL;
;;;777    	}
;;;778    */
;;;779    
;;;780    
;;;781    //“оки батарей
;;;782    if(!mess_find_unvol(MESS2MATEMAT))
0004fe  f04f00dc          MOV      r0,#0xdc
000502  f7fffffe          BL       mess_find_unvol
000506  bbf0              CBNZ     r0,|L1.1414|
;;;783    	{
;;;784    	temp_SL=(signed long)ad7705_buff_[0];
000508  f8dfc37c          LDR      r12,|L1.2184|
00050c  f8bc0000          LDRH     r0,[r12,#0]  ; ad7705_buff_
;;;785    	temp_SL-=(signed long)Kibat0[0];
000510  f8dfb378          LDR      r11,|L1.2188|
000514  f8bb1000          LDRH     r1,[r11,#0]  ; Kibat0
000518  eba00001          SUB      r0,r0,r1
;;;786    	temp_SL*=(signed long)Kibat1[0];
00051c  4adc              LDR      r2,|L1.2192|
00051e  f9b21000          LDRSH    r1,[r2,#0]  ; Kibat1
000522  fb01f100          MUL      r1,r1,r0
;;;787    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
000526  f8ba0000          LDRH     r0,[r10,#0]  ; AUSW_MAIN
00052a  f6456392          MOV      r3,#0x5e92
00052e  f5a04eb0          SUB      lr,r0,#0x5800
000532  f5be6ec7          SUBS     lr,lr,#0x638
000536  d001              BEQ      |L1.1340|
000538  4298              CMP      r0,r3
00053a  d104              BNE      |L1.1350|
                  |L1.1340|
00053c  f44f7e96          MOV      lr,#0x12c
000540  fb91f1fe          SDIV     r1,r1,lr
000544  e00f              B        |L1.1382|
                  |L1.1350|
;;;788    	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
000546  4548              CMP      r0,r9
000548  d006              BEQ      |L1.1368|
00054a  f5a04eac          SUB      lr,r0,#0x5600
00054e  f1be0e13          SUBS     lr,lr,#0x13
000552  d001              BEQ      |L1.1368|
000554  42b8              CMP      r0,r7
000556  d102              BNE      |L1.1374|
                  |L1.1368|
000558  fb91f1f8          SDIV     r1,r1,r8
00055c  e003              B        |L1.1382|
                  |L1.1374|
;;;789    	else temp_SL/=1000L;
00055e  f44f7e7a          MOV      lr,#0x3e8
000562  fb91f1fe          SDIV     r1,r1,lr
                  |L1.1382|
;;;790    	#ifdef UKU_TELECORE2015
;;;791    	temp_SL/=2L;
;;;792    	//temp_SL=-temp_SL;
;;;793    	#endif
;;;794    	//#ifdef UKU_TELECORE2017
;;;795    	//temp_SL/=-2L;
;;;796    	//temp_SL=-temp_SL;
;;;797    	//#endif
;;;798    	bat[0]._Ib=(signed short)temp_SL;
000566  8129              STRH     r1,[r5,#8]
;;;799    
;;;800    	temp_SL=(signed long)ad7705_buff_[1];
000568  f8bc1002          LDRH     r1,[r12,#2]  ; ad7705_buff_
;;;801    	temp_SL-=(signed long)Kibat0[1];
00056c  f8bbc002          LDRH     r12,[r11,#2]  ; Kibat0
000570  eba10c0c          SUB      r12,r1,r12
;;;802    	temp_SL*=(signed long)Kibat1[1];
000574  f9b21002          LDRSH    r1,[r2,#2]  ; Kibat1
000578  fb01f10c          MUL      r1,r1,r12
;;;803    	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
00057c  f5a042bc          SUB      r2,r0,#0x5e00
000580  3a38              SUBS     r2,r2,#0x38
000582  d003              BEQ      |L1.1420|
000584  e000              B        |L1.1416|
                  |L1.1414|
000586  e017              B        |L1.1464|
                  |L1.1416|
000588  4298              CMP      r0,r3
00058a  d104              BNE      |L1.1430|
                  |L1.1420|
00058c  f44f7096          MOV      r0,#0x12c
000590  fb91f0f0          SDIV     r0,r1,r0
000594  e00e              B        |L1.1460|
                  |L1.1430|
;;;804    	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
000596  4548              CMP      r0,r9
000598  d005              BEQ      |L1.1446|
00059a  f5a042ac          SUB      r2,r0,#0x5600
00059e  3a13              SUBS     r2,r2,#0x13
0005a0  d001              BEQ      |L1.1446|
0005a2  42b8              CMP      r0,r7
0005a4  d102              BNE      |L1.1452|
                  |L1.1446|
0005a6  fb91f0f8          SDIV     r0,r1,r8
0005aa  e003              B        |L1.1460|
                  |L1.1452|
;;;805    	else temp_SL/=1000L;
0005ac  f44f707a          MOV      r0,#0x3e8
0005b0  fb91f0f0          SDIV     r0,r1,r0
                  |L1.1460|
;;;806    	bat[1]._Ib=(signed short)temp_SL;
0005b4  f8a50054          STRH     r0,[r5,#0x54]
                  |L1.1464|
;;;807    	}
;;;808    
;;;809    
;;;810    
;;;811    
;;;812    
;;;813    //“емпературы батарей
;;;814    
;;;815    #ifdef UKU_KONTUR
;;;816    if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
;;;817    else bat[0]._nd=1;
;;;818    temp_SL=(signed long)adc_buff_[6];
;;;819    temp_SL*=Ktbat[0];
;;;820    temp_SL/=20000L;
;;;821    temp_SL-=273L;
;;;822    bat[0]._Tb=(signed short)temp_SL;
;;;823    #else
;;;824    if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
0005b8  f9b6700c          LDRSH    r7,[r6,#0xc]  ; adc_buff_
0005bc  f64033b7          MOV      r3,#0xbb7
0005c0  f2a73b21          SUB      r11,r7,#0x321
0005c4  2200              MOVS     r2,#0
;;;825    else bat[0]._nd=1;
0005c6  f04f0c01          MOV      r12,#1
0005ca  459b              CMP      r11,r3                ;824
0005cc  d201              BCS      |L1.1490|
0005ce  732a              STRB     r2,[r5,#0xc]          ;824
0005d0  e001              B        |L1.1494|
                  |L1.1490|
0005d2  f885c00c          STRB     r12,[r5,#0xc]
                  |L1.1494|
;;;826    temp_SL=(signed long)adc_buff_[6];
;;;827    temp_SL*=Ktbat[0];
0005d6  49af              LDR      r1,|L1.2196|
0005d8  f9b10000          LDRSH    r0,[r1,#0]  ; Ktbat
0005dc  4378              MULS     r0,r7,r0
;;;828    temp_SL/=20000L;
0005de  f6446e20          MOV      lr,#0x4e20
0005e2  fb90f0fe          SDIV     r0,r0,lr
;;;829    temp_SL-=273L;
0005e6  f2a01011          SUB      r0,r0,#0x111
;;;830    bat[0]._Tb=(signed short)temp_SL;
0005ea  8168              STRH     r0,[r5,#0xa]
;;;831    #endif
;;;832    
;;;833    #ifdef UKU_KONTUR
;;;834    if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
;;;835    else bat[1]._nd=1;
;;;836    temp_SL=(signed long)adc_buff_[7];
;;;837    temp_SL*=Ktbat[1];
;;;838    temp_SL/=20000L;
;;;839    temp_SL-=273L;
;;;840    bat[1]._Tb=(signed short)temp_SL;
;;;841    #else
;;;842    if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
0005ec  f9b6000e          LDRSH    r0,[r6,#0xe]  ; adc_buff_
0005f0  f64033b7          MOV      r3,#0xbb7
0005f4  f2a03e21          SUB      lr,r0,#0x321
0005f8  459e              CMP      lr,r3
0005fa  d202              BCS      |L1.1538|
0005fc  f8852058          STRB     r2,[r5,#0x58]
000600  e001              B        |L1.1542|
                  |L1.1538|
;;;843    else bat[1]._nd=1;
000602  f885c058          STRB     r12,[r5,#0x58]
                  |L1.1542|
;;;844    temp_SL=(signed long)adc_buff_[7];
;;;845    temp_SL*=Ktbat[1];
000606  f9b11002          LDRSH    r1,[r1,#2]  ; Ktbat
00060a  4341              MULS     r1,r0,r1
;;;846    temp_SL/=20000L;
00060c  f6446020          MOV      r0,#0x4e20
000610  fb91f0f0          SDIV     r0,r1,r0
;;;847    temp_SL-=273L;
000614  f2a01011          SUB      r0,r0,#0x111
;;;848    bat[1]._Tb=(signed short)temp_SL;
000618  4999              LDR      r1,|L1.2176|
00061a  f8a10056          STRH     r0,[r1,#0x56]
;;;849    #endif
;;;850    
;;;851    #ifdef UKU_6U
;;;852    
;;;853    if(NUMMAKB==2)
;;;854    	{
;;;855    	if(makb[0]._cnt<5)
;;;856    		{
;;;857    		if(makb[0]._T_nd[0]==0)
;;;858    			{
;;;859    			bat[0]._Tb=makb[0]._T[0];
;;;860    			bat[0]._nd=0;
;;;861    			}
;;;862    		}
;;;863    
;;;864    	if(makb[1]._cnt<5)
;;;865    		{
;;;866    		if(makb[1]._T_nd[0]==0)
;;;867    			{
;;;868    			bat[1]._Tb=makb[1]._T[0];
;;;869    			bat[1]._nd=0;
;;;870    			}
;;;871    		}
;;;872    
;;;873    	}
;;;874    else if(NUMMAKB==4)
;;;875    	{
;;;876    	signed short temp_t;
;;;877    	temp_t=-20;
;;;878    	if(makb[0]._cnt<5)
;;;879    		{
;;;880    		if(makb[0]._T_nd[0]==0)
;;;881    			{
;;;882    			temp_t=makb[0]._T[0];
;;;883    			bat[0]._nd=0;
;;;884    			}
;;;885    		}
;;;886    	if(makb[1]._cnt<5)
;;;887    		{
;;;888    		if(makb[1]._T_nd[0]==0)
;;;889    			{
;;;890    			if(temp_t<makb[1]._T[0])
;;;891    				{
;;;892    				bat[0]._nd=0;
;;;893    				temp_t=makb[1]._T[0];
;;;894    				}
;;;895    			}
;;;896    		}
;;;897    	if(temp_t!=-20)bat[0]._Tb = temp_t;
;;;898    
;;;899     	temp_t=-20;
;;;900    	if(makb[2]._cnt<5)
;;;901    		{
;;;902    		if(makb[2]._T_nd[0]==0)
;;;903    			{
;;;904    			temp_t=makb[2]._T[0];
;;;905    			bat[1]._nd=0;
;;;906    			}
;;;907    		}
;;;908    	if(makb[3]._cnt<5)
;;;909    		{
;;;910    		if(makb[3]._T_nd[0]==0)
;;;911    			{
;;;912    			if(temp_t<makb[3]._T[0])
;;;913    				{
;;;914    				bat[1]._nd=0;
;;;915    				temp_t=makb[3]._T[0];
;;;916    				}
;;;917    			}
;;;918    		}
;;;919    	if(temp_t!=-20)bat[1]._Tb = temp_t;
;;;920    	}
;;;921    
;;;922    #endif
;;;923    
;;;924    
;;;925    //Ќапр€жение нагрузки
;;;926    temp_SL=(signed long)adc_buff_[2];
00061e  f9b60004          LDRSH    r0,[r6,#4]  ; adc_buff_
;;;927    temp_SL*=Kuload;
000622  499d              LDR      r1,|L1.2200|
000624  f9b11000          LDRSH    r1,[r1,#0]  ; Kuload
000628  fb00f101          MUL      r1,r0,r1
;;;928    temp_SL/=2000L;
00062c  f44f63fa          MOV      r3,#0x7d0
000630  fb91f1f3          SDIV     r1,r1,r3
;;;929    load_U=(signed short)temp_SL;
000634  fa0ff881          SXTH     r8,r1
000638  4998              LDR      r1,|L1.2204|
00063a  f8a18000          STRH     r8,[r1,#0]
;;;930    
;;;931    #ifdef UKU_220 
;;;932    //Ќапр€жение нагрузки
;;;933    temp_SL=(signed long)adc_buff_[2];
;;;934    temp_SL*=Kuload;
;;;935    temp_SL/=350L;
;;;936    load_U=(signed short)temp_SL;
;;;937    #endif
;;;938    
;;;939    #ifdef UKU_220_V2 
;;;940    //Ќапр€жение нагрузки
;;;941    temp_SL=(signed long)adc_buff_[2];
;;;942    temp_SL*=Kuload;
;;;943    temp_SL/=350L;
;;;944    load_U=(signed short)temp_SL;
;;;945    #endif
;;;946    
;;;947    #ifdef UKU_VD
;;;948    //Ќапр€жение выхода
;;;949    temp_SL=(signed long)adc_buff_[1];
00063e  f9b61002          LDRSH    r1,[r6,#2]  ; adc_buff_
;;;950    temp_SL*=Kuout;
000642  4b97              LDR      r3,|L1.2208|
000644  f9b33000          LDRSH    r3,[r3,#0]  ; Kuout
000648  fb01f103          MUL      r1,r1,r3
;;;951    temp_SL/=500L;
00064c  f44f75fa          MOV      r5,#0x1f4
000650  fb91f1f5          SDIV     r1,r1,r5
;;;952    out_U=(signed short)temp_SL;
000654  4b93              LDR      r3,|L1.2212|
000656  8019              STRH     r1,[r3,#0]
;;;953    
;;;954    
;;;955    //Ќапр€жение вольтдобавки
;;;956    temp_SL=(signed long)adc_buff_[2];
;;;957    temp_SL*=Kuvd;
000658  4b93              LDR      r3,|L1.2216|
00065a  f9b33000          LDRSH    r3,[r3,#0]  ; Kuvd
00065e  fb00f303          MUL      r3,r0,r3
;;;958    temp_SL/=500L;
000662  fb93f3f5          SDIV     r3,r3,r5
;;;959    vd_U=(signed short)temp_SL;
000666  f8dfe244          LDR      lr,|L1.2220|
00066a  f8ae3000          STRH     r3,[lr,#0]
;;;960    
;;;961    //Ќапр€жение входа
;;;962    in_U=out_U-vd_U;
00066e  eba10103          SUB      r1,r1,r3
000672  4b8f              LDR      r3,|L1.2224|
000674  8019              STRH     r1,[r3,#0]
;;;963    
;;;964    //Ќапр€жение выпр€мителей
;;;965    temp_SL=(signed long)adc_buff_[2];
;;;966    temp_SL*=Kubps;
000676  498f              LDR      r1,|L1.2228|
000678  f9b11000          LDRSH    r1,[r1,#0]  ; Kubps
00067c  fb00f001          MUL      r0,r0,r1
;;;967    if(AUSW_MAIN==22010)temp_SL/=400L;
000680  f8ba1000          LDRH     r1,[r10,#0]  ; AUSW_MAIN
000684  4549              CMP      r1,r9
000686  d104              BNE      |L1.1682|
000688  f44f71c8          MOV      r1,#0x190
00068c  fb90f0f1          SDIV     r0,r0,r1
000690  e001              B        |L1.1686|
                  |L1.1682|
;;;968    else temp_SL/=500L;
000692  fb90f0f5          SDIV     r0,r0,r5
                  |L1.1686|
;;;969    bps_U=(signed short)temp_SL;
000696  4d88              LDR      r5,|L1.2232|
000698  b200              SXTH     r0,r0
00069a  8028              STRH     r0,[r5,#0]
;;;970    
;;;971    if(bps_U<100)
;;;972    	{
;;;973    	char i;
;;;974    	for(i=0;i<NUMIST;i++)
00069c  f8dfe21c          LDR      lr,|L1.2236|
0006a0  2864              CMP      r0,#0x64              ;971
0006a2  da17              BGE      |L1.1748|
0006a4  f04f0000          MOV      r0,#0
0006a8  f9be9000          LDRSH    r9,[lr,#0]
0006ac  f8dfa210          LDR      r10,|L1.2240|
0006b0  e00e              B        |L1.1744|
                  |L1.1714|
;;;975    		{
;;;976    		if(bps[i]._Uin>bps_U)bps_U=bps[i]._Uin;
0006b2  eb000180          ADD      r1,r0,r0,LSL #2
0006b6  eb0101c0          ADD      r1,r1,r0,LSL #3
0006ba  eb0a01c1          ADD      r1,r10,r1,LSL #3
0006be  f9b53000          LDRSH    r3,[r5,#0]  ; bps_U
0006c2  6a09              LDR      r1,[r1,#0x20]
0006c4  4299              CMP      r1,r3
0006c6  dd00              BLE      |L1.1738|
0006c8  8029              STRH     r1,[r5,#0]
                  |L1.1738|
0006ca  f1000001          ADD      r0,r0,#1              ;974
0006ce  b2c0              UXTB     r0,r0                 ;974
                  |L1.1744|
0006d0  4548              CMP      r0,r9                 ;974
0006d2  dbee              BLT      |L1.1714|
                  |L1.1748|
;;;977    		}
;;;978    	}
;;;979    
;;;980    //—уммарный ток выпр€мителей
;;;981    temp_SL=0;
0006d4  f04f0300          MOV      r3,#0
;;;982    for (i=0;i<NUMIST;i++)
0006d8  4618              MOV      r0,r3
0006da  f9be1000          LDRSH    r1,[lr,#0]            ;974
0006de  4d78              LDR      r5,|L1.2240|
0006e0  e00b              B        |L1.1786|
                  |L1.1762|
;;;983    	{
;;;984    	temp_SL+=((signed long)bps[i]._Ii);
0006e2  eb000980          ADD      r9,r0,r0,LSL #2
0006e6  eb0909c0          ADD      r9,r9,r0,LSL #3
0006ea  eb0509c9          ADD      r9,r5,r9,LSL #3
0006ee  f8d99024          LDR      r9,[r9,#0x24]
0006f2  444b              ADD      r3,r3,r9
0006f4  f1000001          ADD      r0,r0,#1              ;982
0006f8  b2c0              UXTB     r0,r0                 ;982
                  |L1.1786|
0006fa  4288              CMP      r0,r1                 ;982
0006fc  dbf1              BLT      |L1.1762|
;;;985    	}
;;;986    bps_I=(signed short)temp_SL;
0006fe  4871              LDR      r0,|L1.2244|
000700  8003              STRH     r3,[r0,#0]
;;;987    
;;;988    
;;;989    #endif
;;;990    
;;;991    
;;;992    #ifdef UKU_KONTUR
;;;993    //¬нешний датчик температуры є1(температура внешнего воздуха)
;;;994    if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
;;;995    else ND_EXT[0]=1;
;;;996    temp_SL=(signed long)adc_buff_[5];
;;;997    temp_SL*=Ktext[0];
;;;998    temp_SL/=20000L;
;;;999    temp_SL-=273L;
;;;1000   t_ext[0]=(signed short)temp_SL;
;;;1001   #else 
;;;1002   //¬нешний датчик температуры є1(температура внешнего воздуха)
;;;1003   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
000702  f9b6300a          LDRSH    r3,[r6,#0xa]  ; adc_buff_
000706  f64036b7          MOV      r6,#0xbb7
00070a  f2a33021          SUB      r0,r3,#0x321
00070e  f8df91b8          LDR      r9,|L1.2248|
000712  42b0              CMP      r0,r6
000714  d202              BCS      |L1.1820|
000716  f8892000          STRB     r2,[r9,#0]
00071a  e001              B        |L1.1824|
                  |L1.1820|
;;;1004   else ND_EXT[0]=1;
00071c  f889c000          STRB     r12,[r9,#0]
                  |L1.1824|
;;;1005   temp_SL=(signed long)adc_buff_[5];
;;;1006   temp_SL*=Ktext[0];
000720  486a              LDR      r0,|L1.2252|
000722  f9b00000          LDRSH    r0,[r0,#0]  ; Ktext
000726  4343              MULS     r3,r0,r3
;;;1007   temp_SL/=20000L;
000728  f6446e20          MOV      lr,#0x4e20
00072c  fb93f3fe          SDIV     r3,r3,lr
;;;1008   temp_SL-=273L;
000730  f2a31311          SUB      r3,r3,#0x111
;;;1009   t_ext[0]=(signed short)temp_SL;
000734  f8dfa198          LDR      r10,|L1.2256|
000738  f8aa3000          STRH     r3,[r10,#0]
;;;1010   /*
;;;1011   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;1012   else ND_EXT[1]=1;
;;;1013   temp_SL=(signed long)adc_buff_[6];
;;;1014   temp_SL*=Ktext[1];
;;;1015   temp_SL/=20000L;
;;;1016   temp_SL-=273L;
;;;1017   t_ext[1]=(signed short)temp_SL;	*/
;;;1018   #endif
;;;1019   
;;;1020   #ifdef UKU_220
;;;1021   
;;;1022   //¬нешний датчик температуры є2(температура отсека Ёѕ”)
;;;1023   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[1]=0;
;;;1024   else ND_EXT[1]=1;
;;;1025   temp_SL=(signed long)adc_buff_[3];
;;;1026   temp_SL*=Ktext[1];
;;;1027   temp_SL/=20000L;
;;;1028   temp_SL-=273L;
;;;1029   t_ext[1]=(signed short)temp_SL;
;;;1030   
;;;1031   //¬нешний датчик температуры є3(температура отсека MSAN)
;;;1032   if((adc_buff_[10]>800)&&(adc_buff_[10]<3800))ND_EXT[2]=0;
;;;1033   else ND_EXT[2]=1;
;;;1034   temp_SL=(signed long)adc_buff_[10];
;;;1035   temp_SL*=Ktext[2];
;;;1036   temp_SL/=20000L;
;;;1037   temp_SL-=273L;
;;;1038   t_ext[2]=(signed short)temp_SL;
;;;1039   
;;;1040   #else
;;;1041   
;;;1042   
;;;1043   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1044   
;;;1045   //¬нешний датчик температуры 
;;;1046   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[0]=0;
00073c  45b3              CMP      r11,r6
00073e  d202              BCS      |L1.1862|
000740  f8892000          STRB     r2,[r9,#0]
000744  e001              B        |L1.1866|
                  |L1.1862|
;;;1047   else ND_EXT[0]=1;
000746  f889c000          STRB     r12,[r9,#0]
                  |L1.1866|
;;;1048   temp_SL=(signed long)adc_buff_[6];
;;;1049   temp_SL*=Ktext[0];
00074a  4378              MULS     r0,r7,r0
;;;1050   temp_SL/=20000L;
00074c  fb90f0fe          SDIV     r0,r0,lr
;;;1051   temp_SL-=273L;
000750  f2a01011          SUB      r0,r0,#0x111
;;;1052   t_ext[0]=(signed short)temp_SL;
000754  f8aa0000          STRH     r0,[r10,#0]
;;;1053   sys_T=t_ext[0];
000758  4b5e              LDR      r3,|L1.2260|
00075a  8018              STRH     r0,[r3,#0]
;;;1054   #else
;;;1055   
;;;1056   
;;;1057   
;;;1058   //¬нешний датчик температуры є2(температура отсека Ёѕ”)
;;;1059   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;1060   else ND_EXT[1]=1;
;;;1061   temp_SL=(signed long)adc_buff_[6];
;;;1062   temp_SL*=Ktext[1];
;;;1063   temp_SL/=20000L;
;;;1064   temp_SL-=273L;
;;;1065   t_ext[1]=(signed short)temp_SL;
;;;1066   
;;;1067   //¬нешний датчик температуры є3(температура отсека MSAN)
;;;1068   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[2]=0;
;;;1069   else ND_EXT[2]=1;
;;;1070   temp_SL=(signed long)adc_buff_[3];
;;;1071   temp_SL*=Ktext[2];
;;;1072   temp_SL/=20000L;
;;;1073   temp_SL-=273L;
;;;1074   t_ext[2]=(signed short)temp_SL;
;;;1075   
;;;1076   #endif
;;;1077   #endif
;;;1078   
;;;1079   if(!bIBAT_SMKLBR)
00075c  485e              LDR      r0,|L1.2264|
;;;1080   	{
;;;1081   	signed long temp_SL;
;;;1082   	temp_SL=(signed long)ibat_metr_buff_[0];
;;;1083   	temp_SL-=(signed long)ibat_metr_buff_[1];
;;;1084   	temp_SL*=(signed long)Kibat1[0];
;;;1085   	temp_SL/=2000L;
;;;1086   	
;;;1087   	Ib_ips_termokompensat =(signed short)temp_SL;
;;;1088   	out_I=Ib_ips_termokompensat;
00075e  4e5f              LDR      r6,|L1.2268|
000760  4f5f              LDR      r7,|L1.2272|
000762  8800              LDRH     r0,[r0,#0]            ;1079  ; bIBAT_SMKLBR
000764  b978              CBNZ     r0,|L1.1926|
000766  4b5f              LDR      r3,|L1.2276|
000768  6818              LDR      r0,[r3,#0]            ;1082  ; ibat_metr_buff_
00076a  685b              LDR      r3,[r3,#4]            ;1083  ; ibat_metr_buff_
00076c  eba00303          SUB      r3,r0,r3              ;1083
000770  4847              LDR      r0,|L1.2192|
000772  f9b00000          LDRSH    r0,[r0,#0]            ;1084  ; Kibat1
000776  fb00f003          MUL      r0,r0,r3              ;1084
00077a  f44f63fa          MOV      r3,#0x7d0             ;1085
00077e  fb90f0f3          SDIV     r0,r0,r3              ;1085
000782  8038              STRH     r0,[r7,#0]            ;1087
000784  8030              STRH     r0,[r6,#0]
                  |L1.1926|
;;;1089   	}
;;;1090   
;;;1091   if(I_LOAD_MODE==0)
000786  4858              LDR      r0,|L1.2280|
000788  8800              LDRH     r0,[r0,#0]  ; I_LOAD_MODE
00078a  b9c0              CBNZ     r0,|L1.1982|
;;;1092   	{
;;;1093   	temp_SL=0;
00078c  f04f0300          MOV      r3,#0
;;;1094   	for(i=0;i<NUMIST;i++)
000790  4618              MOV      r0,r3
000792  e00b              B        |L1.1964|
                  |L1.1940|
;;;1095   		{
;;;1096   		temp_SL+=(signed long)bps[i]._Ii;
000794  eb000c80          ADD      r12,r0,r0,LSL #2
000798  eb0c0cc0          ADD      r12,r12,r0,LSL #3
00079c  eb050ccc          ADD      r12,r5,r12,LSL #3
0007a0  f8dcc024          LDR      r12,[r12,#0x24]
0007a4  4463              ADD      r3,r3,r12
0007a6  f1000001          ADD      r0,r0,#1              ;1094
0007aa  b2c0              UXTB     r0,r0                 ;1094
                  |L1.1964|
0007ac  4288              CMP      r0,r1                 ;1094
0007ae  dbf1              BLT      |L1.1940|
;;;1097   		}
;;;1098   	Ib_ips_termokompensat=(signed short)temp_SL/10;
0007b0  b21b              SXTH     r3,r3
0007b2  f04f000a          MOV      r0,#0xa
0007b6  fb93f0f0          SDIV     r0,r3,r0
0007ba  8038              STRH     r0,[r7,#0]
;;;1099   	out_I=Ib_ips_termokompensat;
0007bc  8030              STRH     r0,[r6,#0]
                  |L1.1982|
;;;1100   	}
;;;1101   
;;;1102   
;;;1103   bat[0]._Ub=load_U;
0007be  4e30              LDR      r6,|L1.2176|
0007c0  f8a68002          STRH     r8,[r6,#2]
;;;1104   
;;;1105   
;;;1106   
;;;1107   
;;;1108   #ifdef UKU_TELECORE2015
;;;1109   
;;;1110   //¬нешний датчик температуры є1
;;;1111   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;1112   else ND_EXT[0]=1;
;;;1113   temp_SL=(signed long)adc_buff_[7];
;;;1114   temp_SL*=Ktext[0];
;;;1115   temp_SL/=20000L;
;;;1116   temp_SL-=273L;
;;;1117   t_ext[0]=(signed short)temp_SL;
;;;1118   
;;;1119   
;;;1120   //¬нешний датчик температуры є2
;;;1121   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;1122   else ND_EXT[1]=1;
;;;1123   temp_SL=(signed long)adc_buff_[6];
;;;1124   temp_SL*=Ktext[1];
;;;1125   temp_SL/=20000L;
;;;1126   temp_SL-=273L;
;;;1127   t_ext[1]=(signed short)temp_SL;
;;;1128   
;;;1129   #endif
;;;1130   
;;;1131   #ifdef UKU_TELECORE2017
;;;1132   
;;;1133   //¬нешний датчик температуры є1
;;;1134   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;1135   else ND_EXT[0]=1;
;;;1136   temp_SL=(signed long)adc_buff_[7];
;;;1137   temp_SL*=Ktext[0];
;;;1138   temp_SL/=20000L;
;;;1139   temp_SL-=273L;
;;;1140   t_ext[0]=(signed short)temp_SL;
;;;1141   
;;;1142   
;;;1143   //¬нешний датчик температуры є2
;;;1144   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;1145   else ND_EXT[1]=1;
;;;1146   temp_SL=(signed long)adc_buff_[6];
;;;1147   temp_SL*=Ktext[1];
;;;1148   temp_SL/=20000L;
;;;1149   temp_SL-=273L;
;;;1150   t_ext[1]=(signed short)temp_SL;
;;;1151   
;;;1152   #endif
;;;1153   
;;;1154   //напр€жение ввода
;;;1155   temp_SL=(signed long)adc_buff_ext_[0];
0007c4  f8dfb124          LDR      r11,|L1.2284|
0007c8  f8bb3000          LDRH     r3,[r11,#0]  ; adc_buff_ext_
;;;1156   temp_SL*=Kunet_ext[0];
0007cc  4848              LDR      r0,|L1.2288|
0007ce  f9b00000          LDRSH    r0,[r0,#0]  ; Kunet_ext
0007d2  4358              MULS     r0,r3,r0
;;;1157   temp_SL/=4000L;
0007d4  f44f637a          MOV      r3,#0xfa0
0007d8  fb90f0f3          SDIV     r0,r0,r3
;;;1158   Uvv[0]=(signed short)temp_SL;
0007dc  f8dfc114          LDR      r12,|L1.2292|
0007e0  b280              UXTH     r0,r0
0007e2  f8ac0000          STRH     r0,[r12,#0]
;;;1159   if(Uvv[0]<100) Uvv0=Uvv[0];
0007e6  f8dfe110          LDR      lr,|L1.2296|
0007ea  2864              CMP      r0,#0x64
0007ec  d202              BCS      |L1.2036|
0007ee  f8ae0000          STRH     r0,[lr,#0]
0007f2  e002              B        |L1.2042|
                  |L1.2036|
;;;1160   else Uvv0=net_U;
0007f4  8820              LDRH     r0,[r4,#0]  ; net_U
0007f6  f8ae0000          STRH     r0,[lr,#0]
                  |L1.2042|
;;;1161   
;;;1162   //напр€жение пэс
;;;1163   temp_SL=(signed long)adc_buff_ext_[1];
0007fa  f8bb4002          LDRH     r4,[r11,#2]  ; adc_buff_ext_
;;;1164   temp_SL*=Kunet_ext[1];
0007fe  483c              LDR      r0,|L1.2288|
000800  f9b00002          LDRSH    r0,[r0,#2]  ; Kunet_ext
000804  4360              MULS     r0,r4,r0
;;;1165   temp_SL/=4000L;
000806  fb90f0f3          SDIV     r0,r0,r3
;;;1166   Uvv[1]=(signed short)temp_SL;
00080a  f8ac0002          STRH     r0,[r12,#2]
;;;1167   
;;;1168   
;;;1169   //напр€жение ввода трехфазное
;;;1170   temp_SL=(signed long)eb2_data_short[0];
00080e  4b3b              LDR      r3,|L1.2300|
000810  f9b30000          LDRSH    r0,[r3,#0]  ; eb2_data_short
;;;1171   temp_SL*=Kvv_eb2[0];
000814  4c3a              LDR      r4,|L1.2304|
000816  f9b4c000          LDRSH    r12,[r4,#0]  ; Kvv_eb2
00081a  fb0cfc00          MUL      r12,r12,r0
;;;1172   temp_SL/=6000L;
00081e  f2417070          MOV      r0,#0x1770
000822  fb9cfbf0          SDIV     r11,r12,r0
;;;1173   Uvv_eb2[0]=(signed short)temp_SL;
000826  f8dfc0dc          LDR      r12,|L1.2308|
00082a  f8acb000          STRH     r11,[r12,#0]
;;;1174   
;;;1175   temp_SL=(signed long)eb2_data_short[1];
00082e  f9b3e002          LDRSH    lr,[r3,#2]  ; eb2_data_short
;;;1176   temp_SL*=Kvv_eb2[1];
000832  f9b4b002          LDRSH    r11,[r4,#2]  ; Kvv_eb2
000836  fb0bfb0e          MUL      r11,r11,lr
;;;1177   temp_SL/=6000L;
00083a  fb9bfbf0          SDIV     r11,r11,r0
;;;1178   Uvv_eb2[1]=(signed short)temp_SL;
00083e  f8acb002          STRH     r11,[r12,#2]
;;;1179   
;;;1180   temp_SL=(signed long)eb2_data_short[2];
000842  f9b3b004          LDRSH    r11,[r3,#4]  ; eb2_data_short
;;;1181   temp_SL*=Kvv_eb2[2];
000846  f9b44004          LDRSH    r4,[r4,#4]  ; Kvv_eb2
00084a  fb04f40b          MUL      r4,r4,r11
;;;1182   temp_SL/=6000L;
00084e  fb94f4f0          SDIV     r4,r4,r0
;;;1183   Uvv_eb2[2]=(signed short)temp_SL;
000852  f8ac4004          STRH     r4,[r12,#4]
;;;1184   
;;;1185   //напр€жение пэс трехфазное
;;;1186   temp_SL=(signed long)eb2_data_short[3];
000856  f9b3b006          LDRSH    r11,[r3,#6]  ; eb2_data_short
;;;1187   temp_SL*=Kpes_eb2[0];
00085a  4c2b              LDR      r4,|L1.2312|
00085c  f9b4c000          LDRSH    r12,[r4,#0]  ; Kpes_eb2
000860  fb0cfc0b          MUL      r12,r12,r11
;;;1188   temp_SL/=6000L;
000864  e052              B        |L1.2316|
000866  0000              DCW      0x0000
                  |L1.2152|
                          DCD      Kunet
                  |L1.2156|
                          DCD      ||area_number.26||
                  |L1.2160|
                          DCD      net_F
                  |L1.2164|
                          DCD      net_F3
                  |L1.2168|
                          DCD      ||.bss||+0x400
                  |L1.2172|
                          DCD      Kubat
                  |L1.2176|
                          DCD      bat
                  |L1.2180|
                          DCD      Kubatm
                  |L1.2184|
                          DCD      ad7705_buff_
                  |L1.2188|
                          DCD      Kibat0
                  |L1.2192|
                          DCD      Kibat1
                  |L1.2196|
                          DCD      Ktbat
                  |L1.2200|
                          DCD      Kuload
                  |L1.2204|
                          DCD      load_U
                  |L1.2208|
                          DCD      Kuout
                  |L1.2212|
                          DCD      out_U
                  |L1.2216|
                          DCD      Kuvd
                  |L1.2220|
                          DCD      vd_U
                  |L1.2224|
                          DCD      in_U
                  |L1.2228|
                          DCD      Kubps
                  |L1.2232|
                          DCD      bps_U
                  |L1.2236|
                          DCD      NUMIST
                  |L1.2240|
                          DCD      bps
                  |L1.2244|
                          DCD      bps_I
                  |L1.2248|
                          DCD      ND_EXT
                  |L1.2252|
                          DCD      Ktext
                  |L1.2256|
                          DCD      t_ext
                  |L1.2260|
                          DCD      sys_T
                  |L1.2264|
                          DCD      bIBAT_SMKLBR
                  |L1.2268|
                          DCD      out_I
                  |L1.2272|
                          DCD      Ib_ips_termokompensat
                  |L1.2276|
                          DCD      ibat_metr_buff_
                  |L1.2280|
                          DCD      I_LOAD_MODE
                  |L1.2284|
                          DCD      adc_buff_ext_
                  |L1.2288|
                          DCD      Kunet_ext
                  |L1.2292|
                          DCD      Uvv
                  |L1.2296|
                          DCD      Uvv0
                  |L1.2300|
                          DCD      eb2_data_short
                  |L1.2304|
                          DCD      Kvv_eb2
                  |L1.2308|
                          DCD      Uvv_eb2
                  |L1.2312|
                          DCD      Kpes_eb2
                  |L1.2316|
00090c  fb9cfbf0          SDIV     r11,r12,r0
;;;1189   Upes_eb2[0]=(signed short)temp_SL;
000910  f8dfc428          LDR      r12,|L1.3388|
000914  f8acb000          STRH     r11,[r12,#0]
;;;1190   
;;;1191   temp_SL=(signed long)eb2_data_short[4];
000918  f9b3e008          LDRSH    lr,[r3,#8]  ; eb2_data_short
;;;1192   temp_SL*=Kpes_eb2[1];
00091c  f9b4b002          LDRSH    r11,[r4,#2]  ; Kpes_eb2
000920  fb0bfb0e          MUL      r11,r11,lr
;;;1193   temp_SL/=6000L;
000924  fb9bfbf0          SDIV     r11,r11,r0
;;;1194   Upes_eb2[1]=(signed short)temp_SL;
000928  f8acb002          STRH     r11,[r12,#2]
;;;1195   
;;;1196   temp_SL=(signed long)eb2_data_short[5];
00092c  f9b3300a          LDRSH    r3,[r3,#0xa]  ; eb2_data_short
;;;1197   temp_SL*=Kpes_eb2[2];
000930  f9b44004          LDRSH    r4,[r4,#4]  ; Kpes_eb2
000934  fb04f403          MUL      r4,r4,r3
;;;1198   temp_SL/=6000L;
000938  fb94f0f0          SDIV     r0,r4,r0
;;;1199   Upes_eb2[2]=(signed short)temp_SL;
00093c  f8ac0004          STRH     r0,[r12,#4]
;;;1200   
;;;1201   //¬ычисление температуры шкафа
;;;1202   
;;;1203   ibt._T[0]=t_ext[1]+273;
000940  f8ba0002          LDRH     r0,[r10,#2]  ; t_ext
000944  4cfe              LDR      r4,|L1.3392|
000946  f2001011          ADD      r0,r0,#0x111
00094a  fa0ffc80          SXTH     r12,r0
00094e  f8a4c000          STRH     r12,[r4,#0]
;;;1204   ibt._T[1]=t_ext[2]+273;
000952  f8ba0004          LDRH     r0,[r10,#4]  ; t_ext
000956  f2001011          ADD      r0,r0,#0x111
00095a  fa0ffa80          SXTH     r10,r0
00095e  f8a4a002          STRH     r10,[r4,#2]
;;;1205   
;;;1206   ibt._nd[0]=ND_EXT[1];
000962  f8993001          LDRB     r3,[r9,#1]  ; ND_EXT
000966  7223              STRB     r3,[r4,#8]
;;;1207   ibt._nd[1]=ND_EXT[2];
000968  f8990002          LDRB     r0,[r9,#2]  ; ND_EXT
00096c  7260              STRB     r0,[r4,#9]
;;;1208   
;;;1209   #ifndef UKU_TELECORE2015
;;;1210   if((ibt._nd[0]==0) &&  (ibt._nd[1]==0))
;;;1211   	{
;;;1212   	t_box=((ibt._T[0]+ibt._T[1])/2)-273;
00096e  4cf5              LDR      r4,|L1.3396|
000970  b903              CBNZ     r3,|L1.2420|
000972  b110              CBZ      r0,|L1.2426|
                  |L1.2420|
;;;1213   	}
;;;1214   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==0))
000974  2b01              CMP      r3,#1
000976  d00a              BEQ      |L1.2446|
000978  e00a              B        |L1.2448|
                  |L1.2426|
00097a  eb0c000a          ADD      r0,r12,r10            ;1212
00097e  eb0070d0          ADD      r0,r0,r0,LSR #31      ;1212
000982  f46f7388          MVN      r3,#0x110             ;1212
000986  eb030060          ADD      r0,r3,r0,ASR #1       ;1212
00098a  8020              STRH     r0,[r4,#0]            ;1212
00098c  e01e              B        |L1.2508|
                  |L1.2446|
00098e  b108              CBZ      r0,|L1.2452|
                  |L1.2448|
;;;1215   	{
;;;1216   	t_box=ibt._T[1]-273;
;;;1217   	}
;;;1218   else if((ibt._nd[0]==0) &&  (ibt._nd[1]==1))
000990  b12b              CBZ      r3,|L1.2462|
000992  e006              B        |L1.2466|
                  |L1.2452|
000994  f2aa1a11          SUB      r10,r10,#0x111        ;1216
000998  f8a4a000          STRH     r10,[r4,#0]           ;1216
00099c  e016              B        |L1.2508|
                  |L1.2462|
00099e  2801              CMP      r0,#1
0009a0  d002              BEQ      |L1.2472|
                  |L1.2466|
;;;1219   	{
;;;1220   	t_box=ibt._T[0]-273;
;;;1221   	}
;;;1222   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==1))
0009a2  2b01              CMP      r3,#1
0009a4  d005              BEQ      |L1.2482|
0009a6  e011              B        |L1.2508|
                  |L1.2472|
0009a8  f2ac1c11          SUB      r12,r12,#0x111        ;1220
0009ac  f8a4c000          STRH     r12,[r4,#0]           ;1220
0009b0  e00c              B        |L1.2508|
                  |L1.2482|
0009b2  2801              CMP      r0,#1
0009b4  d10a              BNE      |L1.2508|
;;;1223   	{
;;;1224   	if(t_ext_can_nd<5)t_box= t_ext_can;
0009b6  48e4              LDR      r0,|L1.3400|
0009b8  7800              LDRB     r0,[r0,#0]  ; t_ext_can_nd
0009ba  2805              CMP      r0,#5
0009bc  d203              BCS      |L1.2502|
0009be  48e3              LDR      r0,|L1.3404|
0009c0  8800              LDRH     r0,[r0,#0]  ; t_ext_can
0009c2  8020              STRH     r0,[r4,#0]
0009c4  e002              B        |L1.2508|
                  |L1.2502|
;;;1225   	else t_box=20;
0009c6  f04f0014          MOV      r0,#0x14
0009ca  8020              STRH     r0,[r4,#0]
                  |L1.2508|
;;;1226   	}
;;;1227   #endif
;;;1228   /*
;;;1229   //¬ычисление температуры шкафа
;;;1230   
;;;1231   ibt._T[0]=bat[0]._Tb+273;
;;;1232   ibt._T[1]=bat[1]._Tb+273;
;;;1233   ibt._T[2]=t_ext[1]+273;
;;;1234   ibt._T[3]=t_ext[2]+273;
;;;1235   
;;;1236   ibt._nd[0]=bat[0]._nd;
;;;1237   ibt._nd[1]=bat[1]._nd;
;;;1238   ibt._nd[2]=ND_EXT[1];
;;;1239   ibt._nd[3]=ND_EXT[2];
;;;1240   
;;;1241   ibt._avg1=0;
;;;1242   ibt._avg_cnt=4;
;;;1243   
;;;1244   if(ibt._nd[0]==0)
;;;1245   	{
;;;1246   	ibt._avg1+=ibt._T[0];
;;;1247   	}
;;;1248   else 
;;;1249   	{
;;;1250   	ibt._avg_cnt--;
;;;1251   	}
;;;1252   
;;;1253   if(ibt._nd[1]==0)
;;;1254   	{
;;;1255   	ibt._avg1+=ibt._T[1];
;;;1256   	}
;;;1257   else 
;;;1258   	{
;;;1259   	ibt._avg_cnt--;
;;;1260   	}
;;;1261   
;;;1262   if(ibt._nd[2]==0)
;;;1263   	{
;;;1264   	ibt._avg1+=ibt._T[2];
;;;1265   	}
;;;1266   else 
;;;1267   	{
;;;1268   	ibt._avg_cnt--;
;;;1269   	}
;;;1270   
;;;1271   if(ibt._nd[3]==0)
;;;1272   	{
;;;1273   	ibt._avg1+=ibt._T[3];
;;;1274   	}
;;;1275   else 
;;;1276   	{
;;;1277   	ibt._avg_cnt--;
;;;1278   	}
;;;1279   
;;;1280   if(ibt._avg_cnt==0)
;;;1281   	{
;;;1282   	}
;;;1283   else
;;;1284   	{
;;;1285   	ibt._avg1/=ibt._avg_cnt;
;;;1286   	}
;;;1287   
;;;1288   
;;;1289   if(ibt._nd[0]!=0)
;;;1290   	{
;;;1291   	ibt._T_dispers[0]=0;
;;;1292   	}
;;;1293   else 
;;;1294   	{
;;;1295   	ibt._T_dispers[0]=abs(ibt._T[0]-ibt._avg1);
;;;1296   	}
;;;1297   
;;;1298   if(ibt._nd[1]!=0)
;;;1299   	{
;;;1300   	ibt._T_dispers[1]=0;
;;;1301   	}
;;;1302   else 
;;;1303   	{
;;;1304   	ibt._T_dispers[1]=abs(ibt._T[1]-ibt._avg1);
;;;1305   	}
;;;1306   
;;;1307   if(ibt._nd[2]!=0)
;;;1308   	{
;;;1309   	ibt._T_dispers[2]=0;
;;;1310   	}
;;;1311   else 
;;;1312   	{
;;;1313   	ibt._T_dispers[2]=abs(ibt._T[2]-ibt._avg1);
;;;1314   	}
;;;1315   
;;;1316   if(ibt._nd[3]!=0)
;;;1317   	{
;;;1318   	ibt._T_dispers[3]=0;
;;;1319   	}
;;;1320   else 
;;;1321   	{
;;;1322   	ibt._T_dispers[3]=abs(ibt._T[3]-ibt._avg1);
;;;1323   	}
;;;1324   
;;;1325   if(	ibt._nd[0]&&
;;;1326   	ibt._nd[1]&&
;;;1327   	ibt._nd[2]&&
;;;1328   	ibt._nd[3]
;;;1329   	)
;;;1330   	{
;;;1331   	t_box=(bps[0]._Ti);
;;;1332   	}
;;;1333   
;;;1334   else if(	ibt._nd[0]||
;;;1335   	ibt._nd[1]||
;;;1336   	ibt._nd[2]||
;;;1337   	ibt._nd[3]
;;;1338   	)
;;;1339   	{
;;;1340   	t_box=(ibt._avg1-273);
;;;1341   	}
;;;1342   else 
;;;1343   	{
;;;1344   	ibt._max_dispers_num=0;
;;;1345   	ibt._max_dispers=ibt._T_dispers[0];
;;;1346   
;;;1347   	if(ibt._T_dispers[1]>ibt._max_dispers)
;;;1348   		{
;;;1349   		ibt._max_dispers_num=1;
;;;1350   		ibt._max_dispers=ibt._T_dispers[1];
;;;1351   		}
;;;1352   	if(ibt._T_dispers[2]>ibt._max_dispers)
;;;1353   		{
;;;1354   		ibt._max_dispers_num=2;
;;;1355   		ibt._max_dispers=ibt._T_dispers[2];
;;;1356   		}
;;;1357   	if(ibt._T_dispers[3]>ibt._max_dispers)
;;;1358   		{
;;;1359   		ibt._max_dispers_num=3;
;;;1360   		ibt._max_dispers=ibt._T_dispers[3];
;;;1361   		}
;;;1362   
;;;1363   	ibt._avg2=0;
;;;1364   
;;;1365   	if(ibt._max_dispers_num!=0)
;;;1366   		{
;;;1367   		ibt._avg2+=ibt._T[0];
;;;1368   		}
;;;1369   	if(ibt._max_dispers_num!=1)
;;;1370   		{
;;;1371   		ibt._avg2+=ibt._T[1];
;;;1372   		}
;;;1373   	if(ibt._max_dispers_num!=2)
;;;1374   		{
;;;1375   		ibt._avg2+=ibt._T[2];
;;;1376   		}
;;;1377   	if(ibt._max_dispers_num!=3)
;;;1378   		{
;;;1379   		ibt._avg2+=ibt._T[3];
;;;1380   		}
;;;1381   
;;;1382   	t_box=(ibt._avg2/3)-273;
;;;1383   
;;;1384   	}*/
;;;1385   
;;;1386   
;;;1387   //*********************************************
;;;1388   
;;;1389   #ifndef TELECORE
;;;1390   if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib;
0009cc  4be0              LDR      r3,|L1.3408|
0009ce  7818              LDRB     r0,[r3,#0]  ; BAT_IS_ON
0009d0  2855              CMP      r0,#0x55
0009d2  d105              BNE      |L1.2528|
0009d4  f1b80fc8          CMP      r8,#0xc8
0009d8  dd02              BLE      |L1.2528|
0009da  48de              LDR      r0,|L1.3412|
0009dc  8934              LDRH     r4,[r6,#8]  ; bat
0009de  8704              STRH     r4,[r0,#0x38]
                  |L1.2528|
;;;1391   if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
0009e0  7858              LDRB     r0,[r3,#1]  ; BAT_IS_ON
0009e2  2855              CMP      r0,#0x55
0009e4  d10b              BNE      |L1.2558|
0009e6  f9b6004e          LDRSH    r0,[r6,#0x4e]  ; bat
0009ea  28c8              CMP      r0,#0xc8
0009ec  dd07              BLE      |L1.2558|
0009ee  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
0009f2  f9b63008          LDRSH    r3,[r6,#8]  ; bat
0009f6  4298              CMP      r0,r3
0009f8  dd01              BLE      |L1.2558|
0009fa  4bd6              LDR      r3,|L1.3412|
0009fc  8718              STRH     r0,[r3,#0x38]
                  |L1.2558|
;;;1392   #endif
;;;1393   
;;;1394   #ifdef TELECORE
;;;1395   Ibmax=0;
;;;1396   /*
;;;1397   if((NUMBAT_TELECORE>0)&&(lakb[0]._communicationFullErrorStat==0)&&(lakb[0]._ch_curr/10>Ibmax))Ibmax=lakb[0]._ch_curr/10;
;;;1398   if((NUMBAT_TELECORE>1)&&(lakb[1]._communicationFullErrorStat==0)&&(lakb[1]._ch_curr/10>Ibmax))Ibmax=lakb[1]._ch_curr/10;
;;;1399   if((NUMBAT_TELECORE>2)&&(lakb[2]._communicationFullErrorStat==0)&&(lakb[2]._ch_curr/10>Ibmax))Ibmax=lakb[2]._ch_curr/10;
;;;1400   */
;;;1401   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;1402   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;1403   //if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib/1;
;;;1404   //if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
;;;1405   #endif
;;;1406   //Ibmax=bat[0]._Ib;
;;;1407   //if((AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043))Ibmax=Ib_ips_termokompensat;
;;;1408   
;;;1409   #ifdef UKU_TELECORE2017
;;;1410   Ibmax=0;
;;;1411   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;1412   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;1413   #endif
;;;1414   
;;;1415   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1416   Ibmax=Ib_ips_termokompensat;
0009fe  48d5              LDR      r0,|L1.3412|
000a00  883b              LDRH     r3,[r7,#0]  ; Ib_ips_termokompensat
000a02  8703              STRH     r3,[r0,#0x38]
;;;1417   #endif
;;;1418   for(i=0;i<NUMIST;i++)
000a04  f04f0300          MOV      r3,#0
000a08  e03f              B        |L1.2698|
                  |L1.2570|
;;;1419   	{
;;;1420   	if(bps[i]._cnt<25)
000a0a  eb030083          ADD      r0,r3,r3,LSL #2
000a0e  eb0000c3          ADD      r0,r0,r3,LSL #3
000a12  eb0500c0          ADD      r0,r5,r0,LSL #3
000a16  78c4              LDRB     r4,[r0,#3]
000a18  2c19              CMP      r4,#0x19
000a1a  d228              BCS      |L1.2670|
;;;1421        	{
;;;1422        	bps[i]._Ii=bps[i]._buff[0]+(bps[i]._buff[1]*256);
000a1c  7984              LDRB     r4,[r0,#6]
000a1e  79c7              LDRB     r7,[r0,#7]
000a20  eb042407          ADD      r4,r4,r7,LSL #8
000a24  6244              STR      r4,[r0,#0x24]
;;;1423        	bps[i]._Uin=bps[i]._buff[2]+(bps[i]._buff[3]*256);
000a26  7a04              LDRB     r4,[r0,#8]
000a28  7a47              LDRB     r7,[r0,#9]
000a2a  eb042407          ADD      r4,r4,r7,LSL #8
000a2e  6204              STR      r4,[r0,#0x20]
;;;1424        	bps[i]._Uii=bps[i]._buff[4]+(bps[i]._buff[5]*256);
000a30  7a84              LDRB     r4,[r0,#0xa]
000a32  7ac7              LDRB     r7,[r0,#0xb]
000a34  eb042407          ADD      r4,r4,r7,LSL #8
000a38  61c4              STR      r4,[r0,#0x1c]
;;;1425        	bps[i]._Ti=(signed)(bps[i]._buff[6]);
000a3a  7b04              LDRB     r4,[r0,#0xc]
000a3c  6284              STR      r4,[r0,#0x28]
;;;1426        	bps[i]._adr_ee=bps[i]._buff[7];
000a3e  7b44              LDRB     r4,[r0,#0xd]
000a40  f8804056          STRB     r4,[r0,#0x56]
;;;1427        	bps[i]._flags_tm=bps[i]._buff[8];
000a44  7b84              LDRB     r4,[r0,#0xe]
000a46  f8804046          STRB     r4,[r0,#0x46]
;;;1428   	    //bps[i]._rotor=bps[i]._buff[10]+(bps[i]._buff[11]*256); 
;;;1429   		bps[i]._Uisum=bps[i]._buff[10]+(bps[i]._buff[11]*256); 
000a4a  7c04              LDRB     r4,[r0,#0x10]
000a4c  7c47              LDRB     r7,[r0,#0x11]
000a4e  eb042407          ADD      r4,r4,r7,LSL #8
000a52  6304              STR      r4,[r0,#0x30]
;;;1430   		bps[i].debug_info_to_uku0=bps[i]._buff[12]+(bps[i]._buff[13]*256); 
000a54  7c84              LDRB     r4,[r0,#0x12]
000a56  7cc7              LDRB     r7,[r0,#0x13]
000a58  eb042407          ADD      r4,r4,r7,LSL #8
000a5c  f8a0405e          STRH     r4,[r0,#0x5e]
;;;1431   		bps[i].debug_info_to_uku1=bps[i]._buff[14]+(bps[i]._buff[15]*256);    
000a60  7d04              LDRB     r4,[r0,#0x14]
000a62  7d47              LDRB     r7,[r0,#0x15]
000a64  eb042407          ADD      r4,r4,r7,LSL #8
000a68  f8a04060          STRH     r4,[r0,#0x60]
000a6c  e00a              B        |L1.2692|
                  |L1.2670|
;;;1432        	} 
;;;1433   	else 
;;;1434        	{
;;;1435        	bps[i]._Uii=0; 
000a6e  61c2              STR      r2,[r0,#0x1c]
;;;1436        	bps[i]._Ii=0;
000a70  6242              STR      r2,[r0,#0x24]
;;;1437        	bps[i]._Uin=0;
000a72  6202              STR      r2,[r0,#0x20]
;;;1438        	bps[i]._Ti=0;
000a74  6282              STR      r2,[r0,#0x28]
;;;1439        	bps[i]._flags_tm=0; 
000a76  f8802046          STRB     r2,[r0,#0x46]
;;;1440   	     //bps[i]._rotor=0;
;;;1441   		bps[i]._Uisum=0; 
000a7a  6302              STR      r2,[r0,#0x30]
;;;1442   		bps[i].debug_info_to_uku0=0; 
000a7c  f8a0205e          STRH     r2,[r0,#0x5e]
;;;1443   		bps[i].debug_info_to_uku1=0;    
000a80  f8a02060          STRH     r2,[r0,#0x60]
                  |L1.2692|
000a84  f1030301          ADD      r3,r3,#1              ;1418
000a88  b2db              UXTB     r3,r3                 ;1418
                  |L1.2698|
000a8a  428b              CMP      r3,r1                 ;1418
000a8c  dbbd              BLT      |L1.2570|
;;;1444        	}
;;;1445        
;;;1446        }
;;;1447   
;;;1448   load_I=0;
000a8e  4cb2              LDR      r4,|L1.3416|
;;;1449   #ifdef TELECORE
;;;1450   
;;;1451   /*for(i=0;i<NUMBAT_TELECORE;i++)
;;;1452   	{
;;;1453   	load_I-=lakb[i]._ch_curr/10;
;;;1454   	}*/
;;;1455   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;1456   #elif UKU_TELECORE2017
;;;1457   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;1458   #else
;;;1459   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
000a90  f9b63008          LDRSH    r3,[r6,#8]  ; bat
000a94  f04f000a          MOV      r0,#0xa
000a98  fb93f3f0          SDIV     r3,r3,r0
000a9c  f9b66054          LDRSH    r6,[r6,#0x54]  ; bat
000aa0  fb96f0f0          SDIV     r0,r6,r0
000aa4  4418              ADD      r0,r0,r3
000aa6  f1c00000          RSB      r0,r0,#0
000aaa  b207              SXTH     r7,r0
000aac  8027              STRH     r7,[r4,#0]
;;;1460   #endif
;;;1461   Isumm=0;
000aae  4eab              LDR      r6,|L1.3420|
000ab0  8032              STRH     r2,[r6,#0]
;;;1462   
;;;1463   for(i=0;i<NUMIST;i++)
000ab2  f04f0000          MOV      r0,#0
000ab6  e012              B        |L1.2782|
                  |L1.2744|
;;;1464        {
;;;1465        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
000ab8  eb000380          ADD      r3,r0,r0,LSL #2
000abc  eb0303c0          ADD      r3,r3,r0,LSL #3
000ac0  eb0503c3          ADD      r3,r5,r3,LSL #3
000ac4  f893c003          LDRB     r12,[r3,#3]
000ac8  f1bc0f05          CMP      r12,#5
000acc  d204              BCS      |L1.2776|
000ace  6a5b              LDR      r3,[r3,#0x24]
000ad0  f8b6c000          LDRH     r12,[r6,#0]  ; Isumm
000ad4  4463              ADD      r3,r3,r12
000ad6  8033              STRH     r3,[r6,#0]
                  |L1.2776|
000ad8  f1000001          ADD      r0,r0,#1              ;1463
000adc  b2c0              UXTB     r0,r0                 ;1463
                  |L1.2782|
000ade  4288              CMP      r0,r1                 ;1463
000ae0  dbea              BLT      |L1.2744|
;;;1466        }  
;;;1467        
;;;1468   load_I=load_I+Isumm;
000ae2  8830              LDRH     r0,[r6,#0]  ; Isumm
000ae4  4438              ADD      r0,r0,r7
000ae6  b200              SXTH     r0,r0
000ae8  8020              STRH     r0,[r4,#0]
;;;1469   if(load_I<0)load_I=0;
000aea  2800              CMP      r0,#0
000aec  da00              BGE      |L1.2800|
000aee  8022              STRH     r2,[r4,#0]
                  |L1.2800|
;;;1470   
;;;1471   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1472   load_I=0;
000af0  8022              STRH     r2,[r4,#0]
;;;1473   
;;;1474   Isumm=0;
000af2  8032              STRH     r2,[r6,#0]
;;;1475   
;;;1476   for(i=0;i<NUMIST;i++)
000af4  f04f0000          MOV      r0,#0
000af8  e00f              B        |L1.2842|
                  |L1.2810|
;;;1477        {
;;;1478        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
000afa  eb000380          ADD      r3,r0,r0,LSL #2
000afe  eb0303c0          ADD      r3,r3,r0,LSL #3
000b02  eb0503c3          ADD      r3,r5,r3,LSL #3
000b06  78df              LDRB     r7,[r3,#3]
000b08  2f05              CMP      r7,#5
000b0a  d203              BCS      |L1.2836|
000b0c  6a5b              LDR      r3,[r3,#0x24]
000b0e  8837              LDRH     r7,[r6,#0]  ; Isumm
000b10  443b              ADD      r3,r3,r7
000b12  8033              STRH     r3,[r6,#0]
                  |L1.2836|
000b14  f1000001          ADD      r0,r0,#1              ;1476
000b18  b2c0              UXTB     r0,r0                 ;1476
                  |L1.2842|
000b1a  4288              CMP      r0,r1                 ;1476
000b1c  dbed              BLT      |L1.2810|
;;;1479        }  
;;;1480        
;;;1481   load_I=load_I+Isumm;
000b1e  8831              LDRH     r1,[r6,#0]  ; Isumm
000b20  eb020001          ADD      r0,r2,r1
000b24  b200              SXTH     r0,r0
000b26  8020              STRH     r0,[r4,#0]
;;;1482   if(load_I<0)load_I=0;
000b28  2800              CMP      r0,#0
000b2a  da00              BGE      |L1.2862|
000b2c  8022              STRH     r2,[r4,#0]
                  |L1.2862|
;;;1483   
;;;1484   #endif
;;;1485   
;;;1486   
;;;1487   
;;;1488   #ifdef UKU_GLONASS
;;;1489   inv[0]._Uio=6;
;;;1490   if (NUMINV)
;;;1491   	{
;;;1492   	for(i=0;i<NUMINV;i++)
;;;1493   		{
;;;1494   		if(bps[i+first_inv_slot]._cnt<25)
;;;1495        		{
;;;1496        		inv[i]._Ii=bps[i+first_inv_slot]._buff[0]+(bps[i+first_inv_slot]._buff[1]*256);
;;;1497        		inv[i]._Uin=bps[i+first_inv_slot]._buff[2]+(bps[i+first_inv_slot]._buff[3]*256);
;;;1498        		inv[i]._Uio=bps[i+first_inv_slot]._buff[4]+(bps[i+first_inv_slot]._buff[5]*256);
;;;1499        		inv[i]._Ti=(signed)(bps[i+first_inv_slot]._buff[6]);
;;;1500        		inv[i]._flags_tm=bps[i+first_inv_slot]._buff[8];
;;;1501   	    	//	inv[i]._rotor=bps[i+first_inv_slot]._buff[10]+(bps[i+first_inv_slot]._buff[11]*256);
;;;1502   			inv[i]._cnt=0;    
;;;1503        		} 
;;;1504   		else 
;;;1505        		{
;;;1506        		inv[i]._Uio=0; 
;;;1507        		inv[i]._Ii=0;
;;;1508        		inv[i]._Uin=0;
;;;1509        		inv[i]._Ti=0;
;;;1510        		inv[i]._flags_tm=0; 
;;;1511   //	     	inv[i]._rotor0;
;;;1512   			inv[i]._cnt=25;    
;;;1513        		}
;;;1514        	}
;;;1515      	}
;;;1516   #endif
;;;1517   
;;;1518   #ifndef UKU_GLONASS
;;;1519   if (NUMINV)
000b2e  488c              LDR      r0,|L1.3424|
000b30  f9b04000          LDRSH    r4,[r0,#0]  ; NUMINV
000b34  2c00              CMP      r4,#0
000b36  d066              BEQ      |L1.3078|
;;;1520   	{
;;;1521   	for(i=0;i<NUMINV;i++)
000b38  f04f0300          MOV      r3,#0
;;;1522   		{
;;;1523   		if(bps[i+20]._cnt<25)
;;;1524        		{
;;;1525        		inv[i]._Ii=bps[i+20]._buff[0]+(bps[i+20]._buff[1]*256);
000b3c  4e89              LDR      r6,|L1.3428|
000b3e  e060              B        |L1.3074|
                  |L1.2880|
000b40  f1030014          ADD      r0,r3,#0x14           ;1523
000b44  eb000180          ADD      r1,r0,r0,LSL #2       ;1523
000b48  eb0100c0          ADD      r0,r1,r0,LSL #3       ;1523
000b4c  eb0500c0          ADD      r0,r5,r0,LSL #3       ;1523
000b50  78c1              LDRB     r1,[r0,#3]            ;1523
000b52  2919              CMP      r1,#0x19              ;1523
000b54  d239              BCS      |L1.3018|
000b56  7981              LDRB     r1,[r0,#6]
000b58  79c7              LDRB     r7,[r0,#7]
000b5a  eb012707          ADD      r7,r1,r7,LSL #8
000b5e  eb030143          ADD      r1,r3,r3,LSL #1
000b62  eb061141          ADD      r1,r6,r1,LSL #5
000b66  61cf              STR      r7,[r1,#0x1c]
;;;1526        		inv[i]._Pio=bps[i+20]._buff[2]+(bps[i+20]._buff[3]*256);
000b68  7a07              LDRB     r7,[r0,#8]
000b6a  f890c009          LDRB     r12,[r0,#9]
000b6e  eb07270c          ADD      r7,r7,r12,LSL #8
000b72  62cf              STR      r7,[r1,#0x2c]
;;;1527        		inv[i]._Uio=bps[i+20]._buff[4]+(bps[i+20]._buff[5]*256);
000b74  7a87              LDRB     r7,[r0,#0xa]
000b76  f890c00b          LDRB     r12,[r0,#0xb]
000b7a  eb07270c          ADD      r7,r7,r12,LSL #8
000b7e  618f              STR      r7,[r1,#0x18]
;;;1528        		inv[i]._Ti=(signed)(bps[i+20]._buff[6]);
000b80  7b07              LDRB     r7,[r0,#0xc]
000b82  620f              STR      r7,[r1,#0x20]
;;;1529        		inv[i]._flags_tm=bps[i+20]._buff[7];
000b84  7b47              LDRB     r7,[r0,#0xd]
000b86  f8817046          STRB     r7,[r1,#0x46]
;;;1530        		inv[i]._Uin=bps[i+20]._buff[8]+(bps[i+20]._buff[9]*256);
000b8a  7b87              LDRB     r7,[r0,#0xe]
000b8c  f890c00f          LDRB     r12,[r0,#0xf]
000b90  eb07270c          ADD      r7,r7,r12,LSL #8
000b94  628f              STR      r7,[r1,#0x28]
;;;1531        		inv[i]._Uil=bps[i+20]._buff[10]+(bps[i+20]._buff[11]*256);
000b96  7c07              LDRB     r7,[r0,#0x10]
000b98  f890c011          LDRB     r12,[r0,#0x11]
000b9c  eb07270c          ADD      r7,r7,r12,LSL #8
000ba0  624f              STR      r7,[r1,#0x24]
;;;1532   			inv[i]._cnt=0;
000ba2  708a              STRB     r2,[r1,#2]
;;;1533   			inv[i]._Uoutmin=bps[i+20]._buff[12]; 
000ba4  7c87              LDRB     r7,[r0,#0x12]
000ba6  f8817059          STRB     r7,[r1,#0x59]
;;;1534   			inv[i]._Uoutmax=bps[i+20]._buff[13]; 
000baa  7cc7              LDRB     r7,[r0,#0x13]
000bac  f881705a          STRB     r7,[r1,#0x5a]
;;;1535   			inv[i]._Pnom=bps[i+20]._buff[14]; 
000bb0  7d07              LDRB     r7,[r0,#0x14]
000bb2  f8817058          STRB     r7,[r1,#0x58]
;;;1536   			inv[i]._net_contr_en=bps[i+20]._buff[15];
000bb6  7d47              LDRB     r7,[r0,#0x15]
000bb8  f881705b          STRB     r7,[r1,#0x5b]
;;;1537   			inv[i]._pwm_en=bps[i+20]._buff[16];  
000bbc  7d87              LDRB     r7,[r0,#0x16]
000bbe  f881705c          STRB     r7,[r1,#0x5c]
;;;1538   			inv[i]._phase_mode=bps[i+20]._buff[17];  
000bc2  7dc0              LDRB     r0,[r0,#0x17]
000bc4  f881005d          STRB     r0,[r1,#0x5d]
000bc8  e018              B        |L1.3068|
                  |L1.3018|
;;;1539        		} 
;;;1540   		else 
;;;1541        		{
;;;1542         		inv[i]._Ii=0;
000bca  eb030043          ADD      r0,r3,r3,LSL #1
000bce  eb061040          ADD      r0,r6,r0,LSL #5
000bd2  61c2              STR      r2,[r0,#0x1c]
;;;1543   			inv[i]._Pio=0;
000bd4  62c2              STR      r2,[r0,#0x2c]
;;;1544   			inv[i]._Uio=0;
000bd6  6182              STR      r2,[r0,#0x18]
;;;1545        		inv[i]._Ti=0;
000bd8  6202              STR      r2,[r0,#0x20]
;;;1546        		inv[i]._flags_tm=0; 
000bda  f8802046          STRB     r2,[r0,#0x46]
;;;1547        		inv[i]._Uil=0;
000bde  6242              STR      r2,[r0,#0x24]
;;;1548        		inv[i]._Uin=0;
000be0  6282              STR      r2,[r0,#0x28]
;;;1549   			inv[i]._cnt=25; 
000be2  f04f0119          MOV      r1,#0x19
000be6  7081              STRB     r1,[r0,#2]
;;;1550   			inv[i]._Uoutmin=0; 
000be8  f8802059          STRB     r2,[r0,#0x59]
;;;1551   			inv[i]._Uoutmax=0; 
000bec  f880205a          STRB     r2,[r0,#0x5a]
;;;1552   			inv[i]._Pnom=0; 
000bf0  f8802058          STRB     r2,[r0,#0x58]
;;;1553   			inv[i]._net_contr_en=0;
000bf4  f880205b          STRB     r2,[r0,#0x5b]
;;;1554   			inv[i]._pwm_en=0;   
000bf8  f880205c          STRB     r2,[r0,#0x5c]
                  |L1.3068|
000bfc  f1030301          ADD      r3,r3,#1              ;1521
000c00  b2db              UXTB     r3,r3                 ;1521
                  |L1.3074|
000c02  42a3              CMP      r3,r4                 ;1521
000c04  db9c              BLT      |L1.2880|
                  |L1.3078|
;;;1555   			   
;;;1556        		}
;;;1557        	}
;;;1558      	}
;;;1559   #endif
;;;1560   
;;;1561   #ifdef GLADKOV
;;;1562   inv[0]._Ii=bps[4]._buff[0]+(bps[4]._buff[1]*256);
;;;1563   inv[0]._Pio=bps[4]._buff[2]+(bps[4]._buff[3]*256);
;;;1564   inv[0]._Uio=bps[4]._buff[4]+(bps[4]._buff[5]*256);
;;;1565   inv[0]._Ti=(signed)(bps[4]._buff[6]);
;;;1566   inv[0]._flags_tm=bps[4]._buff[7];
;;;1567   inv[0]._Uin=bps[4]._buff[8]+(bps[4]._buff[9]*256);
;;;1568   inv[0]._Uil=bps[4]._buff[10]+(bps[4]._buff[11]*256);
;;;1569   inv[0]._cnt=0;    
;;;1570   
;;;1571   inv[1]._Ii=bps[21]._buff[0]+(bps[21]._buff[1]*256);
;;;1572   inv[1]._Pio=bps[21]._buff[2]+(bps[21]._buff[3]*256);
;;;1573   inv[1]._Uio=bps[21]._buff[4]+(bps[21]._buff[5]*256);
;;;1574   inv[1]._Ti=(signed)(bps[21]._buff[6]);
;;;1575   inv[1]._flags_tm=bps[21]._buff[7];
;;;1576   inv[1]._Uin=bps[21]._buff[8]+(bps[21]._buff[9]*256);
;;;1577   inv[1]._Uil=bps[21]._buff[10]+(bps[21]._buff[11]*256);
;;;1578   inv[1]._cnt=0;    
;;;1579   #endif
;;;1580   
;;;1581   /*
;;;1582   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE==1))
;;;1583   	{
;;;1584   	lakb[0]._battCommState=0;
;;;1585   	if(lakb[0]._cnt>10)lakb[0]._battCommState=2;
;;;1586   	else if(lakb[0]._bRS485ERR==1)lakb[0]._battCommState=1;
;;;1587   	
;;;1588   	if(lakb[0]._battCommState==0)
;;;1589   		{	
;;;1590   		bat[0]._Ub=(signed short)((lakb[0]._tot_bat_volt+5)/10);
;;;1591   		bat[0]._Ib=(signed short)lakb[0]._ch_curr;
;;;1592   		if(lakb[0]._dsch_curr) bat[0]._Ib=(signed short) (-lakb[0]._dsch_curr);
;;;1593   		bat[0]._Tb=(signed short)lakb[0]._max_cell_temp;
;;;1594   		}
;;;1595   	}
;;;1596   */
;;;1597   
;;;1598   #ifdef UKU_TELECORE2015
;;;1599   
;;;1600   	if(BAT_TYPE==2)
;;;1601   		{
;;;1602   		lakb[0]._ch_curr/*temp_SS*/=((ascii2halFhex(liBatteryInBuff[113]))<<12)+
;;;1603   					 		((ascii2halFhex(liBatteryInBuff[114]))<<8)+
;;;1604   							((ascii2halFhex(liBatteryInBuff[115]))<<4)+
;;;1605   							((ascii2halFhex(liBatteryInBuff[116])));
;;;1606   		
;;;1607   		/*if(temp_SS&0x8000)		lakb[0]._ch_curr=~temp_SS;
;;;1608   		else 				lakb[0]._ch_curr=temp_SS;*/
;;;1609   	
;;;1610   		lakb[0]._tot_bat_volt=	(unsigned short)(((ascii2halFhex(liBatteryInBuff[117]))<<12)+
;;;1611   							((ascii2halFhex(liBatteryInBuff[118]))<<8)+
;;;1612   							((ascii2halFhex(liBatteryInBuff[119]))<<4)+
;;;1613   							((ascii2halFhex(liBatteryInBuff[120]))))/100;
;;;1614   	
;;;1615   		lakb[0]._max_cell_temp= 	(((ascii2halFhex(liBatteryInBuff[93]))<<12)+
;;;1616   							((ascii2halFhex(liBatteryInBuff[94]))<<8)+
;;;1617   							((ascii2halFhex(liBatteryInBuff[95]))<<4)+
;;;1618   							((ascii2halFhex(liBatteryInBuff[96]))))/10-273;
;;;1619   	
;;;1620   		lakb[0]._s_o_c_abs=		(unsigned short)((ascii2halFhex(liBatteryInBuff[121]))<<12)+
;;;1621   							((ascii2halFhex(liBatteryInBuff[122]))<<8)+
;;;1622   							((ascii2halFhex(liBatteryInBuff[123]))<<4)+
;;;1623   							((ascii2halFhex(liBatteryInBuff[124])));
;;;1624   	
;;;1625   		lakb[0]._rat_cap=		(unsigned short)((ascii2halFhex(liBatteryInBuff[127]))<<12)+
;;;1626   							((ascii2halFhex(liBatteryInBuff[128]))<<8)+
;;;1627   							((ascii2halFhex(liBatteryInBuff[129]))<<4)+
;;;1628   							((ascii2halFhex(liBatteryInBuff[130])));
;;;1629   	
;;;1630   		lakb[0]._s_o_c=		lakb[0]._s_o_c_abs/(lakb[0]._rat_cap/100);
;;;1631   	
;;;1632   	
;;;1633   	/*	lakb[0]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;1634   		lakb[0]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;1635   		lakb[0]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;1636   		lakb[0]._max_cell_temp= lakb_damp[i][4];
;;;1637   		lakb[0]._min_cell_temp= lakb_damp[i][5];
;;;1638   		lakb[0]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;1639   		lakb[0]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][8];
;;;1640   		lakb[0]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;1641   		lakb[0]._s_o_c= lakb_damp[i][12];
;;;1642   		lakb[0]._r_b_t= lakb_damp[i][15];
;;;1643   		lakb[0]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;1644   		lakb[0]._s_o_h= lakb_damp[i][18];
;;;1645   	
;;;1646   		if(lakb[i]._rat_cap==0)
;;;1647   			{
;;;1648   			if(lakb[i]._isOnCnt)
;;;1649   				{
;;;1650   				lakb[i]._isOnCnt--;
;;;1651   				if(lakb[i]._isOnCnt==0)
;;;1652   					{
;;;1653   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;1654   					}
;;;1655   				}
;;;1656   			}
;;;1657   		else 
;;;1658   			{
;;;1659   			if(lakb[i]._isOnCnt<50)
;;;1660   				{
;;;1661   				lakb[i]._isOnCnt++;
;;;1662   				if(lakb[i]._isOnCnt==50)
;;;1663   					{
;;;1664   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;1665   					}
;;;1666   				}
;;;1667   			}
;;;1668   		gran(&lakb[i]._isOnCnt,0,50);*/
;;;1669   		}
;;;1670   	else if(BAT_TYPE==3)
;;;1671   		{
;;;1672   		//short numOfPacks;
;;;1673   		//short numOfCells, numOfTemperCells, baseOfData;
;;;1674   		
;;;1675   		#ifndef UKU_TELECORE2016
;;;1676   		numOfCells=((ascii2halFhex(liBatteryInBuff[17]))<<4)+((ascii2halFhex(liBatteryInBuff[18])));
;;;1677   		numOfTemperCells=((ascii2halFhex(liBatteryInBuff[17+(numOfCells*4)+2]))<<4)+((ascii2halFhex(liBatteryInBuff[18+(numOfCells*4)+2])));
;;;1678   		numOfPacks=((ascii2halFhex(liBatteryInBuff[15]))<<4)+((ascii2halFhex(liBatteryInBuff[16])));
;;;1679   		if(numOfPacks)numOfPacks-=1;
;;;1680   		if((numOfPacks<0)||(numOfPacks>NUMBAT_TELECORE))numOfPacks=0;
;;;1681   		plazma_numOfCells=numOfCells;
;;;1682   		plazma_numOfTemperCells=numOfTemperCells;
;;;1683   		plazma_numOfPacks=numOfPacks;
;;;1684   
;;;1685   
;;;1686   		baseOfData=16+(numOfCells*4)+2+(numOfTemperCells*4)+2;
;;;1687   
;;;1688   		lakb[numOfPacks]._ch_curr=(signed short)(
;;;1689   							((ascii2halFhex(liBatteryInBuff[1+baseOfData]))<<12)+
;;;1690   							((ascii2halFhex(liBatteryInBuff[2+baseOfData]))<<8)+
;;;1691   							((ascii2halFhex(liBatteryInBuff[3+baseOfData]))<<4)+
;;;1692   							((ascii2halFhex(liBatteryInBuff[4+baseOfData])))
;;;1693   							);	  
;;;1694   
;;;1695   		lakb[numOfPacks]._tot_bat_volt=(signed short)(
;;;1696   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+4]))<<12)+
;;;1697   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+4]))<<8)+
;;;1698   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+4]))<<4)+
;;;1699   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+4])))
;;;1700   							)/10;
;;;1701   
;;;1702   		lakb[numOfPacks]._max_cell_temp=(signed short)(
;;;1703   							((ascii2halFhex(liBatteryInBuff[1+baseOfData-4]))<<12)+
;;;1704   							((ascii2halFhex(liBatteryInBuff[2+baseOfData-4]))<<8)+
;;;1705   							((ascii2halFhex(liBatteryInBuff[3+baseOfData-4]))<<4)+
;;;1706   							((ascii2halFhex(liBatteryInBuff[4+baseOfData-4])))
;;;1707   							)-2730;
;;;1708   
;;;1709   		lakb[numOfPacks]._s_o_c=(signed short)(
;;;1710   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+8]))<<12)+
;;;1711   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+8]))<<8)+
;;;1712   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+8]))<<4)+
;;;1713   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+8])))
;;;1714   							)/10;
;;;1715   
;;;1716   		lakb[numOfPacks]._s_o_h=(signed short)(
;;;1717   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+14]))<<12)+
;;;1718   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+14]))<<8)+
;;;1719   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+14]))<<4)+
;;;1720   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+14])))
;;;1721   							)/10;
;;;1722   		#endif
;;;1723   		
;;;1724   		#ifdef UKU_TELECORE2016
;;;1725   		{
;;;1726   		char i;
;;;1727   		
;;;1728   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;1729   			{
;;;1730   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;1731   			}
;;;1732   		}
;;;1733   		#endif
;;;1734   		
;;;1735   										  
;;;1736   		}
;;;1737   	
;;;1738   if(sacredSunSilentCnt<3) 
;;;1739   	{
;;;1740       	bat[0]._Ub=lakb[0]._tot_bat_volt;
;;;1741       	bat[0]._Tb=lakb[0]._max_cell_temp;
;;;1742      	//bat[0]._Ib=lakb[0]._ch_curr/10;
;;;1743   	}
;;;1744   else 
;;;1745   	{
;;;1746       	//bat[0]._Ub=0;
;;;1747       	//bat[0]._Tb=0;
;;;1748      	//bat[0]._Ib=0;
;;;1749   	}
;;;1750   
;;;1751   if(BAT_TYPE==1)
;;;1752   	{
;;;1753   	char i;
;;;1754   	for(i=0;i<1;i++)
;;;1755   		{
;;;1756   		lakb[i]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;1757   		lakb[i]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;1758   		lakb[i]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;1759   		lakb[i]._max_cell_temp= lakb_damp[i][4];
;;;1760   		lakb[i]._min_cell_temp= lakb_damp[i][5];
;;;1761   		lakb[i]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;1762   		lakb[i]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][9];
;;;1763   		lakb[i]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;1764   		lakb[i]._s_o_c= lakb_damp[i][12];
;;;1765   		lakb[i]._r_b_t= lakb_damp[i][15];
;;;1766   		lakb[i]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;1767   		lakb[i]._s_o_h= lakb_damp[i][18];
;;;1768   		lakb[i]._flags1= lakb_damp[i][34];
;;;1769   		lakb[i]._flags2= lakb_damp[i][35];
;;;1770   		lakb[i]._b_p_ser_num= lakb_damp[i][36];
;;;1771   
;;;1772   /*		if(lakb[i]._rat_cap==0)
;;;1773   			{
;;;1774   			if(lakb[i]._isOnCnt)
;;;1775   				{
;;;1776   				lakb[i]._isOnCnt--;
;;;1777   				if(lakb[i]._isOnCnt==0)
;;;1778   					{
;;;1779   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;1780   					}
;;;1781   				}
;;;1782   			}
;;;1783   		else 
;;;1784   			{
;;;1785   			if(lakb[i]._isOnCnt<50)
;;;1786   				{
;;;1787   				lakb[i]._isOnCnt++;
;;;1788   				if(lakb[i]._isOnCnt==50)
;;;1789   					{
;;;1790   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;1791   					}
;;;1792   				}
;;;1793   			} */
;;;1794   		gran(&lakb[i]._isOnCnt,0,50);
;;;1795   	 	}
;;;1796   
;;;1797   	if(lakb_damp[0][41]==100)
;;;1798   		{
;;;1799   		li_bat._485Error=1;
;;;1800   		}
;;;1801   	if(lakb_damp[0][41]==0)
;;;1802   		{
;;;1803   		//if(bRS485ERR)bLAKB_KONF_CH=1;
;;;1804   		li_bat._485Error=0;
;;;1805   		}
;;;1806   	li_bat._485ErrorCnt=lakb_damp[0][41];
;;;1807   
;;;1808   
;;;1809   	}
;;;1810   
;;;1811   
;;;1812   #endif
;;;1813   
;;;1814   		#ifdef UKU_TELECORE2017
;;;1815   		{
;;;1816   		char i;
;;;1817   		
;;;1818   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;1819   			{
;;;1820   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;1821   			}
;;;1822   		}
;;;1823   		#endif
;;;1824   #ifdef UKU_TELECORE2015
;;;1825   //вычисление параметров работы батареи
;;;1826   //TODO дописать дл€ всех батарей все параметры и при отцепке батарей
;;;1827   li_bat._batStat=bsOK;
;;;1828   if(BAT_TYPE==1) //COSLIGHT
;;;1829   	{
;;;1830   	if(li_bat._batStat==bsOK)
;;;1831   		{
;;;1832   		li_bat._Ub=lakb[0]._tot_bat_volt/10;
;;;1833   
;;;1834   		if(lakb[0]._ch_curr)li_bat._Ib=lakb[0]._ch_curr/10;
;;;1835   		else if(lakb[0]._dsch_curr) li_bat._Ib=bat[0]._Ib/10;//lakb[0]._dsch_curr/10;
;;;1836   	
;;;1837   		li_bat._ratCap=lakb[0]._rat_cap/100;
;;;1838   		li_bat._soc=lakb[0]._s_o_c;
;;;1839   		li_bat._soh=lakb[0]._s_o_h;
;;;1840   		li_bat._cclv=lakb[0]._c_c_l_v/10;
;;;1841   		li_bat._Tb=lakb[0]._max_cell_temp;
;;;1842   		li_bat._rbt=lakb[0]._r_b_t;
;;;1843   		}
;;;1844   	else 
;;;1845   		{
;;;1846   		li_bat._Ub=bat[0]._Ub;
;;;1847   		li_bat._Ib=bat[0]._Ib/10;
;;;1848   		li_bat._Tb=bat[0]._Tb;
;;;1849   		}
;;;1850   
;;;1851   	if((li_bat._485Error)||(li_bat._canError))
;;;1852   		{
;;;1853   		li_bat._batStat=bsOFF;
;;;1854   		}
;;;1855   	else li_bat._batStat=bsOK;
;;;1856   	}
;;;1857   else if(BAT_TYPE==2) //SACRED SUN
;;;1858   	{
;;;1859   	}
;;;1860   else if(BAT_TYPE==3) //ZTT
;;;1861   	{
;;;1862   	if(li_bat._batStat==bsOK)
;;;1863   		{
;;;1864   
;;;1865   		}
;;;1866   	}
;;;1867   #endif
;;;1868   
;;;1869   
;;;1870   /*
;;;1871   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE[0]==1)&&(BAT_LINK==0))
;;;1872   	{
;;;1873   
;;;1874   
;;;1875   	if(bat_drv_rx_buff[13]<=0x39)bbb[0]=bat_drv_rx_buff[13]-0x30;
;;;1876   	else bbb[0]=bat_drv_rx_buff[13]-55;
;;;1877   	if(bat_drv_rx_buff[14]<=0x39)bbb[1]=bat_drv_rx_buff[14]-0x30;
;;;1878   	else bbb[1]=bat_drv_rx_buff[14]-55;
;;;1879   	if(bat_drv_rx_buff[15]<=0x39)bbb[2]=bat_drv_rx_buff[15]-0x30;
;;;1880   	else bbb[2]=bat_drv_rx_buff[15]-55;
;;;1881   	if(bat_drv_rx_buff[16]<=0x39)bbb[3]=bat_drv_rx_buff[16]-0x30;
;;;1882   	else bbb[3]=bat_drv_rx_buff[16]-55;
;;;1883   
;;;1884   	tempSS=0;
;;;1885   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;1886   
;;;1887   	bat[0]._max_cell_volt=(tempSS+5)/10;
;;;1888   
;;;1889   	if(bat_drv_rx_buff[17]<=0x39)bbb[0]=bat_drv_rx_buff[17]-0x30;
;;;1890   	else bbb[0]=bat_drv_rx_buff[17]-55;
;;;1891   	if(bat_drv_rx_buff[18]<=0x39)bbb[1]=bat_drv_rx_buff[18]-0x30;
;;;1892   	else bbb[1]=bat_drv_rx_buff[18]-55;
;;;1893   	if(bat_drv_rx_buff[19]<=0x39)bbb[2]=bat_drv_rx_buff[19]-0x30;
;;;1894   	else bbb[2]=bat_drv_rx_buff[19]-55;
;;;1895   	if(bat_drv_rx_buff[20]<=0x39)bbb[3]=bat_drv_rx_buff[20]-0x30;
;;;1896   	else bbb[3]=bat_drv_rx_buff[20]-55;
;;;1897   
;;;1898   	tempSS=0;
;;;1899   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;1900   
;;;1901   	bat[0]._min_cell_volt=(tempSS+5)/10;
;;;1902   
;;;1903   
;;;1904   	}*/
;;;1905   
;;;1906   
;;;1907   
;;;1908   }
000c06  e8bd8ffe          POP      {r1-r11,pc}
;;;1909   
                          ENDP

                  adc_init PROC
;;;1912   //-----------------------------------------------
;;;1913   void adc_init(void)
000c0a  4857              LDR      r0,|L1.3432|
;;;1914   {
;;;1915   
;;;1916   SET_REG(LPC_PINCON->PINSEL1,1,(25-16)*2,2);
000c0c  6841              LDR      r1,[r0,#4]
000c0e  f4212140          BIC      r1,r1,#0xc0000
000c12  f4412180          ORR      r1,r1,#0x40000
000c16  6041              STR      r1,[r0,#4]
;;;1917   SET_REG(LPC_PINCON->PINSEL1,1,(24-16)*2,2);
000c18  6841              LDR      r1,[r0,#4]
000c1a  f4213140          BIC      r1,r1,#0x30000
000c1e  f4413180          ORR      r1,r1,#0x10000
000c22  6041              STR      r1,[r0,#4]
;;;1918   SET_REG(LPC_PINCON->PINSEL1,1,(23-16)*2,2);
000c24  6841              LDR      r1,[r0,#4]
000c26  f4214140          BIC      r1,r1,#0xc000
000c2a  f4414180          ORR      r1,r1,#0x4000
000c2e  6041              STR      r1,[r0,#4]
;;;1919   
;;;1920   
;;;1921   SET_REG(LPC_PINCON->PINMODE1,2,(25-16)*2,2);
000c30  6c41              LDR      r1,[r0,#0x44]
000c32  f4212140          BIC      r1,r1,#0xc0000
000c36  f4412100          ORR      r1,r1,#0x80000
000c3a  6441              STR      r1,[r0,#0x44]
;;;1922   SET_REG(LPC_PINCON->PINMODE1,2,(24-16)*2,2);
000c3c  6c41              LDR      r1,[r0,#0x44]
000c3e  f4213140          BIC      r1,r1,#0x30000
000c42  f4413100          ORR      r1,r1,#0x20000
000c46  6441              STR      r1,[r0,#0x44]
;;;1923   SET_REG(LPC_PINCON->PINMODE1,2,(23-16)*2,2);
000c48  6c41              LDR      r1,[r0,#0x44]
000c4a  f4214140          BIC      r1,r1,#0xc000
000c4e  f4414100          ORR      r1,r1,#0x8000
000c52  6441              STR      r1,[r0,#0x44]
;;;1924   
;;;1925   SET_REG(LPC_ADC->ADCR,0,24,3);
000c54  4845              LDR      r0,|L1.3436|
000c56  6801              LDR      r1,[r0,#0]
000c58  f02161e0          BIC      r1,r1,#0x7000000
000c5c  6001              STR      r1,[r0,#0]
;;;1926   
;;;1927   SET_REG(LPC_ADC->ADCR,1,21,1);
000c5e  6801              LDR      r1,[r0,#0]
000c60  f4411100          ORR      r1,r1,#0x200000
000c64  6001              STR      r1,[r0,#0]
;;;1928   SET_REG(LPC_ADC->ADCR,0,16,1);
000c66  6801              LDR      r1,[r0,#0]
000c68  f4213180          BIC      r1,r1,#0x10000
000c6c  6001              STR      r1,[r0,#0]
;;;1929   SET_REG(LPC_ADC->ADCR,1,8,8);
000c6e  6801              LDR      r1,[r0,#0]
000c70  f421417f          BIC      r1,r1,#0xff00
000c74  f4417180          ORR      r1,r1,#0x100
000c78  6001              STR      r1,[r0,#0]
;;;1930   
;;;1931   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;1932   //SET_REG(LPC_GPIO0->FIOPIN,4,5,3);
;;;1933   	
;;;1934   	/*if(adc_ch<=7)*///SET_REG(LPC_ADC->ADCR,1<<5,0,8);
;;;1935        /*else if(adc_ch==8) SET_REG(LPC_ADC->ADCR,1<<2,0,8);
;;;1936        else SET_REG(LPC_ADC->ADCR,1<<4,0,8);*/
;;;1937   
;;;1938   LPC_ADC->ADINTEN     =  (1<< 8);      /* global enable interrupt            */
000c7a  f44f7180          MOV      r1,#0x100
000c7e  60c1              STR      r1,[r0,#0xc]
000c80  483b              LDR      r0,|L1.3440|
000c82  f44f0180          MOV      r1,#0x400000
000c86  6001              STR      r1,[r0,#0]
;;;1939   
;;;1940   NVIC_EnableIRQ(ADC_IRQn);             /* enable ADC Interrupt               */
;;;1941   
;;;1942   
;;;1943   }
000c88  4770              BX       lr
;;;1944   
                          ENDP

                  adc_drv7 PROC
;;;1945   //-----------------------------------------------
;;;1946   void adc_drv7(void) //(Uсети - посто€нка)
000c8a  e92d41f0          PUSH     {r4-r8,lr}
;;;1947   {
;;;1948   //int temp_S;
;;;1949   //char i;
;;;1950   //signed short temp_SS;
;;;1951   
;;;1952   adc_self_ch_disp[0]=abs_pal(adc_self_ch_buff[1]-adc_self_ch_buff[0]);//adc_self_ch_buff[0]&0x0f80;
000c8e  4c31              LDR      r4,|L1.3412|
000c90  3472              ADDS     r4,r4,#0x72
000c92  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000c94  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000c96  1a40              SUBS     r0,r0,r1
000c98  b200              SXTH     r0,r0
000c9a  f7fffffe          BL       abs_pal
000c9e  1da6              ADDS     r6,r4,#6
000ca0  8030              STRH     r0,[r6,#0]
;;;1953   adc_self_ch_disp[1]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[1]);//adc_self_ch_buff[1]&0x0f80;
000ca2  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000ca4  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
000ca6  1a40              SUBS     r0,r0,r1
000ca8  b200              SXTH     r0,r0
000caa  f7fffffe          BL       abs_pal
000cae  8070              STRH     r0,[r6,#2]
;;;1954   adc_self_ch_disp[2]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[0]);//adc_self_ch_buff[2]&0x0f80;
000cb0  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000cb2  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000cb4  1a40              SUBS     r0,r0,r1
000cb6  b200              SXTH     r0,r0
000cb8  f7fffffe          BL       abs_pal
000cbc  80b0              STRH     r0,[r6,#4]
;;;1955   
;;;1956   //adc_self_ch_disp[0]=adc_self_ch_buff[0]&0x0ff0;
;;;1957   //adc_self_ch_disp[1]=adc_self_ch_buff[1]&0x0ff0;
;;;1958   //adc_self_ch_disp[2]=adc_self_ch_buff[2]&0x0ff0;
;;;1959   
;;;1960   
;;;1961   if(adc_self_ch_disp[2]<300)//==adc_self_ch_disp[2])
000cbe  f44f7196          MOV      r1,#0x12c
;;;1962   	{
;;;1963   	adc_result=adc_self_ch_buff[2];
000cc2  4d24              LDR      r5,|L1.3412|
000cc4  4288              CMP      r0,r1                 ;1961
000cc6  da02              BGE      |L1.3278|
000cc8  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000cca  8568              STRH     r0,[r5,#0x2a]
000ccc  e00c              B        |L1.3304|
                  |L1.3278|
;;;1964   	} 
;;;1965   else if(adc_self_ch_disp[1]<300)//==adc_self_ch_disp[2])
000cce  f9b60002          LDRSH    r0,[r6,#2]  ; adc_self_ch_disp
000cd2  4288              CMP      r0,r1
000cd4  da02              BGE      |L1.3292|
;;;1966   	{
;;;1967   	adc_result=adc_self_ch_buff[1];
000cd6  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000cd8  8568              STRH     r0,[r5,#0x2a]
000cda  e005              B        |L1.3304|
                  |L1.3292|
;;;1968   	}
;;;1969   else if(adc_self_ch_disp[0]<300)//==adc_self_ch_disp[1])
000cdc  f9b60000          LDRSH    r0,[r6,#0]  ; adc_self_ch_disp
000ce0  4288              CMP      r0,r1
000ce2  da01              BGE      |L1.3304|
;;;1970   	{
;;;1971   	adc_result=adc_self_ch_buff[0];
000ce4  8820              LDRH     r0,[r4,#0]  ; adc_self_ch_buff
000ce6  8568              STRH     r0,[r5,#0x2a]
                  |L1.3304|
;;;1972   	}
;;;1973       //adc_result=92;
;;;1974   
;;;1975   if(adc_ch_net)
000ce8  78ef              LDRB     r7,[r5,#3]  ; adc_ch_net
000cea  2600              MOVS     r6,#0
000cec  b32f              CBZ      r7,|L1.3386|
;;;1976   	{
;;;1977   
;;;1978   	main_power_buffer[0]+=(long)(adc_result);
000cee  4821              LDR      r0,|L1.3444|
000cf0  f9b5102a          LDRSH    r1,[r5,#0x2a]  ; adc_result
000cf4  6802              LDR      r2,[r0,#0]  ; main_power_buffer
000cf6  440a              ADD      r2,r2,r1
000cf8  6002              STR      r2,[r0,#0]  ; main_power_buffer
;;;1979   	main_power_buffer[1]+=(long)(adc_result);
000cfa  6842              LDR      r2,[r0,#4]  ; main_power_buffer
000cfc  440a              ADD      r2,r2,r1
000cfe  6042              STR      r2,[r0,#4]  ; main_power_buffer
;;;1980   	main_power_buffer[2]+=(long)(adc_result);
000d00  6882              LDR      r2,[r0,#8]  ; main_power_buffer
000d02  440a              ADD      r2,r2,r1
000d04  6082              STR      r2,[r0,#8]  ; main_power_buffer
;;;1981   	main_power_buffer[3]+=(long)(adc_result);
000d06  68c2              LDR      r2,[r0,#0xc]  ; main_power_buffer
000d08  4411              ADD      r1,r1,r2
000d0a  60c1              STR      r1,[r0,#0xc]  ; main_power_buffer
;;;1982   
;;;1983   	adc_net_buff_cnt++;
000d0c  8e69              LDRH     r1,[r5,#0x32]  ; adc_net_buff_cnt
000d0e  f1010101          ADD      r1,r1,#1
000d12  b209              SXTH     r1,r1
000d14  8669              STRH     r1,[r5,#0x32]
;;;1984   	if(adc_net_buff_cnt>=0x1000)
000d16  f5b15f80          CMP      r1,#0x1000
000d1a  db00              BLT      |L1.3358|
;;;1985   		{
;;;1986   		adc_net_buff_cnt=0;
000d1c  866e              STRH     r6,[r5,#0x32]
                  |L1.3358|
;;;1987   		}
;;;1988   	if((adc_net_buff_cnt&0x03ff)==0)
000d1e  f9b51032          LDRSH    r1,[r5,#0x32]  ; adc_net_buff_cnt
000d22  058a              LSLS     r2,r1,#22
000d24  d14e              BNE      |L1.3524|
;;;1989   		{
;;;1990   		#ifdef UKU_220
;;;1991   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;1992   		#else
;;;1993   		#ifdef UKU_220_V2
;;;1994   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;1995   		#else
;;;1996   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>8);
000d26  ea4f21a1          ASR      r1,r1,#10
000d2a  f8502021          LDR      r2,[r0,r1,LSL #2]
000d2e  ea4f2222          ASR      r2,r2,#8
000d32  852a              STRH     r2,[r5,#0x28]
;;;1997   		#endif
;;;1998   		#endif
;;;1999   		main_power_buffer[adc_net_buff_cnt>>10]=0;
000d34  f8406021          STR      r6,[r0,r1,LSL #2]
000d38  e044              B        |L1.3524|
                  |L1.3386|
000d3a  e01d              B        |L1.3448|
                  |L1.3388|
                          DCD      Upes_eb2
                  |L1.3392|
                          DCD      ibt
                  |L1.3396|
                          DCD      t_box
                  |L1.3400|
                          DCD      t_ext_can_nd
                  |L1.3404|
                          DCD      t_ext_can
                  |L1.3408|
                          DCD      BAT_IS_ON
                  |L1.3412|
                          DCD      ||area_number.26||
                  |L1.3416|
                          DCD      load_I
                  |L1.3420|
                          DCD      Isumm
                  |L1.3424|
                          DCD      NUMINV
                  |L1.3428|
                          DCD      inv
                  |L1.3432|
                          DCD      0x4002c000
                  |L1.3436|
                          DCD      0x40034000
                  |L1.3440|
                          DCD      0xe000e100
                  |L1.3444|
                          DCD      ||.bss||+0x420
                  |L1.3448|
;;;2000   		}
;;;2001   
;;;2002   
;;;2003   	} 
;;;2004   else if(!adc_ch_net)
;;;2005   	{
;;;2006   	adc_buff[adc_ch][adc_ch_cnt]=(long)adc_result;
000d78  48f9              LDR      r0,|L1.4448|
000d7a  792c              LDRB     r4,[r5,#4]  ; adc_ch
000d7c  796a              LDRB     r2,[r5,#5]  ; adc_ch_cnt
000d7e  eb001384          ADD      r3,r0,r4,LSL #6
000d82  f9b5102a          LDRSH    r1,[r5,#0x2a]  ; adc_result
000d86  f8431022          STR      r1,[r3,r2,LSL #2]
;;;2007   	
;;;2008   	if((adc_ch_cnt&0x03)==0)
000d8a  0790              LSLS     r0,r2,#30
000d8c  d10d              BNE      |L1.3498|
;;;2009   		{
;;;2010   		long temp_L;
;;;2011   		char i;
;;;2012   		temp_L=0;
000d8e  4601              MOV      r1,r0
                  |L1.3472|
;;;2013   		for(i=0;i<16;i++)
;;;2014   			{
;;;2015   			temp_L+=adc_buff[adc_ch][i];
000d90  f853c020          LDR      r12,[r3,r0,LSL #2]
000d94  4461              ADD      r1,r1,r12
000d96  f1000001          ADD      r0,r0,#1              ;2013
000d9a  b2c0              UXTB     r0,r0                 ;2013
000d9c  2810              CMP      r0,#0x10              ;2013
000d9e  d3f7              BCC      |L1.3472|
;;;2016   			}
;;;2017   		adc_buff_[adc_ch]= (short)(temp_L>>4);
000da0  ea4f1021          ASR      r0,r1,#4
000da4  49ef              LDR      r1,|L1.4452|
000da6  f8210014          STRH     r0,[r1,r4,LSL #1]
                  |L1.3498|
;;;2018   
;;;2019   		//adc_buff_[3]=346;
;;;2020   		}
;;;2021   	if(++adc_ch>=16) 
000daa  1c64              ADDS     r4,r4,#1
000dac  b2e0              UXTB     r0,r4
000dae  7128              STRB     r0,[r5,#4]
000db0  2810              CMP      r0,#0x10
000db2  d307              BCC      |L1.3524|
;;;2022   		{
;;;2023   		adc_ch=0;
000db4  712e              STRB     r6,[r5,#4]
;;;2024   		adc_ch_cnt++;
000db6  f1020201          ADD      r2,r2,#1
000dba  b2d0              UXTB     r0,r2
000dbc  7168              STRB     r0,[r5,#5]
;;;2025   		if(adc_ch_cnt>=16)adc_ch_cnt=0;
000dbe  2810              CMP      r0,#0x10
000dc0  d300              BCC      |L1.3524|
000dc2  716e              STRB     r6,[r5,#5]
                  |L1.3524|
;;;2026   		}
;;;2027   	}
;;;2028   
;;;2029   //adc_buff[adc_ch][adc_cnt1]=(adc_self_ch_buff[2]+adc_self_ch_buff[1])/2;
;;;2030   
;;;2031   //if(adc_buff[adc_ch][adc_cnt1]<adc_buff_min[adc_ch])adc_buff_min[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;2032   //if(adc_buff[adc_ch][adc_cnt1]>adc_buff_max[adc_ch])adc_buff_max[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;2033   /*
;;;2034   	{
;;;2035   	if((adc_cnt1&0x03)==0)
;;;2036   		{
;;;2037   		temp_S=0;
;;;2038   		for(i=0;i<16;i++)
;;;2039   			{
;;;2040   			temp_S+=adc_buff[adc_ch][i];
;;;2041   			} 
;;;2042            	adc_buff_[adc_ch]=temp_S>>4;
;;;2043             }
;;;2044   	}*/
;;;2045   
;;;2046   
;;;2047   		  
;;;2048   
;;;2049   adc_self_ch_cnt=0;
000dc4  70ae              STRB     r6,[r5,#2]
;;;2050   
;;;2051   adc_ch_net++;
000dc6  f1070701          ADD      r7,r7,#1
;;;2052   adc_ch_net&=1;
000dca  f0070001          AND      r0,r7,#1
000dce  70e8              STRB     r0,[r5,#3]
;;;2053   
;;;2054   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;2055   //SET_REG(LPC_GPIO0->FIOPIN,adc_ch,5,3);
;;;2056   
;;;2057   if(adc_ch_net)
;;;2058   	{
;;;2059   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;2060   	//LPC_GPIO2->FIOPIN|=(1<<7);
;;;2061   	SET_REG(LPC_ADC->ADCR,1<<2,0,8);
000dd0  4ae5              LDR      r2,|L1.4456|
000dd2  b130              CBZ      r0,|L1.3554|
000dd4  6810              LDR      r0,[r2,#0]
000dd6  f02000ff          BIC      r0,r0,#0xff
000dda  f1000004          ADD      r0,r0,#4
000dde  6010              STR      r0,[r2,#0]
000de0  e03d              B        |L1.3678|
                  |L1.3554|
;;;2062   	}
;;;2063   else
;;;2064   	{
;;;2065   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;2066   	//LPC_GPIO2->FIOPIN&=~(1<<7);
;;;2067   	if(!(adc_ch&(1<<3)))SET_REG(LPC_ADC->ADCR,1<<0,0,8);
000de2  7929              LDRB     r1,[r5,#4]  ; adc_ch
000de4  0708              LSLS     r0,r1,#28
000de6  d406              BMI      |L1.3574|
000de8  6810              LDR      r0,[r2,#0]
000dea  f02000ff          BIC      r0,r0,#0xff
000dee  f1000001          ADD      r0,r0,#1
000df2  6010              STR      r0,[r2,#0]
000df4  e005              B        |L1.3586|
                  |L1.3574|
;;;2068   	else 			SET_REG(LPC_ADC->ADCR,1<<1,0,8);
000df6  6810              LDR      r0,[r2,#0]
000df8  f02000ff          BIC      r0,r0,#0xff
000dfc  f1000002          ADD      r0,r0,#2
000e00  6010              STR      r0,[r2,#0]
                  |L1.3586|
;;;2069   
;;;2070   
;;;2071   	SET_REG(LPC_GPIO0->FIODIR,1,28,1);
000e02  48da              LDR      r0,|L1.4460|
000e04  6803              LDR      r3,[r0,#0]
000e06  f0435380          ORR      r3,r3,#0x10000000
000e0a  6003              STR      r3,[r0,#0]
;;;2072   	SET_REG(LPC_GPIO1->FIODIR,1,30,1);
000e0c  6a03              LDR      r3,[r0,#0x20]
000e0e  f0434380          ORR      r3,r3,#0x40000000
000e12  6203              STR      r3,[r0,#0x20]
;;;2073   	SET_REG(LPC_GPIO3->FIODIR,1,26,1);
000e14  6e03              LDR      r3,[r0,#0x60]
000e16  f0436380          ORR      r3,r3,#0x4000000
000e1a  6603              STR      r3,[r0,#0x60]
;;;2074   
;;;2075   	if(!(adc_ch&(1<<0)))SET_REG(LPC_GPIO0->FIOPIN,0,28,1);
000e1c  07cb              LSLS     r3,r1,#31
000e1e  d00a              BEQ      |L1.3638|
;;;2076   	else 			SET_REG(LPC_GPIO0->FIOPIN,1,28,1);
000e20  6943              LDR      r3,[r0,#0x14]
000e22  f0435380          ORR      r3,r3,#0x10000000
000e26  6143              STR      r3,[r0,#0x14]
                  |L1.3624|
;;;2077   
;;;2078   	if(!(adc_ch&(1<<1)))SET_REG(LPC_GPIO1->FIOPIN,0,30,1);
000e28  078b              LSLS     r3,r1,#30
000e2a  d409              BMI      |L1.3648|
000e2c  6b43              LDR      r3,[r0,#0x34]
000e2e  f0234380          BIC      r3,r3,#0x40000000
000e32  6343              STR      r3,[r0,#0x34]
000e34  e008              B        |L1.3656|
                  |L1.3638|
000e36  6943              LDR      r3,[r0,#0x14]         ;2075
000e38  f0235380          BIC      r3,r3,#0x10000000     ;2075
000e3c  6143              STR      r3,[r0,#0x14]         ;2075
000e3e  e7f3              B        |L1.3624|
                  |L1.3648|
;;;2079   	else 			SET_REG(LPC_GPIO1->FIOPIN,1,30,1);
000e40  6b43              LDR      r3,[r0,#0x34]
000e42  f0434380          ORR      r3,r3,#0x40000000
000e46  6343              STR      r3,[r0,#0x34]
                  |L1.3656|
;;;2080   
;;;2081   	if(!(adc_ch&(1<<2)))SET_REG(LPC_GPIO3->FIOPIN,0,26,1);
000e48  0749              LSLS     r1,r1,#29
000e4a  d404              BMI      |L1.3670|
000e4c  6f41              LDR      r1,[r0,#0x74]
000e4e  f0216180          BIC      r1,r1,#0x4000000
000e52  6741              STR      r1,[r0,#0x74]
000e54  e003              B        |L1.3678|
                  |L1.3670|
;;;2082   	else 			SET_REG(LPC_GPIO3->FIOPIN,1,26,1);
000e56  6f41              LDR      r1,[r0,#0x74]
000e58  f0416180          ORR      r1,r1,#0x4000000
000e5c  6741              STR      r1,[r0,#0x74]
                  |L1.3678|
;;;2083   	}
;;;2084   	
;;;2085   
;;;2086   
;;;2087   
;;;2088   LPC_ADC->ADCR |=  (1<<24);
000e5e  6810              LDR      r0,[r2,#0]
000e60  f0407080          ORR      r0,r0,#0x1000000
000e64  6010              STR      r0,[r2,#0]
;;;2089   
;;;2090   }
000e66  e8bd81f0          POP      {r4-r8,pc}
;;;2091   
                          ENDP

                  avg_hndl PROC
;;;2348   //-----------------------------------------------
;;;2349   void avg_hndl(void)
000e6a  e92d47f0          PUSH     {r4-r10,lr}
;;;2350   { 
;;;2351   char i;
;;;2352   
;;;2353   if(bAVG_BLOCK)return;
000e6e  4fc0              LDR      r7,|L1.4464|
000e70  7bf8              LDRB     r0,[r7,#0xf]  ; bAVG_BLOCK
000e72  2800              CMP      r0,#0
000e74  d105              BNE      |L1.3714|
;;;2354   //#define AVGCNTMAX	5
;;;2355   if(avg_main_cnt)
000e76  f9b70022          LDRSH    r0,[r7,#0x22]  ; avg_main_cnt
000e7a  b120              CBZ      r0,|L1.3718|
;;;2356   	{
;;;2357   	avg_main_cnt--;
000e7c  f1a00001          SUB      r0,r0,#1
000e80  8478              STRH     r0,[r7,#0x22]
                  |L1.3714|
;;;2358   	return;
;;;2359   	}                 
;;;2360   
;;;2361   if(avg_cnt_<10)
;;;2362   	{
;;;2363   	avg_cnt_++;
;;;2364   	return;
;;;2365   	}   
;;;2366   avg_cnt_=0;
;;;2367   avg_num=0;
;;;2368   
;;;2369   if(bAVG_DIR)bAVG_DIR=0;
;;;2370   else bAVG_DIR=1;
;;;2371   
;;;2372   for(i=0;i<NUMIST;i++)
;;;2373   	{
;;;2374   	if((bps[i]._state==bsWRK)&&(bps[i]._cnt<20))avg_num++;
;;;2375   	}
;;;2376   
;;;2377   /*if((K[NUMI]>=1)&&(bps_state[0]==ssWRK))	avg_num++;
;;;2378   if((K[NUMI]>=2)&&(bps_state[1]==ssWRK))	avg_num++;
;;;2379   if((K[NUMI]>=3)&&(bps_state[2]==ssWRK))	avg_num++;*/
;;;2380   
;;;2381   	
;;;2382   if(avg_num<2)
;;;2383   	{
;;;2384   	return;
;;;2385   	}
;;;2386   	
;;;2387   else
;;;2388   	{
;;;2389   	i_avg_min=5000;
;;;2390   	i_avg_max=0;
;;;2391   	i_avg_summ=0;
;;;2392   	for(i=0;i<NUMIST;i++)
;;;2393   		{
;;;2394   		if(bps[i]._state==bsWRK)
;;;2395   			{
;;;2396   			if(bps[i]._Ii>i_avg_max)i_avg_max=bps[i]._Ii;
;;;2397   			if(bps[i]._Ii<i_avg_min)i_avg_min=bps[i]._Ii;
;;;2398   			
;;;2399   			i_avg_summ+=bps[i]._Ii;
;;;2400   			}
;;;2401   		}
;;;2402   	i_avg=i_avg_summ/avg_num;	
;;;2403   	
;;;2404   	if(i_avg_min==0)i_avg_min=1;
;;;2405   
;;;2406   	avg=i_avg_max;
;;;2407   	avg*=100;
;;;2408   	avg/=i_avg_min;
;;;2409   
;;;2410   	if(avg>160) bAVG=1;
;;;2411   	if(avg<120) bAVG=0;
;;;2412   
;;;2413   	if(bAVG==1)
;;;2414   		{
;;;2415   		for(i=0;i<NUMIST;i++)
;;;2416   			{
;;;2417   			if(bps[i]._state==bsWRK)
;;;2418   				{
;;;2419   				signed long tempSL;
;;;2420   				tempSL=0;
;;;2421   				tempSL=(signed long)bps[i]._Ii;
;;;2422   				tempSL*=100L;
;;;2423   				if(i_avg==0) i_avg=1;
;;;2424   				tempSL/=(signed long)i_avg;
;;;2425   				bps[i]._avg=(signed short)tempSL;
;;;2426   				if(bps[i]._Ii<500)
;;;2427   					{
;;;2428   					if((bps[i]._Ii>i_avg)&&(bps[i]._avg>120)&&(!bAVG_DIR))bps[i]._x_--;
;;;2429   					if((bps[i]._Ii<i_avg)&&(bps[i]._avg<80)&&(bAVG_DIR))bps[i]._x_++;
;;;2430   					}
;;;2431   				if(bps[i]._x_<-50)bps[i]._x_=-50;
;;;2432   				if(bps[i]._x_>50)bps[i]._x_=50;	
;;;2433   				}
;;;2434   			else bps[i]._avg=0;
;;;2435   			}		
;;;2436   		}			
;;;2437   	}   	 
;;;2438   
;;;2439   if(((signed long)(UOUT_-in_U))<20L)
;;;2440   	{
;;;2441   	for(i=0;i<NUMIST;i++) bps[i]._x_=0;
;;;2442   	}
;;;2443   
;;;2444   avg_hndl_end:
;;;2445   __nop();  
;;;2446   }
000e82  e8bd87f0          POP      {r4-r10,pc}
                  |L1.3718|
000e86  7b78              LDRB     r0,[r7,#0xd]          ;2361  ; avg_cnt_
000e88  280a              CMP      r0,#0xa               ;2361
000e8a  d203              BCS      |L1.3732|
000e8c  f1000001          ADD      r0,r0,#1              ;2363
000e90  7378              STRB     r0,[r7,#0xd]          ;2363
000e92  e7f6              B        |L1.3714|
                  |L1.3732|
000e94  f04f0500          MOV      r5,#0                 ;2366
000e98  737d              STRB     r5,[r7,#0xd]          ;2366
000e9a  73bd              STRB     r5,[r7,#0xe]          ;2367
000e9c  7c38              LDRB     r0,[r7,#0x10]         ;2369  ; bAVG_DIR
000e9e  f04f0601          MOV      r6,#1                 ;2370
000ea2  b108              CBZ      r0,|L1.3752|
000ea4  743d              STRB     r5,[r7,#0x10]         ;2369
000ea6  e000              B        |L1.3754|
                  |L1.3752|
000ea8  743e              STRB     r6,[r7,#0x10]         ;2370
                  |L1.3754|
000eaa  f04f0000          MOV      r0,#0                 ;2372
000eae  49b2              LDR      r1,|L1.4472|
000eb0  4cb0              LDR      r4,|L1.4468|
000eb2  f9b12000          LDRSH    r2,[r1,#0]            ;2372
000eb6  e012              B        |L1.3806|
                  |L1.3768|
000eb8  eb000180          ADD      r1,r0,r0,LSL #2       ;2374
000ebc  eb0101c0          ADD      r1,r1,r0,LSL #3       ;2374
000ec0  eb0401c1          ADD      r1,r4,r1,LSL #3       ;2374
000ec4  788b              LDRB     r3,[r1,#2]            ;2374
000ec6  2b02              CMP      r3,#2                 ;2374
000ec8  d106              BNE      |L1.3800|
000eca  78c9              LDRB     r1,[r1,#3]            ;2374
000ecc  2914              CMP      r1,#0x14              ;2374
000ece  d203              BCS      |L1.3800|
000ed0  7bb9              LDRB     r1,[r7,#0xe]          ;2374  ; avg_num
000ed2  f1010101          ADD      r1,r1,#1              ;2374
000ed6  73b9              STRB     r1,[r7,#0xe]          ;2374
                  |L1.3800|
000ed8  f1000001          ADD      r0,r0,#1              ;2372
000edc  b2c0              UXTB     r0,r0                 ;2372
                  |L1.3806|
000ede  4290              CMP      r0,r2                 ;2372
000ee0  dbea              BLT      |L1.3768|
000ee2  7bbb              LDRB     r3,[r7,#0xe]          ;2382  ; avg_num
000ee4  2b02              CMP      r3,#2                 ;2382
000ee6  d3cc              BCC      |L1.3714|
000ee8  f2413088          MOV      r0,#0x1388            ;2389
000eec  65b8              STR      r0,[r7,#0x58]         ;2389  ; i_avg_min
000eee  657d              STR      r5,[r7,#0x54]         ;2390  ; i_avg_max
000ef0  65fd              STR      r5,[r7,#0x5c]         ;2391  ; i_avg_summ
000ef2  f04f0100          MOV      r1,#0                 ;2392
000ef6  e01c              B        |L1.3890|
                  |L1.3832|
000ef8  eb010081          ADD      r0,r1,r1,LSL #2       ;2394
000efc  eb0000c1          ADD      r0,r0,r1,LSL #3       ;2394
000f00  eb0400c0          ADD      r0,r4,r0,LSL #3       ;2394
000f04  f890c002          LDRB     r12,[r0,#2]           ;2394
000f08  f1bc0f02          CMP      r12,#2                ;2394
000f0c  d10e              BNE      |L1.3884|
000f0e  6a40              LDR      r0,[r0,#0x24]         ;2396
000f10  f8d7c054          LDR      r12,[r7,#0x54]        ;2396  ; i_avg_max
000f14  4560              CMP      r0,r12                ;2396
000f16  dd00              BLE      |L1.3866|
000f18  6578              STR      r0,[r7,#0x54]         ;2396  ; i_avg_max
                  |L1.3866|
000f1a  f8d7c058          LDR      r12,[r7,#0x58]        ;2397  ; i_avg_min
000f1e  4560              CMP      r0,r12                ;2397
000f20  da00              BGE      |L1.3876|
000f22  65b8              STR      r0,[r7,#0x58]         ;2397  ; i_avg_min
                  |L1.3876|
000f24  f8d7c05c          LDR      r12,[r7,#0x5c]        ;2399  ; i_avg_summ
000f28  4460              ADD      r0,r0,r12             ;2399
000f2a  65f8              STR      r0,[r7,#0x5c]         ;2399  ; i_avg_summ
                  |L1.3884|
000f2c  f1010101          ADD      r1,r1,#1              ;2392
000f30  b2c9              UXTB     r1,r1                 ;2392
                  |L1.3890|
000f32  4291              CMP      r1,r2                 ;2392
000f34  dbe0              BLT      |L1.3832|
000f36  6df8              LDR      r0,[r7,#0x5c]         ;2402  ; i_avg_summ
000f38  fb90f0f3          SDIV     r0,r0,r3              ;2402
000f3c  6638              STR      r0,[r7,#0x60]         ;2402  ; i_avg
000f3e  6db8              LDR      r0,[r7,#0x58]         ;2404  ; i_avg_min
000f40  b900              CBNZ     r0,|L1.3908|
000f42  65be              STR      r6,[r7,#0x58]         ;2404  ; i_avg_min
                  |L1.3908|
000f44  6d78              LDR      r0,[r7,#0x54]         ;2406  ; i_avg_max
000f46  f04f0164          MOV      r1,#0x64              ;2407
000f4a  fb00f001          MUL      r0,r0,r1              ;2407
000f4e  6db9              LDR      r1,[r7,#0x58]         ;2408  ; i_avg_min
000f50  fb90f0f1          SDIV     r0,r0,r1              ;2408
000f54  6678              STR      r0,[r7,#0x64]         ;2408  ; avg
000f56  28a0              CMP      r0,#0xa0              ;2410
000f58  dd00              BLE      |L1.3932|
000f5a  733e              STRB     r6,[r7,#0xc]          ;2410
                  |L1.3932|
000f5c  2878              CMP      r0,#0x78              ;2411
000f5e  da00              BGE      |L1.3938|
000f60  733d              STRB     r5,[r7,#0xc]          ;2411
                  |L1.3938|
000f62  7b38              LDRB     r0,[r7,#0xc]          ;2413  ; bAVG
000f64  2801              CMP      r0,#1                 ;2413
000f66  d114              BNE      |L1.3986|
000f68  f04f0100          MOV      r1,#0                 ;2415
000f6c  f06f0931          MVN      r9,#0x31              ;2431
000f70  e00d              B        |L1.3982|
                  |L1.3954|
000f72  eb010081          ADD      r0,r1,r1,LSL #2       ;2417
000f76  eb0000c1          ADD      r0,r0,r1,LSL #3       ;2417
000f7a  eb0400c0          ADD      r0,r4,r0,LSL #3       ;2417
000f7e  7883              LDRB     r3,[r0,#2]            ;2417
000f80  2b02              CMP      r3,#2                 ;2417
000f82  d012              BEQ      |L1.4010|
000f84  f8a05062          STRH     r5,[r0,#0x62]         ;2434
                  |L1.3976|
000f88  f1010101          ADD      r1,r1,#1              ;2415
000f8c  b2c9              UXTB     r1,r1                 ;2415
                  |L1.3982|
000f8e  4291              CMP      r1,r2                 ;2415
000f90  dbef              BLT      |L1.3954|
                  |L1.3986|
000f92  487a              LDR      r0,|L1.4476|
000f94  497a              LDR      r1,|L1.4480|
000f96  f9b00000          LDRSH    r0,[r0,#0]            ;2439  ; UOUT_
000f9a  f9b11000          LDRSH    r1,[r1,#0]            ;2439  ; in_U
000f9e  1a40              SUBS     r0,r0,r1              ;2439
000fa0  2814              CMP      r0,#0x14              ;2439
000fa2  da51              BGE      |L1.4168|
000fa4  f04f0000          MOV      r0,#0                 ;2441
000fa8  e04c              B        |L1.4164|
                  |L1.4010|
000faa  6a43              LDR      r3,[r0,#0x24]         ;2421
000fac  f04f0c64          MOV      r12,#0x64             ;2422
000fb0  fb03f80c          MUL      r8,r3,r12             ;2422
000fb4  f8d7c060          LDR      r12,[r7,#0x60]        ;2423  ; i_avg
000fb8  f1bc0f00          CMP      r12,#0                ;2423
000fbc  d100              BNE      |L1.4032|
000fbe  663e              STR      r6,[r7,#0x60]         ;2423  ; i_avg
                  |L1.4032|
000fc0  f8d7c060          LDR      r12,[r7,#0x60]        ;2424  ; i_avg
000fc4  fb98f8fc          SDIV     r8,r8,r12             ;2424
000fc8  fa0ff888          SXTH     r8,r8                 ;2425
000fcc  f8a08062          STRH     r8,[r0,#0x62]         ;2425
000fd0  f5b37ffa          CMP      r3,#0x1f4             ;2426
000fd4  da1c              BGE      |L1.4112|
000fd6  4563              CMP      r3,r12                ;2428
000fd8  dd0d              BLE      |L1.4086|
000fda  f1b80f78          CMP      r8,#0x78              ;2428
000fde  dd0a              BLE      |L1.4086|
000fe0  f897a010          LDRB     r10,[r7,#0x10]        ;2428  ; bAVG_DIR
000fe4  f1ba0f00          CMP      r10,#0                ;2428
000fe8  d105              BNE      |L1.4086|
000fea  f8b0a054          LDRH     r10,[r0,#0x54]        ;2428
000fee  f1aa0a01          SUB      r10,r10,#1            ;2428
000ff2  f8a0a054          STRH     r10,[r0,#0x54]        ;2428
                  |L1.4086|
000ff6  4563              CMP      r3,r12                ;2429
000ff8  da0a              BGE      |L1.4112|
000ffa  f1b80f50          CMP      r8,#0x50              ;2429
000ffe  da07              BGE      |L1.4112|
001000  7c3b              LDRB     r3,[r7,#0x10]         ;2429  ; bAVG_DIR
001002  b12b              CBZ      r3,|L1.4112|
001004  f8b03054          LDRH     r3,[r0,#0x54]         ;2429
001008  f1030301          ADD      r3,r3,#1              ;2429
00100c  f8a03054          STRH     r3,[r0,#0x54]         ;2429
                  |L1.4112|
001010  f9b03054          LDRSH    r3,[r0,#0x54]         ;2431
001014  454b              CMP      r3,r9                 ;2431
001016  da01              BGE      |L1.4124|
001018  f8a09054          STRH     r9,[r0,#0x54]         ;2431
                  |L1.4124|
00101c  f9b03054          LDRSH    r3,[r0,#0x54]         ;2432
001020  2b32              CMP      r3,#0x32              ;2432
001022  ddb1              BLE      |L1.3976|
001024  f04f0332          MOV      r3,#0x32              ;2432
001028  f8a03054          STRH     r3,[r0,#0x54]         ;2432
00102c  e7ac              B        |L1.3976|
                  |L1.4142|
00102e  eb000180          ADD      r1,r0,r0,LSL #2       ;2441
001032  eb0101c0          ADD      r1,r1,r0,LSL #3       ;2441
001036  eb0401c1          ADD      r1,r4,r1,LSL #3       ;2441
00103a  f8a15054          STRH     r5,[r1,#0x54]         ;2441
00103e  f1000001          ADD      r0,r0,#1              ;2441
001042  b2c0              UXTB     r0,r0                 ;2441
                  |L1.4164|
001044  4290              CMP      r0,r2                 ;2441
001046  dbf2              BLT      |L1.4142|
                  |L1.4168|
001048  bf00              NOP                            ;2445
00104a  e71a              B        |L1.3714|
;;;2447   
                          ENDP

                  u_out_reg_hndl PROC
;;;2448   //-----------------------------------------------
;;;2449   void u_out_reg_hndl(void)
00104c  b510              PUSH     {r4,lr}
;;;2450   { 
;;;2451   char i;
;;;2452   
;;;2453   if(u_out_reg_main_cnt)
00104e  4948              LDR      r1,|L1.4464|
001050  f9b10024          LDRSH    r0,[r1,#0x24]  ; u_out_reg_main_cnt
001054  b118              CBZ      r0,|L1.4190|
;;;2454   	{
;;;2455   	u_out_reg_main_cnt--;
001056  f1a00001          SUB      r0,r0,#1
00105a  8488              STRH     r0,[r1,#0x24]
;;;2456   	return;
;;;2457   	}                 
;;;2458   u_out_reg_main_cnt=5;
;;;2459   
;;;2460   if(out_U<(UOUT-5))
;;;2461   	{
;;;2462   	//if(UOUT_<UOUT)UOUT_=UOUT;
;;;2463   	UOUT_++;
;;;2464   	if(UOUT_>(UOUT+50))UOUT_=UOUT+50;
;;;2465   	}
;;;2466   else if(out_U>(UOUT+5))
;;;2467   	{
;;;2468   	//if(UOUT_>UOUT)UOUT_=UOUT;
;;;2469   	UOUT_--;
;;;2470   	if(UOUT_<(UOUT-50))UOUT_=UOUT-50;
;;;2471   	}
;;;2472   UOUT_=UOUT;
;;;2473   }
00105c  bd10              POP      {r4,pc}
                  |L1.4190|
00105e  f04f0005          MOV      r0,#5                 ;2458
001062  8488              STRH     r0,[r1,#0x24]         ;2458
001064  4847              LDR      r0,|L1.4484|
001066  4b45              LDR      r3,|L1.4476|
001068  f9b02000          LDRSH    r2,[r0,#0]            ;2460  ; out_U
00106c  4846              LDR      r0,|L1.4488|
00106e  f9b31000          LDRSH    r1,[r3,#0]            ;2463
001072  f9b00000          LDRSH    r0,[r0,#0]            ;2460  ; UOUT
001076  f1a00405          SUB      r4,r0,#5              ;2460
00107a  42a2              CMP      r2,r4                 ;2460
00107c  da09              BGE      |L1.4242|
00107e  f1010101          ADD      r1,r1,#1              ;2463
001082  b20a              SXTH     r2,r1                 ;2463
001084  801a              STRH     r2,[r3,#0]            ;2463
001086  f1000132          ADD      r1,r0,#0x32           ;2464
00108a  428a              CMP      r2,r1                 ;2464
00108c  dd0d              BLE      |L1.4266|
00108e  8019              STRH     r1,[r3,#0]            ;2464
001090  e00b              B        |L1.4266|
                  |L1.4242|
001092  1d44              ADDS     r4,r0,#5              ;2466
001094  42a2              CMP      r2,r4                 ;2466
001096  dd08              BLE      |L1.4266|
001098  f1a10101          SUB      r1,r1,#1              ;2469
00109c  b20a              SXTH     r2,r1                 ;2469
00109e  801a              STRH     r2,[r3,#0]            ;2469
0010a0  f1a00132          SUB      r1,r0,#0x32           ;2470
0010a4  428a              CMP      r2,r1                 ;2470
0010a6  da00              BGE      |L1.4266|
0010a8  8019              STRH     r1,[r3,#0]            ;2470
                  |L1.4266|
0010aa  8018              STRH     r0,[r3,#0]            ;2472
0010ac  bd10              POP      {r4,pc}
;;;2474   
                          ENDP

                  rele_av_hndl PROC
;;;2487   //-----------------------------------------------
;;;2488   void rele_av_hndl(void)
0010ae  b570              PUSH     {r4-r6,lr}
;;;2489   {
;;;2490   char i,i1,i2;
;;;2491   
;;;2492   i1=0;
0010b0  f04f0300          MOV      r3,#0
;;;2493   i2=0;
0010b4  461a              MOV      r2,r3
;;;2494   
;;;2495   for(i=0;i<NUMIST;i++)
0010b6  4610              MOV      r0,r2
0010b8  492f              LDR      r1,|L1.4472|
;;;2496   	{
;;;2497   	if(bps[i]._av&0x07)i1=1;
0010ba  4c2e              LDR      r4,|L1.4468|
0010bc  f9b15000          LDRSH    r5,[r1,#0]            ;2495
0010c0  e011              B        |L1.4326|
                  |L1.4290|
0010c2  eb000180          ADD      r1,r0,r0,LSL #2
0010c6  eb0101c0          ADD      r1,r1,r0,LSL #3
0010ca  eb0401c1          ADD      r1,r4,r1,LSL #3
0010ce  7849              LDRB     r1,[r1,#1]
0010d0  074e              LSLS     r6,r1,#29
0010d2  d001              BEQ      |L1.4312|
0010d4  f04f0301          MOV      r3,#1
                  |L1.4312|
;;;2498   	if(bps[i]._av&0x08)i2=1;
0010d8  0709              LSLS     r1,r1,#28
0010da  d501              BPL      |L1.4320|
0010dc  f04f0201          MOV      r2,#1
                  |L1.4320|
0010e0  f1000001          ADD      r0,r0,#1              ;2495
0010e4  b2c0              UXTB     r0,r0                 ;2495
                  |L1.4326|
0010e6  42a8              CMP      r0,r5                 ;2495
0010e8  dbeb              BLT      |L1.4290|
;;;2499   	}
;;;2500   
;;;2501   if(i1)					avar_vd_stat|=(1<<0);
0010ea  4928              LDR      r1,|L1.4492|
0010ec  f9b10000          LDRSH    r0,[r1,#0]
0010f0  b11b              CBZ      r3,|L1.4346|
0010f2  f0400001          ORR      r0,r0,#1
0010f6  8008              STRH     r0,[r1,#0]
0010f8  e002              B        |L1.4352|
                  |L1.4346|
;;;2502   else 					avar_vd_stat&=~(1<<0);
0010fa  f0200001          BIC      r0,r0,#1
0010fe  8008              STRH     r0,[r1,#0]
                  |L1.4352|
;;;2503   if(overloadAvar==0) 	avar_vd_stat&=~(1<<1);
001100  4823              LDR      r0,|L1.4496|
001102  7800              LDRB     r0,[r0,#0]  ; overloadAvar
001104  b110              CBZ      r0,|L1.4364|
;;;2504   else if(overloadAvar==1)avar_vd_stat|=(1<<1);
001106  2801              CMP      r0,#1
001108  d005              BEQ      |L1.4374|
00110a  e008              B        |L1.4382|
                  |L1.4364|
00110c  8808              LDRH     r0,[r1,#0]            ;2503  ; avar_vd_stat
00110e  f0200002          BIC      r0,r0,#2              ;2503
001112  8008              STRH     r0,[r1,#0]            ;2503
001114  e003              B        |L1.4382|
                  |L1.4374|
001116  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
001118  f0400002          ORR      r0,r0,#2
00111c  8008              STRH     r0,[r1,#0]
                  |L1.4382|
;;;2505   
;;;2506   if(sysTAvar==0) 		avar_vd_stat&=~(1<<2);
00111e  481d              LDR      r0,|L1.4500|
001120  7800              LDRB     r0,[r0,#0]  ; sysTAvar
001122  b110              CBZ      r0,|L1.4394|
;;;2507   else if(sysTAvar==1)	avar_vd_stat|=(1<<2);
001124  2801              CMP      r0,#1
001126  d005              BEQ      |L1.4404|
001128  e008              B        |L1.4412|
                  |L1.4394|
00112a  8808              LDRH     r0,[r1,#0]            ;2506  ; avar_vd_stat
00112c  f0200004          BIC      r0,r0,#4              ;2506
001130  8008              STRH     r0,[r1,#0]            ;2506
001132  e003              B        |L1.4412|
                  |L1.4404|
001134  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
001136  f0400004          ORR      r0,r0,#4
00113a  8008              STRH     r0,[r1,#0]
                  |L1.4412|
;;;2508   
;;;2509   if(uOutAvar==0) 		avar_vd_stat&=~((1<<3)|(1<<4));
00113c  4816              LDR      r0,|L1.4504|
00113e  7800              LDRB     r0,[r0,#0]  ; uOutAvar
001140  b120              CBZ      r0,|L1.4428|
;;;2510   else if(uOutAvar==1)	avar_vd_stat|=(1<<4);
001142  2801              CMP      r0,#1
001144  d007              BEQ      |L1.4438|
;;;2511   else if(uOutAvar==2)	avar_vd_stat|=(1<<3);
001146  2802              CMP      r0,#2
001148  d028              BEQ      |L1.4508|
00114a  e02b              B        |L1.4516|
                  |L1.4428|
00114c  8808              LDRH     r0,[r1,#0]            ;2509  ; avar_vd_stat
00114e  f0200018          BIC      r0,r0,#0x18           ;2509
001152  8008              STRH     r0,[r1,#0]            ;2509
001154  e026              B        |L1.4516|
                  |L1.4438|
001156  8808              LDRH     r0,[r1,#0]            ;2510  ; avar_vd_stat
001158  f0400010          ORR      r0,r0,#0x10           ;2510
00115c  8008              STRH     r0,[r1,#0]            ;2510
00115e  e021              B        |L1.4516|
                  |L1.4448|
                          DCD      ||.bss||
                  |L1.4452|
                          DCD      ||.bss||+0x400
                  |L1.4456|
                          DCD      0x40034000
                  |L1.4460|
                          DCD      0x2009c000
                  |L1.4464|
                          DCD      ||area_number.26||
                  |L1.4468|
                          DCD      bps
                  |L1.4472|
                          DCD      NUMIST
                  |L1.4476|
                          DCD      UOUT_
                  |L1.4480|
                          DCD      in_U
                  |L1.4484|
                          DCD      out_U
                  |L1.4488|
                          DCD      UOUT
                  |L1.4492|
                          DCD      avar_vd_stat
                  |L1.4496|
                          DCD      overloadAvar
                  |L1.4500|
                          DCD      sysTAvar
                  |L1.4504|
                          DCD      uOutAvar
                  |L1.4508|
00119c  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
00119e  f0400008          ORR      r0,r0,#8
0011a2  8008              STRH     r0,[r1,#0]
                  |L1.4516|
;;;2512   if(uInAvar==0) 			avar_vd_stat&=~((1<<5)|(1<<6));
0011a4  48ff              LDR      r0,|L1.5540|
0011a6  7800              LDRB     r0,[r0,#0]  ; uInAvar
0011a8  b120              CBZ      r0,|L1.4532|
;;;2513   else if(uInAvar==1)		avar_vd_stat|=(1<<6);
0011aa  2801              CMP      r0,#1
0011ac  d007              BEQ      |L1.4542|
;;;2514   else if(uInAvar==2)		avar_vd_stat|=(1<<5);
0011ae  2802              CMP      r0,#2
0011b0  d00a              BEQ      |L1.4552|
0011b2  e00d              B        |L1.4560|
                  |L1.4532|
0011b4  8808              LDRH     r0,[r1,#0]            ;2512  ; avar_vd_stat
0011b6  f0200060          BIC      r0,r0,#0x60           ;2512
0011ba  8008              STRH     r0,[r1,#0]            ;2512
0011bc  e008              B        |L1.4560|
                  |L1.4542|
0011be  8808              LDRH     r0,[r1,#0]            ;2513  ; avar_vd_stat
0011c0  f0400040          ORR      r0,r0,#0x40           ;2513
0011c4  8008              STRH     r0,[r1,#0]            ;2513
0011c6  e003              B        |L1.4560|
                  |L1.4552|
0011c8  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
0011ca  f0400020          ORR      r0,r0,#0x20
0011ce  8008              STRH     r0,[r1,#0]
                  |L1.4560|
;;;2515   
;;;2516   if(i2)					avar_vd_stat|=(1<<7);
0011d0  b122              CBZ      r2,|L1.4572|
0011d2  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
0011d4  f0400080          ORR      r0,r0,#0x80
0011d8  8008              STRH     r0,[r1,#0]
0011da  e003              B        |L1.4580|
                  |L1.4572|
;;;2517   else 					avar_vd_stat&=~(1<<7);
0011dc  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
0011de  f0200080          BIC      r0,r0,#0x80
0011e2  8008              STRH     r0,[r1,#0]
                  |L1.4580|
;;;2518   
;;;2519   if(bVDISWORK)			avar_vd_stat|=(1<<8);
0011e4  48f0              LDR      r0,|L1.5544|
0011e6  7800              LDRB     r0,[r0,#0]  ; bVDISWORK
0011e8  b120              CBZ      r0,|L1.4596|
0011ea  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
0011ec  f4407080          ORR      r0,r0,#0x100
0011f0  8008              STRH     r0,[r1,#0]
0011f2  e003              B        |L1.4604|
                  |L1.4596|
;;;2520   else 					avar_vd_stat&=~(1<<8);
0011f4  8808              LDRH     r0,[r1,#0]  ; avar_vd_stat
0011f6  f4207080          BIC      r0,r0,#0x100
0011fa  8008              STRH     r0,[r1,#0]
                  |L1.4604|
;;;2521   
;;;2522   for (i=0;i<4;i++)
0011fc  f04f0000          MOV      r0,#0
001200  f9b15000          LDRSH    r5,[r1,#0]            ;2501
;;;2523   	{
;;;2524   	if(avar_vd_stat&RELE_SET_MASK[i])rele_av_flags|=(1<<i);
001204  4ce9              LDR      r4,|L1.5548|
001206  49ea              LDR      r1,|L1.5552|
001208  f04f0601          MOV      r6,#1                 ;2497
                  |L1.4620|
00120c  f9342010          LDRSH    r2,[r4,r0,LSL #1]
001210  422a              TST      r2,r5
001212  d006              BEQ      |L1.4642|
001214  880b              LDRH     r3,[r1,#0]  ; rele_av_flags
001216  fa06f200          LSL      r2,r6,r0
00121a  ea420203          ORR      r2,r2,r3
00121e  800a              STRH     r2,[r1,#0]
001220  e005              B        |L1.4654|
                  |L1.4642|
;;;2525   	else rele_av_flags&=~(1<<i);
001222  880b              LDRH     r3,[r1,#0]  ; rele_av_flags
001224  fa06f200          LSL      r2,r6,r0
001228  ea230302          BIC      r3,r3,r2
00122c  800b              STRH     r3,[r1,#0]
                  |L1.4654|
00122e  f1000001          ADD      r0,r0,#1              ;2522
001232  b2c0              UXTB     r0,r0                 ;2522
001234  2804              CMP      r0,#4                 ;2522
001236  d3e9              BCC      |L1.4620|
;;;2526   	} 
;;;2527   }
001238  bd70              POP      {r4-r6,pc}
;;;2528   
                          ENDP

                  rele_hndl PROC
;;;2529   //*************-----------------------------------------------
;;;2530   void rele_hndl(void)
00123a  b570              PUSH     {r4-r6,lr}
;;;2531   {
;;;2532   //static char cnt_rel_sam;
;;;2533   //char temp;
;;;2534   
;;;2535   //temp=0;
;;;2536   
;;;2537   
;;;2538   SET_REG(LPC_PINCON->PINSEL0,0,4*2,6*2);
00123c  48dd              LDR      r0,|L1.5556|
00123e  6801              LDR      r1,[r0,#0]
001240  4add              LDR      r2,|L1.5560|
001242  ea010102          AND      r1,r1,r2
001246  6001              STR      r1,[r0,#0]
;;;2539   SET_REG(LPC_GPIO0->FIODIR,63,4,6);
001248  4cdc              LDR      r4,|L1.5564|
00124a  6821              LDR      r1,[r4,#0]
00124c  f441717c          ORR      r1,r1,#0x3f0
001250  6021              STR      r1,[r4,#0]
;;;2540   SET_REG(LPC_PINCON->PINSEL7,0,(25-16)*2,2);
001252  69c1              LDR      r1,[r0,#0x1c]
001254  f4212140          BIC      r1,r1,#0xc0000
001258  61c1              STR      r1,[r0,#0x1c]
;;;2541   SET_REG(LPC_GPIO3->FIODIR,1,25,1);
00125a  6e21              LDR      r1,[r4,#0x60]
00125c  f0417100          ORR      r1,r1,#0x2000000
001260  6621              STR      r1,[r4,#0x60]
;;;2542   SET_REG(LPC_PINCON->PINSEL1,0,(29-16)*2,2);
001262  6841              LDR      r1,[r0,#4]
001264  f0216140          BIC      r1,r1,#0xc000000
001268  6041              STR      r1,[r0,#4]
;;;2543   SET_REG(LPC_GPIO0->FIODIR,1,29,1);
00126a  6820              LDR      r0,[r4,#0]
00126c  f0405000          ORR      r0,r0,#0x20000000
001270  6020              STR      r0,[r4,#0]
;;;2544   
;;;2545   
;;;2546   
;;;2547   
;;;2548   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_1))
001272  f04f00d2          MOV      r0,#0xd2
001276  f7fffffe          BL       mess_find_unvol
;;;2549   	{
;;;2550   	if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;2551   	else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;2552   	}
;;;2553   else if(!(rele_av_flags&(1<<0))) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
00127a  4ecd              LDR      r6,|L1.5552|
00127c  4dd0              LDR      r5,|L1.5568|
00127e  b110              CBZ      r0,|L1.4742|
001280  6828              LDR      r0,[r5,#0]            ;2548  ; mess_data
001282  2865              CMP      r0,#0x65              ;2548
001284  d015              BEQ      |L1.4786|
                  |L1.4742|
001286  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
001288  07c0              LSLS     r0,r0,#31
00128a  d01e              BEQ      |L1.4810|
;;;2554   else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
00128c  6fa0              LDR      r0,[r4,#0x78]
00128e  f0407000          ORR      r0,r0,#0x2000000
001292  67a0              STR      r0,[r4,#0x78]
                  |L1.4756|
;;;2555   
;;;2556   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_2))
001294  20d2              MOVS     r0,#0xd2
001296  f7fffffe          BL       mess_find_unvol
00129a  b110              CBZ      r0,|L1.4770|
00129c  6828              LDR      r0,[r5,#0]  ; mess_data
00129e  2866              CMP      r0,#0x66
0012a0  d018              BEQ      |L1.4820|
                  |L1.4770|
;;;2557   	{
;;;2558   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;2559   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;2560   	}
;;;2561   else if(!(rele_av_flags&(1<<1))) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
0012a2  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
0012a4  0780              LSLS     r0,r0,#30
0012a6  d424              BMI      |L1.4850|
0012a8  69e0              LDR      r0,[r4,#0x1c]
0012aa  f0400080          ORR      r0,r0,#0x80
0012ae  61e0              STR      r0,[r4,#0x1c]
0012b0  e023              B        |L1.4858|
                  |L1.4786|
0012b2  6868              LDR      r0,[r5,#4]            ;2550  ; mess_data
0012b4  b120              CBZ      r0,|L1.4800|
0012b6  6fa0              LDR      r0,[r4,#0x78]         ;2551
0012b8  f0407000          ORR      r0,r0,#0x2000000      ;2551
0012bc  67a0              STR      r0,[r4,#0x78]         ;2551
0012be  e7e9              B        |L1.4756|
                  |L1.4800|
0012c0  6fe0              LDR      r0,[r4,#0x7c]         ;2550
0012c2  f0407000          ORR      r0,r0,#0x2000000      ;2550
0012c6  67e0              STR      r0,[r4,#0x7c]         ;2550
0012c8  e7e4              B        |L1.4756|
                  |L1.4810|
0012ca  6fe0              LDR      r0,[r4,#0x7c]         ;2553
0012cc  f0407000          ORR      r0,r0,#0x2000000      ;2553
0012d0  67e0              STR      r0,[r4,#0x7c]         ;2553
0012d2  e7df              B        |L1.4756|
                  |L1.4820|
0012d4  6868              LDR      r0,[r5,#4]            ;2558  ; mess_data
0012d6  b110              CBZ      r0,|L1.4830|
0012d8  2801              CMP      r0,#1                 ;2559
0012da  d005              BEQ      |L1.4840|
0012dc  e00d              B        |L1.4858|
                  |L1.4830|
0012de  69e0              LDR      r0,[r4,#0x1c]         ;2558
0012e0  f0400080          ORR      r0,r0,#0x80           ;2558
0012e4  61e0              STR      r0,[r4,#0x1c]         ;2558
0012e6  e008              B        |L1.4858|
                  |L1.4840|
0012e8  69a0              LDR      r0,[r4,#0x18]         ;2559
0012ea  f0400080          ORR      r0,r0,#0x80           ;2559
0012ee  61a0              STR      r0,[r4,#0x18]         ;2559
0012f0  e003              B        |L1.4858|
                  |L1.4850|
;;;2562   else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
0012f2  69a0              LDR      r0,[r4,#0x18]
0012f4  f0400080          ORR      r0,r0,#0x80
0012f8  61a0              STR      r0,[r4,#0x18]
                  |L1.4858|
;;;2563   
;;;2564   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_3))
0012fa  20d2              MOVS     r0,#0xd2
0012fc  f7fffffe          BL       mess_find_unvol
001300  b110              CBZ      r0,|L1.4872|
001302  6828              LDR      r0,[r5,#0]  ; mess_data
001304  2867              CMP      r0,#0x67
001306  d007              BEQ      |L1.4888|
                  |L1.4872|
;;;2565   	{
;;;2566   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;2567   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;2568       }
;;;2569   else if(!(rele_av_flags&(1<<2))) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
001308  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
00130a  0740              LSLS     r0,r0,#29
00130c  d413              BMI      |L1.4918|
00130e  69e0              LDR      r0,[r4,#0x1c]
001310  f0400010          ORR      r0,r0,#0x10
001314  61e0              STR      r0,[r4,#0x1c]
001316  e012              B        |L1.4926|
                  |L1.4888|
001318  6868              LDR      r0,[r5,#4]            ;2566  ; mess_data
00131a  b110              CBZ      r0,|L1.4898|
00131c  2801              CMP      r0,#1                 ;2567
00131e  d005              BEQ      |L1.4908|
001320  e00d              B        |L1.4926|
                  |L1.4898|
001322  69e0              LDR      r0,[r4,#0x1c]         ;2566
001324  f0400010          ORR      r0,r0,#0x10           ;2566
001328  61e0              STR      r0,[r4,#0x1c]         ;2566
00132a  e008              B        |L1.4926|
                  |L1.4908|
00132c  69a0              LDR      r0,[r4,#0x18]         ;2567
00132e  f0400010          ORR      r0,r0,#0x10           ;2567
001332  61a0              STR      r0,[r4,#0x18]         ;2567
001334  e003              B        |L1.4926|
                  |L1.4918|
;;;2570   else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
001336  69a0              LDR      r0,[r4,#0x18]
001338  f0400010          ORR      r0,r0,#0x10
00133c  61a0              STR      r0,[r4,#0x18]
                  |L1.4926|
;;;2571   
;;;2572   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_4))	 
00133e  20d2              MOVS     r0,#0xd2
001340  f7fffffe          BL       mess_find_unvol
001344  b110              CBZ      r0,|L1.4940|
001346  6828              LDR      r0,[r5,#0]  ; mess_data
001348  2868              CMP      r0,#0x68
00134a  d007              BEQ      |L1.4956|
                  |L1.4940|
;;;2573   	{
;;;2574   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
;;;2575   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,9,1);
;;;2576   	}
;;;2577   else if(!(rele_av_flags&(1<<3))) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
00134c  8830              LDRH     r0,[r6,#0]  ; rele_av_flags
00134e  0700              LSLS     r0,r0,#28
001350  d412              BMI      |L1.4984|
001352  69e0              LDR      r0,[r4,#0x1c]
001354  f4407000          ORR      r0,r0,#0x200
001358  61e0              STR      r0,[r4,#0x1c]
                  |L1.4954|
;;;2578   else SET_REG(LPC_GPIO0->FIOSET,1,9,1);
;;;2579   
;;;2580   }
00135a  bd70              POP      {r4-r6,pc}
                  |L1.4956|
00135c  6868              LDR      r0,[r5,#4]            ;2574  ; mess_data
00135e  b130              CBZ      r0,|L1.4974|
001360  2801              CMP      r0,#1                 ;2575
001362  d1fa              BNE      |L1.4954|
001364  69a0              LDR      r0,[r4,#0x18]         ;2575
001366  f4407000          ORR      r0,r0,#0x200          ;2575
00136a  61a0              STR      r0,[r4,#0x18]         ;2575
00136c  bd70              POP      {r4-r6,pc}
                  |L1.4974|
00136e  69e0              LDR      r0,[r4,#0x1c]         ;2574
001370  f4407000          ORR      r0,r0,#0x200          ;2574
001374  61e0              STR      r0,[r4,#0x1c]         ;2574
001376  bd70              POP      {r4-r6,pc}
                  |L1.4984|
001378  69a0              LDR      r0,[r4,#0x18]         ;2578
00137a  f4407000          ORR      r0,r0,#0x200          ;2578
00137e  61a0              STR      r0,[r4,#0x18]         ;2578
001380  bd70              POP      {r4-r6,pc}
;;;2581   
                          ENDP

                  bps_hndl PROC
;;;2582   //-----------------------------------------------
;;;2583   void bps_hndl(void)
001382  e92d5ff0          PUSH     {r4-r12,lr}
;;;2584   {
;;;2585   char ptr__,i;
;;;2586   unsigned short tempUS;
;;;2587   
;;;2588   if(sh_cnt0<10)
001386  4e8f              LDR      r6,|L1.5572|
;;;2589   	{
;;;2590   	sh_cnt0++;
;;;2591   	if(sh_cnt0>=10)
;;;2592   		{
;;;2593   		sh_cnt0=0;
001388  2700              MOVS     r7,#0
;;;2594   		b1Hz_sh=1;
00138a  f04f0a01          MOV      r10,#1
00138e  7d30              LDRB     r0,[r6,#0x14]         ;2588  ; sh_cnt0
001390  280a              CMP      r0,#0xa               ;2588
001392  d208              BCS      |L1.5030|
001394  f1000001          ADD      r0,r0,#1              ;2590
001398  b2c0              UXTB     r0,r0                 ;2590
00139a  7530              STRB     r0,[r6,#0x14]         ;2590
00139c  280a              CMP      r0,#0xa               ;2591
00139e  d302              BCC      |L1.5030|
0013a0  7537              STRB     r7,[r6,#0x14]         ;2593
0013a2  f886a015          STRB     r10,[r6,#0x15]
                  |L1.5030|
;;;2595   		}
;;;2596   	}
;;;2597   
;;;2598   /*if(sh_cnt1<5)
;;;2599   	{
;;;2600   	sh_cnt1++;
;;;2601   	if(sh_cnt1==5)
;;;2602   		{
;;;2603   		sh_cnt1=0;
;;;2604   		b2Hz_sh=1;
;;;2605   		}
;;;2606   	} */
;;;2607   
;;;2608   
;;;2609   /*
;;;2610   if(mess_find(MESS_SRC_ON_OFF))
;;;2611   	{
;;;2612   	if(mess_data[0]==_MESS_SRC_MASK_BLOK_2SEC)
;;;2613   		{
;;;2614   		char i;
;;;2615   		for(i=0;i<NUMIST;i++)
;;;2616   			{
;;;2617   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=20;
;;;2618   			}
;;;2619   		
;;;2620   		}
;;;2621   	else if(mess_data[0]==_MESS_SRC_MASK_UNBLOK)
;;;2622   		{
;;;2623   		char i;
;;;2624   		for(i=0;i<NUMIST;i++)
;;;2625   			{
;;;2626   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=0;
;;;2627   			}
;;;2628   		
;;;2629   		}
;;;2630   	}
;;;2631   	
;;;2632   else if(mess_find(_MESS_SRC_MASK_ON))
;;;2633   	{				
;;;2634   	if(mess_data[0]==_MESS_SRC_MASK_ON)
;;;2635   		{
;;;2636   		char i;
;;;2637   		for(i=0;i<NUMIST;i++)
;;;2638   			{
;;;2639   			if(mess_data[1]&(1<<i))
;;;2640   				{
;;;2641   				src[i]._ist_blok_cnt=0;
;;;2642   				src[i]._flags_tu=2;
;;;2643   				}
;;;2644   			}
;;;2645   		
;;;2646   		}				
;;;2647   	}*/
;;;2648   
;;;2649   
;;;2650   
;;;2651   /*else*/ 
;;;2652   bps_on_mask=0;
0013a6  f8a67044          STRH     r7,[r6,#0x44]
;;;2653   bps_off_mask=0;
0013aa  f8a67046          STRH     r7,[r6,#0x46]
;;;2654   
;;;2655   if(mess_find_unvol(MESS2BPS_HNDL))
0013ae  20cd              MOVS     r0,#0xcd
0013b0  f7fffffe          BL       mess_find_unvol
;;;2656   	{
;;;2657   	if(mess_data[0]==PARAM_BPS_ALL_OFF_AFTER_2SEC)
;;;2658   		{
;;;2659   		bps_off_mask=0xffff;
;;;2660   		}
;;;2661   
;;;2662   	if(mess_data[0]==PARAM_BPS_MASK_OFF_AFTER_2SEC)
;;;2663   		{
;;;2664   		bps_off_mask=mess_data[1];
;;;2665   		}
;;;2666   
;;;2667   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;2668   		{
;;;2669   		bps_on_mask=mess_data[1];
;;;2670   		}
;;;2671   
;;;2672   	if(mess_data[0]==PARAM_BPS_ALL_ON)
;;;2673   		{
;;;2674   		bps_on_mask=0xffff;
;;;2675   		}
;;;2676   
;;;2677   	if(mess_data[0]==PARAM_BPS_MASK_ON_OFF_AFTER_2SEC)
;;;2678   		{
;;;2679   		bps_on_mask=mess_data[1];
;;;2680   		bps_off_mask=~(mess_data[1]);
;;;2681   		}
;;;2682   
;;;2683   
;;;2684   	for(i=0;i<=NUMIST;i++)
;;;2685   		{
;;;2686   		if(bps_off_mask&(1<<i)) bps[i]._blok_cnt++;
0013b4  f8df8210          LDR      r8,|L1.5576|
0013b8  f8dfb210          LDR      r11,|L1.5580|
0013bc  b3a0              CBZ      r0,|L1.5160|
0013be  4a80              LDR      r2,|L1.5568|
0013c0  f64f73ff          MOV      r3,#0xffff            ;2659
0013c4  6810              LDR      r0,[r2,#0]            ;2657  ; mess_data
0013c6  28ce              CMP      r0,#0xce              ;2657
0013c8  d101              BNE      |L1.5070|
0013ca  f8a63046          STRH     r3,[r6,#0x46]         ;2659
                  |L1.5070|
0013ce  28cf              CMP      r0,#0xcf              ;2662
0013d0  d102              BNE      |L1.5080|
0013d2  6851              LDR      r1,[r2,#4]            ;2664  ; mess_data
0013d4  f8a61046          STRH     r1,[r6,#0x46]         ;2664
                  |L1.5080|
0013d8  28d1              CMP      r0,#0xd1              ;2667
0013da  d102              BNE      |L1.5090|
0013dc  6851              LDR      r1,[r2,#4]            ;2669  ; mess_data
0013de  f8a61044          STRH     r1,[r6,#0x44]         ;2669
                  |L1.5090|
0013e2  28d2              CMP      r0,#0xd2              ;2672
0013e4  d101              BNE      |L1.5098|
0013e6  f8a63044          STRH     r3,[r6,#0x44]         ;2674
                  |L1.5098|
0013ea  28d0              CMP      r0,#0xd0              ;2677
0013ec  d106              BNE      |L1.5116|
0013ee  6850              LDR      r0,[r2,#4]            ;2679  ; mess_data
0013f0  f8a60044          STRH     r0,[r6,#0x44]         ;2679
0013f4  ea6f0000          MVN      r0,r0                 ;2680
0013f8  f8a60046          STRH     r0,[r6,#0x46]         ;2680
                  |L1.5116|
0013fc  f04f0400          MOV      r4,#0                 ;2684
001400  e037              B        |L1.5234|
                  |L1.5122|
001402  f8b60046          LDRH     r0,[r6,#0x46]  ; bps_off_mask
001406  fa0af904          LSL      r9,r10,r4
00140a  ea190f00          TST      r9,r0
00140e  d00c              BEQ      |L1.5162|
001410  eb040084          ADD      r0,r4,r4,LSL #2
001414  eb0000c4          ADD      r0,r0,r4,LSL #3
001418  eb0800c0          ADD      r0,r8,r0,LSL #3
00141c  f8301f44          LDRH     r1,[r0,#0x44]!
001420  f1010101          ADD      r1,r1,#1
001424  8001              STRH     r1,[r0,#0]
001426  e008              B        |L1.5178|
                  |L1.5160|
001428  e028              B        |L1.5244|
                  |L1.5162|
;;;2687   		else bps[i]._blok_cnt=0;
00142a  eb040084          ADD      r0,r4,r4,LSL #2
00142e  eb0000c4          ADD      r0,r0,r4,LSL #3
001432  eb0800c0          ADD      r0,r8,r0,LSL #3
001436  f8a07044          STRH     r7,[r0,#0x44]
                  |L1.5178|
;;;2688   		gran(&bps[i]._blok_cnt,0,50);
00143a  eb040084          ADD      r0,r4,r4,LSL #2
00143e  eb0000c4          ADD      r0,r0,r4,LSL #3
001442  eb0805c0          ADD      r5,r8,r0,LSL #3
001446  f1050044          ADD      r0,r5,#0x44
00144a  2232              MOVS     r2,#0x32
00144c  2100              MOVS     r1,#0
00144e  f7fffffe          BL       gran
;;;2689   		if(bps[i]._blok_cnt>20) bps[i]._flags_tu=1;
001452  f9b50044          LDRSH    r0,[r5,#0x44]
001456  2814              CMP      r0,#0x14
001458  dd01              BLE      |L1.5214|
00145a  f885a02c          STRB     r10,[r5,#0x2c]
                  |L1.5214|
;;;2690   		if(bps_on_mask&(1<<i)) bps[i]._flags_tu=0;
00145e  f8b60044          LDRH     r0,[r6,#0x44]  ; bps_on_mask
001462  ea190f00          TST      r9,r0
001466  d001              BEQ      |L1.5228|
001468  f885702c          STRB     r7,[r5,#0x2c]
                  |L1.5228|
00146c  f1040401          ADD      r4,r4,#1              ;2684
001470  b2e4              UXTB     r4,r4                 ;2684
                  |L1.5234|
001472  f9bb0000          LDRSH    r0,[r11,#0]           ;2684  ; NUMIST
001476  4284              CMP      r4,r0                 ;2684
001478  ddc3              BLE      |L1.5122|
00147a  e07c              B        |L1.5494|
                  |L1.5244|
;;;2691   	     }
;;;2692   
;;;2693   	
;;;2694   /*
;;;2695   
;;;2696   	if(bps_all_off_cnt>20)
;;;2697   		{
;;;2698   		for(i=0;i<=NUMIST;i++)
;;;2699   			{
;;;2700   	     	bps[i]._flags_tu=1;
;;;2701   	     	}
;;;2702   		}
;;;2703   	else if(bps_mask_off_cnt>20)
;;;2704   		{
;;;2705   		for(i=0;i<=NUMIST;i++)
;;;2706   			{
;;;2707   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;2708   	     	}
;;;2709   		}	
;;;2710   		
;;;2711   	else if(bps_mask_on_off_cnt>20)
;;;2712   		{
;;;2713   		for(i=0;i<=NUMIST;i++)
;;;2714   			{
;;;2715   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;2716   			else bps[i]._flags_tu=0;
;;;2717   	     	}
;;;2718   		}
;;;2719   		
;;;2720   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;2721   		{
;;;2722   		for(i=0;i<=NUMIST;i++)
;;;2723   			{
;;;2724   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=0;
;;;2725   	     	}
;;;2726   		}
;;;2727   */										
;;;2728   	}
;;;2729   
;;;2730   
;;;2731   else if(b1Hz_sh)
00147c  7d70              LDRB     r0,[r6,#0x15]  ; b1Hz_sh
00147e  b3f0              CBZ      r0,|L1.5374|
;;;2732   	{
;;;2733   	ptr__=0;
001480  f04f0400          MOV      r4,#0
;;;2734        for(i=0;i<=NUMIST;i++)
001484  4621              MOV      r1,r4
001486  f9bb0000          LDRSH    r0,[r11,#0]           ;2684
00148a  e00a              B        |L1.5282|
                  |L1.5260|
;;;2735   		{
;;;2736   	    bps[i]._flags_tu=1;
00148c  eb010281          ADD      r2,r1,r1,LSL #2
001490  eb0202c1          ADD      r2,r2,r1,LSL #3
001494  eb0802c2          ADD      r2,r8,r2,LSL #3
001498  f882a02c          STRB     r10,[r2,#0x2c]
00149c  f1010101          ADD      r1,r1,#1              ;2734
0014a0  b2c9              UXTB     r1,r1                 ;2734
                  |L1.5282|
0014a2  4281              CMP      r1,r0                 ;2734
0014a4  ddf2              BLE      |L1.5260|
;;;2737   	    }	
;;;2738     	     
;;;2739     	for(i=0;(i<NUMIST)&&(ptr__<num_necc);i++)
0014a6  f04f0100          MOV      r1,#0
0014aa  e022              B        |L1.5362|
                  |L1.5292|
;;;2740     		{
;;;2741   		char ii,iii;
;;;2742   
;;;2743   		ii=(char)NUMIST;
0014ac  b2c2              UXTB     r2,r0
;;;2744   		//if(ii<0)ii=0;
;;;2745   		if(ii>32)ii=32;
0014ae  2a20              CMP      r2,#0x20
0014b0  d901              BLS      |L1.5302|
0014b2  f04f0220          MOV      r2,#0x20
                  |L1.5302|
;;;2746   		iii=numOfForvardBps;
0014b6  7eb3              LDRB     r3,[r6,#0x1a]  ; numOfForvardBps
;;;2747   		//if(iii<0)iii=0;
;;;2748   		if(iii>=NUMIST)iii=0;
0014b8  4283              CMP      r3,r0
0014ba  db01              BLT      |L1.5312|
0014bc  f04f0300          MOV      r3,#0
                  |L1.5312|
;;;2749   		iii+=i;
0014c0  440b              ADD      r3,r3,r1
0014c2  b2db              UXTB     r3,r3
;;;2750   		iii=iii%ii;
0014c4  fbb3f5f2          UDIV     r5,r3,r2
0014c8  fb023215          MLS      r2,r2,r5,r3
;;;2751   		
;;;2752     	     if((bps[iii]._state==bsRDY)||(bps[iii]._state==bsWRK))
0014cc  eb020382          ADD      r3,r2,r2,LSL #2
0014d0  eb0302c2          ADD      r2,r3,r2,LSL #3
0014d4  eb0802c2          ADD      r2,r8,r2,LSL #3
0014d8  7893              LDRB     r3,[r2,#2]
0014da  2b03              CMP      r3,#3
0014dc  d001              BEQ      |L1.5346|
0014de  2b02              CMP      r3,#2
0014e0  d104              BNE      |L1.5356|
                  |L1.5346|
;;;2753     	         	{
;;;2754     	         	bps[iii]._flags_tu=0;
0014e2  f882702c          STRB     r7,[r2,#0x2c]
;;;2755     	         	ptr__++;
0014e6  f1040401          ADD      r4,r4,#1
0014ea  b2e4              UXTB     r4,r4
                  |L1.5356|
0014ec  f1010101          ADD      r1,r1,#1              ;2739
0014f0  b2c9              UXTB     r1,r1                 ;2739
                  |L1.5362|
0014f2  4281              CMP      r1,r0                 ;2739
0014f4  da06              BGE      |L1.5380|
0014f6  4a36              LDR      r2,|L1.5584|
0014f8  f9b22000          LDRSH    r2,[r2,#0]            ;2739  ; num_necc
0014fc  e000              B        |L1.5376|
                  |L1.5374|
0014fe  e03a              B        |L1.5494|
                  |L1.5376|
001500  4294              CMP      r4,r2                 ;2739
001502  dbd3              BLT      |L1.5292|
                  |L1.5380|
;;;2756     	         	}
;;;2757   			
;;;2758     	     }
;;;2759   	bps[numOfForvardBps_old]._flags_tu=0;
001504  7ef1              LDRB     r1,[r6,#0x1b]  ; numOfForvardBps_old
001506  eb010281          ADD      r2,r1,r1,LSL #2
00150a  eb0201c1          ADD      r1,r2,r1,LSL #3
00150e  eb0801c1          ADD      r1,r8,r1,LSL #3
001512  f881702c          STRB     r7,[r1,#0x2c]
;;;2760   
;;;2761   	if(main_1Hz_cnt<60)
001516  492f              LDR      r1,|L1.5588|
001518  f9b11000          LDRSH    r1,[r1,#0]  ; main_1Hz_cnt
00151c  293c              CMP      r1,#0x3c
00151e  da0f              BGE      |L1.5440|
;;;2762   		{
;;;2763        	for(i=0;i<=NUMIST;i++)
001520  f04f0100          MOV      r1,#0
001524  e00a              B        |L1.5436|
                  |L1.5414|
;;;2764   			{
;;;2765   	     	bps[i]._flags_tu=0;
001526  eb010281          ADD      r2,r1,r1,LSL #2
00152a  eb0202c1          ADD      r2,r2,r1,LSL #3
00152e  eb0802c2          ADD      r2,r8,r2,LSL #3
001532  f882702c          STRB     r7,[r2,#0x2c]
001536  f1010101          ADD      r1,r1,#1              ;2763
00153a  b2c9              UXTB     r1,r1                 ;2763
                  |L1.5436|
00153c  4281              CMP      r1,r0                 ;2763
00153e  ddf2              BLE      |L1.5414|
                  |L1.5440|
;;;2766   	     	}	
;;;2767   		}
;;;2768   	if(ipsBlckStat)
001540  4925              LDR      r1,|L1.5592|
001542  8809              LDRH     r1,[r1,#0]  ; ipsBlckStat
001544  b179              CBZ      r1,|L1.5478|
;;;2769   		{
;;;2770        	for(i=0;i<=NUMIST;i++)
001546  f04f0100          MOV      r1,#0
00154a  e00a              B        |L1.5474|
                  |L1.5452|
;;;2771   			{
;;;2772   	     	bps[i]._flags_tu=1;
00154c  eb010281          ADD      r2,r1,r1,LSL #2
001550  eb0202c1          ADD      r2,r2,r1,LSL #3
001554  eb0802c2          ADD      r2,r8,r2,LSL #3
001558  f882a02c          STRB     r10,[r2,#0x2c]
00155c  f1010101          ADD      r1,r1,#1              ;2770
001560  b2c9              UXTB     r1,r1                 ;2770
                  |L1.5474|
001562  4281              CMP      r1,r0                 ;2770
001564  ddf2              BLE      |L1.5452|
                  |L1.5478|
;;;2773   	     	}
;;;2774   		}
;;;2775   
;;;2776        for(i=0;i<=NUMIST;i++)
001566  f04f0100          MOV      r1,#0
00156a  e002              B        |L1.5490|
                  |L1.5484|
00156c  f1010101          ADD      r1,r1,#1
001570  b2c9              UXTB     r1,r1
                  |L1.5490|
001572  4281              CMP      r1,r0
001574  ddfa              BLE      |L1.5484|
                  |L1.5494|
;;;2777   		{
;;;2778   	    //if(bps[i]._flags_tu==1) 	bps[i]._x_=-50;
;;;2779   	   	}	
;;;2780   		 
;;;2781     	}
;;;2782   
;;;2783   
;;;2784   for(i=0;i<NUMIST;i++)
001576  f04f0000          MOV      r0,#0
;;;2785        {
;;;2786        if(bps[i]._ist_blok_host_cnt!=0)
;;;2787           {
;;;2788           bps[i]._flags_tu=99;
00157a  f04f0463          MOV      r4,#0x63
00157e  f9bb3000          LDRSH    r3,[r11,#0]           ;2684
001582  e02c              B        |L1.5598|
                  |L1.5508|
001584  eb000180          ADD      r1,r0,r0,LSL #2       ;2786
001588  eb0101c0          ADD      r1,r1,r0,LSL #3       ;2786
00158c  eb0801c1          ADD      r1,r8,r1,LSL #3       ;2786
001590  6c0a              LDR      r2,[r1,#0x40]         ;2786
001592  b122              CBZ      r2,|L1.5534|
001594  f881402c          STRB     r4,[r1,#0x2c]
;;;2789   		bps[i]._ist_blok_host_cnt--;
001598  f1a20201          SUB      r2,r2,#1
00159c  640a              STR      r2,[r1,#0x40]
                  |L1.5534|
00159e  f1000001          ADD      r0,r0,#1              ;2784
0015a2  e01b              B        |L1.5596|
                  |L1.5540|
                          DCD      uInAvar
                  |L1.5544|
                          DCD      bVDISWORK
                  |L1.5548|
                          DCD      RELE_SET_MASK
                  |L1.5552|
                          DCD      rele_av_flags
                  |L1.5556|
                          DCD      0x4002c000
                  |L1.5560|
                          DCD      0xfff000ff
                  |L1.5564|
                          DCD      0x2009c000
                  |L1.5568|
                          DCD      mess_data
                  |L1.5572|
                          DCD      ||area_number.26||
                  |L1.5576|
                          DCD      bps
                  |L1.5580|
                          DCD      NUMIST
                  |L1.5584|
                          DCD      num_necc
                  |L1.5588|
                          DCD      main_1Hz_cnt
                  |L1.5592|
                          DCD      ipsBlckStat
                  |L1.5596|
0015dc  b2c0              UXTB     r0,r0                 ;2784
                  |L1.5598|
0015de  4298              CMP      r0,r3                 ;2784
0015e0  dbd0              BLT      |L1.5508|
;;;2790           }
;;;2791        }
;;;2792   
;;;2793   
;;;2794   
;;;2795   
;;;2796   b1Hz_sh=0;
0015e2  7577              STRB     r7,[r6,#0x15]
;;;2797   
;;;2798   
;;;2799   num_of_wrks_bps=0;
0015e4  7477              STRB     r7,[r6,#0x11]
;;;2800   tempUS=0;
0015e6  f04f0100          MOV      r1,#0
;;;2801   for(i=0;i<NUMIST;i++)
0015ea  4608              MOV      r0,r1
0015ec  e013              B        |L1.5654|
                  |L1.5614|
;;;2802   	{
;;;2803   	if(bps[i]._state==bsWRK)
0015ee  eb000280          ADD      r2,r0,r0,LSL #2
0015f2  eb0202c0          ADD      r2,r2,r0,LSL #3
0015f6  eb0802c2          ADD      r2,r8,r2,LSL #3
0015fa  7894              LDRB     r4,[r2,#2]
0015fc  2c02              CMP      r4,#2
0015fe  d107              BNE      |L1.5648|
;;;2804   		{
;;;2805   		num_of_wrks_bps++;
001600  7c74              LDRB     r4,[r6,#0x11]  ; num_of_wrks_bps
001602  f1040401          ADD      r4,r4,#1
001606  7474              STRB     r4,[r6,#0x11]
;;;2806   		if(bps[i]._Uii>tempUS)tempUS=bps[i]._Uii;
001608  69d2              LDR      r2,[r2,#0x1c]
00160a  428a              CMP      r2,r1
00160c  dd00              BLE      |L1.5648|
00160e  b291              UXTH     r1,r2
                  |L1.5648|
001610  f1000001          ADD      r0,r0,#1              ;2801
001614  b2c0              UXTB     r0,r0                 ;2801
                  |L1.5654|
001616  4298              CMP      r0,r3                 ;2801
001618  dbe9              BLT      |L1.5614|
;;;2807   		}
;;;2808   	}
;;;2809   Ubpsmax=tempUS;
00161a  87b1              STRH     r1,[r6,#0x3c]
;;;2810   
;;;2811   //bPARALLEL_ENOUG=0;
;;;2812   //bPARALLEL_NOT_ENOUG=1;
;;;2813   /*
;;;2814   for(i=0;i<NUMIST;i++)
;;;2815   	{
;;;2816   	if(bps[i]._Ti>=TSIGN)
;;;2817   		{
;;;2818   		bPARALLEL_ENOUG=1;
;;;2819   		}
;;;2820   	if(bps[i]._Ti>=(TSIGN-5))
;;;2821   		{
;;;2822   		bPARALLEL_NOT_ENOUG=0;
;;;2823   		}
;;;2824   	}
;;;2825   
;;;2826   if(bPARALLEL_ENOUG==1)
;;;2827   	{
;;;2828   	bPARALLEL=1;
;;;2829   	}
;;;2830   else if(bPARALLEL && bPARALLEL_NOT_ENOUG)
;;;2831   	{
;;;2832   	bPARALLEL=0;
;;;2833   	}*/
;;;2834   }
00161c  e8bd9ff0          POP      {r4-r12,pc}
;;;2835   
                          ENDP

                  powerAntiAliasingHndl PROC
;;;2842   //-----------------------------------------------
;;;2843   void powerAntiAliasingHndl(void)
001620  b570              PUSH     {r4-r6,lr}
;;;2844   {
;;;2845   if((power_summary_tempo/10UL)==(power_summary_tempo_old/10UL))
001622  230a              MOVS     r3,#0xa
001624  4cff              LDR      r4,|L1.6692|
001626  48fe              LDR      r0,|L1.6688|
;;;2846   	{
;;;2847   	if(powerSummaryCnt<15)powerSummaryCnt++;
;;;2848   	if(powerSummaryCnt>=10)
;;;2849   		{
;;;2850   		power_summary=power_summary_tempo;
;;;2851   		}
;;;2852   	}
;;;2853   else powerSummaryCnt=0;
001628  2500              MOVS     r5,#0
00162a  6822              LDR      r2,[r4,#0]            ;2845  ; power_summary_tempo_old
00162c  6800              LDR      r0,[r0,#0]            ;2845  ; power_summary_tempo
00162e  fbb2f6f3          UDIV     r6,r2,r3              ;2845
001632  fbb0f1f3          UDIV     r1,r0,r3              ;2845
001636  4afc              LDR      r2,|L1.6696|
001638  42b1              CMP      r1,r6                 ;2845
00163a  d10b              BNE      |L1.5716|
00163c  7811              LDRB     r1,[r2,#0]            ;2847  ; powerSummaryCnt
00163e  290f              CMP      r1,#0xf               ;2847
001640  d202              BCS      |L1.5704|
001642  f1010101          ADD      r1,r1,#1              ;2847
001646  7011              STRB     r1,[r2,#0]            ;2847
                  |L1.5704|
001648  7811              LDRB     r1,[r2,#0]            ;2848  ; powerSummaryCnt
00164a  290a              CMP      r1,#0xa               ;2848
00164c  d303              BCC      |L1.5718|
00164e  49f7              LDR      r1,|L1.6700|
001650  6008              STR      r0,[r1,#0]            ;2850  ; power_summary
001652  e000              B        |L1.5718|
                  |L1.5716|
001654  7015              STRB     r5,[r2,#0]
                  |L1.5718|
;;;2854   power_summary_tempo_old=power_summary_tempo;
001656  6020              STR      r0,[r4,#0]  ; power_summary_tempo_old
;;;2855   
;;;2856   if((power_current_tempo/10UL)==(power_current_tempo_old/10UL))
001658  48f5              LDR      r0,|L1.6704|
00165a  4cf6              LDR      r4,|L1.6708|
00165c  f9b00000          LDRSH    r0,[r0,#0]  ; power_current_tempo
001660  f9b42000          LDRSH    r2,[r4,#0]  ; power_current_tempo_old
001664  fbb0f1f3          UDIV     r1,r0,r3
001668  fbb2f3f3          UDIV     r3,r2,r3
;;;2857   	{
;;;2858   	if(powerCurrentCnt<15)powerCurrentCnt++;
00166c  4af2              LDR      r2,|L1.6712|
00166e  4299              CMP      r1,r3                 ;2856
001670  d10b              BNE      |L1.5770|
001672  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
001674  290f              CMP      r1,#0xf
001676  d202              BCS      |L1.5758|
001678  f1010101          ADD      r1,r1,#1
00167c  7011              STRB     r1,[r2,#0]
                  |L1.5758|
;;;2859   	if(powerCurrentCnt>=10)
00167e  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
001680  290a              CMP      r1,#0xa
001682  d303              BCC      |L1.5772|
;;;2860   		{
;;;2861   		power_current=power_current_tempo;
001684  49ed              LDR      r1,|L1.6716|
001686  8008              STRH     r0,[r1,#0]
001688  e000              B        |L1.5772|
                  |L1.5770|
;;;2862   		}
;;;2863   	}
;;;2864   else powerCurrentCnt=0;
00168a  7015              STRB     r5,[r2,#0]
                  |L1.5772|
;;;2865   power_current_tempo_old=power_current_tempo;
00168c  8020              STRH     r0,[r4,#0]
;;;2866   }
00168e  bd70              POP      {r4-r6,pc}
;;;2867   
                          ENDP

                  ips_current_average_hndl PROC
;;;2868   //-----------------------------------------------
;;;2869   void ips_current_average_hndl(void)
001690  e92d43f0          PUSH     {r4-r9,lr}
;;;2870   {
001694  b085              SUB      sp,sp,#0x14
;;;2871   if(++ica_timer_cnt>=10)
001696  4cea              LDR      r4,|L1.6720|
;;;2872   	{
;;;2873   	ica_timer_cnt=0;
;;;2874   	ica_plazma[0]++;
;;;2875   
;;;2876   	ica_my_current=bps_I;
;;;2877   
;;;2878   	if((ica_my_current>ica_your_current)&&((ica_my_current-ica_your_current)>=10)&&(ICA_EN==1))
001698  4eea              LDR      r6,|L1.6724|
00169a  2500              MOVS     r5,#0                 ;2873
00169c  7820              LDRB     r0,[r4,#0]            ;2871  ; ica_timer_cnt
00169e  1c40              ADDS     r0,r0,#1              ;2871
0016a0  b2c0              UXTB     r0,r0                 ;2871
0016a2  7020              STRB     r0,[r4,#0]            ;2871
0016a4  280a              CMP      r0,#0xa               ;2871
0016a6  d340              BCC      |L1.5930|
0016a8  7025              STRB     r5,[r4,#0]            ;2873
0016aa  f8dfc39c          LDR      r12,|L1.6728|
0016ae  f89c0000          LDRB     r0,[r12,#0]           ;2874  ; ica_plazma
0016b2  f1000001          ADD      r0,r0,#1              ;2874
0016b6  f88c0000          STRB     r0,[r12,#0]           ;2874
0016ba  48e4              LDR      r0,|L1.6732|
0016bc  49e4              LDR      r1,|L1.6736|
0016be  f9b00000          LDRSH    r0,[r0,#0]            ;2876  ; bps_I
0016c2  8008              STRH     r0,[r1,#0]            ;2876
0016c4  49e3              LDR      r1,|L1.6740|
;;;2879   		{
;;;2880   		ica_plazma[1]++;
;;;2881   		ica_u_necc--;
0016c6  f8df8390          LDR      r8,|L1.6744|
0016ca  4662              MOV      r2,r12                ;2874
0016cc  4637              MOV      r7,r6                 ;2878
0016ce  f9b11000          LDRSH    r1,[r1,#0]            ;2878  ; ica_your_current
0016d2  7852              LDRB     r2,[r2,#1]            ;2880
0016d4  f9b83000          LDRSH    r3,[r8,#0]
0016d8  f9b77000          LDRSH    r7,[r7,#0]            ;2878
0016dc  4288              CMP      r0,r1                 ;2878
0016de  dd06              BLE      |L1.5870|
0016e0  eba00901          SUB      r9,r0,r1              ;2878
0016e4  f1b90f0a          CMP      r9,#0xa               ;2878
0016e8  db01              BLT      |L1.5870|
0016ea  2f01              CMP      r7,#1                 ;2878
0016ec  d007              BEQ      |L1.5886|
                  |L1.5870|
;;;2882   		}
;;;2883   	else if((ica_my_current<ica_your_current)&&((ica_your_current-ica_my_current)>=10)&&(ICA_EN==1))
0016ee  4288              CMP      r0,r1
0016f0  da16              BGE      |L1.5920|
0016f2  1a08              SUBS     r0,r1,r0
0016f4  280a              CMP      r0,#0xa
0016f6  db13              BLT      |L1.5920|
0016f8  2f01              CMP      r7,#1
0016fa  d009              BEQ      |L1.5904|
0016fc  e010              B        |L1.5920|
                  |L1.5886|
0016fe  f1020201          ADD      r2,r2,#1              ;2880
001702  f88c2001          STRB     r2,[r12,#1]           ;2880
001706  f1a30301          SUB      r3,r3,#1              ;2881
00170a  f8a83000          STRH     r3,[r8,#0]            ;2881
00170e  e007              B        |L1.5920|
                  |L1.5904|
;;;2884   		{
;;;2885   		ica_plazma[1]--;
001710  f1a20201          SUB      r2,r2,#1
001714  f88c2001          STRB     r2,[r12,#1]
;;;2886   		ica_u_necc++;
001718  f1030301          ADD      r3,r3,#1
00171c  f8a83000          STRH     r3,[r8,#0]
                  |L1.5920|
;;;2887   		}
;;;2888   	gran(&ica_u_necc,-20,20);
001720  2214              MOVS     r2,#0x14
001722  4251              RSBS     r1,r2,#0
001724  48cc              LDR      r0,|L1.6744|
001726  f7fffffe          BL       gran
                  |L1.5930|
;;;2889   	}
;;;2890   
;;;2891   if((ica_timer_cnt==8)&&(ICA_EN==1))
00172a  7820              LDRB     r0,[r4,#0]  ; ica_timer_cnt
;;;2892   	{
;;;2893   	char modbus_buff[20],i;
;;;2894   	short crc_temp;
;;;2895   
;;;2896   	modbus_buff[0] = ICA_MODBUS_ADDRESS;
00172c  f8df832c          LDR      r8,|L1.6748|
;;;2897   	modbus_buff[1] = 4;
;;;2898   	modbus_buff[2] = 0;
;;;2899   	modbus_buff[3] = 2;
;;;2900   	modbus_buff[4] = 0;	
;;;2901   	modbus_buff[5] = 1;
;;;2902   
;;;2903   	crc_temp= CRC16_2(modbus_buff,6);
;;;2904   
;;;2905   	modbus_buff[6]= (char)crc_temp;
;;;2906   	modbus_buff[7]= (char)(crc_temp>>8);
;;;2907   
;;;2908   	if(ICA_CH==0)
001730  4fcb              LDR      r7,|L1.6752|
001732  2808              CMP      r0,#8                 ;2891
001734  d125              BNE      |L1.6018|
001736  8830              LDRH     r0,[r6,#0]            ;2891  ; ICA_EN
001738  2801              CMP      r0,#1                 ;2891
00173a  d122              BNE      |L1.6018|
00173c  f8b80000          LDRH     r0,[r8,#0]            ;2896  ; ICA_MODBUS_ADDRESS
001740  f88d0000          STRB     r0,[sp,#0]            ;2896
001744  f04f0004          MOV      r0,#4                 ;2897
001748  f88d0001          STRB     r0,[sp,#1]            ;2897
00174c  f88d5002          STRB     r5,[sp,#2]            ;2898
001750  f04f0002          MOV      r0,#2                 ;2899
001754  f88d0003          STRB     r0,[sp,#3]            ;2899
001758  f88d5004          STRB     r5,[sp,#4]            ;2900
00175c  f04f0001          MOV      r0,#1                 ;2901
001760  f88d0005          STRB     r0,[sp,#5]            ;2901
001764  f04f0106          MOV      r1,#6                 ;2903
001768  4668              MOV      r0,sp                 ;2903
00176a  f7fffffe          BL       CRC16_2
00176e  f88d0006          STRB     r0,[sp,#6]            ;2905
001772  ea4f2020          ASR      r0,r0,#8              ;2906
001776  f88d0007          STRB     r0,[sp,#7]            ;2906
00177a  f9b70000          LDRSH    r0,[r7,#0]  ; ICA_CH
00177e  b3e8              CBZ      r0,|L1.6140|
;;;2909   		{
;;;2910   		for (i=0;i<8;i++)
;;;2911   			{
;;;2912   			putchar_sc16is700(modbus_buff[i]);
;;;2913   			}
;;;2914   		}
;;;2915   	else if(ICA_CH==1)
001780  2801              CMP      r0,#1
                  |L1.6018|
;;;2916   		{
;;;2917   	/*	static U8 rem_IP[4];
;;;2918   		rem_IP[0]=ICA_MODBUS_TCP_IP1;
;;;2919   		rem_IP[1]=ICA_MODBUS_TCP_IP2;
;;;2920   		rem_IP[2]=ICA_MODBUS_TCP_IP3;
;;;2921   		rem_IP[3]=ICA_MODBUS_TCP_IP4;*/
;;;2922     		//tcp_soc_avg = tcp_get_socket (TCP_TYPE_CLIENT, 0, 30, tcp_callback);
;;;2923     		if (tcp_soc_avg != 0) 
;;;2924   			{
;;;2925       		
;;;2926   			//tcp_connect_stat=0;
;;;2927       		//tcp_connect (tcp_soc_avg, rem_IP, 502, 1000);
;;;2928   			/*while(!tcp_connect_stat)
;;;2929   				{
;;;2930   				}*/
;;;2931   			//delay_us(500);
;;;2932   			//tcp_close(tcp_soc_avg);
;;;2933   
;;;2934   			}
;;;2935   		}
;;;2936   	}
;;;2937   
;;;2938   if((ica_timer_cnt==3)&&(ICA_EN==1))
;;;2939   	{
;;;2940   	//if(tcp_connect_stat)
;;;2941   		{
;;;2942   		//tcp_close(tcp_soc_avg);
;;;2943   		//tcp_connect_stat=3;
;;;2944   		}
;;;2945   	}
;;;2946   
;;;2947   if((main_kb_cnt==(TBAT*60)-21)&&(ICA_EN==1))
001782  48b8              LDR      r0,|L1.6756|
001784  f06f0214          MVN      r2,#0x14
001788  f9b00000          LDRSH    r0,[r0,#0]  ; TBAT
00178c  ebc01100          RSB      r1,r0,r0,LSL #4
001790  eb020181          ADD      r1,r2,r1,LSL #2
001794  4ab4              LDR      r2,|L1.6760|
001796  f9b22042          LDRSH    r2,[r2,#0x42]  ; main_kb_cnt
00179a  4291              CMP      r1,r2
00179c  d134              BNE      |L1.6152|
00179e  8831              LDRH     r1,[r6,#0]  ; ICA_EN
0017a0  2901              CMP      r1,#1
0017a2  d131              BNE      |L1.6152|
;;;2948   	{
;;;2949   	char modbus_buff[20],i;
;;;2950   	short crc_temp;
;;;2951   
;;;2952   	modbus_buff[0] = ICA_MODBUS_ADDRESS;
0017a4  f8b81000          LDRH     r1,[r8,#0]  ; ICA_MODBUS_ADDRESS
0017a8  f88d1000          STRB     r1,[sp,#0]
;;;2953   	modbus_buff[1] = 6;
0017ac  f04f0106          MOV      r1,#6
0017b0  f88d1001          STRB     r1,[sp,#1]
;;;2954   	modbus_buff[2] = 0;
0017b4  f88d5002          STRB     r5,[sp,#2]
;;;2955   	modbus_buff[3] = 30;
0017b8  f04f011e          MOV      r1,#0x1e
0017bc  f88d1003          STRB     r1,[sp,#3]
;;;2956   	modbus_buff[4] = (char)(TBAT/256);	
0017c0  ea4f71e0          ASR      r1,r0,#31
0017c4  eb006111          ADD      r1,r0,r1,LSR #24
0017c8  ea4f2221          ASR      r2,r1,#8
0017cc  f88d2004          STRB     r2,[sp,#4]
;;;2957   	modbus_buff[5] = (char)(TBAT%256);
0017d0  f88d0005          STRB     r0,[sp,#5]
;;;2958   
;;;2959   	crc_temp= CRC16_2(modbus_buff,6);
0017d4  f04f0106          MOV      r1,#6
0017d8  4668              MOV      r0,sp
0017da  f7fffffe          BL       CRC16_2
;;;2960   
;;;2961   	modbus_buff[6]= (char)crc_temp;
0017de  f88d0006          STRB     r0,[sp,#6]
;;;2962   	modbus_buff[7]= (char)(crc_temp>>8);
0017e2  ea4f2020          ASR      r0,r0,#8
0017e6  f88d0007          STRB     r0,[sp,#7]
;;;2963   
;;;2964   	if(ICA_CH==0)
0017ea  8838              LDRH     r0,[r7,#0]  ; ICA_CH
0017ec  2800              CMP      r0,#0
0017ee  d10b              BNE      |L1.6152|
;;;2965   		{
;;;2966   		for (i=0;i<8;i++)
0017f0  4604              MOV      r4,r0
0017f2  466d              MOV      r5,sp                 ;2949
                  |L1.6132|
;;;2967   			{
;;;2968   			putchar_sc16is700(modbus_buff[i]);
0017f4  5d28              LDRB     r0,[r5,r4]
0017f6  f7fffffe          BL       putchar_sc16is700
0017fa  e000              B        |L1.6142|
                  |L1.6140|
0017fc  e007              B        |L1.6158|
                  |L1.6142|
0017fe  f1040401          ADD      r4,r4,#1              ;2966
001802  b2e4              UXTB     r4,r4                 ;2966
001804  2c08              CMP      r4,#8                 ;2966
001806  d3f5              BCC      |L1.6132|
                  |L1.6152|
;;;2969   			}
;;;2970   		}
;;;2971   	}
;;;2972   
;;;2973   }
001808  b005              ADD      sp,sp,#0x14
00180a  e8bd83f0          POP      {r4-r9,pc}
                  |L1.6158|
00180e  f04f0400          MOV      r4,#0                 ;2910
001812  46e9              MOV      r9,sp                 ;2893
                  |L1.6164|
001814  f8190004          LDRB     r0,[r9,r4]            ;2912
001818  f7fffffe          BL       putchar_sc16is700
00181c  f1040401          ADD      r4,r4,#1              ;2910
001820  b2e4              UXTB     r4,r4                 ;2910
001822  2c08              CMP      r4,#8                 ;2910
001824  d3f6              BCC      |L1.6164|
001826  e7ac              B        |L1.6018|
;;;2974   
                          ENDP

                  bps_drv PROC
;;;3072   //-----------------------------------------------
;;;3073   void bps_drv(char in)
001828  e92d41f0          PUSH     {r4-r8,lr}
;;;3074   {
00182c  4606              MOV      r6,r0
;;;3075   char temp;
;;;3076   
;;;3077   if (bps[in]._device!=dSRC) return;
00182e  eb060086          ADD      r0,r6,r6,LSL #2
001832  eb0001c6          ADD      r1,r0,r6,LSL #3
001836  488d              LDR      r0,|L1.6764|
001838  f8102031          LDRB     r2,[r0,r1,LSL #3]
00183c  2a03              CMP      r2,#3
00183e  d177              BNE      |L1.6448|
;;;3078   temp=bps[in]._flags_tm;
001840  eb0004c1          ADD      r4,r0,r1,LSL #3
001844  f8945046          LDRB     r5,[r4,#0x46]
;;;3079   if(temp&(1<<AV_T))
001848  07a8              LSLS     r0,r5,#30
00184a  d517              BPL      |L1.6268|
;;;3080   	{
;;;3081   	if(bps[in]._temp_av_cnt<1200) 
00184c  f9b4104a          LDRSH    r1,[r4,#0x4a]
001850  f44f6296          MOV      r2,#0x4b0
001854  4291              CMP      r1,r2
001856  da22              BGE      |L1.6302|
;;;3082   		{
;;;3083   		bps[in]._temp_av_cnt++;
001858  f1010101          ADD      r1,r1,#1
00185c  b208              SXTH     r0,r1
00185e  f8a4004a          STRH     r0,[r4,#0x4a]
;;;3084   		if(bps[in]._temp_av_cnt>=1200)
001862  4290              CMP      r0,r2
001864  db1b              BLT      |L1.6302|
;;;3085   			{
;;;3086   			bps[in]._temp_av_cnt=1200;
001866  f8a4204a          STRH     r2,[r4,#0x4a]
;;;3087   		   	if(!(bps[in]._av&(1<<0)))avar_bps_hndl(in,0,1);
00186a  7860              LDRB     r0,[r4,#1]
00186c  07c0              LSLS     r0,r0,#31
00186e  d116              BNE      |L1.6302|
001870  2201              MOVS     r2,#1
001872  2100              MOVS     r1,#0
001874  4630              MOV      r0,r6
001876  f7fffffe          BL       avar_bps_hndl
00187a  e010              B        |L1.6302|
                  |L1.6268|
;;;3088   			}
;;;3089   		}
;;;3090   	}
;;;3091   
;;;3092   else if(!(temp&(1<<AV_T)))
;;;3093   	{
;;;3094   	if(bps[in]._temp_av_cnt) 
00187c  f9b4104a          LDRSH    r1,[r4,#0x4a]
001880  b169              CBZ      r1,|L1.6302|
;;;3095   		{
;;;3096   		bps[in]._temp_av_cnt--;
001882  f1a10101          SUB      r1,r1,#1
001886  b208              SXTH     r0,r1
001888  f8a4004a          STRH     r0,[r4,#0x4a]
;;;3097   		if(!bps[in]._temp_av_cnt)
00188c  b938              CBNZ     r0,|L1.6302|
;;;3098   			{
;;;3099   			if(bps[in]._av&(1<<0))avar_bps_hndl(in,0,0);
00188e  7860              LDRB     r0,[r4,#1]
001890  07c0              LSLS     r0,r0,#31
001892  d004              BEQ      |L1.6302|
001894  2200              MOVS     r2,#0
001896  4611              MOV      r1,r2
001898  4630              MOV      r0,r6
00189a  f7fffffe          BL       avar_bps_hndl
                  |L1.6302|
;;;3100   			}
;;;3101   		} 	
;;;3102   
;;;3103   	}
;;;3104   
;;;3105   if((temp&(1<<AVUMAX)))
00189e  0728              LSLS     r0,r5,#28
;;;3106   	{
;;;3107   	if(bps[in]._umax_av_cnt<10) 
;;;3108   		{
;;;3109   		bps[in]._umax_av_cnt++;
;;;3110   		if(bps[in]._umax_av_cnt>=10)
;;;3111   			{ 
;;;3112   			bps[in]._umax_av_cnt=10;
0018a0  f04f070a          MOV      r7,#0xa
0018a4  f04f0800          MOV      r8,#0                 ;3087
0018a8  d515              BPL      |L1.6358|
0018aa  f9b4104c          LDRSH    r1,[r4,#0x4c]         ;3107
0018ae  290a              CMP      r1,#0xa               ;3107
0018b0  da26              BGE      |L1.6400|
0018b2  f1010101          ADD      r1,r1,#1              ;3109
0018b6  b208              SXTH     r0,r1                 ;3109
0018b8  f8a4004c          STRH     r0,[r4,#0x4c]         ;3109
0018bc  280a              CMP      r0,#0xa               ;3110
0018be  db1f              BLT      |L1.6400|
0018c0  f8a4704c          STRH     r7,[r4,#0x4c]
;;;3113   			if(!(bps[in]._av&(1<<1)))avar_bps_hndl(in,1,1);
0018c4  7860              LDRB     r0,[r4,#1]
0018c6  0780              LSLS     r0,r0,#30
0018c8  d41a              BMI      |L1.6400|
0018ca  2201              MOVS     r2,#1
0018cc  4611              MOV      r1,r2
0018ce  4630              MOV      r0,r6
0018d0  f7fffffe          BL       avar_bps_hndl
0018d4  e014              B        |L1.6400|
                  |L1.6358|
;;;3114   		  	/*if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,1,1);
;;;3115   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;3116   				{
;;;3117   				apv_cnt[in,0]=APV_INIT;
;;;3118   				apv_cnt[in,1]=APV_INIT;
;;;3119   				apv_cnt[in,2]=APV_INIT;
;;;3120   				apv_flags[in]=afOFF;
;;;3121   				}				*/
;;;3122   						
;;;3123   			}
;;;3124   		} 
;;;3125   	}		
;;;3126   else if(!(temp&(1<<AVUMAX)))
;;;3127   	{
;;;3128   	if(bps[in]._umax_av_cnt>0) 
0018d6  f9b4104c          LDRSH    r1,[r4,#0x4c]
0018da  2900              CMP      r1,#0
0018dc  dd0d              BLE      |L1.6394|
;;;3129   		{
;;;3130   		bps[in]._umax_av_cnt--;
0018de  f1a10101          SUB      r1,r1,#1
0018e2  b208              SXTH     r0,r1
0018e4  f8a4004c          STRH     r0,[r4,#0x4c]
;;;3131   		if(bps[in]._umax_av_cnt==0)
0018e8  b950              CBNZ     r0,|L1.6400|
;;;3132   			{
;;;3133   			bps[in]._umax_av_cnt=0;
;;;3134   			avar_bps_hndl(in,1,0);
0018ea  f04f0200          MOV      r2,#0
0018ee  f04f0101          MOV      r1,#1
0018f2  4630              MOV      r0,r6
0018f4  f7fffffe          BL       avar_bps_hndl
0018f8  e002              B        |L1.6400|
                  |L1.6394|
;;;3135   	 //		apv_cnt[in,0]=0;
;;;3136   	//		apv_cnt[in,1]=0;
;;;3137   	 //		apv_cnt[in,2]=0;			
;;;3138   			}
;;;3139   		}
;;;3140   	else if(bps[in]._umax_av_cnt<0) bps[in]._umax_av_cnt=0;		 
0018fa  da01              BGE      |L1.6400|
0018fc  f8a4804c          STRH     r8,[r4,#0x4c]
                  |L1.6400|
;;;3141   	}
;;;3142   
;;;3143   if(temp&(1<<AVUMIN))
001900  06e8              LSLS     r0,r5,#27
001902  d516              BPL      |L1.6450|
;;;3144   	{
;;;3145   	if(bps[in]._umin_av_cnt<10) 
001904  f9b4004e          LDRSH    r0,[r4,#0x4e]
001908  280a              CMP      r0,#0xa
00190a  da20              BGE      |L1.6478|
;;;3146   		{
;;;3147   		bps[in]._umin_av_cnt++;
00190c  f1000001          ADD      r0,r0,#1
001910  b200              SXTH     r0,r0
001912  f8a4004e          STRH     r0,[r4,#0x4e]
;;;3148   		if(bps[in]._umin_av_cnt>=10)
001916  280a              CMP      r0,#0xa
001918  db19              BLT      |L1.6478|
;;;3149   			{ 
;;;3150   			bps[in]._umin_av_cnt=10;
00191a  f8a4704e          STRH     r7,[r4,#0x4e]
;;;3151   			if(!(bps[in]._av&(1<<2)))avar_bps_hndl(in,2,1);
00191e  7860              LDRB     r0,[r4,#1]
001920  0740              LSLS     r0,r0,#29
001922  d414              BMI      |L1.6478|
001924  2201              MOVS     r2,#1
001926  2102              MOVS     r1,#2
001928  4630              MOV      r0,r6
00192a  f7fffffe          BL       avar_bps_hndl
00192e  e00e              B        |L1.6478|
                  |L1.6448|
001930  e045              B        |L1.6590|
                  |L1.6450|
;;;3152   		  	/*	if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,2,1);
;;;3153   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;3154   				{
;;;3155   				apv_cnt[in,0]=APV_INIT;
;;;3156   				apv_cnt[in,1]=APV_INIT;
;;;3157   				apv_cnt[in,2]=APV_INIT;
;;;3158   				apv_flags[in]=afOFF;
;;;3159   				}*/				
;;;3160   			}
;;;3161   		} 
;;;3162   	}	
;;;3163   	
;;;3164   else if(!(temp&(1<<AVUMIN)))
;;;3165   	{
;;;3166   	if(bps[in]._umin_av_cnt) 
001932  f9b4004e          LDRSH    r0,[r4,#0x4e]
001936  b150              CBZ      r0,|L1.6478|
;;;3167   		{
;;;3168   		bps[in]._umin_av_cnt--;
001938  f1a00001          SUB      r0,r0,#1
00193c  b200              SXTH     r0,r0
00193e  f8a4004e          STRH     r0,[r4,#0x4e]
;;;3169   		if(bps[in]._umin_av_cnt==0)
001942  b920              CBNZ     r0,|L1.6478|
;;;3170   			{
;;;3171   			bps[in]._umin_av_cnt=0;
;;;3172   			avar_bps_hndl(in,2,0);
001944  2200              MOVS     r2,#0
001946  2102              MOVS     r1,#2
001948  4630              MOV      r0,r6
00194a  f7fffffe          BL       avar_bps_hndl
                  |L1.6478|
;;;3173   		//	apv_cnt[in,0]=0;
;;;3174   		//	apv_cnt[in,1]=0;
;;;3175   		//	apv_cnt[in,2]=0;
;;;3176   			}
;;;3177   		}
;;;3178   	else if(bps[in]._umin_av_cnt>10)bps[in]._umin_av_cnt--;	 
;;;3179   	}
;;;3180   
;;;3181   //bps[in]._state=bsOFF;
;;;3182   
;;;3183   if (bps[in]._av&0x0f)					bps[in]._state=bsAV;
00194e  7860              LDRB     r0,[r4,#1]
001950  0700              LSLS     r0,r0,#28
001952  d003              BEQ      |L1.6492|
001954  f04f0005          MOV      r0,#5
001958  70a0              STRB     r0,[r4,#2]
00195a  e016              B        |L1.6538|
                  |L1.6492|
;;;3184   else if ( (net_av) && (bps[in]._cnt>20)/*&& 
00195c  4844              LDR      r0,|L1.6768|
00195e  7800              LDRB     r0,[r0,#0]  ; net_av
001960  b128              CBZ      r0,|L1.6510|
001962  78e0              LDRB     r0,[r4,#3]
001964  2814              CMP      r0,#0x14
001966  d902              BLS      |L1.6510|
;;;3185   		(bps[in]._Uii<200)*/)				bps[in]._state=bsOFF_AV_NET;
001968  f8848002          STRB     r8,[r4,#2]
00196c  e00d              B        |L1.6538|
                  |L1.6510|
;;;3186   else if (bps[in]._flags_tm&BIN8(100000))	bps[in]._state=bsRDY;
00196e  f8940046          LDRB     r0,[r4,#0x46]
001972  0680              LSLS     r0,r0,#26
001974  d503              BPL      |L1.6526|
001976  f04f0003          MOV      r0,#3
00197a  70a0              STRB     r0,[r4,#2]
00197c  e005              B        |L1.6538|
                  |L1.6526|
;;;3187   else if (bps[in]._cnt<20)				bps[in]._state=bsWRK;
00197e  78e0              LDRB     r0,[r4,#3]
001980  2814              CMP      r0,#0x14
001982  d202              BCS      |L1.6538|
001984  f04f0002          MOV      r0,#2
001988  70a0              STRB     r0,[r4,#2]
                  |L1.6538|
;;;3188   
;;;3189   
;;;3190   
;;;3191   //else if(bps[in]._flags_tm&BIN8(100000)) bps[in]._state=ssBL;
;;;3192   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))bps[in]._state=ssWRK;
;;;3193   //else bps[0]._state=ssNOT;
;;;3194   
;;;3195   //bps[in]._is_ready=0;
;;;3196   //bps[in]._is_wrk=0;
;;;3197   //if(bps[in]._av_net) bps[in]._flags_bp='N';// не подключен
;;;3198   //else if(bps[in]._av_u_max) bps[in]._flags_bp='P';// завышено напр€жение(u_.av_.bAS1T)) bps_state[0]=ssAV;
;;;3199   //else if(bps[in]._av_u_min) bps[in]._flags_bp='M';// занижено напр€жение
;;;3200   //else if(bps[in]._av_temper) bps[in]._flags_bp='T';// температура
;;;3201   //else if(bps[in]._flags_tm&BIN8(100000)) 
;;;3202   //	{
;;;3203   //	bps[in]._flags_bp='B';// заблокирован
;;;3204   //	bps[in]._is_ready=1;
;;;3205   //	}
;;;3206   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))
;;;3207   //     {
;;;3208   //     bps[in]._flags_bp='W';// работает
;;;3209   //     bps[in]._is_ready=1;
;;;3210   //     bps[in]._is_wrk=1;
;;;3211        
;;;3212   //     }
;;;3213   //else bps[in]._is_ready=1;     
;;;3214   
;;;3215   
;;;3216   
;;;3217   
;;;3218   
;;;3219   /*
;;;3220   bps[in]._flags_tu&=BIN8(11111110);
;;;3221   if(bps[in]._ist_blok_cnt)
;;;3222   	{
;;;3223   	bps[in]._ist_blok_cnt--;
;;;3224   	bps[in]._flags_tu|=BIN8(1);
;;;3225   	}
;;;3226   
;;;3227   	   */ 
;;;3228   
;;;3229   //ѕересброс Ѕѕ—а при потере св€зи
;;;3230   if(bps[in]._cnt>=10) bps[in]._flags_tu|=BIN8(10000000);
00198a  78e0              LDRB     r0,[r4,#3]
00198c  280a              CMP      r0,#0xa
00198e  d306              BCC      |L1.6558|
001990  f894002c          LDRB     r0,[r4,#0x2c]
001994  f0400080          ORR      r0,r0,#0x80
001998  f884002c          STRB     r0,[r4,#0x2c]
00199c  e005              B        |L1.6570|
                  |L1.6558|
;;;3231   else bps[in]._flags_tu&=BIN8(1111111);
00199e  f894002c          LDRB     r0,[r4,#0x2c]
0019a2  f000007f          AND      r0,r0,#0x7f
0019a6  f884002c          STRB     r0,[r4,#0x2c]
                  |L1.6570|
;;;3232   	
;;;3233   bps[in]._vol_u=cntrl_stat+bps[in]._x_;	
0019aa  492f              LDR      r1,|L1.6760|
0019ac  f9b40054          LDRSH    r0,[r4,#0x54]
0019b0  f9b1101e          LDRSH    r1,[r1,#0x1e]  ; cntrl_stat
0019b4  4408              ADD      r0,r0,r1
0019b6  6360              STR      r0,[r4,#0x34]
;;;3234   bps[in]._vol_i=2000; 
0019b8  f44f60fa          MOV      r0,#0x7d0
0019bc  63a0              STR      r0,[r4,#0x38]
                  |L1.6590|
;;;3235   }
0019be  e8bd81f0          POP      {r4-r8,pc}
;;;3236   
                          ENDP

                  avt_hndl PROC
;;;3237   //-----------------------------------------------
;;;3238   void avt_hndl(void)
0019c2  b570              PUSH     {r4-r6,lr}
;;;3239   {
;;;3240   char i;
;;;3241   for(i=0;i<12;i++)
0019c4  f04f0000          MOV      r0,#0
;;;3242   	{
;;;3243   	if(eb2_data_short[6]&(1<<i))
0019c8  492a              LDR      r1,|L1.6772|
;;;3244   		{
;;;3245   		avt_stat[i]=avtON;
0019ca  4d2b              LDR      r5,|L1.6776|
0019cc  f04f0401          MOV      r4,#1                 ;3243
0019d0  f9b1200c          LDRSH    r2,[r1,#0xc]          ;3243
0019d4  4603              MOV      r3,r0                 ;3241
                  |L1.6614|
0019d6  fa04f100          LSL      r1,r4,r0              ;3243
0019da  420a              TST      r2,r1                 ;3243
0019dc  d001              BEQ      |L1.6626|
0019de  542c              STRB     r4,[r5,r0]
0019e0  e000              B        |L1.6628|
                  |L1.6626|
;;;3246   		}
;;;3247   	else avt_stat[i]=avtOFF;
0019e2  542b              STRB     r3,[r5,r0]
                  |L1.6628|
0019e4  f1000001          ADD      r0,r0,#1              ;3241
0019e8  b2c0              UXTB     r0,r0                 ;3241
0019ea  280c              CMP      r0,#0xc               ;3241
0019ec  d3f3              BCC      |L1.6614|
;;;3248   	}
;;;3249   
;;;3250   if((avt_stat_old[0]!=avt_stat[0])&&(NUMAVT>=1))
0019ee  4e23              LDR      r6,|L1.6780|
0019f0  7828              LDRB     r0,[r5,#0]  ; avt_stat
0019f2  4c23              LDR      r4,|L1.6784|
0019f4  7831              LDRB     r1,[r6,#0]  ; avt_stat_old
0019f6  4281              CMP      r1,r0
0019f8  d00b              BEQ      |L1.6674|
0019fa  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
0019fe  2901              CMP      r1,#1
001a00  db07              BLT      |L1.6674|
;;;3251   	{
;;;3252   	if(avt_stat[0]==avtON) 	snmp_trap_send("Avtomat #1 is ON ",11,1,1);
001a02  2801              CMP      r0,#1
001a04  d07e              BEQ      |L1.6916|
;;;3253   	else 				snmp_trap_send("Avtomat #1 is OFF",11,1,0);
001a06  2300              MOVS     r3,#0
001a08  2201              MOVS     r2,#1
001a0a  210b              MOVS     r1,#0xb
001a0c  a01d              ADR      r0,|L1.6788|
001a0e  f7fffffe          BL       snmp_trap_send
                  |L1.6674|
;;;3254   	}
;;;3255   if((avt_stat_old[1]!=avt_stat[1])&&(NUMAVT>=2))
001a12  7871              LDRB     r1,[r6,#1]  ; avt_stat_old
001a14  7868              LDRB     r0,[r5,#1]  ; avt_stat
001a16  4281              CMP      r1,r0
001a18  d048              BEQ      |L1.6828|
001a1a  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001a1e  e03b              B        |L1.6808|
                  |L1.6688|
                          DCD      power_summary_tempo
                  |L1.6692|
                          DCD      power_summary_tempo_old
                  |L1.6696|
                          DCD      powerSummaryCnt
                  |L1.6700|
                          DCD      power_summary
                  |L1.6704|
                          DCD      power_current_tempo
                  |L1.6708|
                          DCD      power_current_tempo_old
                  |L1.6712|
                          DCD      powerCurrentCnt
                  |L1.6716|
                          DCD      power_current
                  |L1.6720|
                          DCD      ica_timer_cnt
                  |L1.6724|
                          DCD      ICA_EN
                  |L1.6728|
                          DCD      ica_plazma
                  |L1.6732|
                          DCD      bps_I
                  |L1.6736|
                          DCD      ica_my_current
                  |L1.6740|
                          DCD      ica_your_current
                  |L1.6744|
                          DCD      ica_u_necc
                  |L1.6748|
                          DCD      ICA_MODBUS_ADDRESS
                  |L1.6752|
                          DCD      ICA_CH
                  |L1.6756|
                          DCD      TBAT
                  |L1.6760|
                          DCD      ||area_number.26||
                  |L1.6764|
                          DCD      bps
                  |L1.6768|
                          DCD      net_av
                  |L1.6772|
                          DCD      eb2_data_short
                  |L1.6776|
                          DCD      avt_stat
                  |L1.6780|
                          DCD      avt_stat_old
                  |L1.6784|
                          DCD      NUMAVT
                  |L1.6788|
001a84  4176746f          DCB      "Avtomat #1 is OFF",0
001a88  6d617420
001a8c  23312069
001a90  73204f46
001a94  4600    
001a96  00                DCB      0
001a97  00                DCB      0
                  |L1.6808|
001a98  2902              CMP      r1,#2
001a9a  db07              BLT      |L1.6828|
;;;3256   	{
;;;3257   	if(avt_stat[1]==avtON) 	snmp_trap_send("Avtomat #2 is ON ",11,2,1);
001a9c  2801              CMP      r0,#1
001a9e  d07e              BEQ      |L1.7070|
;;;3258   	else 				snmp_trap_send("Avtomat #2 is OFF",11,2,0);
001aa0  2300              MOVS     r3,#0
001aa2  2202              MOVS     r2,#2
001aa4  210b              MOVS     r1,#0xb
001aa6  a0f9              ADR      r0,|L1.7820|
001aa8  f7fffffe          BL       snmp_trap_send
                  |L1.6828|
;;;3259   	}
;;;3260   if((avt_stat_old[2]!=avt_stat[2])&&(NUMAVT>=3))
001aac  78b1              LDRB     r1,[r6,#2]  ; avt_stat_old
001aae  78a8              LDRB     r0,[r5,#2]  ; avt_stat
001ab0  4281              CMP      r1,r0
001ab2  d00b              BEQ      |L1.6860|
001ab4  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001ab8  2903              CMP      r1,#3
001aba  db07              BLT      |L1.6860|
;;;3261   	{
;;;3262   	if(avt_stat[2]==avtON) 	snmp_trap_send("Avtomat #3 is ON ",11,3,1);
001abc  2801              CMP      r0,#1
001abe  d06f              BEQ      |L1.7072|
;;;3263   	else 				snmp_trap_send("Avtomat #3 is OFF",11,3,0);
001ac0  2300              MOVS     r3,#0
001ac2  2203              MOVS     r2,#3
001ac4  210b              MOVS     r1,#0xb
001ac6  a0f6              ADR      r0,|L1.7840|
001ac8  f7fffffe          BL       snmp_trap_send
                  |L1.6860|
;;;3264   	}
;;;3265   if((avt_stat_old[3]!=avt_stat[3])&&(NUMAVT>=4))
001acc  78f1              LDRB     r1,[r6,#3]  ; avt_stat_old
001ace  78e8              LDRB     r0,[r5,#3]  ; avt_stat
001ad0  4281              CMP      r1,r0
001ad2  d00b              BEQ      |L1.6892|
001ad4  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001ad8  2904              CMP      r1,#4
001ada  db07              BLT      |L1.6892|
;;;3266   	{
;;;3267   	if(avt_stat[3]==avtON) 	snmp_trap_send("Avtomat #4 is ON ",11,4,1);
001adc  2801              CMP      r0,#1
001ade  d07a              BEQ      |L1.7126|
;;;3268   	else 				snmp_trap_send("Avtomat #4 is OFF",11,4,0);
001ae0  2300              MOVS     r3,#0
001ae2  2204              MOVS     r2,#4
001ae4  210b              MOVS     r1,#0xb
001ae6  a0f3              ADR      r0,|L1.7860|
001ae8  f7fffffe          BL       snmp_trap_send
                  |L1.6892|
;;;3269   	}
;;;3270   if((avt_stat_old[4]!=avt_stat[4])&&(NUMAVT>=5))
001aec  7931              LDRB     r1,[r6,#4]  ; avt_stat_old
001aee  7928              LDRB     r0,[r5,#4]  ; avt_stat
001af0  4281              CMP      r1,r0
001af2  d00d              BEQ      |L1.6928|
001af4  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001af8  2905              CMP      r1,#5
001afa  db09              BLT      |L1.6928|
;;;3271   	{
;;;3272   	if(avt_stat[4]==avtON) 	snmp_trap_send("Avtomat #5 is ON ",11,5,1);
001afc  2801              CMP      r0,#1
001afe  d072              BEQ      |L1.7142|
;;;3273   	else 				snmp_trap_send("Avtomat #5 is OFF",11,5,0);
001b00  2300              MOVS     r3,#0
001b02  e000              B        |L1.6918|
                  |L1.6916|
001b04  e051              B        |L1.7082|
                  |L1.6918|
001b06  2205              MOVS     r2,#5
001b08  210b              MOVS     r1,#0xb
001b0a  a0ef              ADR      r0,|L1.7880|
001b0c  f7fffffe          BL       snmp_trap_send
                  |L1.6928|
;;;3274   	}
;;;3275   if((avt_stat_old[5]!=avt_stat[5])&&(NUMAVT>=6))
001b10  7971              LDRB     r1,[r6,#5]  ; avt_stat_old
001b12  7968              LDRB     r0,[r5,#5]  ; avt_stat
001b14  4281              CMP      r1,r0
001b16  d00b              BEQ      |L1.6960|
001b18  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b1c  2906              CMP      r1,#6
001b1e  db07              BLT      |L1.6960|
;;;3276   	{
;;;3277   	if(avt_stat[5]==avtON) 	snmp_trap_send("Avtomat #6 is ON ",11,6,1);
001b20  2801              CMP      r0,#1
001b22  d067              BEQ      |L1.7156|
;;;3278   	else 				snmp_trap_send("Avtomat #6 is OFF",11,6,0);
001b24  2300              MOVS     r3,#0
001b26  2206              MOVS     r2,#6
001b28  210b              MOVS     r1,#0xb
001b2a  a0ec              ADR      r0,|L1.7900|
001b2c  f7fffffe          BL       snmp_trap_send
                  |L1.6960|
;;;3279   	}
;;;3280   if((avt_stat_old[6]!=avt_stat[6])&&(NUMAVT>=7))
001b30  79b1              LDRB     r1,[r6,#6]  ; avt_stat_old
001b32  79a8              LDRB     r0,[r5,#6]  ; avt_stat
001b34  4281              CMP      r1,r0
001b36  d00b              BEQ      |L1.6992|
001b38  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b3c  2907              CMP      r1,#7
001b3e  db07              BLT      |L1.6992|
;;;3281   	{
;;;3282   	if(avt_stat[6]==avtON) 	snmp_trap_send("Avtomat #7 is ON ",11,7,1);
001b40  2801              CMP      r0,#1
001b42  d05e              BEQ      |L1.7170|
;;;3283   	else 				snmp_trap_send("Avtomat #7 is OFF",11,7,0);
001b44  2300              MOVS     r3,#0
001b46  2207              MOVS     r2,#7
001b48  210b              MOVS     r1,#0xb
001b4a  a0e9              ADR      r0,|L1.7920|
001b4c  f7fffffe          BL       snmp_trap_send
                  |L1.6992|
;;;3284   	}
;;;3285   if((avt_stat_old[7]!=avt_stat[7])&&(NUMAVT>=8))
001b50  79f1              LDRB     r1,[r6,#7]  ; avt_stat_old
001b52  79e8              LDRB     r0,[r5,#7]  ; avt_stat
001b54  4281              CMP      r1,r0
001b56  d00b              BEQ      |L1.7024|
001b58  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b5c  2908              CMP      r1,#8
001b5e  db07              BLT      |L1.7024|
;;;3286   	{
;;;3287   	if(avt_stat[7]==avtON) 	snmp_trap_send("Avtomat #8 is ON ",11,8,1);
001b60  2801              CMP      r0,#1
001b62  d055              BEQ      |L1.7184|
;;;3288   	else 				snmp_trap_send("Avtomat #8 is OFF",11,8,0);
001b64  2300              MOVS     r3,#0
001b66  2208              MOVS     r2,#8
001b68  210b              MOVS     r1,#0xb
001b6a  a0e6              ADR      r0,|L1.7940|
001b6c  f7fffffe          BL       snmp_trap_send
                  |L1.7024|
;;;3289   	}
;;;3290   if((avt_stat_old[8]!=avt_stat[8])&&(NUMAVT>=9))
001b70  7a31              LDRB     r1,[r6,#8]  ; avt_stat_old
001b72  7a28              LDRB     r0,[r5,#8]  ; avt_stat
001b74  4281              CMP      r1,r0
001b76  d00b              BEQ      |L1.7056|
001b78  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
001b7c  2909              CMP      r1,#9
001b7e  db07              BLT      |L1.7056|
;;;3291   	{
;;;3292   	if(avt_stat[8]==avtON) 	snmp_trap_send("Avtomat #9 is ON ",11,9,1);
001b80  2801              CMP      r0,#1
001b82  d04c              BEQ      |L1.7198|
;;;3293   	else 				snmp_trap_send("Avtomat #9 is OFF",11,9,0);
001b84  2300              MOVS     r3,#0
001b86  2209              MOVS     r2,#9
001b88  210b              MOVS     r1,#0xb
001b8a  a0e3              ADR      r0,|L1.7960|
001b8c  f7fffffe          BL       snmp_trap_send
                  |L1.7056|
;;;3294   	}
;;;3295   
;;;3296   for(i=0;i<12;i++)
001b90  f04f0000          MOV      r0,#0
                  |L1.7060|
;;;3297   	{
;;;3298   	avt_stat_old[i]=avt_stat[i];
001b94  5c29              LDRB     r1,[r5,r0]
001b96  5431              STRB     r1,[r6,r0]
001b98  f1000001          ADD      r0,r0,#1              ;3296
001b9c  e001              B        |L1.7074|
                  |L1.7070|
001b9e  e00b              B        |L1.7096|
                  |L1.7072|
001ba0  e012              B        |L1.7112|
                  |L1.7074|
001ba2  b2c0              UXTB     r0,r0                 ;3296
001ba4  280c              CMP      r0,#0xc               ;3296
001ba6  d3f5              BCC      |L1.7060|
;;;3299   	}
;;;3300   }
001ba8  bd70              POP      {r4-r6,pc}
                  |L1.7082|
001baa  2301              MOVS     r3,#1                 ;3252
001bac  461a              MOV      r2,r3                 ;3252
001bae  210b              MOVS     r1,#0xb               ;3252
001bb0  a0de              ADR      r0,|L1.7980|
001bb2  f7fffffe          BL       snmp_trap_send
001bb6  e72c              B        |L1.6674|
                  |L1.7096|
001bb8  2301              MOVS     r3,#1                 ;3257
001bba  2202              MOVS     r2,#2                 ;3257
001bbc  210b              MOVS     r1,#0xb               ;3257
001bbe  a0e0              ADR      r0,|L1.8000|
001bc0  f7fffffe          BL       snmp_trap_send
001bc4  e772              B        |L1.6828|
001bc6  e006              B        |L1.7126|
                  |L1.7112|
001bc8  2301              MOVS     r3,#1                 ;3262
001bca  2203              MOVS     r2,#3                 ;3262
001bcc  210b              MOVS     r1,#0xb               ;3262
001bce  a0e1              ADR      r0,|L1.8020|
001bd0  f7fffffe          BL       snmp_trap_send
001bd4  e77a              B        |L1.6860|
                  |L1.7126|
001bd6  2301              MOVS     r3,#1                 ;3267
001bd8  2204              MOVS     r2,#4                 ;3267
001bda  210b              MOVS     r1,#0xb               ;3267
001bdc  a0e2              ADR      r0,|L1.8040|
001bde  f7fffffe          BL       snmp_trap_send
001be2  e783              B        |L1.6892|
001be4  e7ff              B        |L1.7142|
                  |L1.7142|
001be6  2301              MOVS     r3,#1                 ;3272
001be8  2205              MOVS     r2,#5                 ;3272
001bea  210b              MOVS     r1,#0xb               ;3272
001bec  a0e3              ADR      r0,|L1.8060|
001bee  f7fffffe          BL       snmp_trap_send
001bf2  e78d              B        |L1.6928|
                  |L1.7156|
001bf4  2301              MOVS     r3,#1                 ;3277
001bf6  2206              MOVS     r2,#6                 ;3277
001bf8  210b              MOVS     r1,#0xb               ;3277
001bfa  a0e5              ADR      r0,|L1.8080|
001bfc  f7fffffe          BL       snmp_trap_send
001c00  e796              B        |L1.6960|
                  |L1.7170|
001c02  2301              MOVS     r3,#1                 ;3282
001c04  2207              MOVS     r2,#7                 ;3282
001c06  210b              MOVS     r1,#0xb               ;3282
001c08  a0e6              ADR      r0,|L1.8100|
001c0a  f7fffffe          BL       snmp_trap_send
001c0e  e79f              B        |L1.6992|
                  |L1.7184|
001c10  2301              MOVS     r3,#1                 ;3287
001c12  2208              MOVS     r2,#8                 ;3287
001c14  210b              MOVS     r1,#0xb               ;3287
001c16  a0e8              ADR      r0,|L1.8120|
001c18  f7fffffe          BL       snmp_trap_send
001c1c  e7a8              B        |L1.7024|
                  |L1.7198|
001c1e  2301              MOVS     r3,#1                 ;3292
001c20  2209              MOVS     r2,#9                 ;3292
001c22  210b              MOVS     r1,#0xb               ;3292
001c24  a0e9              ADR      r0,|L1.8140|
001c26  f7fffffe          BL       snmp_trap_send
001c2a  e7b1              B        |L1.7056|
;;;3301   
                          ENDP

                  overload_hndl PROC
;;;4042   //-----------------------------------------------
;;;4043   void overload_hndl(void)
001c2c  b430              PUSH     {r4,r5}
;;;4044   {
;;;4045   
;;;4046   if(main_1Hz_cnt<30)return;
001c2e  48ec              LDR      r0,|L1.8160|
001c30  f9b00000          LDRSH    r0,[r0,#0]  ; main_1Hz_cnt
001c34  281e              CMP      r0,#0x1e
001c36  db2e              BLT      |L1.7318|
;;;4047   
;;;4048   if((out_U<UOUT)&&((UOUT-out_U)>50))
001c38  48ea              LDR      r0,|L1.8164|
;;;4049   	{
;;;4050   	if(overloadHndlCnt<(TZAS*10))
001c3a  4bec              LDR      r3,|L1.8172|
001c3c  f9b02000          LDRSH    r2,[r0,#0]            ;4048  ; out_U
001c40  48e9              LDR      r0,|L1.8168|
001c42  f9b01000          LDRSH    r1,[r0,#0]            ;4048  ; UOUT
001c46  f9b30000          LDRSH    r0,[r3,#0]
001c4a  428a              CMP      r2,r1                 ;4048
001c4c  da15              BGE      |L1.7290|
001c4e  1a8c              SUBS     r4,r1,r2              ;4048
001c50  2c32              CMP      r4,#0x32              ;4048
001c52  dd12              BLE      |L1.7290|
001c54  49e6              LDR      r1,|L1.8176|
001c56  f9b11000          LDRSH    r1,[r1,#0]  ; TZAS
001c5a  eb010181          ADD      r1,r1,r1,LSL #2
001c5e  ebb00f41          CMP      r0,r1,LSL #1
001c62  da18              BGE      |L1.7318|
;;;4051   		{
;;;4052   		overloadHndlCnt++;
001c64  f1000001          ADD      r0,r0,#1
001c68  b200              SXTH     r0,r0
001c6a  8018              STRH     r0,[r3,#0]
;;;4053   		if(overloadHndlCnt==(TZAS*10))
001c6c  ebb00f41          CMP      r0,r1,LSL #1
001c70  d111              BNE      |L1.7318|
;;;4054   			{
;;;4055   			avar_overload_hndl(1);
001c72  bc30              POP      {r4,r5}
001c74  2001              MOVS     r0,#1
001c76  f7ffbffe          B.W      avar_overload_hndl
                  |L1.7290|
;;;4056   			}
;;;4057   		}
;;;4058   	}
;;;4059   else if(out_U>(UOUT-20))
001c7a  3914              SUBS     r1,r1,#0x14
001c7c  428a              CMP      r2,r1
001c7e  dd0a              BLE      |L1.7318|
;;;4060   	{
;;;4061   	if(overloadHndlCnt)
001c80  2800              CMP      r0,#0
001c82  d008              BEQ      |L1.7318|
;;;4062   		{
;;;4063   		overloadHndlCnt--;
001c84  f1a00001          SUB      r0,r0,#1
001c88  b200              SXTH     r0,r0
001c8a  8018              STRH     r0,[r3,#0]
;;;4064   		if(overloadHndlCnt==0)
001c8c  2800              CMP      r0,#0
001c8e  d102              BNE      |L1.7318|
;;;4065   			{
;;;4066   			avar_overload_hndl(0);
001c90  bc30              POP      {r4,r5}
001c92  f7ffbffe          B.W      avar_overload_hndl
                  |L1.7318|
;;;4067   			}
;;;4068   		}
;;;4069   	}
;;;4070   
;;;4071   }
001c96  bc30              POP      {r4,r5}
001c98  4770              BX       lr
;;;4072   
                          ENDP

                  u_avar_hndl PROC
;;;4073   //-----------------------------------------------
;;;4074   void u_avar_hndl(void)
001c9a  e92d41f0          PUSH     {r4-r8,lr}
;;;4075   {
;;;4076   
;;;4077   if(main_1Hz_cnt<10)return;
001c9e  48d0              LDR      r0,|L1.8160|
001ca0  f9b00000          LDRSH    r0,[r0,#0]  ; main_1Hz_cnt
001ca4  280a              CMP      r0,#0xa
001ca6  db7d              BLT      |L1.7588|
;;;4078   
;;;4079   if(out_U>UOUTMAX)
001ca8  4ece              LDR      r6,|L1.8164|
001caa  48d2              LDR      r0,|L1.8180|
;;;4080   	{
;;;4081   	if(uAvarHndlOutUMaxCnt<(10*TZAS))
001cac  4fd2              LDR      r7,|L1.8184|
001cae  f9b61000          LDRSH    r1,[r6,#0]            ;4079  ; out_U
001cb2  f9b02000          LDRSH    r2,[r0,#0]            ;4079  ; UOUTMAX
001cb6  f9b70000          LDRSH    r0,[r7,#0]
001cba  2500              MOVS     r5,#0
001cbc  4ccc              LDR      r4,|L1.8176|
001cbe  4291              CMP      r1,r2                 ;4079
001cc0  dd17              BLE      |L1.7410|
001cc2  f9b42000          LDRSH    r2,[r4,#0]  ; TZAS
001cc6  eb020382          ADD      r3,r2,r2,LSL #2
001cca  ebb00f43          CMP      r0,r3,LSL #1
001cce  da0a              BGE      |L1.7398|
;;;4082   		{
;;;4083   		uAvarHndlOutUMaxCnt++;
001cd0  f1000001          ADD      r0,r0,#1
001cd4  b200              SXTH     r0,r0
001cd6  8038              STRH     r0,[r7,#0]
;;;4084   		if(uAvarHndlOutUMaxCnt>=(10*TZAS))
001cd8  ebb00f43          CMP      r0,r3,LSL #1
001cdc  db15              BLT      |L1.7434|
;;;4085   			{
;;;4086   			avar_u_out_hndl(1,out_U);
001cde  2001              MOVS     r0,#1
001ce0  f7fffffe          BL       avar_u_out_hndl
001ce4  e011              B        |L1.7434|
                  |L1.7398|
;;;4087   			}
;;;4088   		}
;;;4089   	else uAvarHndlOutUMaxCnt=(10*TZAS);
001ce6  eb020082          ADD      r0,r2,r2,LSL #2
001cea  ea4f0040          LSL      r0,r0,#1
001cee  8038              STRH     r0,[r7,#0]
001cf0  e00b              B        |L1.7434|
                  |L1.7410|
;;;4090   	}
;;;4091   else 
;;;4092   	{
;;;4093   	if(uAvarHndlOutUMaxCnt>0)
001cf2  2800              CMP      r0,#0
001cf4  dd08              BLE      |L1.7432|
;;;4094   		{
;;;4095   		uAvarHndlOutUMaxCnt--;
001cf6  f1a00001          SUB      r0,r0,#1
001cfa  b200              SXTH     r0,r0
001cfc  8038              STRH     r0,[r7,#0]
;;;4096   		if(uAvarHndlOutUMaxCnt==0)
001cfe  b920              CBNZ     r0,|L1.7434|
;;;4097   			{
;;;4098   			avar_u_out_hndl(0,out_U);
001d00  2000              MOVS     r0,#0
001d02  f7fffffe          BL       avar_u_out_hndl
001d06  e000              B        |L1.7434|
                  |L1.7432|
;;;4099   			}
;;;4100   		}
;;;4101   	else uAvarHndlOutUMaxCnt=0;
001d08  803d              STRH     r5,[r7,#0]
                  |L1.7434|
;;;4102   	}
;;;4103   
;;;4104   if(out_U<UOUTMIN)
001d0a  48bc              LDR      r0,|L1.8188|
001d0c  f9b61000          LDRSH    r1,[r6,#0]  ; out_U
;;;4105   	{
;;;4106   	if(uAvarHndlOutUMinCnt<(10*TZAS))
001d10  4ebb              LDR      r6,|L1.8192|
001d12  f9b00000          LDRSH    r0,[r0,#0]            ;4104  ; UOUTMIN
001d16  4281              CMP      r1,r0                 ;4104
001d18  da19              BGE      |L1.7502|
001d1a  f9b40000          LDRSH    r0,[r4,#0]  ; TZAS
001d1e  f9b62000          LDRSH    r2,[r6,#0]  ; uAvarHndlOutUMinCnt
001d22  eb000380          ADD      r3,r0,r0,LSL #2
001d26  ebb20f43          CMP      r2,r3,LSL #1
001d2a  da0a              BGE      |L1.7490|
;;;4107   		{
;;;4108   		uAvarHndlOutUMinCnt++;
001d2c  f1020201          ADD      r2,r2,#1
001d30  b210              SXTH     r0,r2
001d32  8030              STRH     r0,[r6,#0]
;;;4109   		if(uAvarHndlOutUMinCnt>=(10*TZAS))
001d34  ebb00f43          CMP      r0,r3,LSL #1
001d38  db17              BLT      |L1.7530|
;;;4110   			{
;;;4111   			avar_u_out_hndl(2,out_U);
001d3a  2002              MOVS     r0,#2
001d3c  f7fffffe          BL       avar_u_out_hndl
001d40  e013              B        |L1.7530|
                  |L1.7490|
;;;4112   			}
;;;4113   		}
;;;4114   	else uAvarHndlOutUMinCnt=(10*TZAS);
001d42  eb000080          ADD      r0,r0,r0,LSL #2
001d46  ea4f0040          LSL      r0,r0,#1
001d4a  8030              STRH     r0,[r6,#0]
001d4c  e00d              B        |L1.7530|
                  |L1.7502|
;;;4115   	}
;;;4116   else 
;;;4117   	{
;;;4118   	if(uAvarHndlOutUMinCnt>0)
001d4e  f9b60000          LDRSH    r0,[r6,#0]  ; uAvarHndlOutUMinCnt
001d52  2800              CMP      r0,#0
001d54  dd08              BLE      |L1.7528|
;;;4119   		{
;;;4120   		uAvarHndlOutUMinCnt--;
001d56  f1a00001          SUB      r0,r0,#1
001d5a  b200              SXTH     r0,r0
001d5c  8030              STRH     r0,[r6,#0]
;;;4121   		if(uAvarHndlOutUMinCnt==0)
001d5e  b920              CBNZ     r0,|L1.7530|
;;;4122   			{
;;;4123   			avar_u_out_hndl(0,out_U);
001d60  2000              MOVS     r0,#0
001d62  f7fffffe          BL       avar_u_out_hndl
001d66  e000              B        |L1.7530|
                  |L1.7528|
;;;4124   			}
;;;4125   		}
;;;4126   	else uAvarHndlOutUMinCnt=0;
001d68  8035              STRH     r5,[r6,#0]
                  |L1.7530|
;;;4127   	}
;;;4128   
;;;4129   if(in_U>UINMAX)
001d6a  4ea6              LDR      r6,|L1.8196|
001d6c  48a6              LDR      r0,|L1.8200|
;;;4130   	{
;;;4131   	if(uAvarHndlInUMaxCnt<(10*TZAS))
001d6e  4fa7              LDR      r7,|L1.8204|
001d70  f9b61000          LDRSH    r1,[r6,#0]            ;4129  ; in_U
001d74  f9b00000          LDRSH    r0,[r0,#0]            ;4129  ; UINMAX
001d78  4281              CMP      r1,r0                 ;4129
001d7a  dd1a              BLE      |L1.7602|
001d7c  f9b40000          LDRSH    r0,[r4,#0]  ; TZAS
001d80  f9b72000          LDRSH    r2,[r7,#0]  ; uAvarHndlInUMaxCnt
001d84  eb000380          ADD      r3,r0,r0,LSL #2
001d88  ebb20f43          CMP      r2,r3,LSL #1
001d8c  da0b              BGE      |L1.7590|
;;;4132   		{
;;;4133   		uAvarHndlInUMaxCnt++;
001d8e  f1020201          ADD      r2,r2,#1
001d92  b210              SXTH     r0,r2
001d94  8038              STRH     r0,[r7,#0]
;;;4134   		if(uAvarHndlInUMaxCnt>=(10*TZAS))
001d96  ebb00f43          CMP      r0,r3,LSL #1
001d9a  db18              BLT      |L1.7630|
;;;4135   			{
;;;4136   			avar_u_in_hndl(1,in_U);
001d9c  2001              MOVS     r0,#1
001d9e  f7fffffe          BL       avar_u_in_hndl
001da2  e014              B        |L1.7630|
                  |L1.7588|
001da4  e035              B        |L1.7698|
                  |L1.7590|
;;;4137   			}
;;;4138   		}
;;;4139   	else uAvarHndlInUMaxCnt=(10*TZAS);
001da6  eb000080          ADD      r0,r0,r0,LSL #2
001daa  ea4f0040          LSL      r0,r0,#1
001dae  8038              STRH     r0,[r7,#0]
001db0  e00d              B        |L1.7630|
                  |L1.7602|
;;;4140   	}
;;;4141   else 
;;;4142   	{
;;;4143   	if(uAvarHndlInUMaxCnt>0)
001db2  f9b70000          LDRSH    r0,[r7,#0]  ; uAvarHndlInUMaxCnt
001db6  2800              CMP      r0,#0
001db8  dd08              BLE      |L1.7628|
;;;4144   		{
;;;4145   		uAvarHndlInUMaxCnt--;
001dba  f1a00001          SUB      r0,r0,#1
001dbe  b200              SXTH     r0,r0
001dc0  8038              STRH     r0,[r7,#0]
;;;4146   		if(uAvarHndlInUMaxCnt==0)
001dc2  b920              CBNZ     r0,|L1.7630|
;;;4147   			{
;;;4148   			avar_u_in_hndl(0,in_U);
001dc4  2000              MOVS     r0,#0
001dc6  f7fffffe          BL       avar_u_in_hndl
001dca  e000              B        |L1.7630|
                  |L1.7628|
;;;4149   			}
;;;4150   		}
;;;4151   	else uAvarHndlInUMaxCnt=0;
001dcc  803d              STRH     r5,[r7,#0]
                  |L1.7630|
;;;4152   	}
;;;4153   
;;;4154   if(in_U<UINMIN)
001dce  4890              LDR      r0,|L1.8208|
001dd0  f9b61000          LDRSH    r1,[r6,#0]  ; in_U
;;;4155   	{
;;;4156   	if(uAvarHndlInUMinCnt<(10*TZAS))
001dd4  4e8f              LDR      r6,|L1.8212|
001dd6  f9b00000          LDRSH    r0,[r0,#0]            ;4154  ; UINMIN
001dda  4281              CMP      r1,r0                 ;4154
001ddc  da1a              BGE      |L1.7700|
001dde  f9b40000          LDRSH    r0,[r4,#0]  ; TZAS
001de2  f9b62000          LDRSH    r2,[r6,#0]  ; uAvarHndlInUMinCnt
001de6  eb000380          ADD      r3,r0,r0,LSL #2
001dea  ebb20f43          CMP      r2,r3,LSL #1
001dee  da0b              BGE      |L1.7688|
;;;4157   		{
;;;4158   		uAvarHndlInUMinCnt++;
001df0  f1020201          ADD      r2,r2,#1
001df4  b210              SXTH     r0,r2
001df6  8030              STRH     r0,[r6,#0]
;;;4159   		if(uAvarHndlInUMinCnt>=(10*TZAS))
001df8  ebb00f43          CMP      r0,r3,LSL #1
001dfc  db09              BLT      |L1.7698|
;;;4160   			{
;;;4161   			avar_u_in_hndl(2,in_U);
001dfe  e8bd41f0          POP      {r4-r8,lr}
001e02  2002              MOVS     r0,#2
001e04  f7ffbffe          B.W      avar_u_in_hndl
                  |L1.7688|
;;;4162   			}
;;;4163   		}
;;;4164   	else uAvarHndlInUMinCnt=(10*TZAS);
001e08  eb000080          ADD      r0,r0,r0,LSL #2
001e0c  ea4f0040          LSL      r0,r0,#1
001e10  8030              STRH     r0,[r6,#0]
                  |L1.7698|
;;;4165   	}
;;;4166   else 
;;;4167   	{
;;;4168   	if(uAvarHndlInUMinCnt>0)
;;;4169   		{
;;;4170   		uAvarHndlInUMinCnt--;
;;;4171   		if(uAvarHndlInUMinCnt==0)
;;;4172   			{
;;;4173   			avar_u_in_hndl(0,in_U);
;;;4174   			}
;;;4175   		}
;;;4176   	else uAvarHndlInUMinCnt=0;
;;;4177   	}
;;;4178   }
001e12  e5d4              B        |L1.6590|
                  |L1.7700|
001e14  f9b60000          LDRSH    r0,[r6,#0]            ;4168  ; uAvarHndlInUMinCnt
001e18  2800              CMP      r0,#0                 ;4168
001e1a  dd09              BLE      |L1.7728|
001e1c  f1a00001          SUB      r0,r0,#1              ;4170
001e20  b200              SXTH     r0,r0                 ;4170
001e22  8030              STRH     r0,[r6,#0]            ;4170
001e24  2800              CMP      r0,#0                 ;4171
001e26  d1f4              BNE      |L1.7698|
001e28  e8bd41f0          POP      {r4-r8,lr}            ;4173
001e2c  f7ffbffe          B.W      avar_u_in_hndl
                  |L1.7728|
001e30  8035              STRH     r5,[r6,#0]            ;4176
001e32  e5c4              B        |L1.6590|
;;;4179   
                          ENDP

                  t_sys_avar_hndl PROC
;;;4180   //-----------------------------------------------
;;;4181   void t_sys_avar_hndl(void)
001e34  b430              PUSH     {r4,r5}
;;;4182   {
;;;4183   
;;;4184   if(main_1Hz_cnt<10)return;
001e36  486a              LDR      r0,|L1.8160|
001e38  f9b00000          LDRSH    r0,[r0,#0]  ; main_1Hz_cnt
001e3c  280a              CMP      r0,#0xa
001e3e  db22              BLT      |L1.7814|
;;;4185   
;;;4186   if(sys_T>TSYSMAX)
001e40  4875              LDR      r0,|L1.8216|
;;;4187   	{
;;;4188   	if(sysTAvarHndlCnt<(10*TZAS))
001e42  4c77              LDR      r4,|L1.8224|
001e44  f9b01000          LDRSH    r1,[r0,#0]            ;4186  ; sys_T
001e48  4874              LDR      r0,|L1.8220|
001e4a  f9b02000          LDRSH    r2,[r0,#0]            ;4186  ; TSYSMAX
001e4e  f9b40000          LDRSH    r0,[r4,#0]
001e52  4291              CMP      r1,r2                 ;4186
001e54  dd18              BLE      |L1.7816|
001e56  4a66              LDR      r2,|L1.8176|
001e58  f9b22000          LDRSH    r2,[r2,#0]  ; TZAS
001e5c  eb020382          ADD      r3,r2,r2,LSL #2
001e60  ebb00f43          CMP      r0,r3,LSL #1
001e64  da0a              BGE      |L1.7804|
;;;4189   		{
;;;4190   		sysTAvarHndlCnt++;
001e66  f1000001          ADD      r0,r0,#1
001e6a  b200              SXTH     r0,r0
001e6c  8020              STRH     r0,[r4,#0]
;;;4191   		if(sysTAvarHndlCnt>=(10*TZAS))
001e6e  ebb00f43          CMP      r0,r3,LSL #1
001e72  db08              BLT      |L1.7814|
;;;4192   			{
;;;4193   			avar_sys_t_hndl(1,sys_T);
001e74  bc30              POP      {r4,r5}
001e76  2001              MOVS     r0,#1
001e78  f7ffbffe          B.W      avar_sys_t_hndl
                  |L1.7804|
;;;4194   			}
;;;4195   		}
;;;4196   	else sysTAvarHndlCnt=(10*TZAS);
001e7c  eb020082          ADD      r0,r2,r2,LSL #2
001e80  ea4f0040          LSL      r0,r0,#1
001e84  8020              STRH     r0,[r4,#0]
                  |L1.7814|
;;;4197   	}
;;;4198   else 
;;;4199   	{
;;;4200   	if(sysTAvarHndlCnt>0)
;;;4201   		{
;;;4202   		sysTAvarHndlCnt--;
;;;4203   		if(sysTAvarHndlCnt==0)
;;;4204   			{
;;;4205   			avar_sys_t_hndl(0,sys_T);
;;;4206   			}
;;;4207   		}
;;;4208   	else sysTAvarHndlCnt=0;
;;;4209   	}
;;;4210   }
001e86  e706              B        |L1.7318|
                  |L1.7816|
001e88  e0cc              B        |L1.8228|
001e8a  0000              DCW      0x0000
                  |L1.7820|
001e8c  4176746f          DCB      "Avtomat #2 is OFF",0
001e90  6d617420
001e94  23322069
001e98  73204f46
001e9c  4600    
001e9e  00                DCB      0
001e9f  00                DCB      0
                  |L1.7840|
001ea0  4176746f          DCB      "Avtomat #3 is OFF",0
001ea4  6d617420
001ea8  23332069
001eac  73204f46
001eb0  4600    
001eb2  00                DCB      0
001eb3  00                DCB      0
                  |L1.7860|
001eb4  4176746f          DCB      "Avtomat #4 is OFF",0
001eb8  6d617420
001ebc  23342069
001ec0  73204f46
001ec4  4600    
001ec6  00                DCB      0
001ec7  00                DCB      0
                  |L1.7880|
001ec8  4176746f          DCB      "Avtomat #5 is OFF",0
001ecc  6d617420
001ed0  23352069
001ed4  73204f46
001ed8  4600    
001eda  00                DCB      0
001edb  00                DCB      0
                  |L1.7900|
001edc  4176746f          DCB      "Avtomat #6 is OFF",0
001ee0  6d617420
001ee4  23362069
001ee8  73204f46
001eec  4600    
001eee  00                DCB      0
001eef  00                DCB      0
                  |L1.7920|
001ef0  4176746f          DCB      "Avtomat #7 is OFF",0
001ef4  6d617420
001ef8  23372069
001efc  73204f46
001f00  4600    
001f02  00                DCB      0
001f03  00                DCB      0
                  |L1.7940|
001f04  4176746f          DCB      "Avtomat #8 is OFF",0
001f08  6d617420
001f0c  23382069
001f10  73204f46
001f14  4600    
001f16  00                DCB      0
001f17  00                DCB      0
                  |L1.7960|
001f18  4176746f          DCB      "Avtomat #9 is OFF",0
001f1c  6d617420
001f20  23392069
001f24  73204f46
001f28  4600    
001f2a  00                DCB      0
001f2b  00                DCB      0
                  |L1.7980|
001f2c  4176746f          DCB      "Avtomat #1 is ON ",0
001f30  6d617420
001f34  23312069
001f38  73204f4e
001f3c  2000    
001f3e  00                DCB      0
001f3f  00                DCB      0
                  |L1.8000|
001f40  4176746f          DCB      "Avtomat #2 is ON ",0
001f44  6d617420
001f48  23322069
001f4c  73204f4e
001f50  2000    
001f52  00                DCB      0
001f53  00                DCB      0
                  |L1.8020|
001f54  4176746f          DCB      "Avtomat #3 is ON ",0
001f58  6d617420
001f5c  23332069
001f60  73204f4e
001f64  2000    
001f66  00                DCB      0
001f67  00                DCB      0
                  |L1.8040|
001f68  4176746f          DCB      "Avtomat #4 is ON ",0
001f6c  6d617420
001f70  23342069
001f74  73204f4e
001f78  2000    
001f7a  00                DCB      0
001f7b  00                DCB      0
                  |L1.8060|
001f7c  4176746f          DCB      "Avtomat #5 is ON ",0
001f80  6d617420
001f84  23352069
001f88  73204f4e
001f8c  2000    
001f8e  00                DCB      0
001f8f  00                DCB      0
                  |L1.8080|
001f90  4176746f          DCB      "Avtomat #6 is ON ",0
001f94  6d617420
001f98  23362069
001f9c  73204f4e
001fa0  2000    
001fa2  00                DCB      0
001fa3  00                DCB      0
                  |L1.8100|
001fa4  4176746f          DCB      "Avtomat #7 is ON ",0
001fa8  6d617420
001fac  23372069
001fb0  73204f4e
001fb4  2000    
001fb6  00                DCB      0
001fb7  00                DCB      0
                  |L1.8120|
001fb8  4176746f          DCB      "Avtomat #8 is ON ",0
001fbc  6d617420
001fc0  23382069
001fc4  73204f4e
001fc8  2000    
001fca  00                DCB      0
001fcb  00                DCB      0
                  |L1.8140|
001fcc  4176746f          DCB      "Avtomat #9 is ON ",0
001fd0  6d617420
001fd4  23392069
001fd8  73204f4e
001fdc  2000    
001fde  00                DCB      0
001fdf  00                DCB      0
                  |L1.8160|
                          DCD      main_1Hz_cnt
                  |L1.8164|
                          DCD      out_U
                  |L1.8168|
                          DCD      UOUT
                  |L1.8172|
                          DCD      overloadHndlCnt
                  |L1.8176|
                          DCD      TZAS
                  |L1.8180|
                          DCD      UOUTMAX
                  |L1.8184|
                          DCD      uAvarHndlOutUMaxCnt
                  |L1.8188|
                          DCD      UOUTMIN
                  |L1.8192|
                          DCD      uAvarHndlOutUMinCnt
                  |L1.8196|
                          DCD      in_U
                  |L1.8200|
                          DCD      UINMAX
                  |L1.8204|
                          DCD      uAvarHndlInUMaxCnt
                  |L1.8208|
                          DCD      UINMIN
                  |L1.8212|
                          DCD      uAvarHndlInUMinCnt
                  |L1.8216|
                          DCD      sys_T
                  |L1.8220|
                          DCD      TSYSMAX
                  |L1.8224|
                          DCD      sysTAvarHndlCnt
                  |L1.8228|
002024  2800              CMP      r0,#0                 ;4200
002026  dd09              BLE      |L1.8252|
002028  f1a00001          SUB      r0,r0,#1              ;4202
00202c  b200              SXTH     r0,r0                 ;4202
00202e  8020              STRH     r0,[r4,#0]            ;4202
002030  2800              CMP      r0,#0                 ;4203
002032  f47faf28          BNE      |L1.7814|
002036  bc30              POP      {r4,r5}               ;4205
002038  f7ffbffe          B.W      avar_sys_t_hndl
                  |L1.8252|
00203c  f04f0000          MOV      r0,#0                 ;4208
002040  8020              STRH     r0,[r4,#0]            ;4208
002042  e628              B        |L1.7318|
;;;4211   
                          ENDP

                  u_necc_hndl PROC
;;;4213   //-----------------------------------------------
;;;4214   void u_necc_hndl(void)
002044  b538              PUSH     {r3-r5,lr}
;;;4215   {
;;;4216   signed long temp_L;
;;;4217   signed long temp_SL;
;;;4218   //signed short temp_SS;
;;;4219   
;;;4220   //char i;
;;;4221   
;;;4222   //temp_SS=0;
;;;4223   signed short t[2];
;;;4224   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4225   
;;;4226   if(!TERMOKOMPENS)
002046  49ff              LDR      r1,|L1.9284|
;;;4227   	{
;;;4228   	//u_necc=U0B;
;;;4229   	//u_necc=UB20;
;;;4230   	}
;;;4231   else
;;;4232   	{
;;;4233   	if(ND_EXT[0])t[0]=20;
;;;4234   	else t[0]=t_ext[0];
;;;4235   
;;;4236   	mat_temper=t[0];
;;;4237   			
;;;4238   /*	if(mat_temper<0)temp_SL=UB0; 
;;;4239   	else 
;;;4240   		{
;;;4241   		if(mat_temper>40)mat_temper=40; 
;;;4242   		temp_SL=(UB20-UB0)*10;
;;;4243   		temp_SL*=mat_temper;
;;;4244   		temp_SL/=200;
;;;4245   		temp_SL+=UB0;
;;;4246   		}			  */
;;;4247   	if(spc_stat==spcVZ)
;;;4248   		{
;;;4249   		//temp_SL=UVZ;
;;;4250   		}
;;;4251   	u_necc=(unsigned int)temp_SL;
002048  4cff              LDR      r4,|L1.9288|
00204a  8809              LDRH     r1,[r1,#0]            ;4226  ; TERMOKOMPENS
00204c  b181              CBZ      r1,|L1.8304|
00204e  49ff              LDR      r1,|L1.9292|
002050  7809              LDRB     r1,[r1,#0]            ;4233  ; ND_EXT
002052  b121              CBZ      r1,|L1.8286|
002054  f04f0114          MOV      r1,#0x14              ;4233
002058  f8ad1000          STRH     r1,[sp,#0]            ;4233
00205c  e003              B        |L1.8294|
                  |L1.8286|
00205e  49fc              LDR      r1,|L1.9296|
002060  8809              LDRH     r1,[r1,#0]            ;4234  ; t_ext
002062  f8ad1000          STRH     r1,[sp,#0]            ;4234
                  |L1.8294|
002066  4afb              LDR      r2,|L1.9300|
002068  f9bd1000          LDRSH    r1,[sp,#0]            ;4236
00206c  6011              STR      r1,[r2,#0]            ;4236  ; mat_temper
00206e  8020              STRH     r0,[r4,#0]
                  |L1.8304|
;;;4252   	///u_necc=3456;
;;;4253   	}  
;;;4254   
;;;4255   //u_necc=2355;
;;;4256   
;;;4257   if(speedChIsOn)
002070  48f9              LDR      r0,|L1.9304|
002072  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
002074  b110              CBZ      r0,|L1.8316|
;;;4258   	{
;;;4259   	u_necc=speedChrgVolt;
002076  48f9              LDR      r0,|L1.9308|
002078  8800              LDRH     r0,[r0,#0]  ; speedChrgVolt
00207a  8020              STRH     r0,[r4,#0]
                  |L1.8316|
;;;4260   	}
;;;4261   
;;;4262   if(mess_find_unvol(MESS2UNECC_HNDL))
00207c  20be              MOVS     r0,#0xbe
00207e  f7fffffe          BL       mess_find_unvol
002082  b128              CBZ      r0,|L1.8336|
;;;4263   	{		
;;;4264   	if(mess_data[0]==PARAM_UNECC_SET)
002084  48f6              LDR      r0,|L1.9312|
002086  6801              LDR      r1,[r0,#0]  ; mess_data
002088  29bf              CMP      r1,#0xbf
00208a  d101              BNE      |L1.8336|
;;;4265   		{
;;;4266   		u_necc=mess_data[1];
00208c  6840              LDR      r0,[r0,#4]  ; mess_data
00208e  8020              STRH     r0,[r4,#0]
                  |L1.8336|
;;;4267   		}		
;;;4268   	}
;;;4269   if(ICA_EN)u_necc+=ica_u_necc;
002090  48f4              LDR      r0,|L1.9316|
002092  8800              LDRH     r0,[r0,#0]  ; ICA_EN
002094  b120              CBZ      r0,|L1.8352|
002096  49f4              LDR      r1,|L1.9320|
002098  8820              LDRH     r0,[r4,#0]  ; u_necc
00209a  8809              LDRH     r1,[r1,#0]  ; ica_u_necc
00209c  4408              ADD      r0,r0,r1
00209e  8020              STRH     r0,[r4,#0]
                  |L1.8352|
;;;4270   #endif
;;;4271   
;;;4272   
;;;4273   #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;4274   
;;;4275   #ifndef UKU_TELECORE2015
;;;4276   #ifndef UKU_TELECORE2017
;;;4277   if(unh_cnt0<10)
;;;4278   	{
;;;4279   	unh_cnt0++;
;;;4280   	if(unh_cnt0>=10)
;;;4281   		{
;;;4282   		unh_cnt0=0;
;;;4283   		b1Hz_unh=1;
;;;4284   		}
;;;4285   	}
;;;4286   
;;;4287   if(unh_cnt1<5)
;;;4288   	{
;;;4289   	unh_cnt1++;
;;;4290   	if(unh_cnt1==5)
;;;4291   		{
;;;4292   		unh_cnt1=0;
;;;4293   //		b2Hz_unh=1;
;;;4294   		}
;;;4295   	} 
;;;4296   
;;;4297   
;;;4298   
;;;4299   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;4300   	{		
;;;4301   	if(mess_data[0]==PARAM_UNECC_SET)
;;;4302   		{
;;;4303   		u_necc=mess_data[1];
;;;4304   		}		
;;;4305   	}
;;;4306   
;;;4307   
;;;4308   else if(b1Hz_unh)
;;;4309   	{
;;;4310   	
;;;4311   	if((BAT_IS_ON[0]!=bisON) && (BAT_IS_ON[1]!=bisON))
;;;4312   		{
;;;4313   		
;;;4314   		u_necc=U0B;
;;;4315   		}
;;;4316   	else 
;;;4317   		{
;;;4318   		if(BAT_TYPE==0) //если батаре€ обычна€
;;;4319   			{
;;;4320   			for(i=0;i<2;i++)
;;;4321   				{
;;;4322   				if(BAT_IS_ON[i]==bisON)
;;;4323   					{
;;;4324   					if(bat[i]._nd)t[i]=20;
;;;4325   					else t[i]=bat[i]._Tb;
;;;4326   					}
;;;4327   				else
;;;4328   					{
;;;4329   					t[i]=-20;
;;;4330   					}
;;;4331   				}
;;;4332   			if(t[0]>t[1])mat_temper=t[0];
;;;4333   			else mat_temper=t[1];
;;;4334   			
;;;4335   		
;;;4336   			if(mat_temper<0)temp_SL=UB0; 
;;;4337   			else 
;;;4338   				{
;;;4339   				if(mat_temper>40)mat_temper=40; 
;;;4340   				temp_SL=(UB20-UB0)*10;
;;;4341   				temp_SL*=mat_temper;
;;;4342   				temp_SL/=200;
;;;4343   				temp_SL+=UB0;
;;;4344   				}
;;;4345   			if(spc_stat==spcVZ)
;;;4346   				{
;;;4347   				temp_SL=UVZ;
;;;4348   				}
;;;4349   			u_necc=(unsigned int)temp_SL;
;;;4350   			}
;;;4351   		else if(BAT_TYPE==1) //если батаре€ китайска€
;;;4352   			{
;;;4353   			u_necc=U0B;
;;;4354   					
;;;4355   			u_necc=bat[0]._Ub+10;
;;;4356   
;;;4357   			
;;;4358   			if(spc_stat==spcVZ)
;;;4359   				{
;;;4360   				u_necc=UVZ;
;;;4361   				}
;;;4362   			if(u_necc>=UB0) u_necc=UB0;
;;;4363   			if(u_necc>=UB20) u_necc=UB20;
;;;4364   			}
;;;4365   		}  
;;;4366   	}
;;;4367   #endif
;;;4368   #endif
;;;4369   
;;;4370   #ifdef UKU_TELECORE2015
;;;4371   
;;;4372   if(unh_cnt0<10)
;;;4373   	{
;;;4374   	unh_cnt0++;
;;;4375   	if(unh_cnt0>=10)
;;;4376   		{
;;;4377   		unh_cnt0=0;
;;;4378   		b1Hz_unh=1;
;;;4379   		}
;;;4380   	}
;;;4381   
;;;4382   if(unh_cnt1<5)
;;;4383   	{
;;;4384   	unh_cnt1++;
;;;4385   	if(unh_cnt1==5)
;;;4386   		{
;;;4387   		unh_cnt1=0;
;;;4388   //		b2Hz_unh=1;
;;;4389   		}
;;;4390   	} 
;;;4391   
;;;4392   
;;;4393   
;;;4394   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;4395   	{		
;;;4396   	if(mess_data[0]==PARAM_UNECC_SET)
;;;4397   		{
;;;4398   		u_necc=mess_data[1];
;;;4399   		}		
;;;4400   	}
;;;4401   
;;;4402   
;;;4403   else if(b1Hz_unh)
;;;4404   	{
;;;4405   	b1Hz_unh=0;
;;;4406   
;;;4407   	if(BAT_TYPE==0)
;;;4408   		{
;;;4409   		if(bat[0]._nd)mat_temper=20;
;;;4410   		else mat_temper=bat[0]._Tb;
;;;4411   
;;;4412   			
;;;4413   		if(mat_temper<0)temp_SL=UB0; 
;;;4414   		else 
;;;4415   			{
;;;4416   			if(mat_temper>40)mat_temper=40; 
;;;4417   			temp_SL=(UB20-UB0)*10;
;;;4418   			temp_SL*=mat_temper;
;;;4419   			temp_SL/=200;
;;;4420   			temp_SL+=UB0;
;;;4421   			}
;;;4422   		if(spc_stat==spcVZ)
;;;4423   			{
;;;4424   			temp_SL=UVZ;
;;;4425   			}
;;;4426   		u_necc=(unsigned int)temp_SL;
;;;4427   	///u_necc=3456;
;;;4428   		}
;;;4429   	else if(BAT_TYPE==1)
;;;4430   		{
;;;4431   		
;;;4432   		gran(&DU_LI_BAT,1,30);
;;;4433   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;4434   		gran(&u_necc,0,UB0);
;;;4435   		gran(&u_necc,0,UB20);
;;;4436   		gran(&u_necc,0,540);		
;;;4437   
;;;4438   
;;;4439   		if(li_bat._batStat!=bsOK)
;;;4440   			{
;;;4441   			u_necc=U0B;
;;;4442   			}
;;;4443   		if(spc_stat==spcVZ)
;;;4444   			{
;;;4445   			u_necc=UVZ;
;;;4446   			}
;;;4447   		/* 
;;;4448   		u_necc=U0B;
;;;4449   		
;;;4450   
;;;4451   	
;;;4452   		u_necc=UB0;
;;;4453   		u_necc=li_bat._Ub+10;
;;;4454   		if((li_bat._Ub<450)||(li_bat._Ub>550))
;;;4455   			{
;;;4456   			lakb_error_cnt++;
;;;4457   			if(lakb_error_cnt>=30)
;;;4458   				{
;;;4459   				lakb_error_cnt=30;
;;;4460   				u_necc=U0B;
;;;4461   				}
;;;4462   			}
;;;4463   		else lakb_error_cnt=0;*/
;;;4464   		}
;;;4465   	else if(BAT_TYPE==2)
;;;4466   		{
;;;4467   		u_necc=U0B;
;;;4468   		
;;;4469   		if(spc_stat==spcVZ)
;;;4470   			{
;;;4471   			u_necc=UVZ;
;;;4472   			}
;;;4473   	
;;;4474   		u_necc=UB0;
;;;4475   		}
;;;4476   
;;;4477   	else if(BAT_TYPE==3)
;;;4478   		{
;;;4479   		u_necc=U0B;
;;;4480   		
;;;4481   		if(spc_stat==spcVZ)
;;;4482   			{
;;;4483   			u_necc=UVZ;
;;;4484   			}
;;;4485   
;;;4486   		gran(&DU_LI_BAT,1,30);
;;;4487   
;;;4488   
;;;4489   		if(lakbNotErrorNum==0)
;;;4490   			{
;;;4491   			u_necc=U0B;
;;;4492   			}
;;;4493   		else 
;;;4494   			{
;;;4495   			signed short i;
;;;4496   			//signed short u_necc_max;
;;;4497   			//u_necc_max=0;
;;;4498   			char soc_flag=0;
;;;4499   
;;;4500   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;4501   				{
;;;4502   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;4503   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;4504   				}
;;;4505   
;;;4506   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;4507   			}
;;;4508   		gran(&u_necc,0,UB0);
;;;4509   		//gran(&u_necc,0,UB20);
;;;4510   		gran(&u_necc,0,540);
;;;4511   		}
;;;4512   	}
;;;4513   
;;;4514   #endif 
;;;4515   
;;;4516   #ifdef UKU_TELECORE2017
;;;4517   
;;;4518   if(unh_cnt0<10)
;;;4519   	{
;;;4520   	unh_cnt0++;
;;;4521   	if(unh_cnt0>=10)
;;;4522   		{
;;;4523   		unh_cnt0=0;
;;;4524   		b1Hz_unh=1;
;;;4525   		}
;;;4526   	}
;;;4527   
;;;4528   if(unh_cnt1<5)
;;;4529   	{
;;;4530   	unh_cnt1++;
;;;4531   	if(unh_cnt1==5)
;;;4532   		{
;;;4533   		unh_cnt1=0;
;;;4534   //		b2Hz_unh=1;
;;;4535   		}
;;;4536   	} 
;;;4537   
;;;4538   
;;;4539   
;;;4540   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;4541   	{		
;;;4542   	if(mess_data[0]==PARAM_UNECC_SET)
;;;4543   		{
;;;4544   		u_necc=mess_data[1];
;;;4545   		}		
;;;4546   	}
;;;4547   
;;;4548   
;;;4549   else if(b1Hz_unh)
;;;4550   	{
;;;4551   	b1Hz_unh=0;
;;;4552   
;;;4553   	if(BAT_TYPE==0)
;;;4554   		{
;;;4555   		if(bat[0]._nd)mat_temper=20;
;;;4556   		else mat_temper=bat[0]._Tb;
;;;4557   
;;;4558   			
;;;4559   		if(mat_temper<0)temp_SL=UB0; 
;;;4560   		else 
;;;4561   			{
;;;4562   			if(mat_temper>40)mat_temper=40; 
;;;4563   			temp_SL=(UB20-UB0)*10;
;;;4564   			temp_SL*=mat_temper;
;;;4565   			temp_SL/=200;
;;;4566   			temp_SL+=UB0;
;;;4567   			}
;;;4568   		if(spc_stat==spcVZ)
;;;4569   			{
;;;4570   			temp_SL=UVZ;
;;;4571   			}
;;;4572   		u_necc=(unsigned int)temp_SL;
;;;4573   	///u_necc=3456;
;;;4574   		}
;;;4575   	else if(BAT_TYPE==1)
;;;4576   		{
;;;4577   		
;;;4578   		gran(&DU_LI_BAT,1,30);
;;;4579   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;4580   		gran(&u_necc,0,UB0);
;;;4581   		gran(&u_necc,0,UB20);
;;;4582   		gran(&u_necc,0,540);		
;;;4583   
;;;4584   
;;;4585   		if(li_bat._batStat!=bsOK)
;;;4586   			{
;;;4587   			u_necc=U0B;
;;;4588   			}
;;;4589   		if(spc_stat==spcVZ)
;;;4590   			{
;;;4591   			u_necc=UVZ;
;;;4592   			}
;;;4593   		}
;;;4594   	else if(BAT_TYPE==2)
;;;4595   		{
;;;4596   		u_necc=U0B;
;;;4597   		
;;;4598   		if(spc_stat==spcVZ)
;;;4599   			{
;;;4600   			u_necc=UVZ;
;;;4601   			}
;;;4602   	
;;;4603   		u_necc=UB0;
;;;4604   		}
;;;4605   
;;;4606   	else if(BAT_TYPE==3)
;;;4607   		{
;;;4608   		u_necc=U0B;
;;;4609   		
;;;4610   		if(spc_stat==spcVZ)
;;;4611   			{
;;;4612   			u_necc=UVZ;
;;;4613   			}
;;;4614   
;;;4615   		gran(&DU_LI_BAT,1,30);
;;;4616   
;;;4617   
;;;4618   		if(lakbNotErrorNum==0)
;;;4619   			{
;;;4620   			u_necc=U0B;
;;;4621   			}
;;;4622   		else 
;;;4623   			{
;;;4624   			signed short i;
;;;4625   			//signed short u_necc_max;
;;;4626   			//u_necc_max=0;
;;;4627   			char soc_flag=0;
;;;4628   
;;;4629   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;4630   				{
;;;4631   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;4632   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;4633   				}
;;;4634   
;;;4635   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;4636   			}
;;;4637   		gran(&u_necc,0,UB0);
;;;4638   		//gran(&u_necc,0,UB20);
;;;4639   		gran(&u_necc,0,540);
;;;4640   		}
;;;4641   	}
;;;4642   
;;;4643   #endif 
;;;4644   //u_necc=2356;
;;;4645   #endif//gran(&u_necc,400,UMAX);
;;;4646   
;;;4647   temp_L=(signed long) u_necc;
0020a0  f9b40000          LDRSH    r0,[r4,#0]  ; u_necc
;;;4648   temp_L*=98L;
0020a4  f04f0162          MOV      r1,#0x62
0020a8  fb00f101          MUL      r1,r0,r1
;;;4649   temp_L/=100L;
0020ac  f04f0264          MOV      r2,#0x64
0020b0  fb91f1f2          SDIV     r1,r1,r2
;;;4650   u_necc_dn=(signed short)temp_L;
0020b4  4bed              LDR      r3,|L1.9324|
0020b6  8019              STRH     r1,[r3,#0]
;;;4651   
;;;4652   temp_L=(signed long) u_necc;
;;;4653   temp_L*=102L;
0020b8  f04f0166          MOV      r1,#0x66
0020bc  fb00f001          MUL      r0,r0,r1
;;;4654   temp_L/=100L;
0020c0  fb90f0f2          SDIV     r0,r0,r2
;;;4655   u_necc_up=(signed short)temp_L;
0020c4  49ea              LDR      r1,|L1.9328|
0020c6  8008              STRH     r0,[r1,#0]
;;;4656   
;;;4657   
;;;4658   }
0020c8  bd38              POP      {r3-r5,pc}
;;;4659   
                          ENDP

                  num_necc_hndl PROC
;;;4661   //-----------------------------------------------
;;;4662   void num_necc_hndl(void)
0020ca  e92d41f0          PUSH     {r4-r8,lr}
;;;4663   {
;;;4664   
;;;4665   static short num_necc_block_cnt;
;;;4666   if(num_necc_block_cnt) num_necc_block_cnt--;
0020ce  4ce9              LDR      r4,|L1.9332|
0020d0  f9b40026          LDRSH    r0,[r4,#0x26]  ; num_necc_block_cnt
0020d4  b110              CBZ      r0,|L1.8412|
0020d6  f1a00001          SUB      r0,r0,#1
0020da  84e0              STRH     r0,[r4,#0x26]
                  |L1.8412|
;;;4667   
;;;4668   Isumm_=Isumm;
0020dc  48e6              LDR      r0,|L1.9336|
0020de  4de7              LDR      r5,|L1.9340|
0020e0  8800              LDRH     r0,[r0,#0]  ; Isumm
0020e2  8028              STRH     r0,[r5,#0]
;;;4669   
;;;4670   if(bat[0]._Ib<0) Isumm_+=(abs(bat[0]._Ib))/10;
0020e4  4ee6              LDR      r6,|L1.9344|
0020e6  270a              MOVS     r7,#0xa
0020e8  f9b60008          LDRSH    r0,[r6,#8]  ; bat
0020ec  2800              CMP      r0,#0
0020ee  da06              BGE      |L1.8446|
0020f0  f7fffffe          BL       abs
0020f4  fb90f0f7          SDIV     r0,r0,r7
0020f8  8829              LDRH     r1,[r5,#0]  ; Isumm_
0020fa  4408              ADD      r0,r0,r1
0020fc  8028              STRH     r0,[r5,#0]
                  |L1.8446|
;;;4671   if(bat[1]._Ib<0) Isumm_+=(abs(bat[1]._Ib))/10;
0020fe  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
002102  2800              CMP      r0,#0
002104  da06              BGE      |L1.8468|
002106  f7fffffe          BL       abs
00210a  fb90f0f7          SDIV     r0,r0,r7
00210e  8829              LDRH     r1,[r5,#0]  ; Isumm_
002110  4408              ADD      r0,r0,r1
002112  8028              STRH     r0,[r5,#0]
                  |L1.8468|
;;;4672   
;;;4673   num_necc_up=(Isumm_/((signed short)IMAX))+1;
002114  48db              LDR      r0,|L1.9348|
002116  f9b51000          LDRSH    r1,[r5,#0]  ; Isumm_
00211a  f9b00000          LDRSH    r0,[r0,#0]  ; IMAX
00211e  fb91f0f0          SDIV     r0,r1,r0
002122  f1000001          ADD      r0,r0,#1
002126  b2c0              UXTB     r0,r0
002128  74a0              STRB     r0,[r4,#0x12]
;;;4674   ////Isumm_+=(signed short)((IMAX*(10-KIMAX))/10);
;;;4675   ////Isumm_+=(signed short)(IMAX-IMIN);
;;;4676   
;;;4677   num_necc_down=(Isumm_/((signed short)IMIN))+1;
00212a  4ad7              LDR      r2,|L1.9352|
00212c  f9b22000          LDRSH    r2,[r2,#0]  ; IMIN
002130  fb91f1f2          SDIV     r1,r1,r2
002134  f1010101          ADD      r1,r1,#1
002138  b2c9              UXTB     r1,r1
00213a  74e1              STRB     r1,[r4,#0x13]
;;;4678   
;;;4679   if(num_necc_up>num_necc)
00213c  4bd3              LDR      r3,|L1.9356|
;;;4680   	{
;;;4681   	num_necc=num_necc_up;
;;;4682   	num_necc_block_cnt=60;
00213e  f04f053c          MOV      r5,#0x3c
002142  f9b32000          LDRSH    r2,[r3,#0]            ;4679  ; num_necc
002146  4290              CMP      r0,r2                 ;4679
002148  dd02              BLE      |L1.8528|
00214a  8018              STRH     r0,[r3,#0]            ;4681
00214c  84e5              STRH     r5,[r4,#0x26]
00214e  e005              B        |L1.8540|
                  |L1.8528|
;;;4683   	}
;;;4684   else if(num_necc_down<num_necc)
002150  4291              CMP      r1,r2
002152  da03              BGE      |L1.8540|
;;;4685   	{
;;;4686   	if(!num_necc_block_cnt)
002154  8ce0              LDRH     r0,[r4,#0x26]  ; num_necc_block_cnt
002156  b908              CBNZ     r0,|L1.8540|
;;;4687   		{
;;;4688   		num_necc=num_necc_down;
002158  8019              STRH     r1,[r3,#0]
;;;4689   		num_necc_block_cnt=60;
00215a  84e5              STRH     r5,[r4,#0x26]
                  |L1.8540|
;;;4690   		}
;;;4691   	}
;;;4692   
;;;4693   /*if(PAR)*/ num_necc=NUMIST;
00215c  48cc              LDR      r0,|L1.9360|
00215e  f9b02000          LDRSH    r2,[r0,#0]  ; NUMIST
002162  801a              STRH     r2,[r3,#0]
;;;4694   
;;;4695   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4696   //if(bPARALLEL) num_necc=NUMIST;
;;;4697   #endif
;;;4698   
;;;4699   num_necc=NUMIST;
;;;4700   
;;;4701   gran(&num_necc,1,NUMIST);
002164  e8bd41f0          POP      {r4-r8,lr}
002168  2101              MOVS     r1,#1
00216a  48c8              LDR      r0,|L1.9356|
00216c  f7ffbffe          B.W      gran
;;;4702   
;;;4703   }
;;;4704   
                          ENDP

                  cntrl_hndl PROC
;;;4706   //-----------------------------------------------
;;;4707   void cntrl_hndl(void)
002170  e92d47f0          PUSH     {r4-r10,lr}
;;;4708   {
;;;4709   
;;;4710   IZMAX_=IZMAX;
002174  48c7              LDR      r0,|L1.9364|
002176  f8df82fc          LDR      r8,|L1.9332|
00217a  f9b01000          LDRSH    r1,[r0,#0]  ; IZMAX
00217e  f8a8103a          STRH     r1,[r8,#0x3a]
;;;4711   
;;;4712   //cntrl_hndl_plazma=10;
;;;4713   
;;;4714   if(speedChIsOn)IZMAX_=speedChrgCurr;
002182  48b5              LDR      r0,|L1.9304|
002184  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
002186  b118              CBZ      r0,|L1.8592|
002188  48c3              LDR      r0,|L1.9368|
00218a  8800              LDRH     r0,[r0,#0]  ; speedChrgCurr
00218c  f8a8003a          STRH     r0,[r8,#0x3a]
                  |L1.8592|
;;;4715   
;;;4716   if(cntrl_stat_blok_cnt)cntrl_stat_blok_cnt--;
002190  f9b8004e          LDRSH    r0,[r8,#0x4e]  ; cntrl_stat_blok_cnt
002194  b118              CBZ      r0,|L1.8606|
002196  f1a00001          SUB      r0,r0,#1
00219a  f8a8004e          STRH     r0,[r8,#0x4e]
                  |L1.8606|
;;;4717   if(cntrl_stat_blok_cnt_)cntrl_stat_blok_cnt_--;
00219e  f9b80050          LDRSH    r0,[r8,#0x50]  ; cntrl_stat_blok_cnt_
0021a2  b118              CBZ      r0,|L1.8620|
0021a4  f1a00001          SUB      r0,r0,#1
0021a8  f8a80050          STRH     r0,[r8,#0x50]
                  |L1.8620|
;;;4718   
;;;4719   if((bat[0]._temper_stat&0x03)||(bat[1]._temper_stat&0x03))IZMAX_=IZMAX/10;
0021ac  48b4              LDR      r0,|L1.9344|
0021ae  f04f090a          MOV      r9,#0xa
0021b2  f890203f          LDRB     r2,[r0,#0x3f]  ; bat
0021b6  0792              LSLS     r2,r2,#30
0021b8  d103              BNE      |L1.8642|
0021ba  f890008b          LDRB     r0,[r0,#0x8b]  ; bat
0021be  0780              LSLS     r0,r0,#30
0021c0  d003              BEQ      |L1.8650|
                  |L1.8642|
0021c2  fb91f0f9          SDIV     r0,r1,r9
0021c6  f8a8003a          STRH     r0,[r8,#0x3a]
                  |L1.8650|
;;;4720   
;;;4721   
;;;4722   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4723   if((REG_SPEED<1)||(REG_SPEED>5)) REG_SPEED=1;
0021ca  48b4              LDR      r0,|L1.9372|
0021cc  2501              MOVS     r5,#1
0021ce  f9b01000          LDRSH    r1,[r0,#0]  ; REG_SPEED
0021d2  1e49              SUBS     r1,r1,#1
0021d4  2905              CMP      r1,#5
0021d6  d300              BCC      |L1.8666|
0021d8  8005              STRH     r5,[r0,#0]
                  |L1.8666|
;;;4724   if(ch_cnt0<(10*REG_SPEED))
0021da  f9b00000          LDRSH    r0,[r0,#0]  ; REG_SPEED
0021de  2400              MOVS     r4,#0                 ;4714
0021e0  eb000180          ADD      r1,r0,r0,LSL #2
0021e4  f8980007          LDRB     r0,[r8,#7]  ; ch_cnt0
0021e8  ebb00f41          CMP      r0,r1,LSL #1
0021ec  da0b              BGE      |L1.8710|
;;;4725   	{
;;;4726   	ch_cnt0++;
0021ee  f1000001          ADD      r0,r0,#1
0021f2  b2c0              UXTB     r0,r0
0021f4  f8880007          STRB     r0,[r8,#7]
;;;4727   	if(ch_cnt0>=10*REG_SPEED)
0021f8  ebb00f41          CMP      r0,r1,LSL #1
0021fc  db03              BLT      |L1.8710|
;;;4728   		{
;;;4729   		ch_cnt0=0;
0021fe  f8884007          STRB     r4,[r8,#7]
;;;4730   		b1Hz_ch=1;
002202  f8885008          STRB     r5,[r8,#8]
                  |L1.8710|
;;;4731   		}
;;;4732   	}
;;;4733   #endif
;;;4734   
;;;4735   
;;;4736   if(mess_find_unvol(MESS2CNTRL_HNDL))
002206  20e1              MOVS     r0,#0xe1
002208  f7fffffe          BL       mess_find_unvol
;;;4737   	{
;;;4738   	if(mess_data[0]==PARAM_CNTRL_STAT_PLUS)
;;;4739   		{
;;;4740   		cntrl_stat=cntrl_stat_old+mess_data[1];
;;;4741   		}
;;;4742   	else if(mess_data[0]==PARAM_CNTRL_STAT_MINUS)
;;;4743   		{
;;;4744   		cntrl_stat=cntrl_stat_old-mess_data[1];
;;;4745   		}
;;;4746   	else if(mess_data[0]==PARAM_CNTRL_STAT_STEP_DOWN)
;;;4747   		{
;;;4748   		static char cntrlStatIsDownCnt;
;;;4749   		cntrl_stat--;
;;;4750   
;;;4751   		if((cntrl_stat<=30)||(load_U<USIGN))
;;;4752   			{
;;;4753   			if(++cntrlStatIsDownCnt==250)mess_send(MESS2KB_HNDL,PARAM_CNTRL_IS_DOWN,0,10);
;;;4754   			}
;;;4755   		else 
;;;4756   			{
;;;4757   			cntrlStatIsDownCnt=0;
;;;4758   			}
;;;4759   
;;;4760   		}
;;;4761   	else if(mess_data[0]==PARAM_CNTRL_STAT_SET)
;;;4762   		{
;;;4763   		cntrl_stat=mess_data[1];
;;;4764   		}
;;;4765   
;;;4766   	else if(mess_data[0]==PARAM_CNTRL_STAT_FAST_REG)
;;;4767   		{
;;;4768   		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4769   		if(load_U>u_necc)
00220c  4b8e              LDR      r3,|L1.9288|
;;;4770   			{
;;;4771   			cntrl_hndl_plazma=11;
;;;4772   			if(((bps_U-u_necc)>40)&&(cntrl_stat>0))cntrl_stat-=5;
00220e  4aa4              LDR      r2,|L1.9376|
;;;4773   			else if((cntrl_stat)&&b1Hz_ch)cntrl_stat--;
;;;4774   			}
;;;4775   		else if(bps_U<u_necc)
;;;4776   			{
;;;4777   			cntrl_hndl_plazma=12;	
;;;4778   			if(((u_necc-bps_U)>40)&&(cntrl_stat<2015))cntrl_stat+=5;
;;;4779   			else	if((cntrl_stat<2020)&&b1Hz_ch)cntrl_stat++;
;;;4780   			}
;;;4781   		#endif	
;;;4782   	 	}
;;;4783   	}
;;;4784   
;;;4785   #ifdef UKU_VD
;;;4786   else if((b1Hz_ch)&&((!bIBAT_SMKLBR)||(bps[8]._cnt>40)))
002210  4ea4              LDR      r6,|L1.9380|
;;;4787   	{
;;;4788   	cntrl_stat_new=cntrl_stat_old;
;;;4789   	cntrl_hndl_plazma=19;
;;;4790   	if((Ibmax/10)>(2*IZMAX_))
;;;4791   		{
;;;4792   		cntrl_hndl_plazma=20;
;;;4793             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;4794   		else	cntrl_stat_new-=10;
;;;4795   		}		
;;;4796   	else if(((Ibmax/10)<(IZMAX_*2))&&(Ibmax>(IZMAX_*15)))
;;;4797   		{
;;;4798   		cntrl_hndl_plazma=21;
;;;4799             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;4800             else	cntrl_stat_new-=3;
;;;4801   		}   
;;;4802   	else if((Ibmax<(IZMAX_*15))&&((Ibmax/10)>IZMAX_))
;;;4803   		{
;;;4804   		cntrl_hndl_plazma=22;
;;;4805   		cntrl_stat_new--;
;;;4806   		}
;;;4807   		
;;;4808   	else if(bps_U<u_necc)
;;;4809   		{
;;;4810   		cntrl_hndl_plazma=23;
;;;4811   /*		if(bps_U<(u_necc-(UB0-UB20)))
;;;4812   			{
;;;4813   			cntrl_hndl_plazma=24;
;;;4814   			if(Ibmax<0)
;;;4815   				{
;;;4816   				cntrl_hndl_plazma=25;
;;;4817                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;4818   				else cntrl_stat_new+=10;
;;;4819   				}
;;;4820   			else if(Ibmax<(IZMAX_*5))
;;;4821   				{
;;;4822   				cntrl_hndl_plazma=26;
;;;4823                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;4824   				else	cntrl_stat_new+=2;
;;;4825   				}
;;;4826   			else if(Ibmax<((IZMAX_*10)))//(Ibmax<((IZMAX_*95)/10))
;;;4827   				{
;;;4828   				cntrl_hndl_plazma=27;
;;;4829   				cntrl_stat_new++;
;;;4830   				}					
;;;4831   			}	*/
;;;4832   /*		else if(bps_U<(u_necc-((UB0-UB20)/4)))
;;;4833   			{
;;;4834   			cntrl_hndl_plazma=28;
;;;4835   			if(Ibmax<(IZMAX_*5))
;;;4836   				{
;;;4837   				cntrl_hndl_plazma=29;
;;;4838                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;4839   				else	cntrl_stat_new+=2;
;;;4840   				}
;;;4841   			else if(Ibmax<((IZMAX_*10)))//(Ibmax<((IZMAX_*95)/10))
;;;4842   				{
;;;4843   				cntrl_hndl_plazma=30;
;;;4844   				cntrl_stat_new++;
;;;4845   				}					
;;;4846   			}
;;;4847   		else if(bps_U<(u_necc-1))
;;;4848   			{
;;;4849   			cntrl_hndl_plazma=31;
;;;4850   			if(Ibmax<((IZMAX_*10)))//(Ibmax<((IZMAX_*95)/10))
;;;4851   				{
;;;4852   				cntrl_hndl_plazma=32;
;;;4853   				cntrl_stat_new++;
;;;4854   				}					
;;;4855   			}	*/					
;;;4856   		}	
;;;4857   	else if((bps_U>u_necc)/*&&(!cntrl_blok)*/)
;;;4858   		{ 	
;;;4859   		cntrl_hndl_plazma=33;
;;;4860   /*		if(bps_U>(u_necc+(UB0-UB20)))
;;;4861   			{
;;;4862   			cntrl_hndl_plazma=34;
;;;4863                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;4864   			else	cntrl_stat_new-=10;
;;;4865   			}
;;;4866   		else if(bps_U>(u_necc+((UB0-UB20)/4)))
;;;4867   			{
;;;4868   			cntrl_hndl_plazma=35;
;;;4869                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;4870   			else cntrl_stat_new-=2;
;;;4871   			}	
;;;4872   		else if(bps_U>(u_necc+1))
;;;4873   			{
;;;4874   			cntrl_hndl_plazma=36;
;;;4875   			cntrl_stat_new--;
;;;4876   			}*/					
;;;4877   		}
;;;4878   
;;;4879   	cntrl_stat_new=(short)((2000L*((long)(UOUT_-in_U)))/650L);
;;;4880   	if(((signed long)(UOUT_-in_U))<0L)cntrl_stat_new=0;
;;;4881   	gran(&cntrl_stat_new,10,2010);			
002212  f24077da          MOV      r7,#0x7da
002216  2800              CMP      r0,#0                 ;4736
002218  d07e              BEQ      |L1.8984|
00221a  4991              LDR      r1,|L1.9312|
00221c  6808              LDR      r0,[r1,#0]            ;4738  ; mess_data
00221e  2864              CMP      r0,#0x64              ;4738
002220  d00a              BEQ      |L1.8760|
002222  2869              CMP      r0,#0x69              ;4742
002224  d00f              BEQ      |L1.8774|
002226  f8dfc280          LDR      r12,|L1.9384|
00222a  286e              CMP      r0,#0x6e              ;4746
00222c  d013              BEQ      |L1.8790|
00222e  28e5              CMP      r0,#0xe5              ;4761
002230  d033              BEQ      |L1.8858|
002232  28e6              CMP      r0,#0xe6              ;4766
002234  d035              BEQ      |L1.8866|
002236  e166              B        |L1.9478|
                  |L1.8760|
002238  6849              LDR      r1,[r1,#4]            ;4740  ; mess_data
00223a  f8b80020          LDRH     r0,[r8,#0x20]         ;4740  ; cntrl_stat_old
00223e  4408              ADD      r0,r0,r1              ;4740
002240  f8a8001e          STRH     r0,[r8,#0x1e]         ;4740
002244  e15f              B        |L1.9478|
                  |L1.8774|
002246  6848              LDR      r0,[r1,#4]            ;4744  ; mess_data
002248  f8b81020          LDRH     r1,[r8,#0x20]         ;4744  ; cntrl_stat_old
00224c  eba10000          SUB      r0,r1,r0              ;4744
002250  f8a8001e          STRH     r0,[r8,#0x1e]         ;4744
002254  e157              B        |L1.9478|
                  |L1.8790|
002256  f8b8001e          LDRH     r0,[r8,#0x1e]         ;4749  ; cntrl_stat
00225a  f1a00001          SUB      r0,r0,#1              ;4749
00225e  b200              SXTH     r0,r0                 ;4749
002260  f8a8001e          STRH     r0,[r8,#0x1e]         ;4749
002264  281e              CMP      r0,#0x1e              ;4751
002266  dd06              BLE      |L1.8822|
002268  4990              LDR      r1,|L1.9388|
00226a  f9bc0000          LDRSH    r0,[r12,#0]           ;4751  ; load_U
00226e  f9b11000          LDRSH    r1,[r1,#0]            ;4751  ; USIGN
002272  4288              CMP      r0,r1                 ;4751
002274  da0e              BGE      |L1.8852|
                  |L1.8822|
002276  f8980001          LDRB     r0,[r8,#1]            ;4753  ; cntrlStatIsDownCnt
00227a  1c40              ADDS     r0,r0,#1              ;4753
00227c  b2c0              UXTB     r0,r0                 ;4753
00227e  f8880001          STRB     r0,[r8,#1]            ;4753
002282  28fa              CMP      r0,#0xfa              ;4753
002284  d105              BNE      |L1.8850|
002286  230a              MOVS     r3,#0xa               ;4753
002288  2200              MOVS     r2,#0                 ;4753
00228a  21e7              MOVS     r1,#0xe7              ;4753
00228c  20e6              MOVS     r0,#0xe6              ;4753
00228e  f7fffffe          BL       mess_send
                  |L1.8850|
002292  e138              B        |L1.9478|
                  |L1.8852|
002294  f8884001          STRB     r4,[r8,#1]            ;4757
002298  e135              B        |L1.9478|
                  |L1.8858|
00229a  6848              LDR      r0,[r1,#4]            ;4763  ; mess_data
00229c  f8a8001e          STRH     r0,[r8,#0x1e]         ;4763
0022a0  e131              B        |L1.9478|
                  |L1.8866|
0022a2  f9bc1000          LDRSH    r1,[r12,#0]           ;4769  ; load_U
0022a6  f9b30000          LDRSH    r0,[r3,#0]            ;4769  ; u_necc
0022aa  4281              CMP      r1,r0                 ;4769
0022ac  dd1f              BLE      |L1.8942|
0022ae  f04f010b          MOV      r1,#0xb               ;4771
0022b2  f888101d          STRB     r1,[r8,#0x1d]         ;4771
0022b6  f9b21000          LDRSH    r1,[r2,#0]            ;4772  ; bps_U
0022ba  eba10000          SUB      r0,r1,r0              ;4772
0022be  2828              CMP      r0,#0x28              ;4772
0022c0  dd08              BLE      |L1.8916|
0022c2  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4772  ; cntrl_stat
0022c6  2800              CMP      r0,#0                 ;4772
0022c8  dd04              BLE      |L1.8916|
0022ca  f1a00005          SUB      r0,r0,#5              ;4772
0022ce  f8a8001e          STRH     r0,[r8,#0x1e]         ;4772
0022d2  e118              B        |L1.9478|
                  |L1.8916|
0022d4  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4773  ; cntrl_stat
0022d8  2800              CMP      r0,#0                 ;4773
0022da  d007              BEQ      |L1.8940|
0022dc  f8981008          LDRB     r1,[r8,#8]            ;4773  ; b1Hz_ch
0022e0  2900              CMP      r1,#0                 ;4773
0022e2  d003              BEQ      |L1.8940|
0022e4  f1a00001          SUB      r0,r0,#1              ;4773
0022e8  f8a8001e          STRH     r0,[r8,#0x1e]         ;4773
                  |L1.8940|
0022ec  e10b              B        |L1.9478|
                  |L1.8942|
0022ee  f9b21000          LDRSH    r1,[r2,#0]            ;4775  ; bps_U
0022f2  4281              CMP      r1,r0                 ;4775
0022f4  da13              BGE      |L1.8990|
0022f6  f04f020c          MOV      r2,#0xc               ;4777
0022fa  f888201d          STRB     r2,[r8,#0x1d]         ;4777
0022fe  eba00001          SUB      r0,r0,r1              ;4778
002302  2828              CMP      r0,#0x28              ;4778
002304  dd0c              BLE      |L1.8992|
002306  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4778  ; cntrl_stat
00230a  f24071df          MOV      r1,#0x7df             ;4778
00230e  4288              CMP      r0,r1                 ;4778
002310  da06              BGE      |L1.8992|
002312  f1000005          ADD      r0,r0,#5              ;4778
002316  e000              B        |L1.8986|
                  |L1.8984|
002318  e010              B        |L1.9020|
                  |L1.8986|
00231a  f8a8001e          STRH     r0,[r8,#0x1e]         ;4778
                  |L1.8990|
00231e  e0f2              B        |L1.9478|
                  |L1.8992|
002320  f9b8001e          LDRSH    r0,[r8,#0x1e]         ;4779  ; cntrl_stat
002324  f24071e4          MOV      r1,#0x7e4             ;4779
002328  4288              CMP      r0,r1                 ;4779
00232a  da33              BGE      |L1.9108|
00232c  f8981008          LDRB     r1,[r8,#8]            ;4779  ; b1Hz_ch
002330  b381              CBZ      r1,|L1.9108|
002332  f1000001          ADD      r0,r0,#1              ;4779
002336  f8a8001e          STRH     r0,[r8,#0x1e]         ;4779
00233a  e0e4              B        |L1.9478|
                  |L1.9020|
00233c  f8980008          LDRB     r0,[r8,#8]            ;4786  ; b1Hz_ch
002340  b340              CBZ      r0,|L1.9108|
002342  485b              LDR      r0,|L1.9392|
002344  8800              LDRH     r0,[r0,#0]            ;4786  ; bIBAT_SMKLBR
002346  b118              CBZ      r0,|L1.9040|
002348  f8960343          LDRB     r0,[r6,#0x343]        ;4786  ; bps
00234c  2828              CMP      r0,#0x28              ;4786
00234e  d921              BLS      |L1.9108|
                  |L1.9040|
002350  f9b80020          LDRSH    r0,[r8,#0x20]         ;4788  ; cntrl_stat_old
002354  f8a80036          STRH     r0,[r8,#0x36]         ;4788
002358  f04f0113          MOV      r1,#0x13              ;4789
00235c  f888101d          STRB     r1,[r8,#0x1d]         ;4789
002360  f9b8c038          LDRSH    r12,[r8,#0x38]        ;4790  ; Ibmax
002364  f8b8103a          LDRH     r1,[r8,#0x3a]         ;4790  ; IZMAX_
002368  fb9cf9f9          SDIV     r9,r12,r9             ;4790
00236c  ebb90f41          CMP      r9,r1,LSL #1          ;4790
002370  dd11              BLE      |L1.9110|
002372  f04f0114          MOV      r1,#0x14              ;4792
002376  f888101d          STRB     r1,[r8,#0x1d]         ;4792
00237a  f8b8104e          LDRH     r1,[r8,#0x4e]         ;4793  ; cntrl_stat_blok_cnt
00237e  b121              CBZ      r1,|L1.9098|
002380  f1a00001          SUB      r0,r0,#1              ;4793
002384  f8a80036          STRH     r0,[r8,#0x36]         ;4793
002388  e03a              B        |L1.9216|
                  |L1.9098|
00238a  f1a0000a          SUB      r0,r0,#0xa            ;4794
00238e  f8a80036          STRH     r0,[r8,#0x36]         ;4794
002392  e035              B        |L1.9216|
                  |L1.9108|
002394  e0b7              B        |L1.9478|
                  |L1.9110|
002396  da14              BGE      |L1.9154|
002398  ebc11a01          RSB      r10,r1,r1,LSL #4      ;4796
00239c  45e2              CMP      r10,r12               ;4796
00239e  da10              BGE      |L1.9154|
0023a0  f04f0115          MOV      r1,#0x15              ;4798
0023a4  f888101d          STRB     r1,[r8,#0x1d]         ;4798
0023a8  f8b8104e          LDRH     r1,[r8,#0x4e]         ;4799  ; cntrl_stat_blok_cnt
0023ac  b121              CBZ      r1,|L1.9144|
0023ae  f1a00001          SUB      r0,r0,#1              ;4799
0023b2  f8a80036          STRH     r0,[r8,#0x36]         ;4799
0023b6  e023              B        |L1.9216|
                  |L1.9144|
0023b8  f1a00003          SUB      r0,r0,#3              ;4800
0023bc  f8a80036          STRH     r0,[r8,#0x36]         ;4800
0023c0  e01e              B        |L1.9216|
                  |L1.9154|
0023c2  ebc11a01          RSB      r10,r1,r1,LSL #4      ;4802
0023c6  45e2              CMP      r10,r12               ;4802
0023c8  dd0a              BLE      |L1.9184|
0023ca  4589              CMP      r9,r1                 ;4802
0023cc  dd08              BLE      |L1.9184|
0023ce  f04f0116          MOV      r1,#0x16              ;4804
0023d2  f888101d          STRB     r1,[r8,#0x1d]         ;4804
0023d6  f1a00001          SUB      r0,r0,#1              ;4805
0023da  f8a80036          STRH     r0,[r8,#0x36]         ;4805
0023de  e00f              B        |L1.9216|
                  |L1.9184|
0023e0  f9b20000          LDRSH    r0,[r2,#0]            ;4808  ; bps_U
0023e4  f9b31000          LDRSH    r1,[r3,#0]            ;4808  ; u_necc
0023e8  4288              CMP      r0,r1                 ;4808
0023ea  da04              BGE      |L1.9206|
0023ec  f04f0017          MOV      r0,#0x17              ;4810
0023f0  f888001d          STRB     r0,[r8,#0x1d]         ;4810
0023f4  e004              B        |L1.9216|
                  |L1.9206|
0023f6  dd03              BLE      |L1.9216|
0023f8  f04f0021          MOV      r0,#0x21              ;4859
0023fc  f888001d          STRB     r0,[r8,#0x1d]         ;4859
                  |L1.9216|
002400  482c              LDR      r0,|L1.9396|
002402  f240228a          MOV      r2,#0x28a             ;4879
002406  f9b01000          LDRSH    r1,[r0,#0]            ;4879  ; UOUT_
00240a  482b              LDR      r0,|L1.9400|
00240c  f9b00000          LDRSH    r0,[r0,#0]            ;4879  ; in_U
002410  eba10000          SUB      r0,r1,r0              ;4879
002414  f44f61fa          MOV      r1,#0x7d0             ;4879
002418  fb00f101          MUL      r1,r0,r1              ;4879
00241c  fb91f1f2          SDIV     r1,r1,r2              ;4879
002420  f8a81036          STRH     r1,[r8,#0x36]         ;4879
002424  2800              CMP      r0,#0                 ;4880
002426  da01              BGE      |L1.9260|
002428  f8a84036          STRH     r4,[r8,#0x36]         ;4880
                  |L1.9260|
00242c  4811              LDR      r0,|L1.9332|
00242e  463a              MOV      r2,r7
002430  210a              MOVS     r1,#0xa
002432  3036              ADDS     r0,r0,#0x36
002434  f7fffffe          BL       gran
;;;4882   	cntrl_stat_old=cntrl_stat_new;
002438  f8b80036          LDRH     r0,[r8,#0x36]  ; cntrl_stat_new
00243c  f8a80020          STRH     r0,[r8,#0x20]
;;;4883   	cntrl_stat=cntrl_stat_new;
002440  e03c              B        |L1.9404|
002442  0000              DCW      0x0000
                  |L1.9284|
                          DCD      TERMOKOMPENS
                  |L1.9288|
                          DCD      u_necc
                  |L1.9292|
                          DCD      ND_EXT
                  |L1.9296|
                          DCD      t_ext
                  |L1.9300|
                          DCD      mat_temper
                  |L1.9304|
                          DCD      speedChIsOn
                  |L1.9308|
                          DCD      speedChrgVolt
                  |L1.9312|
                          DCD      mess_data
                  |L1.9316|
                          DCD      ICA_EN
                  |L1.9320|
                          DCD      ica_u_necc
                  |L1.9324|
                          DCD      u_necc_dn
                  |L1.9328|
                          DCD      u_necc_up
                  |L1.9332|
                          DCD      ||area_number.26||
                  |L1.9336|
                          DCD      Isumm
                  |L1.9340|
                          DCD      Isumm_
                  |L1.9344|
                          DCD      bat
                  |L1.9348|
                          DCD      IMAX
                  |L1.9352|
                          DCD      IMIN
                  |L1.9356|
                          DCD      num_necc
                  |L1.9360|
                          DCD      NUMIST
                  |L1.9364|
                          DCD      IZMAX
                  |L1.9368|
                          DCD      speedChrgCurr
                  |L1.9372|
                          DCD      REG_SPEED
                  |L1.9376|
                          DCD      bps_U
                  |L1.9380|
                          DCD      bps
                  |L1.9384|
                          DCD      load_U
                  |L1.9388|
                          DCD      USIGN
                  |L1.9392|
                          DCD      bIBAT_SMKLBR
                  |L1.9396|
                          DCD      UOUT_
                  |L1.9400|
                          DCD      in_U
                  |L1.9404|
0024bc  f8a8001e          STRH     r0,[r8,#0x1e]
;;;4884   	cntrl_stat_buff[cntrl_stat_buff_ptr]=cntrl_stat_new;  //pwm_u_buff[pwm_u_buff_ptr]=pwm_u_;
0024c0  4aff              LDR      r2,|L1.10432|
0024c2  f898100b          LDRB     r1,[r8,#0xb]  ; cntrl_stat_buff_ptr
0024c6  f8220011          STRH     r0,[r2,r1,LSL #1]
;;;4885   	cntrl_stat_buff_ptr++;								   //pwm_u_buff_ptr++;
0024ca  f1010101          ADD      r1,r1,#1
0024ce  b2c8              UXTB     r0,r1
0024d0  f888000b          STRB     r0,[r8,#0xb]
;;;4886   	
;;;4887   	if(cntrl_stat_buff_ptr>=16)cntrl_stat_buff_ptr=0;	//if(pwm_u_buff_ptr>=16)pwm_u_buff_ptr=0;
0024d4  2810              CMP      r0,#0x10
0024d6  d301              BCC      |L1.9436|
0024d8  f888400b          STRB     r4,[r8,#0xb]
                  |L1.9436|
;;;4888   		{
;;;4889   		char i;
;;;4890   		signed long tempSL;
;;;4891   		tempSL=0;
0024dc  f04f0100          MOV      r1,#0
;;;4892   		for(i=0;i<16;i++)
0024e0  4608              MOV      r0,r1
                  |L1.9442|
;;;4893   			{
;;;4894   			tempSL+=(signed long)cntrl_stat_buff[i];			//tempSL+=(signed long)pwm_u_buff[i];
0024e2  f9323010          LDRSH    r3,[r2,r0,LSL #1]
0024e6  4419              ADD      r1,r1,r3
0024e8  f1000001          ADD      r0,r0,#1              ;4892
0024ec  b2c0              UXTB     r0,r0                 ;4892
0024ee  2810              CMP      r0,#0x10              ;4892
0024f0  d3f7              BCC      |L1.9442|
;;;4895   			}
;;;4896   		tempSL>>=4;
0024f2  ea4f1021          ASR      r0,r1,#4
;;;4897   		cntrl_stat_buff_=(signed short)tempSL;
0024f6  b200              SXTH     r0,r0
0024f8  f8a8003e          STRH     r0,[r8,#0x3e]
;;;4898   		}
;;;4899   	if(NUMSK)cntrl_stat=cntrl_stat_buff_;
0024fc  49f1              LDR      r1,|L1.10436|
0024fe  8809              LDRH     r1,[r1,#0]  ; NUMSK
002500  b109              CBZ      r1,|L1.9478|
002502  f8a8001e          STRH     r0,[r8,#0x1e]
                  |L1.9478|
;;;4900   
;;;4901   	}
;;;4902   
;;;4903   #endif
;;;4904   
;;;4905   iiii=0;
002506  f888400a          STRB     r4,[r8,#0xa]
;;;4906   for(i=0;i<NUMIST;i++)
00250a  f8884009          STRB     r4,[r8,#9]
00250e  48ee              LDR      r0,|L1.10440|
002510  f9b02000          LDRSH    r2,[r0,#0]
002514  e01b              B        |L1.9550|
                  |L1.9494|
;;;4907        {
;;;4908        if(bps[i]._cnt<30)iiii=1;
002516  eb010081          ADD      r0,r1,r1,LSL #2
00251a  eb0000c1          ADD      r0,r0,r1,LSL #3
00251e  eb0600c0          ADD      r0,r6,r0,LSL #3
002522  78c3              LDRB     r3,[r0,#3]
002524  2b1e              CMP      r3,#0x1e
002526  d201              BCS      |L1.9516|
002528  f888500a          STRB     r5,[r8,#0xa]
                  |L1.9516|
;;;4909   
;;;4910   	 bps[i]._cntrl_stat=cntrl_stat+bps[i]._x_;
00252c  f100002c          ADD      r0,r0,#0x2c
002530  f8b8c01e          LDRH     r12,[r8,#0x1e]  ; cntrl_stat
002534  8d03              LDRH     r3,[r0,#0x28]
002536  4463              ADD      r3,r3,r12
002538  8703              STRH     r3,[r0,#0x38]
;;;4911   	 if(bps[i]._flags_tu&0x01) bps[i]._cntrl_stat=0;
00253a  f810392c          LDRB     r3,[r0],#-0x2c
00253e  07db              LSLS     r3,r3,#31
002540  d001              BEQ      |L1.9542|
002542  f8a04064          STRH     r4,[r0,#0x64]
                  |L1.9542|
002546  f1010101          ADD      r1,r1,#1              ;4906
00254a  f8881009          STRB     r1,[r8,#9]            ;4906
                  |L1.9550|
00254e  f8981009          LDRB     r1,[r8,#9]            ;4906  ; i
002552  4291              CMP      r1,r2                 ;4906
002554  dbdf              BLT      |L1.9494|
;;;4912        }
;;;4913   
;;;4914   if(iiii==0)
002556  f898000a          LDRB     r0,[r8,#0xa]  ; iiii
00255a  b938              CBNZ     r0,|L1.9580|
;;;4915        {
;;;4916        cntrl_stat=1200;	
00255c  f44f6096          MOV      r0,#0x4b0
002560  f8a8001e          STRH     r0,[r8,#0x1e]
;;;4917        cntrl_stat_old=1200;
002564  f8a80020          STRH     r0,[r8,#0x20]
;;;4918        cntrl_stat_new=1200;
002568  f8a80036          STRH     r0,[r8,#0x36]
                  |L1.9580|
;;;4919        }
;;;4920   gran(&cntrl_stat,10,2010); 
00256c  463a              MOV      r2,r7
00256e  210a              MOVS     r1,#0xa
002570  48d6              LDR      r0,|L1.10444|
002572  f7fffffe          BL       gran
;;;4921   b1Hz_ch=0;
002576  f8884008          STRB     r4,[r8,#8]
;;;4922   }
00257a  e8bd87f0          POP      {r4-r10,pc}
;;;4923   
                          ENDP

                  ext_drv PROC
;;;4925   //-----------------------------------------------
;;;4926   void ext_drv(void)
00257e  e92d5ff0          PUSH     {r4-r12,lr}
;;;4927   {
;;;4928   char i;
;;;4929   
;;;4930   
;;;4931   for(i=0;i<NUMSK;i++)
002582  f04f0000          MOV      r0,#0
002586  4acf              LDR      r2,|L1.10436|
;;;4932   	{
;;;4933   	#ifdef UKU_MGTS
;;;4934   	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;4935   	#endif
;;;4936   	#ifdef UKU_RSTKM
;;;4937   	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;4938   	#endif
;;;4939   	#ifdef UKU_3U
;;;4940   	if(adc_buff_[sk_buff_3U[i]]<2000)
;;;4941   	#endif
;;;4942   	#ifdef UKU_GLONASS
;;;4943   	if(adc_buff_[sk_buff_GLONASS[i]]<2000)
;;;4944   	#endif
;;;4945   	#ifdef UKU_KONTUR
;;;4946   	if(adc_buff_[sk_buff_KONTUR[i]]<2000)
;;;4947   	#endif
;;;4948   	#ifdef UKU_6U
;;;4949   	if(adc_buff_[sk_buff_6U[i]]<2000)
;;;4950   	#endif
;;;4951   	#ifdef UKU_220
;;;4952   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;4953   	#endif
;;;4954   	#ifdef UKU_220_V2
;;;4955   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;4956   	#endif
;;;4957   	#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4958   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;4959   	#endif
;;;4960   	#ifdef UKU_TELECORE2015	
;;;4961   	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;4962   	#endif
;;;4963   	#ifdef UKU_TELECORE2017
;;;4964   	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;4965   	#endif		
;;;4966   		{
;;;4967   		if(sk_cnt[i]<10)
002588  4bd1              LDR      r3,|L1.10448|
;;;4968   			{
;;;4969   			sk_cnt[i]++;
;;;4970   			if(sk_cnt[i]>=10)
;;;4971   				{
;;;4972   				sk_stat[i]=ssON;
00258a  4dd2              LDR      r5,|L1.10452|
00258c  f04f0a01          MOV      r10,#1
;;;4973   				}
;;;4974   			}
;;;4975   		else 
;;;4976   			{
;;;4977   			sk_cnt[i]=10;
002590  f04f0b0a          MOV      r11,#0xa
002594  4606              MOV      r6,r0                 ;4931
002596  f9b24000          LDRSH    r4,[r2,#0]            ;4931
00259a  e026              B        |L1.9706|
                  |L1.9628|
00259c  49ce              LDR      r1,|L1.10456|
00259e  4fc8              LDR      r7,|L1.10432|
0025a0  5c09              LDRB     r1,[r1,r0]            ;4958
0025a2  3f40              SUBS     r7,r7,#0x40           ;4958
0025a4  f9371011          LDRSH    r1,[r7,r1,LSL #1]     ;4958
0025a8  f5b16ffa          CMP      r1,#0x7d0             ;4958
0025ac  da0e              BGE      |L1.9676|
0025ae  5619              LDRSB    r1,[r3,r0]            ;4967
0025b0  290a              CMP      r1,#0xa               ;4967
0025b2  da08              BGE      |L1.9670|
0025b4  f1010101          ADD      r1,r1,#1              ;4969
0025b8  b249              SXTB     r1,r1                 ;4969
0025ba  5419              STRB     r1,[r3,r0]            ;4969
0025bc  290a              CMP      r1,#0xa               ;4970
0025be  db11              BLT      |L1.9700|
0025c0  f805a000          STRB     r10,[r5,r0]           ;4972
0025c4  e00e              B        |L1.9700|
                  |L1.9670|
0025c6  f803b000          STRB     r11,[r3,r0]
0025ca  e00b              B        |L1.9700|
                  |L1.9676|
;;;4978   			}
;;;4979                  
;;;4980   		}
;;;4981   	else
;;;4982   		{
;;;4983   		if(sk_cnt[i]>0)
0025cc  5619              LDRSB    r1,[r3,r0]
0025ce  2900              CMP      r1,#0
0025d0  dd07              BLE      |L1.9698|
;;;4984   			{
;;;4985   			sk_cnt[i]--;
0025d2  f1a10101          SUB      r1,r1,#1
0025d6  b249              SXTB     r1,r1
0025d8  5419              STRB     r1,[r3,r0]
;;;4986   			if(sk_cnt[i]<=0)
0025da  2900              CMP      r1,#0
0025dc  dc02              BGT      |L1.9700|
;;;4987   				{
;;;4988   				sk_stat[i]=ssOFF;
0025de  542e              STRB     r6,[r5,r0]
0025e0  e000              B        |L1.9700|
                  |L1.9698|
;;;4989   				}
;;;4990   			}
;;;4991   		else 
;;;4992   			{
;;;4993   			sk_cnt[i]=0;
0025e2  541e              STRB     r6,[r3,r0]
                  |L1.9700|
0025e4  f1000001          ADD      r0,r0,#1              ;4931
0025e8  b2c0              UXTB     r0,r0                 ;4931
                  |L1.9706|
0025ea  42a0              CMP      r0,r4                 ;4931
0025ec  dbd6              BLT      |L1.9628|
;;;4994   			}
;;;4995   		}
;;;4996   	}
;;;4997   
;;;4998   for(i=0;i<NUMSK;i++)
0025ee  f04f0400          MOV      r4,#0
;;;4999   	{
;;;5000   	if(((SK_SIGN[i]==0)&&(sk_stat[i]==ssON))||((SK_SIGN[i])&&(sk_stat[i]==ssOFF)) )
;;;5001   		{
;;;5002   		if(sk_av_cnt[i]<10)
0025f2  f8df92e8          LDR      r9,|L1.10460|
;;;5003   			{
;;;5004   			sk_av_cnt[i]++;
;;;5005   			if(sk_av_cnt[i]>=10)
;;;5006   				{
;;;5007   				sk_av_stat[i]=sasON;
0025f6  4fba              LDR      r7,|L1.10464|
;;;5008   				}
;;;5009   			}
;;;5010   		else 
;;;5011   			{
;;;5012   			sk_av_cnt[i]=10;
;;;5013   			}
;;;5014   		}
;;;5015   	else
;;;5016   		{
;;;5017   		if(sk_av_cnt[i]>=0)
;;;5018   			{
;;;5019   			sk_av_cnt[i]--;
;;;5020   			if(sk_av_cnt[i]<=0)
;;;5021   				{
;;;5022   				sk_av_stat[i]=sasOFF;
;;;5023   				}
;;;5024   			}
;;;5025   		else 
;;;5026   			{
;;;5027   			sk_av_cnt[i]=0;
;;;5028   			}
;;;5029   		}
;;;5030   
;;;5031   #ifndef UKU_KONTUR
;;;5032   	if(sk_av_stat_old[i]!=sk_av_stat[i])
0025f8  f8df82e8          LDR      r8,|L1.10468|
0025fc  e083              B        |L1.9990|
                  |L1.9726|
0025fe  48ba              LDR      r0,|L1.10472|
002600  f9300014          LDRSH    r0,[r0,r4,LSL #1]     ;5000
002604  b910              CBNZ     r0,|L1.9740|
002606  5d29              LDRB     r1,[r5,r4]            ;5000
002608  2901              CMP      r1,#1                 ;5000
00260a  d00f              BEQ      |L1.9772|
                  |L1.9740|
00260c  b108              CBZ      r0,|L1.9746|
00260e  5d28              LDRB     r0,[r5,r4]            ;5000
002610  b160              CBZ      r0,|L1.9772|
                  |L1.9746|
002612  f9190004          LDRSB    r0,[r9,r4]            ;5017
002616  2800              CMP      r0,#0                 ;5017
002618  db19              BLT      |L1.9806|
00261a  f1a00001          SUB      r0,r0,#1              ;5019
00261e  b240              SXTB     r0,r0                 ;5019
002620  f8090004          STRB     r0,[r9,r4]            ;5019
002624  2800              CMP      r0,#0                 ;5020
002626  dc14              BGT      |L1.9810|
002628  553e              STRB     r6,[r7,r4]            ;5022
00262a  e012              B        |L1.9810|
                  |L1.9772|
00262c  f9190004          LDRSB    r0,[r9,r4]            ;5002
002630  280a              CMP      r0,#0xa               ;5002
002632  da09              BGE      |L1.9800|
002634  f1000001          ADD      r0,r0,#1              ;5004
002638  b240              SXTB     r0,r0                 ;5004
00263a  f8090004          STRB     r0,[r9,r4]            ;5004
00263e  280a              CMP      r0,#0xa               ;5005
002640  db07              BLT      |L1.9810|
002642  f807a004          STRB     r10,[r7,r4]           ;5007
002646  e004              B        |L1.9810|
                  |L1.9800|
002648  f809b004          STRB     r11,[r9,r4]           ;5012
00264c  e001              B        |L1.9810|
                  |L1.9806|
00264e  f8096004          STRB     r6,[r9,r4]            ;5027
                  |L1.9810|
002652  f8181004          LDRB     r1,[r8,r4]
002656  5d38              LDRB     r0,[r7,r4]
002658  4281              CMP      r1,r0
00265a  d04e              BEQ      |L1.9978|
;;;5033   		{
;;;5034   		plazma_sk++;
00265c  4a9b              LDR      r2,|L1.10444|
00265e  3a1e              SUBS     r2,r2,#0x1e
002660  8e91              LDRH     r1,[r2,#0x34]  ; plazma_sk
002662  f1010101          ADD      r1,r1,#1
002666  8691              STRH     r1,[r2,#0x34]
;;;5035   		if(sk_av_stat[i]==sasON)
002668  2801              CMP      r0,#1
00266a  d007              BEQ      |L1.9852|
;;;5036   			{
;;;5037   			if(i==0)snmp_trap_send("SK #1 Alarm",15,1,1);
;;;5038   			else if(i==1)
;;;5039   				{
;;;5040   				#ifndef UKU_TELEKORE2017
;;;5041   				snmp_trap_send("SK #2 Alarm",15,2,1);
;;;5042   				#endif
;;;5043   				#ifdef UKU_TELEKORE2017
;;;5044   				snmp_trap_send("Door open",15,2,1);
;;;5045   				#endif
;;;5046   				}
;;;5047   			else if(i==2)snmp_trap_send("SK #3 Alarm",15,3,1);
;;;5048   			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;5049   			}
;;;5050   		else 
;;;5051   			{
;;;5052   			if(i==0)snmp_trap_send("SK #1 Alarm is off",15,1,0);
00266c  b354              CBZ      r4,|L1.9924|
;;;5053   			else if(i==1)
00266e  2c01              CMP      r4,#1
002670  d02f              BEQ      |L1.9938|
;;;5054   				{
;;;5055   				#ifndef UKU_TELEKORE2017
;;;5056   				snmp_trap_send("SK #2 Alarm is off",15,2,0);
;;;5057   				#endif
;;;5058   				#ifdef UKU_TELEKORE2017
;;;5059   				snmp_trap_send("Door open clear",15,2,0);
;;;5060   				#endif
;;;5061   				}
;;;5062   			else if(i==2)snmp_trap_send("SK #3 Alarm is off",15,3,0);
002672  2c02              CMP      r4,#2
002674  d034              BEQ      |L1.9952|
;;;5063   			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
002676  2c03              CMP      r4,#3
002678  d039              BEQ      |L1.9966|
00267a  e03e              B        |L1.9978|
                  |L1.9852|
00267c  b134              CBZ      r4,|L1.9868|
00267e  2c01              CMP      r4,#1                 ;5038
002680  d00b              BEQ      |L1.9882|
002682  2c02              CMP      r4,#2                 ;5047
002684  d010              BEQ      |L1.9896|
002686  2c03              CMP      r4,#3                 ;5048
002688  d015              BEQ      |L1.9910|
00268a  e036              B        |L1.9978|
                  |L1.9868|
00268c  2301              MOVS     r3,#1                 ;5037
00268e  461a              MOV      r2,r3                 ;5037
002690  210f              MOVS     r1,#0xf               ;5037
002692  a096              ADR      r0,|L1.10476|
002694  f7fffffe          BL       snmp_trap_send
002698  e02f              B        |L1.9978|
                  |L1.9882|
00269a  2301              MOVS     r3,#1                 ;5041
00269c  2202              MOVS     r2,#2                 ;5041
00269e  210f              MOVS     r1,#0xf               ;5041
0026a0  a095              ADR      r0,|L1.10488|
0026a2  f7fffffe          BL       snmp_trap_send
0026a6  e028              B        |L1.9978|
                  |L1.9896|
0026a8  2301              MOVS     r3,#1                 ;5047
0026aa  2203              MOVS     r2,#3                 ;5047
0026ac  210f              MOVS     r1,#0xf               ;5047
0026ae  a095              ADR      r0,|L1.10500|
0026b0  f7fffffe          BL       snmp_trap_send
0026b4  e021              B        |L1.9978|
                  |L1.9910|
0026b6  2301              MOVS     r3,#1                 ;5048
0026b8  2204              MOVS     r2,#4                 ;5048
0026ba  210f              MOVS     r1,#0xf               ;5048
0026bc  a094              ADR      r0,|L1.10512|
0026be  f7fffffe          BL       snmp_trap_send
0026c2  e01a              B        |L1.9978|
                  |L1.9924|
0026c4  2300              MOVS     r3,#0                 ;5052
0026c6  2201              MOVS     r2,#1                 ;5052
0026c8  210f              MOVS     r1,#0xf               ;5052
0026ca  a094              ADR      r0,|L1.10524|
0026cc  f7fffffe          BL       snmp_trap_send
0026d0  e013              B        |L1.9978|
                  |L1.9938|
0026d2  2300              MOVS     r3,#0                 ;5056
0026d4  2202              MOVS     r2,#2                 ;5056
0026d6  210f              MOVS     r1,#0xf               ;5056
0026d8  a095              ADR      r0,|L1.10544|
0026da  f7fffffe          BL       snmp_trap_send
0026de  e00c              B        |L1.9978|
                  |L1.9952|
0026e0  2300              MOVS     r3,#0                 ;5062
0026e2  2203              MOVS     r2,#3                 ;5062
0026e4  210f              MOVS     r1,#0xf               ;5062
0026e6  a097              ADR      r0,|L1.10564|
0026e8  f7fffffe          BL       snmp_trap_send
0026ec  e005              B        |L1.9978|
                  |L1.9966|
0026ee  2300              MOVS     r3,#0
0026f0  2204              MOVS     r2,#4
0026f2  210f              MOVS     r1,#0xf
0026f4  a098              ADR      r0,|L1.10584|
0026f6  f7fffffe          BL       snmp_trap_send
                  |L1.9978|
;;;5064   			}
;;;5065   	 	}
;;;5066   #endif
;;;5067   
;;;5068   #ifdef UKU_KONTUR
;;;5069   	if(sk_av_stat_old[i]!=sk_av_stat[i])
;;;5070   		{
;;;5071   		plazma_sk++;
;;;5072   		if(sk_av_stat[i]==sasON)
;;;5073   			{
;;;5074   			if(i==0)snmp_trap_send("Door is opened",15,1,1);
;;;5075   			else if(i==1)snmp_trap_send("Smoke Alarm",15,2,1);
;;;5076   			else if(i==2)snmp_trap_send("Shock Sensor Alarm",15,3,1);
;;;5077   			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;5078   			}
;;;5079   		else 
;;;5080   			{
;;;5081   			if(i==0)snmp_trap_send("Door is closed",15,1,0);
;;;5082   			else if(i==1)snmp_trap_send("Smoke Alarm is off",15,2,0);
;;;5083   			else if(i==2)snmp_trap_send("Shock Sensor Alarm is off",15,3,0);
;;;5084   			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
;;;5085   			}
;;;5086   	 	}
;;;5087   #endif
;;;5088   	sk_av_stat_old[i]=sk_av_stat[i];
0026fa  5d38              LDRB     r0,[r7,r4]
0026fc  f8080004          STRB     r0,[r8,r4]
002700  f1040401          ADD      r4,r4,#1              ;4998
002704  b2e4              UXTB     r4,r4                 ;4998
                  |L1.9990|
002706  486f              LDR      r0,|L1.10436|
002708  f9b00000          LDRSH    r0,[r0,#0]            ;4998  ; NUMSK
00270c  4284              CMP      r4,r0                 ;4998
00270e  f6ffaf76          BLT      |L1.9726|
                  |L1.10002|
;;;5089   	}
;;;5090   }
002712  e8bd9ff0          POP      {r4-r12,pc}
;;;5091   
                          ENDP

                  zar_superviser_start PROC
;;;5128   //-----------------------------------------------
;;;5129   void zar_superviser_start(void)
002716  4a95              LDR      r2,|L1.10604|
;;;5130   {
;;;5131   sign_U[0]=1;
002718  f04f0001          MOV      r0,#1
00271c  7010              STRB     r0,[r2,#0]
;;;5132   sign_I[0]=1;
00271e  4994              LDR      r1,|L1.10608|
002720  7008              STRB     r0,[r1,#0]
;;;5133   sign_U[1]=1;
002722  7050              STRB     r0,[r2,#1]
;;;5134   sign_I[1]=1;
002724  7048              STRB     r0,[r1,#1]
;;;5135   
;;;5136   }
002726  4770              BX       lr
;;;5137   
                          ENDP

                  zar_superviser_drv PROC
;;;5093   //-----------------------------------------------
;;;5094   void zar_superviser_drv(void)
002728  e92d5ff0          PUSH     {r4-r12,lr}
;;;5095   {
;;;5096   
;;;5097   if(((bat[0]._Ub>u_necc_up) || (bat[0]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[0]=0;
00272c  4892              LDR      r0,|L1.10616|
00272e  f8df924c          LDR      r9,|L1.10620|
002732  f8df8240          LDR      r8,|L1.10612|
002736  f9b0c000          LDRSH    r12,[r0,#0]  ; u_necc_up
00273a  f9b90000          LDRSH    r0,[r9,#0]
00273e  4c63              LDR      r4,|L1.10444|
002740  ebc01100          RSB      r1,r0,r0,LSL #4
002744  3c1e              SUBS     r4,r4,#0x1e
002746  f9b87002          LDRSH    r7,[r8,#2]  ; bat
00274a  f06f0a1d          MVN      r10,#0x1d
00274e  f06f0b95          MVN      r11,#0x95
002752  2500              MOVS     r5,#0
002754  4e85              LDR      r6,|L1.10604|
002756  f9b40042          LDRSH    r0,[r4,#0x42]
00275a  eb0a0281          ADD      r2,r10,r1,LSL #2
00275e  eb0b0381          ADD      r3,r11,r1,LSL #2
002762  4567              CMP      r7,r12
002764  dc05              BGT      |L1.10098|
002766  f8dfc218          LDR      r12,|L1.10624|
00276a  f9bcc000          LDRSH    r12,[r12,#0]  ; u_necc_dn
00276e  4567              CMP      r7,r12
002770  da04              BGE      |L1.10108|
                  |L1.10098|
002772  4282              CMP      r2,r0
002774  dd02              BLE      |L1.10108|
002776  4283              CMP      r3,r0
002778  da00              BGE      |L1.10108|
00277a  7035              STRB     r5,[r6,#0]
                  |L1.10108|
;;;5098   
;;;5099   if(((bat[0]._Ib>(2*IKB)) || (bat[0]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[0]=0;
00277c  4f81              LDR      r7,|L1.10628|
00277e  f9b8c008          LDRSH    r12,[r8,#8]  ; bat
002782  f9b7e000          LDRSH    lr,[r7,#0]  ; IKB
002786  4f7a              LDR      r7,|L1.10608|
002788  ebbc0f4e          CMP      r12,lr,LSL #1
00278c  dc04              BGT      |L1.10136|
00278e  f1ce0e00          RSB      lr,lr,#0
002792  ebbc0f4e          CMP      r12,lr,LSL #1
002796  da04              BGE      |L1.10146|
                  |L1.10136|
002798  4282              CMP      r2,r0
00279a  dd02              BLE      |L1.10146|
00279c  4283              CMP      r3,r0
00279e  da00              BGE      |L1.10146|
0027a0  703d              STRB     r5,[r7,#0]
                  |L1.10146|
;;;5100   																 
;;;5101   if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
0027a2  f06f0209          MVN      r2,#9
0027a6  eb020181          ADD      r1,r2,r1,LSL #2
0027aa  4281              CMP      r1,r0
0027ac  d120              BNE      |L1.10224|
0027ae  7da0              LDRB     r0,[r4,#0x16]  ; spc_stat
0027b0  b9f0              CBNZ     r0,|L1.10224|
;;;5102   	{
;;;5103   	if((sign_U[0]==1) && (sign_I[0]==1) && (lc640_read_int(EE_BAT1_ZAR_CNT)!=BAT_C_REAL[0]) && (NUMBAT) && (!(bat[0]._av&1)))
0027b2  7830              LDRB     r0,[r6,#0]  ; sign_U
0027b4  2801              CMP      r0,#1
0027b6  d11b              BNE      |L1.10224|
0027b8  7838              LDRB     r0,[r7,#0]  ; sign_I
0027ba  2801              CMP      r0,#1
0027bc  d118              BNE      |L1.10224|
0027be  f44f70d6          MOV      r0,#0x1ac
0027c2  f7fffffe          BL       lc640_read_int
0027c6  4970              LDR      r1,|L1.10632|
0027c8  f9b11000          LDRSH    r1,[r1,#0]  ; BAT_C_REAL
0027cc  4288              CMP      r0,r1
0027ce  d00f              BEQ      |L1.10224|
0027d0  486e              LDR      r0,|L1.10636|
0027d2  8800              LDRH     r0,[r0,#0]  ; NUMBAT
0027d4  b160              CBZ      r0,|L1.10224|
0027d6  f898003d          LDRB     r0,[r8,#0x3d]  ; bat
0027da  07c0              LSLS     r0,r0,#31
0027dc  d108              BNE      |L1.10224|
;;;5104   		{
;;;5105   		lc640_write_int(EE_BAT1_ZAR_CNT,BAT_C_REAL[0]);
0027de  f44f70d6          MOV      r0,#0x1ac
0027e2  f7fffffe          BL       lc640_write_int
;;;5106   		superviser_cnt++;
0027e6  486a              LDR      r0,|L1.10640|
0027e8  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
0027ea  f1010101          ADD      r1,r1,#1
0027ee  7001              STRB     r1,[r0,#0]
                  |L1.10224|
;;;5107   		}
;;;5108   	
;;;5109   	}
;;;5110   
;;;5111   if(((bat[0]._Ub>u_necc_up) || (bat[1]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[1]=0;
0027f0  4861              LDR      r0,|L1.10616|
0027f2  f9b81002          LDRSH    r1,[r8,#2]  ; bat
0027f6  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_up
0027fa  4281              CMP      r1,r0
0027fc  dc06              BGT      |L1.10252|
0027fe  4860              LDR      r0,|L1.10624|
002800  f9b8104e          LDRSH    r1,[r8,#0x4e]  ; bat
002804  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_dn
002808  4281              CMP      r1,r0
00280a  da0e              BGE      |L1.10282|
                  |L1.10252|
00280c  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
002810  f9b41042          LDRSH    r1,[r4,#0x42]  ; main_kb_cnt
002814  ebc01000          RSB      r0,r0,r0,LSL #4
002818  eb0a0280          ADD      r2,r10,r0,LSL #2
00281c  428a              CMP      r2,r1
00281e  dd04              BLE      |L1.10282|
002820  eb0b0080          ADD      r0,r11,r0,LSL #2
002824  4288              CMP      r0,r1
002826  da00              BGE      |L1.10282|
002828  7075              STRB     r5,[r6,#1]
                  |L1.10282|
;;;5112   
;;;5113   if(((bat[1]._Ib>(2*IKB)) || (bat[1]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[1]=0;
00282a  4956              LDR      r1,|L1.10628|
00282c  f9b80054          LDRSH    r0,[r8,#0x54]  ; bat
002830  f9b11000          LDRSH    r1,[r1,#0]  ; IKB
002834  ebb00f41          CMP      r0,r1,LSL #1
002838  dc03              BGT      |L1.10306|
00283a  4249              RSBS     r1,r1,#0
00283c  ebb00f41          CMP      r0,r1,LSL #1
002840  da0e              BGE      |L1.10336|
                  |L1.10306|
002842  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
002846  f9b41042          LDRSH    r1,[r4,#0x42]  ; main_kb_cnt
00284a  ebc01000          RSB      r0,r0,r0,LSL #4
00284e  eb0a0280          ADD      r2,r10,r0,LSL #2
002852  428a              CMP      r2,r1
002854  dd04              BLE      |L1.10336|
002856  eb0b0080          ADD      r0,r11,r0,LSL #2
00285a  4288              CMP      r0,r1
00285c  da00              BGE      |L1.10336|
00285e  707d              STRB     r5,[r7,#1]
                  |L1.10336|
;;;5114   																 
;;;5115   if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
002860  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
002864  ebc01100          RSB      r1,r0,r0,LSL #4
002868  f06f0009          MVN      r0,#9
00286c  eb000081          ADD      r0,r0,r1,LSL #2
002870  f9b41042          LDRSH    r1,[r4,#0x42]  ; main_kb_cnt
002874  4288              CMP      r0,r1
002876  d121              BNE      |L1.10428|
002878  7da0              LDRB     r0,[r4,#0x16]  ; spc_stat
00287a  b9f8              CBNZ     r0,|L1.10428|
;;;5116   	{
;;;5117   	if((sign_U[1]==1) && (sign_I[1]==1) && (lc640_read_int(EE_BAT2_ZAR_CNT)!=BAT_C_REAL[1]) && (NUMBAT==2) && (!(bat[1]._av&1)))
00287c  7870              LDRB     r0,[r6,#1]  ; sign_U
00287e  2801              CMP      r0,#1
002880  d11c              BNE      |L1.10428|
002882  7878              LDRB     r0,[r7,#1]  ; sign_I
002884  2801              CMP      r0,#1
002886  d119              BNE      |L1.10428|
002888  f44f75e5          MOV      r5,#0x1ca
00288c  4628              MOV      r0,r5
00288e  f7fffffe          BL       lc640_read_int
002892  493d              LDR      r1,|L1.10632|
002894  f9b11002          LDRSH    r1,[r1,#2]  ; BAT_C_REAL
002898  4288              CMP      r0,r1
00289a  d00f              BEQ      |L1.10428|
00289c  483b              LDR      r0,|L1.10636|
00289e  8800              LDRH     r0,[r0,#0]  ; NUMBAT
0028a0  2802              CMP      r0,#2
0028a2  d10b              BNE      |L1.10428|
0028a4  f8980089          LDRB     r0,[r8,#0x89]  ; bat
0028a8  07c0              LSLS     r0,r0,#31
0028aa  d107              BNE      |L1.10428|
;;;5118   		{
;;;5119   		lc640_write_int(EE_BAT2_ZAR_CNT,BAT_C_REAL[1]);
0028ac  4628              MOV      r0,r5
0028ae  f7fffffe          BL       lc640_write_int
;;;5120   		superviser_cnt++;
0028b2  4837              LDR      r0,|L1.10640|
0028b4  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
0028b6  f1010101          ADD      r1,r1,#1
0028ba  7001              STRB     r1,[r0,#0]
                  |L1.10428|
;;;5121   		}
;;;5122   	
;;;5123   	}
;;;5124   
;;;5125   if(main_kb_cnt==((TBAT*60)-2)) zar_superviser_start();
0028bc  e06a              B        |L1.10644|
0028be  0000              DCW      0x0000
                  |L1.10432|
                          DCD      ||.bss||+0x440
                  |L1.10436|
                          DCD      NUMSK
                  |L1.10440|
                          DCD      NUMIST
                  |L1.10444|
                          DCD      ||area_number.26||+0x1e
                  |L1.10448|
                          DCD      sk_cnt
                  |L1.10452|
                          DCD      sk_stat
                  |L1.10456|
                          DCD      ||area_number.20||
                  |L1.10460|
                          DCD      sk_av_cnt
                  |L1.10464|
                          DCD      sk_av_stat
                  |L1.10468|
                          DCD      sk_av_stat_old
                  |L1.10472|
                          DCD      SK_SIGN
                  |L1.10476|
0028ec  534b2023          DCB      "SK #1 Alarm",0
0028f0  3120416c
0028f4  61726d00
                  |L1.10488|
0028f8  534b2023          DCB      "SK #2 Alarm",0
0028fc  3220416c
002900  61726d00
                  |L1.10500|
002904  534b2023          DCB      "SK #3 Alarm",0
002908  3320416c
00290c  61726d00
                  |L1.10512|
002910  534b2023          DCB      "SK #4 Alarm",0
002914  3420416c
002918  61726d00
                  |L1.10524|
00291c  534b2023          DCB      "SK #1 Alarm is off",0
002920  3120416c
002924  61726d20
002928  6973206f
00292c  666600  
00292f  00                DCB      0
                  |L1.10544|
002930  534b2023          DCB      "SK #2 Alarm is off",0
002934  3220416c
002938  61726d20
00293c  6973206f
002940  666600  
002943  00                DCB      0
                  |L1.10564|
002944  534b2023          DCB      "SK #3 Alarm is off",0
002948  3320416c
00294c  61726d20
002950  6973206f
002954  666600  
002957  00                DCB      0
                  |L1.10584|
002958  534b2023          DCB      "SK #4 Alarm is off",0
00295c  3420416c
002960  61726d20
002964  6973206f
002968  666600  
00296b  00                DCB      0
                  |L1.10604|
                          DCD      sign_U
                  |L1.10608|
                          DCD      sign_I
                  |L1.10612|
                          DCD      bat
                  |L1.10616|
                          DCD      u_necc_up
                  |L1.10620|
                          DCD      TBAT
                  |L1.10624|
                          DCD      u_necc_dn
                  |L1.10628|
                          DCD      IKB
                  |L1.10632|
                          DCD      BAT_C_REAL
                  |L1.10636|
                          DCD      NUMBAT
                  |L1.10640|
                          DCD      superviser_cnt
                  |L1.10644|
002994  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
002998  f06f0101          MVN      r1,#1
00299c  ebc01000          RSB      r0,r0,r0,LSL #4
0029a0  eb010080          ADD      r0,r1,r0,LSL #2
0029a4  f9b41042          LDRSH    r1,[r4,#0x42]  ; main_kb_cnt
0029a8  4288              CMP      r0,r1
0029aa  d102              BNE      |L1.10674|
0029ac  e8bd5ff0          POP      {r4-r12,lr}
0029b0  e7fe              B        zar_superviser_start
                  |L1.10674|
;;;5126   }
0029b2  e6ae              B        |L1.10002|
;;;5127   
                          ENDP

                  npn_hndl PROC
;;;5138   //-----------------------------------------------
;;;5139   void npn_hndl(void)
0029b4  e92d03f0          PUSH     {r4-r9}
;;;5140   {
;;;5141   if(NPN_OUT!=npnoOFF)
0029b8  48fa              LDR      r0,|L1.11684|
;;;5142   	{
;;;5143   /*	if(NPN_SIGN==npnsAVNET)
;;;5144   		{
;;;5145   		if(net_av==1)
;;;5146   			{
;;;5147   			if(npn_tz_cnt<TZNPN)
;;;5148   				{
;;;5149   				npn_tz_cnt++;
;;;5150   				if(npn_tz_cnt==TZNPN)
;;;5151   					{
;;;5152   					npn_stat=npnsOFF;
;;;5153   					}
;;;5154   				}
;;;5155   			}
;;;5156   		else
;;;5157   			{
;;;5158   			if(npn_tz_cnt)
;;;5159   				{
;;;5160   				npn_tz_cnt--;
;;;5161   				if(npn_tz_cnt==0)
;;;5162   					{
;;;5163   					npn_stat=npnsON;
;;;5164   					}
;;;5165   				}
;;;5166   			}
;;;5167   		}*/
;;;5168   /*	if(NPN_SIGN==npnsULOAD)
;;;5169   		{
;;;5170   		if(load_U<UONPN)
;;;5171   			{
;;;5172   			if(npn_tz_cnt<TZNPN)
;;;5173   				{
;;;5174   				npn_tz_cnt++;
;;;5175   				if(npn_tz_cnt==TZNPN)
;;;5176   					{
;;;5177   					npn_stat=npnsOFF;
;;;5178   					}
;;;5179   				}
;;;5180   			}
;;;5181   		else if(load_U>UVNPN)
;;;5182   			{
;;;5183   			if(npn_tz_cnt)
;;;5184   				{
;;;5185   				npn_tz_cnt--;
;;;5186   				if(npn_tz_cnt==0)
;;;5187   					{
;;;5188   					npn_stat=npnsON;
;;;5189   					}
;;;5190   				}
;;;5191   			}
;;;5192   		}*/
;;;5193   
;;;5194   	if((load_U<UONPN)&&((net_Ua<UMN)||(net_Ub<UMN)||(net_Uc<UMN)))
;;;5195   		{
;;;5196   		if(npn_tz_cnt<TZNPN)
0029ba  4ffb              LDR      r7,|L1.11688|
;;;5197   			{
;;;5198   			npn_tz_cnt++;
;;;5199   			if(npn_tz_cnt==TZNPN)
;;;5200   				{
;;;5201   				npn_stat=npnsOFF;
0029bc  4efb              LDR      r6,|L1.11692|
0029be  7800              LDRB     r0,[r0,#0]            ;5141  ; NPN_OUT
0029c0  f04f0c00          MOV      r12,#0                ;5141
;;;5202   				}
;;;5203   			}
;;;5204   		}
;;;5205   	else if((load_U>UVNPN)&&(net_Ua>UMN)&&(net_Ub>UMN)&&(net_Uc>UMN))
;;;5206   		{
;;;5207   		if(npn_tz_cnt)
;;;5208   			{
;;;5209   			npn_tz_cnt--;
;;;5210   			if(npn_tz_cnt==0)
;;;5211   				{
;;;5212   				npn_stat=npnsON;
0029c4  f04f0801          MOV      r8,#1
0029c8  b3e8              CBZ      r0,|L1.10822|
0029ca  48f9              LDR      r0,|L1.11696|
0029cc  4639              MOV      r1,r7                 ;5196
0029ce  f9b05000          LDRSH    r5,[r0,#0]            ;5194  ; load_U
0029d2  48f8              LDR      r0,|L1.11700|
0029d4  f9b11000          LDRSH    r1,[r1,#0]            ;5196
0029d8  f9b09000          LDRSH    r9,[r0,#0]            ;5194  ; UONPN
0029dc  48f6              LDR      r0,|L1.11704|
0029de  454d              CMP      r5,r9                 ;5194
0029e0  f9b02000          LDRSH    r2,[r0,#0]            ;5194
0029e4  48f5              LDR      r0,|L1.11708|
0029e6  f9b03000          LDRSH    r3,[r0,#0]            ;5194
0029ea  48f5              LDR      r0,|L1.11712|
0029ec  f9b04000          LDRSH    r4,[r0,#0]            ;5194
0029f0  48f4              LDR      r0,|L1.11716|
0029f2  f9b00000          LDRSH    r0,[r0,#0]            ;5194
0029f6  da13              BGE      |L1.10784|
0029f8  4282              CMP      r2,r0                 ;5194
0029fa  db03              BLT      |L1.10756|
0029fc  4283              CMP      r3,r0                 ;5194
0029fe  db01              BLT      |L1.10756|
002a00  4284              CMP      r4,r0                 ;5194
002a02  da0d              BGE      |L1.10784|
                  |L1.10756|
002a04  48f0              LDR      r0,|L1.11720|
002a06  f9b02000          LDRSH    r2,[r0,#0]            ;5196  ; TZNPN
002a0a  4291              CMP      r1,r2                 ;5196
002a0c  da23              BGE      |L1.10838|
002a0e  f1010101          ADD      r1,r1,#1              ;5198
002a12  b208              SXTH     r0,r1                 ;5198
002a14  8038              STRH     r0,[r7,#0]            ;5198
002a16  4290              CMP      r0,r2                 ;5199
002a18  d11d              BNE      |L1.10838|
002a1a  f886c000          STRB     r12,[r6,#0]           ;5201
002a1e  e01a              B        |L1.10838|
                  |L1.10784|
002a20  f8dfc3a8          LDR      r12,|L1.11724|
002a24  f9bcc000          LDRSH    r12,[r12,#0]          ;5205  ; UVNPN
002a28  4565              CMP      r5,r12                ;5205
002a2a  dd14              BLE      |L1.10838|
002a2c  4282              CMP      r2,r0                 ;5205
002a2e  dd12              BLE      |L1.10838|
002a30  4283              CMP      r3,r0                 ;5205
002a32  dd10              BLE      |L1.10838|
002a34  4284              CMP      r4,r0                 ;5205
002a36  dd0e              BLE      |L1.10838|
002a38  b169              CBZ      r1,|L1.10838|
002a3a  f1a10101          SUB      r1,r1,#1              ;5209
002a3e  b208              SXTH     r0,r1                 ;5209
002a40  8038              STRH     r0,[r7,#0]            ;5209
002a42  b940              CBNZ     r0,|L1.10838|
002a44  e000              B        |L1.10824|
                  |L1.10822|
002a46  e002              B        |L1.10830|
                  |L1.10824|
002a48  f8868000          STRB     r8,[r6,#0]
002a4c  e003              B        |L1.10838|
                  |L1.10830|
;;;5213   				}
;;;5214   			}
;;;5215   		}
;;;5216   	}
;;;5217   else
;;;5218   	{
;;;5219   	npn_tz_cnt=0;
002a4e  f8a7c000          STRH     r12,[r7,#0]
;;;5220   	npn_stat=npnsON;
002a52  f8868000          STRB     r8,[r6,#0]
                  |L1.10838|
;;;5221   	}
;;;5222   
;;;5223   if(npn_stat==npnsOFF) mess_send(MESS2RELE_HNDL,PARAM_RELE_NPN,1,15);
002a56  7830              LDRB     r0,[r6,#0]  ; npn_stat
002a58  2800              CMP      r0,#0
002a5a  d107              BNE      |L1.10860|
002a5c  e8bd03f0          POP      {r4-r9}
002a60  230f              MOVS     r3,#0xf
002a62  2201              MOVS     r2,#1
002a64  216e              MOVS     r1,#0x6e
002a66  20d2              MOVS     r0,#0xd2
002a68  f7ffbffe          B.W      mess_send
                  |L1.10860|
;;;5224   
;;;5225   
;;;5226   }
002a6c  e8bd03f0          POP      {r4-r9}
002a70  4770              BX       lr
;;;5227   
                          ENDP

                  numOfForvardBps_hndl PROC
;;;5321   //-----------------------------------------------
;;;5322   void	numOfForvardBps_hndl(void)			//ѕрограмма смены первого источника дл€ равномерного износа Ѕѕ—ов
002a72  e92d41f0          PUSH     {r4-r8,lr}
;;;5323   {
;;;5324   
;;;5325   numOfForvardBps_old=numOfForvardBps;
002a76  4cd6              LDR      r4,|L1.11728|
002a78  7ea0              LDRB     r0,[r4,#0x1a]  ; numOfForvardBps
002a7a  76e0              STRB     r0,[r4,#0x1b]
;;;5326   
;;;5327   numOfForvardBps=0;
002a7c  f04f0500          MOV      r5,#0
002a80  76a5              STRB     r5,[r4,#0x1a]
;;;5328   
;;;5329   //FORVARDBPSCHHOUR=10;
;;;5330   
;;;5331   if((FORVARDBPSCHHOUR<=0)||(FORVARDBPSCHHOUR>500))
002a82  4ed4              LDR      r6,|L1.11732|
002a84  f9b60000          LDRSH    r0,[r6,#0]  ; FORVARDBPSCHHOUR
002a88  2800              CMP      r0,#0
002a8a  dd02              BLE      |L1.10898|
002a8c  f5b07ffa          CMP      r0,#0x1f4
002a90  dd02              BLE      |L1.10904|
                  |L1.10898|
;;;5332   	{
;;;5333   	FORVARDBPSCHHOUR=0;
002a92  8035              STRH     r5,[r6,#0]
                  |L1.10900|
;;;5334   	return;
;;;5335   	}
;;;5336   
;;;5337   numOfForvardBps_minCnt++;
;;;5338   
;;;5339   
;;;5340   if(numOfForvardBps_minCnt>=60)
;;;5341   	{
;;;5342   	numOfForvardBps_minCnt=0;
;;;5343   	numOfForvardBps_hourCnt=lc640_read_int(EE_FORVBPSHOURCNT);
;;;5344   	numOfForvardBps_hourCnt++;
;;;5345   	if(numOfForvardBps_hourCnt>=(FORVARDBPSCHHOUR*NUMIST))
;;;5346   		{
;;;5347   		numOfForvardBps_hourCnt=0;
;;;5348   		}
;;;5349   	lc640_write_int(EE_FORVBPSHOURCNT,numOfForvardBps_hourCnt);
;;;5350   	}
;;;5351   
;;;5352   numOfForvardBps=numOfForvardBps_hourCnt/FORVARDBPSCHHOUR;
;;;5353   
;;;5354   //if(numOfForvardBps)
;;;5355   //numOfForvardBps_old=numOfForvardBps; 
;;;5356   }
002a94  e8bd81f0          POP      {r4-r8,pc}
                  |L1.10904|
002a98  7f20              LDRB     r0,[r4,#0x1c]         ;5337  ; numOfForvardBps_minCnt
002a9a  f1000001          ADD      r0,r0,#1              ;5337
002a9e  b2c0              UXTB     r0,r0                 ;5337
002aa0  7720              STRB     r0,[r4,#0x1c]         ;5337
002aa2  283c              CMP      r0,#0x3c              ;5340
002aa4  d31a              BCC      |L1.10972|
002aa6  7725              STRB     r5,[r4,#0x1c]         ;5342
002aa8  f44f7794          MOV      r7,#0x128             ;5343
002aac  4638              MOV      r0,r7                 ;5343
002aae  f7fffffe          BL       lc640_read_int
002ab2  f1000001          ADD      r0,r0,#1              ;5344
002ab6  b200              SXTH     r0,r0                 ;5344
002ab8  f8a40052          STRH     r0,[r4,#0x52]         ;5344
002abc  4ac6              LDR      r2,|L1.11736|
002abe  f9b61000          LDRSH    r1,[r6,#0]            ;5345  ; FORVARDBPSCHHOUR
002ac2  f9b22000          LDRSH    r2,[r2,#0]            ;5345  ; NUMIST
002ac6  fb01f102          MUL      r1,r1,r2              ;5345
002aca  4281              CMP      r1,r0                 ;5345
002acc  dc01              BGT      |L1.10962|
002ace  f8a45052          STRH     r5,[r4,#0x52]         ;5347
                  |L1.10962|
002ad2  f9b41052          LDRSH    r1,[r4,#0x52]         ;5349  ; numOfForvardBps_hourCnt
002ad6  4638              MOV      r0,r7                 ;5349
002ad8  f7fffffe          BL       lc640_write_int
                  |L1.10972|
002adc  f9b40052          LDRSH    r0,[r4,#0x52]         ;5352  ; numOfForvardBps_hourCnt
002ae0  f9b61000          LDRSH    r1,[r6,#0]            ;5352  ; FORVARDBPSCHHOUR
002ae4  fb90f0f1          SDIV     r0,r0,r1              ;5352
002ae8  76a0              STRB     r0,[r4,#0x1a]         ;5352
002aea  e7d3              B        |L1.10900|
;;;5357   
                          ENDP

                  numOfForvardBps_init PROC
;;;5358   //-----------------------------------------------
;;;5359   void	numOfForvardBps_init(void)			//ѕрограмма сброса системы смены первого источника дл€ равномерного износа Ѕѕ—ов
002aec  b510              PUSH     {r4,lr}
;;;5360   {									//ƒолжна вызыватьс€ при изменении кол-ва источников в структуре
;;;5361   lc640_write_int(EE_FORVBPSHOURCNT,0);
002aee  2100              MOVS     r1,#0
002af0  f44f7094          MOV      r0,#0x128
002af4  f7fffffe          BL       lc640_write_int
;;;5362   numOfForvardBps_minCnt=58;
002af8  49b5              LDR      r1,|L1.11728|
002afa  f04f003a          MOV      r0,#0x3a
002afe  7708              STRB     r0,[r1,#0x1c]
;;;5363   }
002b00  bd10              POP      {r4,pc}
;;;5364   
                          ENDP

                  vent_resurs_hndl PROC
;;;5410   //-----------------------------------------------
;;;5411   void vent_resurs_hndl(void)
002b02  e92d41f0          PUSH     {r4-r8,lr}
;;;5412   {
;;;5413   char i;
;;;5414   char crc_in,crc_eval;
;;;5415   
;;;5416   for(i=0;i<NUMIST;i++)
002b06  f04f0200          MOV      r2,#0
002b0a  48b3              LDR      r0,|L1.11736|
;;;5417   	{
;;;5418   	if((bps[i]._buff[7]&0xc0)==0x00)
002b0c  4fb3              LDR      r7,|L1.11740|
002b0e  f9b06000          LDRSH    r6,[r0,#0]            ;5416
002b12  e06e              B        |L1.11250|
                  |L1.11028|
002b14  eb020082          ADD      r0,r2,r2,LSL #2
002b18  eb0000c2          ADD      r0,r0,r2,LSL #3
002b1c  eb0700c0          ADD      r0,r7,r0,LSL #3
002b20  7b41              LDRB     r1,[r0,#0xd]
002b22  098b              LSRS     r3,r1,#6
002b24  d006              BEQ      |L1.11060|
;;;5419   		{
;;;5420   		bps[i]._vent_resurs_temp[0]=bps[i]._buff[7];
;;;5421   		}
;;;5422   	else if((bps[i]._buff[7]&0xc0)==0x40)
002b26  2301              MOVS     r3,#1
002b28  ebb31f91          CMP      r3,r1,LSR #6
002b2c  d105              BNE      |L1.11066|
;;;5423   		{
;;;5424   		bps[i]._vent_resurs_temp[1]=bps[i]._buff[7];
002b2e  f8801059          STRB     r1,[r0,#0x59]
002b32  e00f              B        |L1.11092|
                  |L1.11060|
002b34  f8801058          STRB     r1,[r0,#0x58]         ;5420
002b38  e00c              B        |L1.11092|
                  |L1.11066|
;;;5425   		}
;;;5426   	else if((bps[i]._buff[7]&0xc0)==0x80)
002b3a  2302              MOVS     r3,#2
002b3c  ebb31f91          CMP      r3,r1,LSR #6
002b40  d102              BNE      |L1.11080|
;;;5427   		{
;;;5428   		bps[i]._vent_resurs_temp[2]=bps[i]._buff[7];
002b42  f880105a          STRB     r1,[r0,#0x5a]
002b46  e005              B        |L1.11092|
                  |L1.11080|
;;;5429   		}
;;;5430   	else if((bps[i]._buff[7]&0xc0)==0xc0)
002b48  2303              MOVS     r3,#3
002b4a  ebb31f91          CMP      r3,r1,LSR #6
002b4e  d101              BNE      |L1.11092|
;;;5431   		{
;;;5432   		bps[i]._vent_resurs_temp[3]=bps[i]._buff[7];
002b50  f880105b          STRB     r1,[r0,#0x5b]
                  |L1.11092|
;;;5433   		}
;;;5434   	crc_in=0;
;;;5435   	crc_in|=(bps[i]._vent_resurs_temp[0]&0x30)>>4;
002b54  f8101f58          LDRB     r1,[r0,#0x58]!
002b58  f3c11401          UBFX     r4,r1,#4,#2
;;;5436   	crc_in|=(bps[i]._vent_resurs_temp[1]&0x30)>>2;
002b5c  7843              LDRB     r3,[r0,#1]
002b5e  f0030530          AND      r5,r3,#0x30
002b62  ea440595          ORR      r5,r4,r5,LSR #2
;;;5437   	crc_in|=(bps[i]._vent_resurs_temp[2]&0x30);
002b66  7884              LDRB     r4,[r0,#2]
002b68  f0040c30          AND      r12,r4,#0x30
002b6c  ea4c0c05          ORR      r12,r12,r5
;;;5438   	crc_in|=(bps[i]._vent_resurs_temp[3]&0x30)<<2;
002b70  78c5              LDRB     r5,[r0,#3]
002b72  f1a00058          SUB      r0,r0,#0x58
002b76  f0050830          AND      r8,r5,#0x30
002b7a  ea4c0c88          ORR      r12,r12,r8,LSL #2
;;;5439   
;;;5440   	crc_eval =bps[i]._vent_resurs_temp[0]&0x0f;
002b7e  f001010f          AND      r1,r1,#0xf
;;;5441   	crc_eval^=bps[i]._vent_resurs_temp[1]&0x0f;
002b82  f003030f          AND      r3,r3,#0xf
002b86  ea830801          EOR      r8,r3,r1
;;;5442   	crc_eval^=bps[i]._vent_resurs_temp[2]&0x0f;
002b8a  f004040f          AND      r4,r4,#0xf
002b8e  ea840808          EOR      r8,r4,r8
;;;5443   	crc_eval^=bps[i]._vent_resurs_temp[3]&0x0f;
002b92  f005050f          AND      r5,r5,#0xf
002b96  ea850808          EOR      r8,r5,r8
;;;5444   
;;;5445   	if(crc_eval==crc_in)
002b9a  45e0              CMP      r8,r12
002b9c  d113              BNE      |L1.11206|
;;;5446   		{
;;;5447   		unsigned short temp_US;
;;;5448   		temp_US=0;
;;;5449   
;;;5450   		temp_US|=(bps[i]._vent_resurs_temp[3]&0x0f);
;;;5451   		temp_US<<=4;
002b9e  ea4f1505          LSL      r5,r5,#4
;;;5452   		temp_US|=(bps[i]._vent_resurs_temp[2]&0x0f);
002ba2  ea440405          ORR      r4,r4,r5
;;;5453   		temp_US<<=4;
002ba6  ea4f1404          LSL      r4,r4,#4
;;;5454   		temp_US|=(bps[i]._vent_resurs_temp[1]&0x0f);
002baa  ea430304          ORR      r3,r3,r4
;;;5455   		temp_US<<=4;
002bae  ea4f5303          LSL      r3,r3,#20
002bb2  ea4f4313          LSR      r3,r3,#16
;;;5456   		temp_US|=(bps[i]._vent_resurs_temp[0]&0x0f);
002bb6  ea410103          ORR      r1,r1,r3
;;;5457   
;;;5458   		if(bps[i]._vent_resurs!=temp_US)bps[i]._vent_resurs=temp_US;
002bba  f8b0305c          LDRH     r3,[r0,#0x5c]
002bbe  428b              CMP      r3,r1
002bc0  d001              BEQ      |L1.11206|
002bc2  f8a0105c          STRH     r1,[r0,#0x5c]
                  |L1.11206|
;;;5459   		}
;;;5460   
;;;5461   	if(bps[i]._vent_resurs>TVENTMAX*10)
002bc6  4986              LDR      r1,|L1.11744|
002bc8  f8b0305c          LDRH     r3,[r0,#0x5c]
002bcc  f9b11000          LDRSH    r1,[r1,#0]  ; TVENTMAX
002bd0  eb010181          ADD      r1,r1,r1,LSL #2
002bd4  ebb30f41          CMP      r3,r1,LSL #1
002bd8  dd04              BLE      |L1.11236|
;;;5462   		{
;;;5463   		bps[i]._av|=(1<<4);
002bda  7841              LDRB     r1,[r0,#1]
002bdc  f0410110          ORR      r1,r1,#0x10
002be0  7041              STRB     r1,[r0,#1]
002be2  e003              B        |L1.11244|
                  |L1.11236|
;;;5464   		}
;;;5465   	else bps[i]._av&=~(1<<4);
002be4  7841              LDRB     r1,[r0,#1]
002be6  f0210110          BIC      r1,r1,#0x10
002bea  7041              STRB     r1,[r0,#1]
                  |L1.11244|
002bec  f1020201          ADD      r2,r2,#1              ;5416
002bf0  b2d2              UXTB     r2,r2                 ;5416
                  |L1.11250|
002bf2  42b2              CMP      r2,r6                 ;5416
002bf4  db8e              BLT      |L1.11028|
;;;5466   	}
;;;5467   }
002bf6  e74d              B        |L1.10900|
;;;5468   
                          ENDP

                  vent_hndl PROC
;;;5469   //-----------------------------------------------
;;;5470   void vent_hndl(void)
002bf8  e92d4ff0          PUSH     {r4-r11,lr}
;;;5471   {
002bfc  b087              SUB      sp,sp,#0x1c
;;;5472   if(RELEVENTSIGN==rvsAKB)
002bfe  4879              LDR      r0,|L1.11748|
;;;5473   	{
;;;5474   	if(vent_stat==0)
002c00  4c73              LDR      r4,|L1.11728|
;;;5475   		{
;;;5476   		if	(
;;;5477   			(BAT_IS_ON[0]==bisON)&&((bat[0]._Tb>TVENTON)||(bat[0]._nd))
002c02  4979              LDR      r1,|L1.11752|
;;;5478   			||
;;;5479   			(BAT_IS_ON[1]==bisON)&&((bat[1]._Tb>TVENTON)||(bat[1]._nd))
;;;5480   			)
;;;5481   			{
;;;5482   			vent_stat=1;
;;;5483   			}
;;;5484   		}
;;;5485   	else if(vent_stat==1)
;;;5486   		{
;;;5487   		if	(
;;;5488   			((BAT_IS_ON[0]!=bisON)||((BAT_IS_ON[0]==bisON)&&(bat[0]._Tb<TVENTOFF)&&(!bat[0]._nd)))
002c04  4a79              LDR      r2,|L1.11756|
002c06  7800              LDRB     r0,[r0,#0]            ;5472  ; RELEVENTSIGN
002c08  f9943000          LDRSB    r3,[r4,#0]            ;5474
002c0c  f9b11000          LDRSH    r1,[r1,#0]            ;5477
002c10  f9b22000          LDRSH    r2,[r2,#0]
002c14  b148              CBZ      r0,|L1.11306|
;;;5489   			&&
;;;5490   			((BAT_IS_ON[1]!=bisON)||((BAT_IS_ON[1]==bisON)&&(bat[1]._Tb<TVENTOFF)&&(!bat[1]._nd)))
;;;5491   			)
;;;5492   			{
;;;5493   			vent_stat=0;
;;;5494   			}
;;;5495   		}
;;;5496   	}
;;;5497   else if(RELEVENTSIGN==rvsBPS)
002c16  2802              CMP      r0,#2
002c18  d03c              BEQ      |L1.11412|
;;;5498   	{
;;;5499   /*	if	(
;;;5500   		(((bps[0]._flags_tm&0x06)||(bps[0]._cnt>=30)))||
;;;5501   		(((bps[1]._flags_tm&0x06)||(bps[1]._cnt>=30))&&(NUMIST>1))||
;;;5502   		(((bps[2]._flags_tm&0x06)||(bps[2]._cnt>=30))&&(NUMIST>2))||
;;;5503   		(((bps[3]._flags_tm&0x06)||(bps[3]._cnt>=30))&&(NUMIST>3))||
;;;5504   		(((bps[4]._flags_tm&0x06)||(bps[4]._cnt>=30))&&(NUMIST>4))||
;;;5505   		(((bps[5]._flags_tm&0x06)||(bps[5]._cnt>=30))&&(NUMIST>5))||
;;;5506   		(((bps[6]._flags_tm&0x06)||(bps[6]._cnt>=30))&&(NUMIST>6))
;;;5507   		)
;;;5508   		{
;;;5509   		vent_stat=1;
;;;5510   		}
;;;5511   	else vent_stat=0;
;;;5512   	*/
;;;5513   
;;;5514   	if	(
;;;5515   		((NUMIST)&&((bps[0]._Ti>TVENTON)||(bps[0]._cnt>=30)))
;;;5516   		||
;;;5517   		((NUMIST>1)&&((bps[1]._Ti>TVENTON)||(bps[1]._cnt>=30)))
;;;5518   		||
;;;5519   		((NUMIST>2)&&((bps[2]._Ti>TVENTON)||(bps[2]._cnt>=30)))
;;;5520   		||
;;;5521   		((NUMIST>3)&&((bps[3]._Ti>TVENTON)||(bps[3]._cnt>=30)))
;;;5522   		||
;;;5523   		((NUMIST>4)&&((bps[4]._Ti>TVENTON)||(bps[4]._cnt>=30)))
;;;5524   		||
;;;5525   		((NUMIST>5)&&((bps[5]._Ti>TVENTON)||(bps[5]._cnt>=30)))
;;;5526   		||
;;;5527   		((NUMIST>6)&&((bps[6]._Ti>TVENTON)||(bps[6]._cnt>=30)))
;;;5528   		||
;;;5529   		((NUMIST>7)&&((bps[7]._Ti>TVENTON)||(bps[7]._cnt>=30)))
;;;5530   		)
;;;5531   		{
;;;5532   		vent_stat=1;
;;;5533   		}
;;;5534   	else if(vent_stat==1)
;;;5535   		{
;;;5536   		if	(
;;;5537   			((!NUMIST)||((NUMIST)&&(bps[0]._Ti<TVENTOFF)&&(bps[0]._cnt<10)))
;;;5538   			&&
;;;5539   			((NUMIST<2)||((NUMIST>=2)&&(bps[1]._Ti<TVENTOFF)&&(bps[1]._cnt<10)))
;;;5540   			&&
;;;5541   			((NUMIST<3)||((NUMIST>=3)&&(bps[2]._Ti<TVENTOFF)&&(bps[2]._cnt<10)))
;;;5542   			&&
;;;5543   			((NUMIST<4)||((NUMIST>=4)&&(bps[3]._Ti<TVENTOFF)&&(bps[3]._cnt<10)))
;;;5544   			&&
;;;5545   			((NUMIST<5)||((NUMIST>=5)&&(bps[4]._Ti<TVENTOFF)&&(bps[4]._cnt<10)))
;;;5546   			&&
;;;5547   			((NUMIST<6)||((NUMIST>=6)&&(bps[5]._Ti<TVENTOFF)&&(bps[5]._cnt<10)))
;;;5548   			&&
;;;5549   			((NUMIST<7)||((NUMIST>=7)&&(bps[6]._Ti<TVENTOFF)&&(bps[6]._cnt<10)))
;;;5550   			&&
;;;5551   			((NUMIST<8)||((NUMIST>=8)&&(bps[7]._Ti<TVENTOFF)&&(bps[7]._cnt<10)))
;;;5552   			)
;;;5553   			{
;;;5554   			vent_stat=0;
;;;5555   			}
;;;5556   		}
;;;5557   	}
;;;5558   else if(RELEVENTSIGN==rvsEXT)
002c1a  2801              CMP      r0,#1
002c1c  d07e              BEQ      |L1.11548|
;;;5559   	{
;;;5560   	if	(
;;;5561   		((NUMDT)&&((t_ext[0]>TVENTON)||(ND_EXT[0])))
;;;5562   		||
;;;5563   		((NUMDT>1)&&((t_ext[1]>TVENTON)||(ND_EXT[1])))
;;;5564   		||
;;;5565   		((NUMDT>2)&&((t_ext[2]>TVENTON)||(ND_EXT[2])))
;;;5566   		)
;;;5567   		{
;;;5568   		vent_stat=1;
;;;5569   		}
;;;5570   	else if(vent_stat==1)
;;;5571   		{
;;;5572   		if	(
;;;5573   			((!NUMDT)||((NUMDT)&&(t_ext[0]<TVENTOFF)&&(!ND_EXT[0])))
;;;5574   			&&
;;;5575   			((NUMDT<2)||((NUMDT>=2)&&(t_ext[1]<TVENTOFF)&&(!ND_EXT[1])))
;;;5576   			&&
;;;5577   			((NUMDT<3)||((NUMDT>=3)&&(t_ext[2]<TVENTOFF)&&(!ND_EXT[2])))
;;;5578   			)
;;;5579   			{
;;;5580   			vent_stat=0;
;;;5581   			}
;;;5582   		}
;;;5583   	}
;;;5584   else vent_stat=1;
002c1e  f04f0001          MOV      r0,#1
002c22  7020              STRB     r0,[r4,#0]
                  |L1.11300|
;;;5585   }
002c24  b007              ADD      sp,sp,#0x1c
002c26  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.11306|
002c2a  4f71              LDR      r7,|L1.11760|
002c2c  f8df81c4          LDR      r8,|L1.11764|
002c30  f9b7000a          LDRSH    r0,[r7,#0xa]          ;5477
002c34  7b3d              LDRB     r5,[r7,#0xc]          ;5477
002c36  f9b76056          LDRSH    r6,[r7,#0x56]         ;5479
002c3a  f898c000          LDRB     r12,[r8,#0]           ;5476
002c3e  f8977058          LDRB     r7,[r7,#0x58]         ;5479
002c42  f8988001          LDRB     r8,[r8,#1]            ;5479
002c46  b12b              CBZ      r3,|L1.11348|
002c48  2b01              CMP      r3,#1                 ;5485
002c4a  d1eb              BNE      |L1.11300|
002c4c  f1bc0f55          CMP      r12,#0x55             ;5487
002c50  d115              BNE      |L1.11390|
002c52  e010              B        |L1.11382|
                  |L1.11348|
002c54  f1bc0f55          CMP      r12,#0x55             ;5476
002c58  d102              BNE      |L1.11360|
002c5a  4288              CMP      r0,r1                 ;5477
002c5c  dc07              BGT      |L1.11374|
002c5e  b935              CBNZ     r5,|L1.11374|
                  |L1.11360|
002c60  f1b80f55          CMP      r8,#0x55              ;5479
002c64  d1de              BNE      |L1.11300|
002c66  428e              CMP      r6,r1                 ;5479
002c68  dc01              BGT      |L1.11374|
002c6a  2f00              CMP      r7,#0                 ;5479
002c6c  d0da              BEQ      |L1.11300|
                  |L1.11374|
002c6e  f04f0001          MOV      r0,#1                 ;5482
002c72  7020              STRB     r0,[r4,#0]            ;5482
002c74  e7d6              B        |L1.11300|
                  |L1.11382|
002c76  4290              CMP      r0,r2                 ;5488
002c78  dad4              BGE      |L1.11300|
002c7a  2d00              CMP      r5,#0                 ;5488
002c7c  d1d2              BNE      |L1.11300|
                  |L1.11390|
002c7e  f1b80f55          CMP      r8,#0x55              ;5490
002c82  d103              BNE      |L1.11404|
002c84  4296              CMP      r6,r2                 ;5490
002c86  dacd              BGE      |L1.11300|
002c88  2f00              CMP      r7,#0                 ;5490
002c8a  d1cb              BNE      |L1.11300|
                  |L1.11404|
002c8c  f04f0000          MOV      r0,#0                 ;5493
002c90  7020              STRB     r0,[r4,#0]            ;5493
002c92  e7c7              B        |L1.11300|
                  |L1.11412|
002c94  4e51              LDR      r6,|L1.11740|
002c96  4850              LDR      r0,|L1.11736|
002c98  6ab5              LDR      r5,[r6,#0x28]         ;5515
002c9a  f9b00000          LDRSH    r0,[r0,#0]            ;5514  ; NUMIST
002c9e  78f6              LDRB     r6,[r6,#3]            ;5515
002ca0  b118              CBZ      r0,|L1.11434|
002ca2  428d              CMP      r5,r1                 ;5515
002ca4  dc7a              BGT      |L1.11676|
002ca6  2e1e              CMP      r6,#0x1e              ;5515
002ca8  d278              BCS      |L1.11676|
                  |L1.11434|
002caa  f8dfc130          LDR      r12,|L1.11740|
002cae  2801              CMP      r0,#1                 ;5517
002cb0  f8dc7090          LDR      r7,[r12,#0x90]        ;5517
002cb4  f89cc06b          LDRB     r12,[r12,#0x6b]       ;5517
002cb8  f8cdc018          STR      r12,[sp,#0x18]        ;5517
002cbc  dd06              BLE      |L1.11468|
002cbe  428f              CMP      r7,r1                 ;5517
002cc0  dc6c              BGT      |L1.11676|
002cc2  f8ddc018          LDR      r12,[sp,#0x18]        ;5517
002cc6  f1bc0f1e          CMP      r12,#0x1e             ;5517
002cca  d267              BCS      |L1.11676|
                  |L1.11468|
002ccc  f8dfc10c          LDR      r12,|L1.11740|
002cd0  2802              CMP      r0,#2                 ;5519
002cd2  f8dc80f8          LDR      r8,[r12,#0xf8]        ;5519
002cd6  f8cd8014          STR      r8,[sp,#0x14]         ;5519
002cda  f89cc0d3          LDRB     r12,[r12,#0xd3]       ;5519
002cde  f8cdc010          STR      r12,[sp,#0x10]        ;5519
002ce2  dd08              BLE      |L1.11510|
002ce4  f8ddc014          LDR      r12,[sp,#0x14]        ;5519
002ce8  458c              CMP      r12,r1                ;5519
002cea  dc57              BGT      |L1.11676|
002cec  f8ddc010          LDR      r12,[sp,#0x10]        ;5519
002cf0  f1bc0f1e          CMP      r12,#0x1e             ;5519
002cf4  d252              BCS      |L1.11676|
                  |L1.11510|
002cf6  f8dfc0e4          LDR      r12,|L1.11740|
002cfa  2803              CMP      r0,#3                 ;5521
002cfc  f8dc8160          LDR      r8,[r12,#0x160]       ;5521
002d00  f8cd800c          STR      r8,[sp,#0xc]          ;5521
002d04  f89cc13b          LDRB     r12,[r12,#0x13b]      ;5521
002d08  f8cdc008          STR      r12,[sp,#8]           ;5521
002d0c  dd0a              BLE      |L1.11556|
002d0e  f8ddc00c          LDR      r12,[sp,#0xc]         ;5521
002d12  458c              CMP      r12,r1                ;5521
002d14  dc42              BGT      |L1.11676|
002d16  f8ddc008          LDR      r12,[sp,#8]           ;5521
002d1a  e000              B        |L1.11550|
                  |L1.11548|
002d1c  e0aa              B        |L1.11892|
                  |L1.11550|
002d1e  f1bc0f1e          CMP      r12,#0x1e             ;5521
002d22  d23b              BCS      |L1.11676|
                  |L1.11556|
002d24  f8df80b4          LDR      r8,|L1.11740|
002d28  2804              CMP      r0,#4                 ;5523
002d2a  f8d8c1c8          LDR      r12,[r8,#0x1c8]       ;5523
002d2e  f89881a3          LDRB     r8,[r8,#0x1a3]        ;5523
002d32  f8cd8004          STR      r8,[sp,#4]            ;5523
002d36  dd06              BLE      |L1.11590|
002d38  458c              CMP      r12,r1                ;5523
002d3a  dc2f              BGT      |L1.11676|
002d3c  f8dd8004          LDR      r8,[sp,#4]            ;5523
002d40  f1b80f1e          CMP      r8,#0x1e              ;5523
002d44  d22a              BCS      |L1.11676|
                  |L1.11590|
002d46  f8df9094          LDR      r9,|L1.11740|
002d4a  2805              CMP      r0,#5                 ;5525
002d4c  f8d98230          LDR      r8,[r9,#0x230]        ;5525
002d50  f899920b          LDRB     r9,[r9,#0x20b]        ;5525
002d54  f8cd9000          STR      r9,[sp,#0]            ;5525
002d58  dd06              BLE      |L1.11624|
002d5a  4588              CMP      r8,r1                 ;5525
002d5c  dc1e              BGT      |L1.11676|
002d5e  f8dd9000          LDR      r9,[sp,#0]            ;5525
002d62  f1b90f1e          CMP      r9,#0x1e              ;5525
002d66  d219              BCS      |L1.11676|
                  |L1.11624|
002d68  f8dfa070          LDR      r10,|L1.11740|
002d6c  2806              CMP      r0,#6                 ;5527
002d6e  f89ae273          LDRB     lr,[r10,#0x273]       ;5527
002d72  f8da9298          LDR      r9,[r10,#0x298]       ;5527
002d76  dd04              BLE      |L1.11650|
002d78  4589              CMP      r9,r1                 ;5527
002d7a  dc0f              BGT      |L1.11676|
002d7c  f1be0f1e          CMP      lr,#0x1e              ;5527
002d80  d20c              BCS      |L1.11676|
                  |L1.11650|
002d82  f8dfb058          LDR      r11,|L1.11740|
002d86  2807              CMP      r0,#7                 ;5529
002d88  f8dba300          LDR      r10,[r11,#0x300]      ;5529
002d8c  f89bb2db          LDRB     r11,[r11,#0x2db]      ;5529
002d90  dd32              BLE      |L1.11768|
002d92  458a              CMP      r10,r1                ;5529
002d94  dc02              BGT      |L1.11676|
002d96  f1bb0f1e          CMP      r11,#0x1e             ;5529
002d9a  d32d              BCC      |L1.11768|
                  |L1.11676|
002d9c  f04f0001          MOV      r0,#1                 ;5532
002da0  7020              STRB     r0,[r4,#0]            ;5532
                  |L1.11682|
002da2  e73f              B        |L1.11300|
                  |L1.11684|
                          DCD      NPN_OUT
                  |L1.11688|
                          DCD      npn_tz_cnt
                  |L1.11692|
                          DCD      npn_stat
                  |L1.11696|
                          DCD      load_U
                  |L1.11700|
                          DCD      UONPN
                  |L1.11704|
                          DCD      net_Ua
                  |L1.11708|
                          DCD      net_Ub
                  |L1.11712|
                          DCD      net_Uc
                  |L1.11716|
                          DCD      UMN
                  |L1.11720|
                          DCD      TZNPN
                  |L1.11724|
                          DCD      UVNPN
                  |L1.11728|
                          DCD      ||area_number.26||
                  |L1.11732|
                          DCD      FORVARDBPSCHHOUR
                  |L1.11736|
                          DCD      NUMIST
                  |L1.11740|
                          DCD      bps
                  |L1.11744|
                          DCD      TVENTMAX
                  |L1.11748|
                          DCD      RELEVENTSIGN
                  |L1.11752|
                          DCD      TVENTON
                  |L1.11756|
                          DCD      TVENTOFF
                  |L1.11760|
                          DCD      bat
                  |L1.11764|
                          DCD      BAT_IS_ON
                  |L1.11768|
002df8  2b01              CMP      r3,#1                 ;5534
002dfa  d1d2              BNE      |L1.11682|
002dfc  b118              CBZ      r0,|L1.11782|
002dfe  4295              CMP      r5,r2                 ;5537
002e00  dacf              BGE      |L1.11682|
002e02  2e0a              CMP      r6,#0xa               ;5537
002e04  d2cd              BCS      |L1.11682|
                  |L1.11782|
002e06  2802              CMP      r0,#2                 ;5539
002e08  db04              BLT      |L1.11796|
002e0a  4297              CMP      r7,r2                 ;5539
002e0c  dac9              BGE      |L1.11682|
002e0e  9906              LDR      r1,[sp,#0x18]         ;5539
002e10  290a              CMP      r1,#0xa               ;5539
002e12  d2c6              BCS      |L1.11682|
                  |L1.11796|
002e14  2803              CMP      r0,#3                 ;5541
002e16  db05              BLT      |L1.11812|
002e18  9905              LDR      r1,[sp,#0x14]         ;5541
002e1a  4291              CMP      r1,r2                 ;5541
002e1c  dac1              BGE      |L1.11682|
002e1e  9904              LDR      r1,[sp,#0x10]         ;5541
002e20  290a              CMP      r1,#0xa               ;5541
002e22  d2be              BCS      |L1.11682|
                  |L1.11812|
002e24  2804              CMP      r0,#4                 ;5543
002e26  db05              BLT      |L1.11828|
002e28  9903              LDR      r1,[sp,#0xc]          ;5543
002e2a  4291              CMP      r1,r2                 ;5543
002e2c  dab9              BGE      |L1.11682|
002e2e  9902              LDR      r1,[sp,#8]            ;5543
002e30  290a              CMP      r1,#0xa               ;5543
002e32  d2b6              BCS      |L1.11682|
                  |L1.11828|
002e34  2805              CMP      r0,#5                 ;5545
002e36  db04              BLT      |L1.11842|
002e38  4594              CMP      r12,r2                ;5545
002e3a  dab2              BGE      |L1.11682|
002e3c  9901              LDR      r1,[sp,#4]            ;5545
002e3e  290a              CMP      r1,#0xa               ;5545
002e40  d2af              BCS      |L1.11682|
                  |L1.11842|
002e42  2806              CMP      r0,#6                 ;5547
002e44  db04              BLT      |L1.11856|
002e46  4590              CMP      r8,r2                 ;5547
002e48  daab              BGE      |L1.11682|
002e4a  9900              LDR      r1,[sp,#0]            ;5547
002e4c  290a              CMP      r1,#0xa               ;5547
002e4e  d2a8              BCS      |L1.11682|
                  |L1.11856|
002e50  2807              CMP      r0,#7                 ;5549
002e52  db04              BLT      |L1.11870|
002e54  4591              CMP      r9,r2                 ;5549
002e56  daa4              BGE      |L1.11682|
002e58  f1be0f0a          CMP      lr,#0xa               ;5549
002e5c  d2a1              BCS      |L1.11682|
                  |L1.11870|
002e5e  2808              CMP      r0,#8                 ;5551
002e60  db04              BLT      |L1.11884|
002e62  4592              CMP      r10,r2                ;5551
002e64  da9d              BGE      |L1.11682|
002e66  f1bb0f0a          CMP      r11,#0xa              ;5551
002e6a  d29a              BCS      |L1.11682|
                  |L1.11884|
002e6c  f04f0000          MOV      r0,#0                 ;5554
002e70  7020              STRB     r0,[r4,#0]            ;5554
                  |L1.11890|
002e72  e6d7              B        |L1.11300|
                  |L1.11892|
002e74  4833              LDR      r0,|L1.12100|
002e76  4d34              LDR      r5,|L1.12104|
002e78  4e34              LDR      r6,|L1.12108|
002e7a  f9b00000          LDRSH    r0,[r0,#0]            ;5560  ; NUMDT
002e7e  f9b55000          LDRSH    r5,[r5,#0]            ;5561
002e82  7836              LDRB     r6,[r6,#0]            ;5561
002e84  b110              CBZ      r0,|L1.11916|
002e86  428d              CMP      r5,r1                 ;5561
002e88  dc1d              BGT      |L1.11974|
002e8a  b9e6              CBNZ     r6,|L1.11974|
                  |L1.11916|
002e8c  4f2e              LDR      r7,|L1.12104|
002e8e  f8dfc0bc          LDR      r12,|L1.12108|
002e92  2801              CMP      r0,#1                 ;5563
002e94  f9b77002          LDRSH    r7,[r7,#2]            ;5563
002e98  f89cc001          LDRB     r12,[r12,#1]          ;5563
002e9c  dd04              BLE      |L1.11944|
002e9e  428f              CMP      r7,r1                 ;5563
002ea0  dc11              BGT      |L1.11974|
002ea2  f1bc0f00          CMP      r12,#0                ;5563
002ea6  d10e              BNE      |L1.11974|
                  |L1.11944|
002ea8  f8df809c          LDR      r8,|L1.12104|
002eac  f8df909c          LDR      r9,|L1.12108|
002eb0  2802              CMP      r0,#2                 ;5565
002eb2  f9b88004          LDRSH    r8,[r8,#4]            ;5565
002eb6  f8999002          LDRB     r9,[r9,#2]            ;5565
002eba  dd08              BLE      |L1.11982|
002ebc  4588              CMP      r8,r1                 ;5565
002ebe  dc02              BGT      |L1.11974|
002ec0  f1b90f00          CMP      r9,#0                 ;5565
002ec4  d003              BEQ      |L1.11982|
                  |L1.11974|
002ec6  f04f0001          MOV      r0,#1                 ;5568
002eca  7020              STRB     r0,[r4,#0]            ;5568
002ecc  e6aa              B        |L1.11300|
                  |L1.11982|
002ece  2b01              CMP      r3,#1                 ;5570
002ed0  d1cf              BNE      |L1.11890|
002ed2  b118              CBZ      r0,|L1.11996|
002ed4  4295              CMP      r5,r2                 ;5573
002ed6  dacc              BGE      |L1.11890|
002ed8  2e00              CMP      r6,#0                 ;5573
002eda  d1ca              BNE      |L1.11890|
                  |L1.11996|
002edc  2802              CMP      r0,#2                 ;5575
002ede  db04              BLT      |L1.12010|
002ee0  4297              CMP      r7,r2                 ;5575
002ee2  dac6              BGE      |L1.11890|
002ee4  f1bc0f00          CMP      r12,#0                ;5575
002ee8  d1c3              BNE      |L1.11890|
                  |L1.12010|
002eea  2803              CMP      r0,#3                 ;5577
002eec  db04              BLT      |L1.12024|
002eee  4590              CMP      r8,r2                 ;5577
002ef0  dabf              BGE      |L1.11890|
002ef2  f1b90f00          CMP      r9,#0                 ;5577
002ef6  d1bc              BNE      |L1.11890|
                  |L1.12024|
002ef8  f04f0000          MOV      r0,#0                 ;5580
002efc  7020              STRB     r0,[r4,#0]            ;5580
002efe  e691              B        |L1.11300|
;;;5586   
                          ENDP

                  vd_is_work_hndl PROC
;;;5587   //-----------------------------------------------
;;;5588   void vd_is_work_hndl(void)
002f00  4813              LDR      r0,|L1.12112|
;;;5589   {
;;;5590   if(vd_U>20)
;;;5591   	{
;;;5592   	if(vd_is_work_cnt<5)vd_is_work_cnt++;
002f02  4914              LDR      r1,|L1.12116|
002f04  2200              MOVS     r2,#0
002f06  f9b03000          LDRSH    r3,[r0,#0]            ;5590  ; vd_U
002f0a  7808              LDRB     r0,[r1,#0]
002f0c  2b14              CMP      r3,#0x14              ;5590
002f0e  dd09              BLE      |L1.12068|
002f10  2805              CMP      r0,#5
002f12  d203              BCS      |L1.12060|
002f14  f1000001          ADD      r0,r0,#1
002f18  7008              STRB     r0,[r1,#0]
002f1a  e007              B        |L1.12076|
                  |L1.12060|
;;;5593   	else vd_is_work_cnt=5;
002f1c  f04f0005          MOV      r0,#5
002f20  7008              STRB     r0,[r1,#0]
002f22  e003              B        |L1.12076|
                  |L1.12068|
;;;5594   	}
;;;5595   else
;;;5596   	{
;;;5597   	if(vd_is_work_cnt>0)vd_is_work_cnt--;
002f24  b110              CBZ      r0,|L1.12076|
002f26  f1a00001          SUB      r0,r0,#1
002f2a  7008              STRB     r0,[r1,#0]
                  |L1.12076|
;;;5598   	else vd_is_work_cnt=0;
;;;5599   	}
;;;5600   
;;;5601   if(vd_is_work_cnt==5) bVDISWORK=1;
002f2c  7808              LDRB     r0,[r1,#0]  ; vd_is_work_cnt
002f2e  490a              LDR      r1,|L1.12120|
002f30  2805              CMP      r0,#5
002f32  d003              BEQ      |L1.12092|
;;;5602   else if(vd_is_work_cnt==0) bVDISWORK=0;
002f34  2800              CMP      r0,#0
002f36  d100              BNE      |L1.12090|
002f38  700a              STRB     r2,[r1,#0]
                  |L1.12090|
;;;5603   }
002f3a  4770              BX       lr
                  |L1.12092|
002f3c  f04f0001          MOV      r0,#1                 ;5601
002f40  7008              STRB     r0,[r1,#0]            ;5601
002f42  4770              BX       lr
;;;5604   
                          ENDP

                  |L1.12100|
                          DCD      NUMDT
                  |L1.12104|
                          DCD      t_ext
                  |L1.12108|
                          DCD      ND_EXT
                  |L1.12112|
                          DCD      vd_U
                  |L1.12116|
                          DCD      vd_is_work_cnt
                  |L1.12120|
                          DCD      bVDISWORK

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  samokalibr_init PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  4902              LDR      r1,|L2.12|
;;;245    {          
000002  f24060f9          MOV      r0,#0x6f9
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000006  f8a10040          STRH     r0,[r1,#0x40]
00000a  4770              BX       lr
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
;;;319    
                          ENDP

                  |L2.12|
                          DCD      ||area_number.26||

                          AREA ||area_number.3||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.3||, ||.text||
                  adc_drv6 PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;245    {          
000004  4c80              LDR      r4,|L3.520|
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000006  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000008  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
00000a  1a40              SUBS     r0,r0,r1
00000c  b200              SXTH     r0,r0
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  f7fffffe          BL       abs_pal
000012  1da5              ADDS     r5,r4,#6
000014  8028              STRH     r0,[r5,#0]
000016  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
00001a  1a40              SUBS     r0,r0,r1
00001c  b200              SXTH     r0,r0
00001e  f7fffffe          BL       abs_pal
000022  8068              STRH     r0,[r5,#2]
000024  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000026  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000028  1a40              SUBS     r0,r0,r1
00002a  b200              SXTH     r0,r0
00002c  f7fffffe          BL       abs_pal
000030  80a8              STRH     r0,[r5,#4]
000032  f44f7196          MOV      r1,#0x12c
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
000036  f1a40672          SUB      r6,r4,#0x72
00003a  4288              CMP      r0,r1
00003c  da02              BGE      |L3.68|
00003e  88a0              LDRH     r0,[r4,#4]            ;253  ; adc_self_ch_buff
000040  8570              STRH     r0,[r6,#0x2a]         ;253
000042  e00c              B        |L3.94|
                  |L3.68|
000044  f9b50002          LDRSH    r0,[r5,#2]            ;253  ; adc_self_ch_disp
000048  4288              CMP      r0,r1                 ;253
00004a  da02              BGE      |L3.82|
00004c  8860              LDRH     r0,[r4,#2]            ;254  ; adc_self_ch_buff
00004e  8570              STRH     r0,[r6,#0x2a]         ;254
000050  e005              B        |L3.94|
                  |L3.82|
000052  f9b50000          LDRSH    r0,[r5,#0]            ;254  ; adc_self_ch_disp
000056  4288              CMP      r0,r1
000058  da01              BGE      |L3.94|
00005a  8820              LDRH     r0,[r4,#0]            ;255  ; adc_self_ch_buff
00005c  8570              STRH     r0,[r6,#0x2a]         ;255
                  |L3.94|
00005e  78f7              LDRB     r7,[r6,#3]            ;255  ; adc_ch_net
000060  2200              MOVS     r2,#0                 ;255
000062  b3f7              CBZ      r7,|L3.226|
000064  79b3              LDRB     r3,[r6,#6]            ;255  ; adc_window_flag
000066  4869              LDR      r0,|L3.524|
000068  b18b              CBZ      r3,|L3.142|
00006a  f9b6102a          LDRSH    r1,[r6,#0x2a]         ;255  ; adc_result
00006e  6804              LDR      r4,[r0,#0]            ;256  ; main_power_buffer
000070  eb0404a1          ADD      r4,r4,r1,ASR #2       ;256
000074  6004              STR      r4,[r0,#0]            ;256  ; main_power_buffer
000076  6844              LDR      r4,[r0,#4]            ;256  ; main_power_buffer
000078  eb0404a1          ADD      r4,r4,r1,ASR #2       ;256
00007c  6044              STR      r4,[r0,#4]            ;246  ; main_power_buffer
00007e  6884              LDR      r4,[r0,#8]            ;257  ; main_power_buffer
000080  eb0404a1          ADD      r4,r4,r1,ASR #2       ;257
000084  6084              STR      r4,[r0,#8]            ;257  ; main_power_buffer
000086  68c4              LDR      r4,[r0,#0xc]          ;258  ; main_power_buffer
000088  eb0401a1          ADD      r1,r4,r1,ASR #2       ;258
00008c  60c1              STR      r1,[r0,#0xc]          ;257  ; main_power_buffer
                  |L3.142|
00008e  f9b6102a          LDRSH    r1,[r6,#0x2a]         ;257  ; adc_result
000092  2964              CMP      r1,#0x64
000094  da04              BGE      |L3.160|
000096  8df1              LDRH     r1,[r6,#0x2e]         ;258  ; adc_zero_cnt
000098  f1010101          ADD      r1,r1,#1              ;262
00009c  85f1              STRH     r1,[r6,#0x2e]         ;262
00009e  e000              B        |L3.162|
                  |L3.160|
0000a0  85f2              STRH     r2,[r6,#0x2e]         ;262
                  |L3.162|
0000a2  f9b6402e          LDRSH    r4,[r6,#0x2e]         ;264  ; adc_zero_cnt
0000a6  f44f61fa          MOV      r1,#0x7d0             ;266
0000aa  428c              CMP      r4,r1                 ;266
0000ac  db05              BLT      |L3.186|
0000ae  85f1              STRH     r1,[r6,#0x2e]         ;266
0000b0  6002              STR      r2,[r0,#0]            ;268  ; main_power_buffer
0000b2  6042              STR      r2,[r0,#4]            ;269  ; main_power_buffer
0000b4  6082              STR      r2,[r0,#8]            ;270  ; main_power_buffer
0000b6  60c2              STR      r2,[r0,#0xc]          ;270  ; main_power_buffer
0000b8  8532              STRH     r2,[r6,#0x28]         ;270
                  |L3.186|
0000ba  8df1              LDRH     r1,[r6,#0x2e]         ;270  ; adc_zero_cnt
0000bc  2905              CMP      r1,#5                 ;270
0000be  d14f              BNE      |L3.352|
0000c0  b1bb              CBZ      r3,|L3.242|
0000c2  8db1              LDRH     r1,[r6,#0x2c]         ;273  ; adc_gorb_cnt
0000c4  f1010101          ADD      r1,r1,#1              ;273
0000c8  b209              SXTH     r1,r1                 ;273
0000ca  85b1              STRH     r1,[r6,#0x2c]         ;273
0000cc  f5b17f00          CMP      r1,#0x200             ;275
0000d0  db00              BLT      |L3.212|
0000d2  85b2              STRH     r2,[r6,#0x2c]         ;277
                  |L3.212|
0000d4  f9b6102c          LDRSH    r1,[r6,#0x2c]         ;277  ; adc_gorb_cnt
0000d8  064c              LSLS     r4,r1,#25             ;277
0000da  d10a              BNE      |L3.242|
0000dc  ea4f11e1          ASR      r1,r1,#7              ;284
0000e0  e000              B        |L3.228|
                  |L3.226|
0000e2  e015              B        |L3.272|
                  |L3.228|
0000e4  f8504021          LDR      r4,[r0,r1,LSL #2]     ;284
0000e8  ea4f2424          ASR      r4,r4,#8              ;284
0000ec  8534              STRH     r4,[r6,#0x28]         ;284
0000ee  f8402021          STR      r2,[r0,r1,LSL #2]     ;286
                  |L3.242|
0000f2  f9b60030          LDRSH    r0,[r6,#0x30]         ;286  ; adc_window_cnt
0000f6  2896              CMP      r0,#0x96              ;287
0000f8  dd01              BLE      |L3.254|
0000fa  b103              CBZ      r3,|L3.254|
0000fc  71b2              STRB     r2,[r6,#6]            ;287
                  |L3.254|
0000fe  381f              SUBS     r0,r0,#0x1f           ;287
000100  2827              CMP      r0,#0x27              ;287
000102  d22d              BCS      |L3.352|
000104  79b0              LDRB     r0,[r6,#6]            ;288  ; adc_window_flag
000106  bb58              CBNZ     r0,|L3.352|
000108  f04f0001          MOV      r0,#1                 ;288
00010c  71b0              STRB     r0,[r6,#6]            ;290
00010e  e027              B        |L3.352|
                  |L3.272|
000110  483f              LDR      r0,|L3.528|
000112  7935              LDRB     r5,[r6,#4]            ;291  ; adc_ch
000114  7973              LDRB     r3,[r6,#5]            ;291  ; adc_ch_cnt
000116  eb001485          ADD      r4,r0,r5,LSL #6       ;291
00011a  f9b6102a          LDRSH    r1,[r6,#0x2a]         ;292  ; adc_result
00011e  f8441023          STR      r1,[r4,r3,LSL #2]     ;292
000122  0798              LSLS     r0,r3,#30             ;294
000124  d10f              BNE      |L3.326|
000126  4601              MOV      r1,r0                 ;295
                  |L3.296|
000128  f854c020          LDR      r12,[r4,r0,LSL #2]    ;295
00012c  4461              ADD      r1,r1,r12             ;295
00012e  f1000001          ADD      r0,r0,#1              ;296
000132  b2c0              UXTB     r0,r0                 ;296
000134  2810              CMP      r0,#0x10              ;298
000136  d3f7              BCC      |L3.296|
000138  ea4f1021          ASR      r0,r1,#4              ;298
00013c  4933              LDR      r1,|L3.524|
00013e  f1a10120          SUB      r1,r1,#0x20           ;299
000142  f8210015          STRH     r0,[r1,r5,LSL #1]     ;299
                  |L3.326|
000146  1c6d              ADDS     r5,r5,#1              ;301
000148  b2e8              UXTB     r0,r5                 ;302
00014a  7130              STRB     r0,[r6,#4]            ;302
00014c  2810              CMP      r0,#0x10              ;302
00014e  d307              BCC      |L3.352|
000150  7132              STRB     r2,[r6,#4]            ;302
000152  f1030301          ADD      r3,r3,#1              ;303
000156  b2d8              UXTB     r0,r3                 ;303
000158  7170              STRB     r0,[r6,#5]            ;305
00015a  2810              CMP      r0,#0x10              ;305
00015c  d300              BCC      |L3.352|
00015e  7172              STRB     r2,[r6,#5]            ;306
                  |L3.352|
000160  70b2              STRB     r2,[r6,#2]            ;306
000162  f1070701          ADD      r7,r7,#1              ;306
000166  f0070001          AND      r0,r7,#1              ;307
00016a  70f0              STRB     r0,[r6,#3]            ;307
00016c  4a29              LDR      r2,|L3.532|
00016e  b130              CBZ      r0,|L3.382|
000170  6810              LDR      r0,[r2,#0]            ;310
000172  f02000ff          BIC      r0,r0,#0xff           ;310
000176  f1000004          ADD      r0,r0,#4              ;310
00017a  6010              STR      r0,[r2,#0]            ;311
00017c  e03d              B        |L3.506|
                  |L3.382|
00017e  7931              LDRB     r1,[r6,#4]            ;311  ; adc_ch
000180  0708              LSLS     r0,r1,#28             ;313
000182  d406              BMI      |L3.402|
000184  6810              LDR      r0,[r2,#0]            ;313
000186  f02000ff          BIC      r0,r0,#0xff           ;314
00018a  f1000001          ADD      r0,r0,#1              ;314
00018e  6010              STR      r0,[r2,#0]            ;314
000190  e005              B        |L3.414|
                  |L3.402|
000192  6810              LDR      r0,[r2,#0]
000194  f02000ff          BIC      r0,r0,#0xff           ;258
000198  f1000002          ADD      r0,r0,#2              ;258
00019c  6010              STR      r0,[r2,#0]
                  |L3.414|
00019e  481e              LDR      r0,|L3.536|
0001a0  6803              LDR      r3,[r0,#0]
0001a2  f0435380          ORR      r3,r3,#0x10000000
0001a6  6003              STR      r3,[r0,#0]
0001a8  6a03              LDR      r3,[r0,#0x20]
0001aa  f0434380          ORR      r3,r3,#0x40000000
0001ae  6203              STR      r3,[r0,#0x20]
0001b0  6e03              LDR      r3,[r0,#0x60]
0001b2  f0436380          ORR      r3,r3,#0x4000000
0001b6  6603              STR      r3,[r0,#0x60]
0001b8  07cb              LSLS     r3,r1,#31
0001ba  d00a              BEQ      |L3.466|
0001bc  6943              LDR      r3,[r0,#0x14]
0001be  f0435380          ORR      r3,r3,#0x10000000
0001c2  6143              STR      r3,[r0,#0x14]
                  |L3.452|
0001c4  078b              LSLS     r3,r1,#30
0001c6  d409              BMI      |L3.476|
0001c8  6b43              LDR      r3,[r0,#0x34]
0001ca  f0234380          BIC      r3,r3,#0x40000000
0001ce  6343              STR      r3,[r0,#0x34]
0001d0  e008              B        |L3.484|
                  |L3.466|
0001d2  6943              LDR      r3,[r0,#0x14]
0001d4  f0235380          BIC      r3,r3,#0x10000000
0001d8  6143              STR      r3,[r0,#0x14]
0001da  e7f3              B        |L3.452|
                  |L3.476|
0001dc  6b43              LDR      r3,[r0,#0x34]
0001de  f0434380          ORR      r3,r3,#0x40000000
0001e2  6343              STR      r3,[r0,#0x34]
                  |L3.484|
0001e4  0749              LSLS     r1,r1,#29
0001e6  d404              BMI      |L3.498|
0001e8  6f41              LDR      r1,[r0,#0x74]
0001ea  f0216180          BIC      r1,r1,#0x4000000
0001ee  6741              STR      r1,[r0,#0x74]
0001f0  e003              B        |L3.506|
                  |L3.498|
0001f2  6f41              LDR      r1,[r0,#0x74]
0001f4  f0416180          ORR      r1,r1,#0x4000000
0001f8  6741              STR      r1,[r0,#0x74]
                  |L3.506|
0001fa  6810              LDR      r0,[r2,#0]
0001fc  f0407080          ORR      r0,r0,#0x1000000
000200  6010              STR      r0,[r2,#0]
000202  e8bd81f0          POP      {r4-r8,pc}
;;;319    
                          ENDP

000206  0000              DCW      0x0000
                  |L3.520|
                          DCD      ||area_number.26||+0x72
                  |L3.524|
                          DCD      ||.bss||+0x420
                  |L3.528|
                          DCD      ||.bss||
                  |L3.532|
                          DCD      0x40034000
                  |L3.536|
                          DCD      0x2009c000

                          AREA ||area_number.4||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.4||, ||.text||
                  inv_drv PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  b570              PUSH     {r4-r6,lr}
;;;245    {          
000002  4604              MOV      r4,r0
000004  f04f0207          MOV      r2,#7
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000008  f04f0101          MOV      r1,#1
00000c  48a4              LDR      r0,|L4.672|
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  f7fffffe          BL       gran_char
000012  48a4              LDR      r0,|L4.676|
000014  eb040144          ADD      r1,r4,r4,LSL #1
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  eb001541          ADD      r5,r0,r1,LSL #5
00001c  f8950047          LDRB     r0,[r5,#0x47]
000020  f8951046          LDRB     r1,[r5,#0x46]
000024  ea800001          EOR      r0,r0,r1
000028  4a9f              LDR      r2,|L4.680|
00002a  b100              CBZ      r0,|L4.46|
00002c  7050              STRB     r0,[r2,#1]
                  |L4.46|
00002e  ea010100          AND      r1,r1,r0
000032  b101              CBZ      r1,|L4.54|
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
000034  7091              STRB     r1,[r2,#2]
                  |L4.54|
000036  ea000301          AND      r3,r0,r1
00003a  07db              LSLS     r3,r3,#31
00003c  d027              BEQ      |L4.142|
00003e  78d0              LDRB     r0,[r2,#3]            ;253  ; plazma_inv
000040  f1000001          ADD      r0,r0,#1              ;253
000044  70d0              STRB     r0,[r2,#3]            ;253
000046  b134              CBZ      r4,|L4.86|
000048  2c01              CMP      r4,#1                 ;253
00004a  d00b              BEQ      |L4.100|
00004c  2c02              CMP      r4,#2                 ;254
00004e  d010              BEQ      |L4.114|
000050  2c03              CMP      r4,#3                 ;254
000052  d015              BEQ      |L4.128|
000054  e120              B        |L4.664|
                  |L4.86|
000056  2301              MOVS     r3,#1
000058  461a              MOV      r2,r3                 ;255
00005a  210e              MOVS     r1,#0xe               ;255
00005c  a093              ADR      r0,|L4.684|
00005e  f7fffffe          BL       snmp_trap_send
000062  e119              B        |L4.664|
                  |L4.100|
000064  2301              MOVS     r3,#1                 ;255
000066  2202              MOVS     r2,#2                 ;255
000068  210e              MOVS     r1,#0xe               ;255
00006a  a097              ADR      r0,|L4.712|
00006c  f7fffffe          BL       snmp_trap_send
000070  e112              B        |L4.664|
                  |L4.114|
000072  2301              MOVS     r3,#1                 ;256
000074  2203              MOVS     r2,#3                 ;256
000076  210e              MOVS     r1,#0xe               ;256
000078  a09a              ADR      r0,|L4.740|
00007a  f7fffffe          BL       snmp_trap_send
00007e  e10b              B        |L4.664|
                  |L4.128|
000080  2301              MOVS     r3,#1                 ;257
000082  2204              MOVS     r2,#4                 ;257
000084  210e              MOVS     r1,#0xe               ;257
000086  a09e              ADR      r0,|L4.768|
000088  f7fffffe          BL       snmp_trap_send
00008c  e104              B        |L4.664|
                  |L4.142|
00008e  0783              LSLS     r3,r0,#30             ;257
000090  d529              BPL      |L4.230|
000092  078b              LSLS     r3,r1,#30
000094  d527              BPL      |L4.230|
000096  78d0              LDRB     r0,[r2,#3]            ;258  ; plazma_inv
000098  f1000001          ADD      r0,r0,#1              ;262
00009c  70d0              STRB     r0,[r2,#3]            ;262
00009e  b134              CBZ      r4,|L4.174|
0000a0  2c01              CMP      r4,#1                 ;262
0000a2  d00b              BEQ      |L4.188|
0000a4  2c02              CMP      r4,#2                 ;265
0000a6  d010              BEQ      |L4.202|
0000a8  2c03              CMP      r4,#3                 ;266
0000aa  d015              BEQ      |L4.216|
0000ac  e0f4              B        |L4.664|
                  |L4.174|
0000ae  2302              MOVS     r3,#2                 ;266
0000b0  2201              MOVS     r2,#1                 ;268
0000b2  210e              MOVS     r1,#0xe               ;269
0000b4  a099              ADR      r0,|L4.796|
0000b6  f7fffffe          BL       snmp_trap_send
0000ba  e0ed              B        |L4.664|
                  |L4.188|
0000bc  2302              MOVS     r3,#2                 ;270
0000be  461a              MOV      r2,r3                 ;272
0000c0  210e              MOVS     r1,#0xe               ;273
0000c2  a09d              ADR      r0,|L4.824|
0000c4  f7fffffe          BL       snmp_trap_send
0000c8  e0e6              B        |L4.664|
                  |L4.202|
0000ca  2302              MOVS     r3,#2                 ;273
0000cc  2203              MOVS     r2,#3                 ;275
0000ce  210e              MOVS     r1,#0xe               ;276
0000d0  a0a0              ADR      r0,|L4.852|
0000d2  f7fffffe          BL       snmp_trap_send
0000d6  e0df              B        |L4.664|
                  |L4.216|
0000d8  2302              MOVS     r3,#2                 ;277
0000da  2204              MOVS     r2,#4                 ;284
0000dc  210e              MOVS     r1,#0xe               ;284
0000de  a0a4              ADR      r0,|L4.880|
0000e0  f7fffffe          BL       snmp_trap_send
0000e4  e0d8              B        |L4.664|
                  |L4.230|
0000e6  0743              LSLS     r3,r0,#29             ;284
0000e8  d529              BPL      |L4.318|
0000ea  074b              LSLS     r3,r1,#29             ;284
0000ec  d527              BPL      |L4.318|
0000ee  78d0              LDRB     r0,[r2,#3]            ;286  ; plazma_inv
0000f0  f1000001          ADD      r0,r0,#1              ;286
0000f4  70d0              STRB     r0,[r2,#3]            ;287
0000f6  b134              CBZ      r4,|L4.262|
0000f8  2c01              CMP      r4,#1                 ;287
0000fa  d00b              BEQ      |L4.276|
0000fc  2c02              CMP      r4,#2                 ;287
0000fe  d010              BEQ      |L4.290|
000100  2c03              CMP      r4,#3                 ;287
000102  d015              BEQ      |L4.304|
000104  e0c8              B        |L4.664|
                  |L4.262|
000106  2303              MOVS     r3,#3                 ;288
000108  2201              MOVS     r2,#1                 ;288
00010a  210e              MOVS     r1,#0xe               ;288
00010c  a09f              ADR      r0,|L4.908|
00010e  f7fffffe          BL       snmp_trap_send
000112  e0c1              B        |L4.664|
                  |L4.276|
000114  2303              MOVS     r3,#3                 ;291
000116  2202              MOVS     r2,#2                 ;291
000118  210e              MOVS     r1,#0xe               ;291
00011a  a0a3              ADR      r0,|L4.936|
00011c  f7fffffe          BL       snmp_trap_send
000120  e0ba              B        |L4.664|
                  |L4.290|
000122  2303              MOVS     r3,#3                 ;294
000124  461a              MOV      r2,r3                 ;295
000126  210e              MOVS     r1,#0xe               ;295
000128  a0a6              ADR      r0,|L4.964|
00012a  f7fffffe          BL       snmp_trap_send
00012e  e0b3              B        |L4.664|
                  |L4.304|
000130  2303              MOVS     r3,#3                 ;296
000132  2204              MOVS     r2,#4                 ;296
000134  210e              MOVS     r1,#0xe               ;298
000136  a0aa              ADR      r0,|L4.992|
000138  f7fffffe          BL       snmp_trap_send
00013c  e0ac              B        |L4.664|
                  |L4.318|
00013e  0703              LSLS     r3,r0,#28             ;299
000140  d529              BPL      |L4.406|
000142  070b              LSLS     r3,r1,#28             ;299
000144  d527              BPL      |L4.406|
000146  78d0              LDRB     r0,[r2,#3]            ;301  ; plazma_inv
000148  f1000001          ADD      r0,r0,#1              ;302
00014c  70d0              STRB     r0,[r2,#3]            ;302
00014e  b134              CBZ      r4,|L4.350|
000150  2c01              CMP      r4,#1                 ;302
000152  d00b              BEQ      |L4.364|
000154  2c02              CMP      r4,#2                 ;303
000156  d010              BEQ      |L4.378|
000158  2c03              CMP      r4,#3                 ;305
00015a  d015              BEQ      |L4.392|
00015c  e09c              B        |L4.664|
                  |L4.350|
00015e  2304              MOVS     r3,#4                 ;306
000160  2201              MOVS     r2,#1                 ;306
000162  210e              MOVS     r1,#0xe               ;306
000164  a0a5              ADR      r0,|L4.1020|
000166  f7fffffe          BL       snmp_trap_send
00016a  e095              B        |L4.664|
                  |L4.364|
00016c  2304              MOVS     r3,#4                 ;309
00016e  2202              MOVS     r2,#2                 ;309
000170  210e              MOVS     r1,#0xe               ;310
000172  a0ab              ADR      r0,|L4.1056|
000174  f7fffffe          BL       snmp_trap_send
000178  e08e              B        |L4.664|
                  |L4.378|
00017a  2304              MOVS     r3,#4                 ;311
00017c  2203              MOVS     r2,#3                 ;311
00017e  210e              MOVS     r1,#0xe               ;311
000180  a0b0              ADR      r0,|L4.1092|
000182  f7fffffe          BL       snmp_trap_send
000186  e087              B        |L4.664|
                  |L4.392|
000188  2304              MOVS     r3,#4                 ;314
00018a  461a              MOV      r2,r3                 ;314
00018c  210e              MOVS     r1,#0xe               ;314
00018e  a0b6              ADR      r0,|L4.1128|
000190  f7fffffe          BL       snmp_trap_send
000194  e080              B        |L4.664|
                  |L4.406|
000196  06c3              LSLS     r3,r0,#27             ;258
000198  d529              BPL      |L4.494|
00019a  06cb              LSLS     r3,r1,#27
00019c  d527              BPL      |L4.494|
00019e  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0001a0  f1000001          ADD      r0,r0,#1
0001a4  70d0              STRB     r0,[r2,#3]
0001a6  b134              CBZ      r4,|L4.438|
0001a8  2c01              CMP      r4,#1
0001aa  d00b              BEQ      |L4.452|
0001ac  2c02              CMP      r4,#2
0001ae  d010              BEQ      |L4.466|
0001b0  2c03              CMP      r4,#3
0001b2  d015              BEQ      |L4.480|
0001b4  e070              B        |L4.664|
                  |L4.438|
0001b6  2305              MOVS     r3,#5
0001b8  2201              MOVS     r2,#1
0001ba  210e              MOVS     r1,#0xe
0001bc  a0b3              ADR      r0,|L4.1164|
0001be  f7fffffe          BL       snmp_trap_send
0001c2  e069              B        |L4.664|
                  |L4.452|
0001c4  2305              MOVS     r3,#5
0001c6  2202              MOVS     r2,#2
0001c8  210e              MOVS     r1,#0xe
0001ca  a0b9              ADR      r0,|L4.1200|
0001cc  f7fffffe          BL       snmp_trap_send
0001d0  e062              B        |L4.664|
                  |L4.466|
0001d2  2305              MOVS     r3,#5
0001d4  2203              MOVS     r2,#3
0001d6  210e              MOVS     r1,#0xe
0001d8  a0be              ADR      r0,|L4.1236|
0001da  f7fffffe          BL       snmp_trap_send
0001de  e05b              B        |L4.664|
                  |L4.480|
0001e0  2305              MOVS     r3,#5
0001e2  2204              MOVS     r2,#4
0001e4  210e              MOVS     r1,#0xe
0001e6  a0c4              ADR      r0,|L4.1272|
0001e8  f7fffffe          BL       snmp_trap_send
0001ec  e054              B        |L4.664|
                  |L4.494|
0001ee  0683              LSLS     r3,r0,#26
0001f0  d529              BPL      |L4.582|
0001f2  068b              LSLS     r3,r1,#26
0001f4  d527              BPL      |L4.582|
0001f6  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0001f8  f1000001          ADD      r0,r0,#1
0001fc  70d0              STRB     r0,[r2,#3]
0001fe  b134              CBZ      r4,|L4.526|
000200  2c01              CMP      r4,#1
000202  d00b              BEQ      |L4.540|
000204  2c02              CMP      r4,#2
000206  d010              BEQ      |L4.554|
000208  2c03              CMP      r4,#3
00020a  d015              BEQ      |L4.568|
00020c  e044              B        |L4.664|
                  |L4.526|
00020e  2306              MOVS     r3,#6
000210  2201              MOVS     r2,#1
000212  210e              MOVS     r1,#0xe
000214  a0c1              ADR      r0,|L4.1308|
000216  f7fffffe          BL       snmp_trap_send
00021a  e03d              B        |L4.664|
                  |L4.540|
00021c  2306              MOVS     r3,#6
00021e  2202              MOVS     r2,#2
000220  210e              MOVS     r1,#0xe
000222  a0c7              ADR      r0,|L4.1344|
000224  f7fffffe          BL       snmp_trap_send
000228  e036              B        |L4.664|
                  |L4.554|
00022a  2306              MOVS     r3,#6
00022c  2203              MOVS     r2,#3
00022e  210e              MOVS     r1,#0xe
000230  a0cc              ADR      r0,|L4.1380|
000232  f7fffffe          BL       snmp_trap_send
000236  e02f              B        |L4.664|
                  |L4.568|
000238  2306              MOVS     r3,#6
00023a  2204              MOVS     r2,#4
00023c  210e              MOVS     r1,#0xe
00023e  a0d2              ADR      r0,|L4.1416|
000240  f7fffffe          BL       snmp_trap_send
000244  e028              B        |L4.664|
                  |L4.582|
000246  b300              CBZ      r0,|L4.650|
000248  b9f9              CBNZ     r1,|L4.650|
00024a  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
00024c  f1000001          ADD      r0,r0,#1
000250  70d0              STRB     r0,[r2,#3]
000252  b134              CBZ      r4,|L4.610|
000254  2c01              CMP      r4,#1
000256  d00b              BEQ      |L4.624|
000258  2c02              CMP      r4,#2
00025a  d010              BEQ      |L4.638|
00025c  2c03              CMP      r4,#3
00025e  d015              BEQ      |L4.652|
000260  e01a              B        |L4.664|
                  |L4.610|
000262  2300              MOVS     r3,#0
000264  2201              MOVS     r2,#1
000266  210e              MOVS     r1,#0xe
000268  a0d0              ADR      r0,|L4.1452|
00026a  f7fffffe          BL       snmp_trap_send
00026e  e013              B        |L4.664|
                  |L4.624|
000270  2300              MOVS     r3,#0
000272  2202              MOVS     r2,#2
000274  210e              MOVS     r1,#0xe
000276  a0d2              ADR      r0,|L4.1472|
000278  f7fffffe          BL       snmp_trap_send
00027c  e00c              B        |L4.664|
                  |L4.638|
00027e  2300              MOVS     r3,#0
000280  2203              MOVS     r2,#3
000282  210e              MOVS     r1,#0xe
000284  a0d3              ADR      r0,|L4.1492|
000286  f7fffffe          BL       snmp_trap_send
                  |L4.650|
00028a  e005              B        |L4.664|
                  |L4.652|
00028c  2300              MOVS     r3,#0
00028e  2204              MOVS     r2,#4
000290  210e              MOVS     r1,#0xe
000292  a0d5              ADR      r0,|L4.1512|
000294  f7fffffe          BL       snmp_trap_send
                  |L4.664|
000298  f8150f46          LDRB     r0,[r5,#0x46]!
00029c  7068              STRB     r0,[r5,#1]
00029e  bd70              POP      {r4-r6,pc}
;;;319    
                          ENDP

                  |L4.672|
                          DCD      first_inv_slot
                  |L4.676|
                          DCD      inv
                  |L4.680|
                          DCD      ||area_number.26||+0x68
                  |L4.684|
0002ac  496e7665          DCB      "Invertor #1 Alarm, overload",0
0002b0  72746f72
0002b4  20233120
0002b8  416c6172
0002bc  6d2c206f
0002c0  7665726c
0002c4  6f616400
                  |L4.712|
0002c8  496e7665          DCB      "Invertor #2 Alarm, overload",0
0002cc  72746f72
0002d0  20233220
0002d4  416c6172
0002d8  6d2c206f
0002dc  7665726c
0002e0  6f616400
                  |L4.740|
0002e4  496e7665          DCB      "Invertor #3 Alarm, overload",0
0002e8  72746f72
0002ec  20233320
0002f0  416c6172
0002f4  6d2c206f
0002f8  7665726c
0002fc  6f616400
                  |L4.768|
000300  496e7665          DCB      "Invertor #4 Alarm, overload",0
000304  72746f72
000308  20233420
00030c  416c6172
000310  6d2c206f
000314  7665726c
000318  6f616400
                  |L4.796|
00031c  496e7665          DCB      "Invertor #1 Alarm, overheat",0
000320  72746f72
000324  20233120
000328  416c6172
00032c  6d2c206f
000330  76657268
000334  65617400
                  |L4.824|
000338  496e7665          DCB      "Invertor #2 Alarm, overheat",0
00033c  72746f72
000340  20233220
000344  416c6172
000348  6d2c206f
00034c  76657268
000350  65617400
                  |L4.852|
000354  496e7665          DCB      "Invertor #3 Alarm, overheat",0
000358  72746f72
00035c  20233320
000360  416c6172
000364  6d2c206f
000368  76657268
00036c  65617400
                  |L4.880|
000370  496e7665          DCB      "Invertor #4 Alarm, overheat",0
000374  72746f72
000378  20233420
00037c  416c6172
000380  6d2c206f
000384  76657268
000388  65617400
                  |L4.908|
00038c  496e7665          DCB      "Invertor #1 Alarm, is warm",0
000390  72746f72
000394  20233120
000398  416c6172
00039c  6d2c2069
0003a0  73207761
0003a4  726d00  
0003a7  00                DCB      0
                  |L4.936|
0003a8  496e7665          DCB      "Invertor #2 Alarm, is warm",0
0003ac  72746f72
0003b0  20233220
0003b4  416c6172
0003b8  6d2c2069
0003bc  73207761
0003c0  726d00  
0003c3  00                DCB      0
                  |L4.964|
0003c4  496e7665          DCB      "Invertor #3 Alarm, is warm",0
0003c8  72746f72
0003cc  20233320
0003d0  416c6172
0003d4  6d2c2069
0003d8  73207761
0003dc  726d00  
0003df  00                DCB      0
                  |L4.992|
0003e0  496e7665          DCB      "Invertor #4 Alarm, is warm",0
0003e4  72746f72
0003e8  20233420
0003ec  416c6172
0003f0  6d2c2069
0003f4  73207761
0003f8  726d00  
0003fb  00                DCB      0
                  |L4.1020|
0003fc  496e7665          DCB      "Invertor #1 Alarm, voltage is up",0
000400  72746f72
000404  20233120
000408  416c6172
00040c  6d2c2076
000410  6f6c7461
000414  67652069
000418  73207570
00041c  00      
00041d  00                DCB      0
00041e  00                DCB      0
00041f  00                DCB      0
                  |L4.1056|
000420  496e7665          DCB      "Invertor #2 Alarm, voltage is up",0
000424  72746f72
000428  20233220
00042c  416c6172
000430  6d2c2076
000434  6f6c7461
000438  67652069
00043c  73207570
000440  00      
000441  00                DCB      0
000442  00                DCB      0
000443  00                DCB      0
                  |L4.1092|
000444  496e7665          DCB      "Invertor #3 Alarm, voltage is up",0
000448  72746f72
00044c  20233320
000450  416c6172
000454  6d2c2076
000458  6f6c7461
00045c  67652069
000460  73207570
000464  00      
000465  00                DCB      0
000466  00                DCB      0
000467  00                DCB      0
                  |L4.1128|
000468  496e7665          DCB      "Invertor #4 Alarm, voltage is up",0
00046c  72746f72
000470  20233420
000474  416c6172
000478  6d2c2076
00047c  6f6c7461
000480  67652069
000484  73207570
000488  00      
000489  00                DCB      0
00048a  00                DCB      0
00048b  00                DCB      0
                  |L4.1164|
00048c  496e7665          DCB      "Invertor #1 Alarm, voltage is down",0
000490  72746f72
000494  20233120
000498  416c6172
00049c  6d2c2076
0004a0  6f6c7461
0004a4  67652069
0004a8  7320646f
0004ac  776e00  
0004af  00                DCB      0
                  |L4.1200|
0004b0  496e7665          DCB      "Invertor #2 Alarm, voltage is down",0
0004b4  72746f72
0004b8  20233220
0004bc  416c6172
0004c0  6d2c2076
0004c4  6f6c7461
0004c8  67652069
0004cc  7320646f
0004d0  776e00  
0004d3  00                DCB      0
                  |L4.1236|
0004d4  496e7665          DCB      "Invertor #3 Alarm, voltage is down",0
0004d8  72746f72
0004dc  20233320
0004e0  416c6172
0004e4  6d2c2076
0004e8  6f6c7461
0004ec  67652069
0004f0  7320646f
0004f4  776e00  
0004f7  00                DCB      0
                  |L4.1272|
0004f8  496e7665          DCB      "Invertor #4 Alarm, voltage is down",0
0004fc  72746f72
000500  20233420
000504  416c6172
000508  6d2c2076
00050c  6f6c7461
000510  67652069
000514  7320646f
000518  776e00  
00051b  00                DCB      0
                  |L4.1308|
00051c  496e7665          DCB      "Invertor #1 Alarm, output is offed",0
000520  72746f72
000524  20233120
000528  416c6172
00052c  6d2c206f
000530  75747075
000534  74206973
000538  206f6666
00053c  656400  
00053f  00                DCB      0
                  |L4.1344|
000540  496e7665          DCB      "Invertor #2 Alarm, output is offed",0
000544  72746f72
000548  20233220
00054c  416c6172
000550  6d2c206f
000554  75747075
000558  74206973
00055c  206f6666
000560  656400  
000563  00                DCB      0
                  |L4.1380|
000564  496e7665          DCB      "Invertor #3 Alarm, output is offed",0
000568  72746f72
00056c  20233320
000570  416c6172
000574  6d2c206f
000578  75747075
00057c  74206973
000580  206f6666
000584  656400  
000587  00                DCB      0
                  |L4.1416|
000588  496e7665          DCB      "Invertor #4 Alarm, output is offed",0
00058c  72746f72
000590  20233420
000594  416c6172
000598  6d2c206f
00059c  75747075
0005a0  74206973
0005a4  206f6666
0005a8  656400  
0005ab  00                DCB      0
                  |L4.1452|
0005ac  496e7665          DCB      "Invertor #1 is norm",0
0005b0  72746f72
0005b4  20233120
0005b8  6973206e
0005bc  6f726d00
                  |L4.1472|
0005c0  496e7665          DCB      "Invertor #2 is norm",0
0005c4  72746f72
0005c8  20233220
0005cc  6973206e
0005d0  6f726d00
                  |L4.1492|
0005d4  496e7665          DCB      "Invertor #3 is norm",0
0005d8  72746f72
0005dc  20233320
0005e0  6973206e
0005e4  6f726d00
                  |L4.1512|
0005e8  496e7665          DCB      "Invertor #4 is norm",0
0005ec  72746f72
0005f0  20233420
0005f4  6973206e
0005f8  6f726d00

                          AREA ||area_number.5||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.5||, ||.text||
                  ipsBlckHndl PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  b510              PUSH     {r4,lr}
;;;245    {          
000002  4b15              LDR      r3,|L5.88|
000004  f04f0000          MOV      r0,#0
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000008  8018              STRH     r0,[r3,#0]
00000a  4814              LDR      r0,|L5.92|
00000c  f04f0401          MOV      r4,#1
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
000010  f44f62fa          MOV      r2,#0x7d0
000014  f9b01000          LDRSH    r1,[r0,#0]  ; ipsBlckSrc
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  4811              LDR      r0,|L5.96|
00001a  2901              CMP      r1,#1
00001c  f9b00000          LDRSH    r0,[r0,#0]
000020  d006              BEQ      |L5.48|
000022  2902              CMP      r1,#2
000024  d10f              BNE      |L5.70|
000026  490f              LDR      r1,|L5.100|
000028  f9b1101a          LDRSH    r1,[r1,#0x1a]
00002c  b160              CBZ      r0,|L5.72|
00002e  e00d              B        |L5.76|
                  |L5.48|
000030  490c              LDR      r1,|L5.100|
000032  f9b11016          LDRSH    r1,[r1,#0x16]
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
000036  b908              CBNZ     r0,|L5.60|
000038  4291              CMP      r1,r2                 ;248
00003a  dc03              BGT      |L5.68|
                  |L5.60|
00003c  2801              CMP      r0,#1                 ;253
00003e  d102              BNE      |L5.70|
000040  4291              CMP      r1,r2                 ;253
000042  da00              BGE      |L5.70|
                  |L5.68|
000044  801c              STRH     r4,[r3,#0]            ;253
                  |L5.70|
000046  bd10              POP      {r4,pc}               ;253
                  |L5.72|
000048  4291              CMP      r1,r2                 ;253
00004a  dc03              BGT      |L5.84|
                  |L5.76|
00004c  2801              CMP      r0,#1                 ;254
00004e  d1fa              BNE      |L5.70|
000050  4291              CMP      r1,r2                 ;254
000052  daf8              BGE      |L5.70|
                  |L5.84|
000054  801c              STRH     r4,[r3,#0]            ;254
000056  bd10              POP      {r4,pc}
;;;319    
                          ENDP

                  |L5.88|
                          DCD      ipsBlckStat
                  |L5.92|
                          DCD      ipsBlckSrc
                  |L5.96|
                          DCD      ipsBlckLog
                  |L5.100|
                          DCD      ||.bss||+0x400

                          AREA ||area_number.6||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.6||, ||.text||
                  bat_hndl PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  b570              PUSH     {r4-r6,lr}
;;;245    {          
000002  20c8              MOVS     r0,#0xc8
000004  f7fffffe          BL       mess_find_unvol
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000008  493a              LDR      r1,|L6.244|
00000a  2200              MOVS     r2,#0
00000c  b3a8              CBZ      r0,|L6.122|
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  4b3a              LDR      r3,|L6.248|
000010  2401              MOVS     r4,#1
000012  6818              LDR      r0,[r3,#0]  ; mess_data
000014  28c9              CMP      r0,#0xc9
000016  d01c              BEQ      |L6.82|
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  28ca              CMP      r0,#0xca
00001a  d02f              BEQ      |L6.124|
00001c  4610              MOV      r0,r2
                  |L6.30|
00001e  eb000340          ADD      r3,r0,r0,LSL #1
000022  eb031300          ADD      r3,r3,r0,LSL #4
000026  f8012023          STRB     r2,[r1,r3,LSL #2]
00002a  f1000001          ADD      r0,r0,#1
00002e  b2c0              UXTB     r0,r0
000030  2802              CMP      r0,#2
000032  d3f4              BCC      |L6.30|
                  |L6.52|
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
000034  f04f0000          MOV      r0,#0
                  |L6.56|
000038  eb000340          ADD      r3,r0,r0,LSL #1       ;248
00003c  eb031300          ADD      r3,r3,r0,LSL #4       ;253
000040  f8115023          LDRB     r5,[r1,r3,LSL #2]     ;253
000044  2d14              CMP      r5,#0x14              ;253
000046  d939              BLS      |L6.188|
000048  eb010383          ADD      r3,r1,r3,LSL #2       ;253
00004c  f883403c          STRB     r4,[r3,#0x3c]         ;254
000050  e038              B        |L6.196|
                  |L6.82|
000052  f04f0000          MOV      r0,#0                 ;254
                  |L6.86|
000056  eb000340          ADD      r3,r0,r0,LSL #1
00005a  eb031500          ADD      r5,r3,r0,LSL #4       ;255
00005e  f8113025          LDRB     r3,[r1,r5,LSL #2]     ;255
000062  2b32              CMP      r3,#0x32              ;255
000064  d203              BCS      |L6.110|
000066  f1030301          ADD      r3,r3,#1              ;255
00006a  f8013025          STRB     r3,[r1,r5,LSL #2]     ;255
                  |L6.110|
00006e  f1000001          ADD      r0,r0,#1              ;256
000072  b2c0              UXTB     r0,r0                 ;256
000074  2802              CMP      r0,#2                 ;256
000076  d3ee              BCC      |L6.86|
000078  e7dc              B        |L6.52|
                  |L6.122|
00007a  e029              B        |L6.208|
                  |L6.124|
00007c  f04f0000          MOV      r0,#0                 ;246
000080  685e              LDR      r6,[r3,#4]            ;257
                  |L6.130|
000082  fa04f300          LSL      r3,r4,r0              ;257
000086  421e              TST      r6,r3                 ;258
000088  d00c              BEQ      |L6.164|
00008a  eb000340          ADD      r3,r0,r0,LSL #1       ;258
00008e  eb031500          ADD      r5,r3,r0,LSL #4       ;257
000092  f8113025          LDRB     r3,[r1,r5,LSL #2]
000096  2b32              CMP      r3,#0x32              ;258
000098  d20a              BCS      |L6.176|
00009a  f1030301          ADD      r3,r3,#1              ;262
00009e  f8013025          STRB     r3,[r1,r5,LSL #2]     ;262
0000a2  e005              B        |L6.176|
                  |L6.164|
0000a4  eb000340          ADD      r3,r0,r0,LSL #1       ;265
0000a8  eb031300          ADD      r3,r3,r0,LSL #4       ;266
0000ac  f8012023          STRB     r2,[r1,r3,LSL #2]     ;266
                  |L6.176|
0000b0  f1000001          ADD      r0,r0,#1              ;268
0000b4  b2c0              UXTB     r0,r0                 ;270
0000b6  2802              CMP      r0,#2                 ;270
0000b8  d3e3              BCC      |L6.130|
0000ba  e7bb              B        |L6.52|
                  |L6.188|
0000bc  eb010383          ADD      r3,r1,r3,LSL #2       ;270
0000c0  f883203c          STRB     r2,[r3,#0x3c]         ;273
                  |L6.196|
0000c4  f1000001          ADD      r0,r0,#1              ;273
0000c8  b2c0              UXTB     r0,r0                 ;273
0000ca  2802              CMP      r0,#2                 ;273
0000cc  d3b4              BCC      |L6.56|
0000ce  bd70              POP      {r4-r6,pc}            ;276
                  |L6.208|
0000d0  f04f0000          MOV      r0,#0                 ;277
                  |L6.212|
0000d4  eb000340          ADD      r3,r0,r0,LSL #1       ;277
0000d8  eb031300          ADD      r3,r3,r0,LSL #4       ;277
0000dc  f8012023          STRB     r2,[r1,r3,LSL #2]     ;284
0000e0  eb010383          ADD      r3,r1,r3,LSL #2       ;284
0000e4  f883203c          STRB     r2,[r3,#0x3c]         ;284
0000e8  f1000001          ADD      r0,r0,#1              ;284
0000ec  b2c0              UXTB     r0,r0                 ;284
0000ee  2802              CMP      r0,#2                 ;286
0000f0  d3f0              BCC      |L6.212|
0000f2  bd70              POP      {r4-r6,pc}            ;286
;;;319    
                          ENDP

                  |L6.244|
                          DCD      bat
                  |L6.248|
                          DCD      mess_data

                          AREA ||area_number.7||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.7||, ||.text||
                  klimat_hndl PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;245    {          
000004  4d66              LDR      r5,|L7.416|
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000006  4867              LDR      r0,|L7.420|
000008  4c67              LDR      r4,|L7.424|
00000a  f9b51000          LDRSH    r1,[r5,#0]  ; t_box
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  f9b02000          LDRSH    r2,[r0,#0]  ; TBOXMAX
000012  f9b40000          LDRSH    r0,[r4,#0]
000016  4291              CMP      r1,r2
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  dd03              BLE      |L7.34|
00001a  f1000001          ADD      r0,r0,#1
00001e  8020              STRH     r0,[r4,#0]
000020  e003              B        |L7.42|
                  |L7.34|
000022  da02              BGE      |L7.42|
000024  f1a00001          SUB      r0,r0,#1
000028  8020              STRH     r0,[r4,#0]
                  |L7.42|
00002a  2206              MOVS     r2,#6
00002c  2100              MOVS     r1,#0
00002e  485e              LDR      r0,|L7.424|
000030  f7fffffe          BL       gran
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
000034  f9b40000          LDRSH    r0,[r4,#0]  ; av_tbox_cnt
000038  495c              LDR      r1,|L7.428|
00003a  2601              MOVS     r6,#1
00003c  2805              CMP      r0,#5                 ;253
00003e  dd00              BLE      |L7.66|
000040  700e              STRB     r6,[r1,#0]            ;253
                  |L7.66|
000042  2400              MOVS     r4,#0                 ;253
000044  2801              CMP      r0,#1                 ;253
000046  da00              BGE      |L7.74|
000048  700c              STRB     r4,[r1,#0]            ;253
                  |L7.74|
00004a  4959              LDR      r1,|L7.432|
00004c  f9b50000          LDRSH    r0,[r5,#0]            ;254  ; t_box
000050  4a58              LDR      r2,|L7.436|
000052  f9b11000          LDRSH    r1,[r1,#0]            ;254  ; TBOXREG
000056  4f58              LDR      r7,|L7.440|
000058  1e8b              SUBS     r3,r1,#2              ;255
00005a  4298              CMP      r0,r3                 ;255
00005c  da0f              BGE      |L7.126|
00005e  f9921000          LDRSB    r1,[r2,#0]            ;255  ; t_box_cnt
000062  291e              CMP      r1,#0x1e              ;255
000064  da1e              BGE      |L7.164|
000066  f1010101          ADD      r1,r1,#1              ;255
00006a  b249              SXTB     r1,r1                 ;255
00006c  7011              STRB     r1,[r2,#0]
00006e  291e              CMP      r1,#0x1e              ;256
000070  db18              BLT      |L7.164|
000072  8839              LDRH     r1,[r7,#0]            ;256  ; main_vent_pos
000074  f1a10101          SUB      r1,r1,#1              ;256
000078  8039              STRH     r1,[r7,#0]            ;256
00007a  7014              STRB     r4,[r2,#0]
00007c  e012              B        |L7.164|
                  |L7.126|
00007e  4288              CMP      r0,r1                 ;257
000080  dd0f              BLE      |L7.162|
000082  f9921000          LDRSB    r1,[r2,#0]            ;257  ; t_box_cnt
000086  291e              CMP      r1,#0x1e              ;258
000088  da0c              BGE      |L7.164|
00008a  f1010101          ADD      r1,r1,#1              ;258
00008e  b249              SXTB     r1,r1                 ;257
000090  7011              STRB     r1,[r2,#0]            ;257
000092  291e              CMP      r1,#0x1e
000094  db06              BLT      |L7.164|
000096  8839              LDRH     r1,[r7,#0]            ;258  ; main_vent_pos
000098  f1010101          ADD      r1,r1,#1              ;262
00009c  8039              STRH     r1,[r7,#0]            ;262
00009e  7014              STRB     r4,[r2,#0]            ;262
0000a0  e000              B        |L7.164|
                  |L7.162|
0000a2  7014              STRB     r4,[r2,#0]            ;264
                  |L7.164|
0000a4  4945              LDR      r1,|L7.444|
0000a6  f9b11000          LDRSH    r1,[r1,#0]            ;266  ; TBOXVENTMAX
0000aa  4288              CMP      r0,r1                 ;266
0000ac  dd05              BLE      |L7.186|
0000ae  2214              MOVS     r2,#0x14              ;266
0000b0  2100              MOVS     r1,#0                 ;268
0000b2  4841              LDR      r0,|L7.440|
0000b4  f7fffffe          BL       gran
0000b8  e007              B        |L7.202|
                  |L7.186|
0000ba  4841              LDR      r0,|L7.448|
0000bc  2100              MOVS     r1,#0                 ;270
0000be  8800              LDRH     r0,[r0,#0]            ;272  ; pos_vent
0000c0  3009              ADDS     r0,r0,#9              ;273
0000c2  b202              SXTH     r2,r0                 ;273
0000c4  483c              LDR      r0,|L7.440|
0000c6  f7fffffe          BL       gran
                  |L7.202|
0000ca  20f0              MOVS     r0,#0xf0              ;273
0000cc  f7fffffe          BL       mess_find_unvol
0000d0  b128              CBZ      r0,|L7.222|
0000d2  483c              LDR      r0,|L7.452|
0000d4  6801              LDR      r1,[r0,#0]            ;277  ; mess_data
0000d6  29f1              CMP      r1,#0xf1              ;277
0000d8  d101              BNE      |L7.222|
0000da  6840              LDR      r0,[r0,#4]            ;284  ; mess_data
0000dc  8038              STRH     r0,[r7,#0]            ;284
                  |L7.222|
0000de  f9b71000          LDRSH    r1,[r7,#0]            ;284  ; main_vent_pos
0000e2  4839              LDR      r0,|L7.456|
0000e4  2901              CMP      r1,#1                 ;284
0000e6  dc01              BGT      |L7.236|
0000e8  7006              STRB     r6,[r0,#0]            ;284
0000ea  e000              B        |L7.238|
                  |L7.236|
0000ec  7004              STRB     r4,[r0,#0]            ;284
                  |L7.238|
0000ee  4837              LDR      r0,|L7.460|
0000f0  f8df80dc          LDR      r8,|L7.464|
0000f4  f9b00000          LDRSH    r0,[r0,#0]            ;287  ; TBATDISABLE
0000f8  f1a00132          SUB      r1,r0,#0x32           ;287
0000fc  2928              CMP      r1,#0x28              ;287
0000fe  d821              BHI      |L7.324|
000100  f9b51000          LDRSH    r1,[r5,#0]            ;287  ; t_box
000104  4f33              LDR      r7,|L7.468|
000106  4281              CMP      r1,r0                 ;288
000108  dd03              BLE      |L7.274|
00010a  8838              LDRH     r0,[r7,#0]            ;288  ; tbatdisable_cnt
00010c  f1000001          ADD      r0,r0,#1              ;290
000110  8038              STRH     r0,[r7,#0]            ;291
                  |L7.274|
000112  4831              LDR      r0,|L7.472|
000114  f9b00000          LDRSH    r0,[r0,#0]            ;291  ; TBATENABLE
000118  4281              CMP      r1,r0                 ;291
00011a  da03              BGE      |L7.292|
00011c  8838              LDRH     r0,[r7,#0]            ;292  ; tbatdisable_cnt
00011e  f1a00001          SUB      r0,r0,#1              ;292
000122  8038              STRH     r0,[r7,#0]            ;294
                  |L7.292|
000124  2206              MOVS     r2,#6                 ;295
000126  2100              MOVS     r1,#0                 ;295
000128  482a              LDR      r0,|L7.468|
00012a  f7fffffe          BL       gran
00012e  f9b70000          LDRSH    r0,[r7,#0]            ;296  ; tbatdisable_cnt
000132  2805              CMP      r0,#5                 ;296
000134  dd01              BLE      |L7.314|
000136  f8886000          STRB     r6,[r8,#0]            ;298
                  |L7.314|
00013a  2801              CMP      r0,#1                 ;299
00013c  da04              BGE      |L7.328|
00013e  f8884000          STRB     r4,[r8,#0]            ;299
000142  e001              B        |L7.328|
                  |L7.324|
000144  f8884000          STRB     r4,[r8,#0]            ;301
                  |L7.328|
000148  4824              LDR      r0,|L7.476|
00014a  4f25              LDR      r7,|L7.480|
00014c  f9b00000          LDRSH    r0,[r0,#0]            ;302  ; TLOADDISABLE
000150  f1a00132          SUB      r1,r0,#0x32           ;302
000154  291e              CMP      r1,#0x1e              ;303
000156  d820              BHI      |L7.410|
000158  f9b51000          LDRSH    r1,[r5,#0]            ;305  ; t_box
00015c  4d21              LDR      r5,|L7.484|
00015e  4281              CMP      r1,r0                 ;306
000160  dd03              BLE      |L7.362|
000162  8828              LDRH     r0,[r5,#0]            ;306  ; tloaddisable_cnt
000164  f1000001          ADD      r0,r0,#1              ;306
000168  8028              STRH     r0,[r5,#0]            ;307
                  |L7.362|
00016a  481f              LDR      r0,|L7.488|
00016c  f9b00000          LDRSH    r0,[r0,#0]            ;309  ; TLOADENABLE
000170  4281              CMP      r1,r0                 ;310
000172  da03              BGE      |L7.380|
000174  8828              LDRH     r0,[r5,#0]            ;310  ; tloaddisable_cnt
000176  f1a00001          SUB      r0,r0,#1              ;310
00017a  8028              STRH     r0,[r5,#0]            ;311
                  |L7.380|
00017c  2206              MOVS     r2,#6                 ;311
00017e  2100              MOVS     r1,#0                 ;311
000180  4818              LDR      r0,|L7.484|
000182  f7fffffe          BL       gran
000186  f9b50000          LDRSH    r0,[r5,#0]            ;314  ; tloaddisable_cnt
00018a  2805              CMP      r0,#5                 ;314
00018c  dd00              BLE      |L7.400|
00018e  703e              STRB     r6,[r7,#0]            ;314
                  |L7.400|
000190  2801              CMP      r0,#1
000192  da00              BGE      |L7.406|
000194  703c              STRB     r4,[r7,#0]            ;258
                  |L7.406|
000196  e8bd81f0          POP      {r4-r8,pc}            ;258
                  |L7.410|
00019a  703c              STRB     r4,[r7,#0]
00019c  e7fb              B        |L7.406|
;;;319    
                          ENDP

00019e  0000              DCW      0x0000
                  |L7.416|
                          DCD      t_box
                  |L7.420|
                          DCD      TBOXMAX
                  |L7.424|
                          DCD      av_tbox_cnt
                  |L7.428|
                          DCD      av_tbox_stat
                  |L7.432|
                          DCD      TBOXREG
                  |L7.436|
                          DCD      t_box_cnt
                  |L7.440|
                          DCD      main_vent_pos
                  |L7.444|
                          DCD      TBOXVENTMAX
                  |L7.448|
                          DCD      pos_vent
                  |L7.452|
                          DCD      mess_data
                  |L7.456|
                          DCD      mixer_vent_stat
                  |L7.460|
                          DCD      TBATDISABLE
                  |L7.464|
                          DCD      tbatdisable_stat
                  |L7.468|
                          DCD      tbatdisable_cnt
                  |L7.472|
                          DCD      TBATENABLE
                  |L7.476|
                          DCD      TLOADDISABLE
                  |L7.480|
                          DCD      tloaddisable_stat
                  |L7.484|
                          DCD      tloaddisable_cnt
                  |L7.488|
                          DCD      TLOADENABLE

                          AREA ||area_number.8||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.8||, ||.text||
                  speedChargeHndl PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  b5f8              PUSH     {r3-r7,lr}
;;;245    {          
000002  4f43              LDR      r7,|L8.272|
000004  4d43              LDR      r5,|L8.276|
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000006  2400              MOVS     r4,#0
000008  8838              LDRH     r0,[r7,#0]  ; speedChIsOn
00000a  b198              CBZ      r0,|L8.52|
00000c  4a42              LDR      r2,|L8.280|
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  6811              LDR      r1,[r2,#0]  ; speedChTimeCnt
000010  f1010101          ADD      r1,r1,#1
000014  6011              STR      r1,[r2,#0]  ; speedChTimeCnt
000016  4841              LDR      r0,|L8.284|
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  f9b00000          LDRSH    r0,[r0,#0]  ; speedChrgTimeInHour
00001c  ebc01340          RSB      r3,r0,r0,LSL #5
000020  ebc32000          RSB      r0,r3,r0,LSL #8
000024  ebb11f00          CMP      r1,r0,LSL #4
000028  db00              BLT      |L8.44|
00002a  803c              STRH     r4,[r7,#0]
                  |L8.44|
00002c  8828              LDRH     r0,[r5,#0]  ; speedChrgBlckStat
00002e  b108              CBZ      r0,|L8.52|
000030  803c              STRH     r4,[r7,#0]
000032  6014              STR      r4,[r2,#0]  ; speedChTimeCnt
                  |L8.52|
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
000034  483a              LDR      r0,|L8.288|
000036  2601              MOVS     r6,#1
000038  8800              LDRH     r0,[r0,#0]            ;248  ; speedChrgAvtEn
00003a  b300              CBZ      r0,|L8.126|
00003c  8838              LDRH     r0,[r7,#0]            ;253  ; speedChIsOn
00003e  b9f0              CBNZ     r0,|L8.126|
000040  4838              LDR      r0,|L8.292|
000042  4939              LDR      r1,|L8.296|
000044  f9b00000          LDRSH    r0,[r0,#0]            ;253  ; load_U
000048  f9b11000          LDRSH    r1,[r1,#0]            ;253  ; u_necc
00004c  4288              CMP      r0,r1                 ;254
00004e  da16              BGE      |L8.126|
000050  1a08              SUBS     r0,r1,r0              ;254
000052  4936              LDR      r1,|L8.300|
000054  f9b11000          LDRSH    r1,[r1,#0]            ;254  ; speedChrgDU
000058  4288              CMP      r0,r1                 ;255
00005a  dd10              BLE      |L8.126|
00005c  4834              LDR      r0,|L8.304|
00005e  210a              MOVS     r1,#0xa               ;255
000060  f9b00000          LDRSH    r0,[r0,#0]            ;255  ; Ib_ips_termokompensat
000064  fb90f0f1          SDIV     r0,r0,r1              ;255
000068  4932              LDR      r1,|L8.308|
00006a  8809              LDRH     r1,[r1,#0]            ;255  ; IZMAX
00006c  1a40              SUBS     r0,r0,r1
00006e  b200              SXTH     r0,r0                 ;256
000070  f7fffffe          BL       abs
000074  2805              CMP      r0,#5                 ;256
000076  da02              BGE      |L8.126|
000078  8828              LDRH     r0,[r5,#0]            ;256  ; speedChrgBlckStat
00007a  b900              CBNZ     r0,|L8.126|
00007c  803e              STRH     r6,[r7,#0]            ;246
                  |L8.126|
00007e  482e              LDR      r0,|L8.312|
000080  f9b00000          LDRSH    r0,[r0,#0]            ;257  ; speedChrgBlckSrc
000084  2801              CMP      r0,#1                 ;257
000086  d003              BEQ      |L8.144|
000088  2802              CMP      r0,#2                 ;258
00008a  d001              BEQ      |L8.144|
00008c  802c              STRH     r4,[r5,#0]            ;257
00008e  e026              B        |L8.222|
                  |L8.144|
000090  802c              STRH     r4,[r5,#0]            ;257
000092  4b2a              LDR      r3,|L8.316|
000094  492a              LDR      r1,|L8.320|
000096  f44f62fa          MOV      r2,#0x7d0             ;258
00009a  2801              CMP      r0,#1                 ;262
00009c  d002              BEQ      |L8.164|
00009e  2802              CMP      r0,#2                 ;262
0000a0  d00f              BEQ      |L8.194|
0000a2  e01c              B        |L8.222|
                  |L8.164|
0000a4  f9b30000          LDRSH    r0,[r3,#0]            ;265  ; speedChrgBlckLog
0000a8  b918              CBNZ     r0,|L8.178|
0000aa  f9b13016          LDRSH    r3,[r1,#0x16]         ;266  ; adc_buff_
0000ae  4293              CMP      r3,r2                 ;266
0000b0  dc05              BGT      |L8.190|
                  |L8.178|
0000b2  2801              CMP      r0,#1                 ;269
0000b4  d113              BNE      |L8.222|
0000b6  f9b10016          LDRSH    r0,[r1,#0x16]         ;270  ; adc_buff_
0000ba  4290              CMP      r0,r2                 ;270
0000bc  da0f              BGE      |L8.222|
                  |L8.190|
0000be  802e              STRH     r6,[r5,#0]            ;272
0000c0  e00d              B        |L8.222|
                  |L8.194|
0000c2  f9b30000          LDRSH    r0,[r3,#0]            ;273  ; speedChrgBlckLog
0000c6  b918              CBNZ     r0,|L8.208|
0000c8  f9b1301a          LDRSH    r3,[r1,#0x1a]         ;273  ; adc_buff_
0000cc  4293              CMP      r3,r2                 ;275
0000ce  dc05              BGT      |L8.220|
                  |L8.208|
0000d0  2801              CMP      r0,#1                 ;277
0000d2  d104              BNE      |L8.222|
0000d4  f9b1001a          LDRSH    r0,[r1,#0x1a]         ;277  ; adc_buff_
0000d8  4290              CMP      r0,r2                 ;277
0000da  da00              BGE      |L8.222|
                  |L8.220|
0000dc  802e              STRH     r6,[r5,#0]            ;284
                  |L8.222|
0000de  8828              LDRH     r0,[r5,#0]            ;284  ; speedChrgBlckStat
0000e0  4918              LDR      r1,|L8.324|
0000e2  2801              CMP      r0,#1                 ;284
0000e4  d001              BEQ      |L8.234|
0000e6  700c              STRB     r4,[r1,#0]            ;284
                  |L8.232|
0000e8  bdf8              POP      {r3-r7,pc}            ;284
                  |L8.234|
0000ea  7808              LDRB     r0,[r1,#0]            ;284  ; speedChrgShowCnt
0000ec  f1000001          ADD      r0,r0,#1              ;284
0000f0  b2c0              UXTB     r0,r0                 ;286
0000f2  7008              STRB     r0,[r1,#0]            ;286
0000f4  281e              CMP      r0,#0x1e              ;287
0000f6  d3f7              BCC      |L8.232|
0000f8  700c              STRB     r4,[r1,#0]            ;287
0000fa  f2413088          MOV      r0,#0x1388            ;287
0000fe  9000              STR      r0,[sp,#0]            ;287
000100  a311              ADR      r3,|L8.328|
000102  a217              ADR      r2,|L8.352|
000104  a11c              ADR      r1,|L8.376|
000106  a022              ADR      r0,|L8.400|
000108  f7fffffe          BL       show_mess
00010c  bdf8              POP      {r3-r7,pc}            ;290
;;;319    
                          ENDP

00010e  0000              DCW      0x0000
                  |L8.272|
                          DCD      speedChIsOn
                  |L8.276|
                          DCD      speedChrgBlckStat
                  |L8.280|
                          DCD      speedChTimeCnt
                  |L8.284|
                          DCD      speedChrgTimeInHour
                  |L8.288|
                          DCD      speedChrgAvtEn
                  |L8.292|
                          DCD      load_U
                  |L8.296|
                          DCD      u_necc
                  |L8.300|
                          DCD      speedChrgDU
                  |L8.304|
                          DCD      Ib_ips_termokompensat
                  |L8.308|
                          DCD      IZMAX
                  |L8.312|
                          DCD      speedChrgBlckSrc
                  |L8.316|
                          DCD      speedChrgBlckLog
                  |L8.320|
                          DCD      ||.bss||+0x400
                  |L8.324|
                          DCD      speedChrgShowCnt
                  |L8.328|
000148  20202020          DCB      "                    ",0
00014c  20202020
000150  20202020
000154  20202020
000158  20202020
00015c  00      
00015d  00                DCB      0
00015e  00                DCB      0
00015f  00                DCB      0
                  |L8.352|
000160  20202020          DCB      "     ",199,192,207,208,197,217,197,205,"!!!    ",0
000164  20c7c0cf
000168  d0c5d9c5
00016c  cd212121
000170  20202020
000174  00      
000175  00                DCB      0
000176  00                DCB      0
000177  00                DCB      0
                  |L8.376|
000178  20202020          DCB      "       ",199,192,208,223,196,"        ",0
00017c  202020c7
000180  c0d0dfc4
000184  20202020
000188  20202020
00018c  00      
00018d  00                DCB      0
00018e  00                DCB      0
00018f  00                DCB      0
                  |L8.400|
000190  20202020          DCB      "     ",211,209,202,206,208,197,205,205,219,201,"     ",0
000194  20d3d1ca
000198  ced0c5cd
00019c  cddbc920
0001a0  20202020
0001a4  00      
0001a5  00                DCB      0
0001a6  00                DCB      0
0001a7  00                DCB      0

                          AREA ||area_number.9||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.9||, ||.text||
                  speedChargeStartStop PROC
;;;243    //-----------------------------------------------
;;;244    void ke_start(char in)
000000  b508              PUSH     {r3,lr}
;;;245    {          
000002  480c              LDR      r0,|L9.52|
000004  2100              MOVS     r1,#0
;;;246    ke_start_stat=(enum_ke_start_stat)0;		 
000006  8802              LDRH     r2,[r0,#0]  ; speedChIsOn
000008  b10a              CBZ      r2,|L9.14|
00000a  8001              STRH     r1,[r0,#0]
00000c  bd08              POP      {r3,pc}
                  |L9.14|
;;;247    
;;;248    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
00000e  4a0a              LDR      r2,|L9.56|
000010  8812              LDRH     r2,[r2,#0]  ; speedChrgBlckStat
000012  b14a              CBZ      r2,|L9.40|
000014  f44f60fa          MOV      r0,#0x7d0
;;;249    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;250    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;251    #endif
;;;252    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
000018  9000              STR      r0,[sp,#0]
00001a  a308              ADR      r3,|L9.60|
00001c  a20d              ADR      r2,|L9.84|
00001e  a113              ADR      r1,|L9.108|
000020  a018              ADR      r0,|L9.132|
000022  f7fffffe          BL       show_mess
000026  bd08              POP      {r3,pc}
                  |L9.40|
000028  f04f0201          MOV      r2,#1
00002c  8002              STRH     r2,[r0,#0]
00002e  481b              LDR      r0,|L9.156|
000030  6001              STR      r1,[r0,#0]  ; speedChTimeCnt
000032  bd08              POP      {r3,pc}
;;;253    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;254    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;255    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;256    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;257    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;258    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;259    else 
;;;260    	{
;;;261    
;;;262    	ke_start_stat=kssYES;
;;;263    
;;;264    	spc_stat=spcKE;
;;;265    	__ee_spc_stat=spcKE;
;;;266    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;267    	
;;;268    	spc_bat=in;
;;;269    	__ee_spc_bat=in;
;;;270    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;271    
;;;272    	bat[in]._zar_cnt_ke=0;
;;;273    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[in],0);
;;;274    	
;;;275    	spc_phase=0;
;;;276    	__ee_spc_phase=0;
;;;277    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;278    
;;;279    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;280    
;;;281    		{					
;;;282    		signed short temp_temp;
;;;283    		signed char temp;
;;;284    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;285    		    
;;;286    		temp=LPC_RTC->YEAR;
;;;287    		gran_char(&temp,1,99);
;;;288    		*((char*)(&(ke_date[0])))=temp;
;;;289    			
;;;290    		temp=LPC_RTC->MONTH;
;;;291    		gran_char(&temp,1,12);
;;;292    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;293    		
;;;294    		temp=LPC_RTC->DOM;
;;;295    		gran_char(&temp,1,31);
;;;296    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;297    				
;;;298    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;299    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;300    
;;;301    		temp=LPC_RTC->HOUR;
;;;302    		gran_char(&temp,0,23);
;;;303    		*((char*)(&(ke_date[1])))=temp;
;;;304                   
;;;305    		temp=LPC_RTC->MIN;
;;;306    		gran_char(&temp,0,59);
;;;307    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;308    	          
;;;309    		temp=LPC_RTC->SEC;
;;;310    		gran_char(&temp,0,59);
;;;311    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;312    			
;;;313    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;314    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;315    		}
;;;316    
;;;317    	}
;;;318    }
;;;319    
                          ENDP

                  |L9.52|
                          DCD      speedChIsOn
                  |L9.56|
                          DCD      speedChrgBlckStat
                  |L9.60|
00003c  20202020          DCB      "                    ",0
000040  20202020
000044  20202020
000048  20202020
00004c  20202020
000050  00      
000051  00                DCB      0
000052  00                DCB      0
000053  00                DCB      0
                  |L9.84|
000054  20202020          DCB      "    ",231,224,225,235,238,234,232,240,238,226,224,237,"!"
000058  e7e0e1eb
00005c  eeeae8f0
000060  eee2e0ed
000064  21      
000065  20202000          DCB      "   ",0
000069  00                DCB      0
00006a  00                DCB      0
00006b  00                DCB      0
                  |L9.108|
00006c  20202020          DCB      "       ",231,224,240,255,228,"        ",0
000070  202020e7
000074  e0f0ffe4
000078  20202020
00007c  20202020
000080  00      
000081  00                DCB      0
000082  00                DCB      0
000083  00                DCB      0
                  |L9.132|
000084  20202020          DCB      "     ",211,241,234,238,240,229,237,237,251,233,"     ",0
000088  20d3f1ea
00008c  eef0e5ed
000090  edfbe920
000094  20202020
000098  00      
000099  00                DCB      0
00009a  00                DCB      0
00009b  00                DCB      0
                  |L9.156|
                          DCD      speedChTimeCnt

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  adc_buff
                          %        1024
                  adc_buff_
                          %        32
                  main_power_buffer
                          %        32
                  cntrl_stat_buff
                          %        64

                          AREA ||area_number.12||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.12||, ||.bss||
                  adc_buff_max
                          %        24

                          AREA ||area_number.13||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.13||, ||.bss||
                  net_buff
                          %        64

                          AREA ||.constdata||, DATA, READONLY, ALIGN=0

                  sk_buff_KONTUR
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.16||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.16||, ||.constdata||
                  sk_buff_RSTKM
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.17||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.17||, ||.constdata||
                  sk_buff_GLONASS
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.18||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.18||, ||.constdata||
                  sk_buff_3U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.19||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.19||, ||.constdata||
                  sk_buff_6U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.20||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.20||, ||.constdata||
                  sk_buff_220
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.21||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.21||, ||.constdata||
                  sk_buff_TELECORE2015
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||.data||, DATA, ALIGN=1

                  adc_buff_min
000000  13881388          DCW      0x1388,0x1388
000004  13881388          DCW      0x1388,0x1388
000008  13881388          DCW      0x1388,0x1388
00000c  13881388          DCW      0x1388,0x1388
000010  13881388          DCW      0x1388,0x1388
                          DCDU     0x00000000

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  unet_buff_min
000000  1388              DCW      0x1388

                          AREA ||area_number.24||, DATA, ALIGN=0

                          EXPORTAS ||area_number.24||, ||.data||
                  adc_stat
000000  01                DCB      0x01

                          AREA ||area_number.25||, DATA, ALIGN=1

                          EXPORTAS ||area_number.25||, ||.data||
                  bat_ver_cnt
000000  0096              DCW      0x0096

                          AREA ||area_number.26||, DATA, ALIGN=2

                          EXPORTAS ||area_number.26||, ||.data||
                  vent_stat
000000  00                DCB      0x00
                  cntrlStatIsDownCnt
000001  00                DCB      0x00
                  adc_self_ch_cnt
000002  00                DCB      0x00
                  adc_ch_net
000003  00                DCB      0x00
                  adc_ch
000004  00                DCB      0x00
                  adc_ch_cnt
000005  00                DCB      0x00
                  adc_window_flag
000006  00                DCB      0x00
                  ch_cnt0
000007  00                DCB      0x00
                  b1Hz_ch
000008  00                DCB      0x00
                  i
000009  00                DCB      0x00
                  iiii
00000a  00                DCB      0x00
                  cntrl_stat_buff_ptr
00000b  00                DCB      0x00
                  bAVG
00000c  00                DCB      0x00
                  avg_cnt_
00000d  00                DCB      0x00
                  avg_num
00000e  00                DCB      0x00
                  bAVG_BLOCK
00000f  00                DCB      0x00
                  bAVG_DIR
000010  00                DCB      0x00
                  num_of_wrks_bps
000011  00                DCB      0x00
                  num_necc_up
000012  00                DCB      0x00
                  num_necc_down
000013  00                DCB      0x00
                  sh_cnt0
000014  00                DCB      0x00
                  b1Hz_sh
000015  00                DCB      0x00
                  spc_stat
000016  00                DCB      0x00
                  spc_bat
000017  00                DCB      0x00
                  spc_phase
000018  00                DCB      0x00
                  ke_start_stat
000019  00                DCB      0x00
                  numOfForvardBps
00001a  00                DCB      0x00
                  numOfForvardBps_old
00001b  00                DCB      0x00
                  numOfForvardBps_minCnt
00001c  00                DCB      0x00
                  cntrl_hndl_plazma
00001d  00                DCB      0x00
                  cntrl_stat
00001e  04b0              DCW      0x04b0
                  cntrl_stat_old
000020  04b0              DCW      0x04b0
                  avg_main_cnt
000022  0014              DCW      0x0014
                  u_out_reg_main_cnt
000024  000a              DCW      0x000a
                  num_necc_block_cnt
000026  0000              DCB      0x00,0x00
                  net_buff_
000028  0000              DCB      0x00,0x00
                  adc_result
00002a  0000              DCB      0x00,0x00
                  adc_gorb_cnt
00002c  0000              DCB      0x00,0x00
                  adc_zero_cnt
00002e  0000              DCB      0x00,0x00
                  adc_window_cnt
000030  0000              DCB      0x00,0x00
                  adc_net_buff_cnt
000032  0000              DCB      0x00,0x00
                  plazma_sk
000034  0000              DCB      0x00,0x00
                  cntrl_stat_new
000036  0000              DCB      0x00,0x00
                  Ibmax
000038  0000              DCB      0x00,0x00
                  IZMAX_
00003a  0000              DCB      0x00,0x00
                  Ubpsmax
00003c  0000              DCB      0x00,0x00
                  cntrl_stat_buff_
00003e  0000              DCB      0x00,0x00
                  samokalibr_cnt
000040  0000              DCB      0x00,0x00
                  main_kb_cnt
000042  0000              DCB      0x00,0x00
                  bps_on_mask
000044  0000              DCB      0x00,0x00
                  bps_off_mask
000046  0000              DCB      0x00,0x00
                  __ee_spc_stat
000048  0000              DCB      0x00,0x00
                  __ee_spc_bat
00004a  0000              DCB      0x00,0x00
                  __ee_spc_phase
00004c  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt
00004e  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt_
000050  0000              DCB      0x00,0x00
                  numOfForvardBps_hourCnt
000052  0000              DCB      0x00,0x00
                  i_avg_max
                          DCD      0x00000000
                  i_avg_min
                          DCD      0x00000000
                  i_avg_summ
                          DCD      0x00000000
                  i_avg
                          DCD      0x00000000
                  avg
                          DCD      0x00000000
                  plazma_inv
                          DCD      0x00000000
                  net_metr_buff_
                          DCD      0x00000000
000070  0000              DCB      0x00,0x00
                  adc_self_ch_buff
000072  0000              DCB      0x00,0x00
                          DCD      0x00000000
                  adc_self_ch_disp
                          DCD      0x00000000
00007c  00000000          DCB      0x00,0x00,0x00,0x00
                  ke_date
                          %        8

                          AREA ||area_number.27||, DATA, ALIGN=1

                          EXPORTAS ||area_number.27||, ||.data||
                  unet_buff_max
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.28||, DATA, ALIGN=0

                          EXPORTAS ||area_number.28||, ||.data||
                  adc_cnt
000000  00                DCB      0x00

                          AREA ||area_number.29||, DATA, ALIGN=0

                          EXPORTAS ||area_number.29||, ||.data||
                  adc_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.30||, DATA, ALIGN=1

                          EXPORTAS ||area_number.30||, ||.data||
                  zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.31||, DATA, ALIGN=0

                          EXPORTAS ||area_number.31||, ||.data||
                  net_buff_cnt
000000  00                DCB      0x00

                          AREA ||area_number.32||, DATA, ALIGN=1

                          EXPORTAS ||area_number.32||, ||.data||
                  ADWR
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.33||, DATA, ALIGN=1

                          EXPORTAS ||area_number.33||, ||.data||
                  period_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.34||, DATA, ALIGN=1

                          EXPORTAS ||area_number.34||, ||.data||
                  non_zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.35||, DATA, ALIGN=0

                          EXPORTAS ||area_number.35||, ||.data||
                  rele_stat
000000  00                DCB      0x00

                          AREA ||area_number.36||, DATA, ALIGN=0

                          EXPORTAS ||area_number.36||, ||.data||
                  bRELE_OUT
000000  00                DCB      0x00

                          AREA ||area_number.37||, DATA, ALIGN=2

                          EXPORTAS ||area_number.37||, ||.data||
                  main_power_buffer_
                          DCD      0x00000000

                          AREA ||area_number.38||, DATA, ALIGN=1

                          EXPORTAS ||area_number.38||, ||.data||
                  main_power_buffer_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.39||, DATA, ALIGN=1

                          EXPORTAS ||area_number.39||, ||.data||
                  adc_buff_out_
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00

                          AREA ||area_number.40||, DATA, ALIGN=1

                          EXPORTAS ||area_number.40||, ||.data||
                  plazma_adc_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.41||, DATA, ALIGN=0

                          EXPORTAS ||area_number.41||, ||.data||
                  unh_cnt0
000000  00                DCB      0x00

                          AREA ||area_number.42||, DATA, ALIGN=0

                          EXPORTAS ||area_number.42||, ||.data||
                  unh_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.43||, DATA, ALIGN=0

                          EXPORTAS ||area_number.43||, ||.data||
                  b1Hz_unh
000000  00                DCB      0x00

                          AREA ||area_number.44||, DATA, ALIGN=0

                          EXPORTAS ||area_number.44||, ||.data||
                  ch_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.45||, DATA, ALIGN=0

                          EXPORTAS ||area_number.45||, ||.data||
                  b1_30Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.46||, DATA, ALIGN=0

                          EXPORTAS ||area_number.46||, ||.data||
                  ch_cnt2
000000  00                DCB      0x00

                          AREA ||area_number.47||, DATA, ALIGN=0

                          EXPORTAS ||area_number.47||, ||.data||
                  b1_10Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.48||, DATA, ALIGN=1

                          EXPORTAS ||area_number.48||, ||.data||
                  IZMAX_70
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.49||, DATA, ALIGN=1

                          EXPORTAS ||area_number.49||, ||.data||
                  IZMAX_130
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.50||, DATA, ALIGN=1

                          EXPORTAS ||area_number.50||, ||.data||
                  cntrl_stat_blck_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.51||, DATA, ALIGN=1

                          EXPORTAS ||area_number.51||, ||.data||
                  kb_cnt_1lev
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.52||, DATA, ALIGN=1

                          EXPORTAS ||area_number.52||, ||.data||
                  kb_cnt_2lev
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.53||, DATA, ALIGN=0

                          EXPORTAS ||area_number.53||, ||.data||
                  kb_full_ver
000000  00                DCB      0x00

                          AREA ||area_number.54||, DATA, ALIGN=0

                          EXPORTAS ||area_number.54||, ||.data||
                  kb_start
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.55||, DATA, ALIGN=0

                          EXPORTAS ||area_number.55||, ||.data||
                  kb_start_ips
000000  00                DCB      0x00

                          AREA ||area_number.56||, DATA, ALIGN=1

                          EXPORTAS ||area_number.56||, ||.data||
                  ibat_ips
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.57||, DATA, ALIGN=1

                          EXPORTAS ||area_number.57||, ||.data||
                  ibat_ips_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.58||, DATA, ALIGN=0

                          EXPORTAS ||area_number.58||, ||.data||
                  bps_all_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.59||, DATA, ALIGN=0

                          EXPORTAS ||area_number.59||, ||.data||
                  bps_mask_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.60||, DATA, ALIGN=0

                          EXPORTAS ||area_number.60||, ||.data||
                  bps_mask_on_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.61||, DATA, ALIGN=0

                          EXPORTAS ||area_number.61||, ||.data||
                  bps_hndl_2sec_cnt
000000  00                DCB      0x00

                          AREA ||area_number.62||, DATA, ALIGN=1

                          EXPORTAS ||area_number.62||, ||.data||
                  vz_cnt_s
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.63||, DATA, ALIGN=1

                          EXPORTAS ||area_number.63||, ||.data||
                  vz_cnt_s_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.64||, DATA, ALIGN=1

                          EXPORTAS ||area_number.64||, ||.data||
                  vz_cnt_h
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.65||, DATA, ALIGN=1

                          EXPORTAS ||area_number.65||, ||.data||
                  vz_cnt_h_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.66||, DATA, ALIGN=0

                          EXPORTAS ||area_number.66||, ||.data||
                  bAVZ
000000  00                DCB      0x00

                          AREA ||area_number.67||, DATA, ALIGN=1

                          EXPORTAS ||area_number.67||, ||.data||
                  cnt_end_ke
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.68||, DATA, ALIGN=1

                          EXPORTAS ||area_number.68||, ||.data||
                  __ee_vz_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.69||, DATA, ALIGN=1

                          EXPORTAS ||area_number.69||, ||.data||
                  cntrl_stat_blok_cnt_plus
                          DCDU     0x00000000

                          AREA ||area_number.70||, DATA, ALIGN=1

                          EXPORTAS ||area_number.70||, ||.data||
                  cntrl_stat_blok_cnt_minus
                          DCDU     0x00000000

                          AREA ||area_number.71||, DATA, ALIGN=0

                          EXPORTAS ||area_number.71||, ||.data||
                  plazma_bat
000000  00                DCB      0x00

                          AREA ||area_number.72||, DATA, ALIGN=0

                          EXPORTAS ||area_number.72||, ||.data||
                  plazma_cntrl_stat
000000  00                DCB      0x00

;*** Start embedded assembler ***

#line 1 "control.c"
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___9_control_c_9601dfb0____REV16|
#line 112 "C:\\Keil\\ARM\\CMSIS\\Include\\core_cmInstr.h"
|__asm___9_control_c_9601dfb0____REV16| PROC
#line 113

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___9_control_c_9601dfb0____REVSH|
#line 130
|__asm___9_control_c_9601dfb0____REVSH| PROC
#line 131

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
